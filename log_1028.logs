{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': None, 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.5, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 2, 'av_threshold': 3, 'max_ngram_length': 5, 'model_name': 'bert_memory_softmax_score_0.7_0.8', 'use_memory': False, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of trainable parameters: 102273792
***** Running training *****
  Num examples = 120
  Batch size = 16
  Num steps = 350
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:02,  3.08it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  3.64it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  3.92it/s][A
 50%|█████     | 4/8 [00:01<00:00,  4.15it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.29it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.28it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.35it/s][A
100%|██████████| 8/8 [00:01<00:00,  4.99it/s][A100%|██████████| 8/8 [00:01<00:00,  4.37it/s]
OOV: 0.055951
GEO: 0.015666
=======entity level========

Epoch: 1, P: 0.270501, R: 0.171962, F: 0.210259, OOV: 0.055951, GEO: 0.015666
=======entity level========
/opt/DevEnvs/anaconda3/envs/WM/lib/python3.6/site-packages/seqeval/metrics/sequence_labeling.py:171: UserWarning: [SEP] seems not to be NE tag.
  warnings.warn('{} seems not to be NE tag.'.format(chunk))
/opt/DevEnvs/anaconda3/envs/WM/lib/python3.6/site-packages/seqeval/metrics/sequence_labeling.py:171: UserWarning: [CLS] seems not to be NE tag.
  warnings.warn('{} seems not to be NE tag.'.format(chunk))
/opt/DevEnvs/anaconda3/envs/WM/lib/python3.6/site-packages/seqeval/metrics/sequence_labeling.py:171: UserWarning: [UNKONW] seems not to be NE tag.
  warnings.warn('{} seems not to be NE tag.'.format(chunk))
/opt/DevEnvs/anaconda3/envs/WM/lib/python3.6/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Epoch:   2%|▏         | 1/50 [00:04<03:39,  4.48s/it]P:  0.27050142545698475
R:  0.17196162046908314
F:  0.2102587499185296

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  4.18it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.22it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.37it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.45it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.41it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.36it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.43it/s][A
100%|██████████| 8/8 [00:01<00:00,  4.93it/s][A100%|██████████| 8/8 [00:01<00:00,  4.57it/s]
OOV: 0.218952
GEO: 0.081509
=======entity level========

Epoch: 2, P: 0.509869, R: 0.556290, F: 0.532069, OOV: 0.218952, GEO: 0.081509
=======entity level========
Epoch:   4%|▍         | 2/50 [00:09<03:37,  4.53s/it]P:  0.5098690639046316
R:  0.5562899786780384
F:  0.5320689303558682

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  4.16it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.41it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.35it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.35it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.41it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.44it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.37it/s][A
100%|██████████| 8/8 [00:01<00:00,  4.95it/s][A100%|██████████| 8/8 [00:01<00:00,  4.58it/s]
OOV: 0.603169
GEO: 0.315637
=======entity level========

Epoch: 3, P: 0.757529, R: 0.785714, F: 0.771364, OOV: 0.603169, GEO: 0.315637
=======entity level========
Epoch:   6%|▌         | 3/50 [00:13<03:36,  4.60s/it]P:  0.7575290368999897
R:  0.7857142857142857
F:  0.7713642786121723

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  4.18it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.41it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.65it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.50it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.40it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.39it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.34it/s][A
100%|██████████| 8/8 [00:01<00:00,  4.87it/s][A100%|██████████| 8/8 [00:01<00:00,  4.59it/s]
OOV: 0.749030
GEO: 0.655991
=======entity level========

Epoch: 4, P: 0.872869, R: 0.862260, F: 0.867532, OOV: 0.749030, GEO: 0.655991
=======entity level========
Epoch:   8%|▊         | 4/50 [00:18<03:32,  4.62s/it]P:  0.8728685516943665
R:  0.8622601279317698
F:  0.8675319103292931

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  5.10it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.79it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.56it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.43it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.36it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.32it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.30it/s][A
100%|██████████| 8/8 [00:01<00:00,  4.87it/s][A100%|██████████| 8/8 [00:01<00:00,  4.61it/s]
OOV: 0.779754
GEO: 0.815671
=======entity level========

Epoch: 5, P: 0.902997, R: 0.880277, F: 0.891492, OOV: 0.779754, GEO: 0.815671
=======entity level========
Epoch:  10%|█         | 5/50 [00:22<03:25,  4.57s/it]P:  0.9029965004374453
R:  0.8802771855010662
F:  0.8914921183329735

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  4.32it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.44it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.46it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.38it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.33it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.41it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.36it/s][A
100%|██████████| 8/8 [00:01<00:00,  5.06it/s][A100%|██████████| 8/8 [00:01<00:00,  4.63it/s]
OOV: 0.791074
GEO: 0.714637
=======entity level========

Epoch: 6, P: 0.892789, R: 0.892217, F: 0.892503, OOV: 0.791074, GEO: 0.714637
=======entity level========
Epoch:  12%|█▏        | 6/50 [00:27<03:20,  4.57s/it]P:  0.8927885641135055
R:  0.8922174840085287
F:  0.892502932707689

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  4.25it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.25it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.58it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.44it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.42it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.45it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.39it/s][A
100%|██████████| 8/8 [00:01<00:00,  4.91it/s][A100%|██████████| 8/8 [00:01<00:00,  4.60it/s]
OOV: 0.785576
GEO: 0.826960
=======entity level========

Epoch: 7, P: 0.913875, R: 0.886887, F: 0.900179, OOV: 0.785576, GEO: 0.826960
=======entity level========
Epoch:  14%|█▍        | 7/50 [00:32<03:17,  4.60s/it]P:  0.9138745468526859
R:  0.8868869936034115
F:  0.9001785424444084

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  4.91it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.71it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.49it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.42it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.44it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.38it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.59it/s][A
100%|██████████| 8/8 [00:01<00:00,  5.05it/s][A100%|██████████| 8/8 [00:01<00:00,  4.71it/s]
OOV: 0.791074
GEO: 0.761726
=======entity level========

Epoch: 8, P: 0.899476, R: 0.896695, F: 0.898083, OOV: 0.791074, GEO: 0.761726
=======entity level========
Epoch:  16%|█▌        | 8/50 [00:36<03:06,  4.44s/it]P:  0.899475991872527
R:  0.8966950959488273
F:  0.8980833911697187

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  4.28it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.34it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.31it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.37it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.36it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.32it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.30it/s][A
100%|██████████| 8/8 [00:01<00:00,  4.89it/s][A100%|██████████| 8/8 [00:01<00:00,  4.53it/s]
OOV: 0.797542
GEO: 0.796935
=======entity level========

Epoch: 9, P: 0.913408, R: 0.894030, F: 0.903615, OOV: 0.797542, GEO: 0.796935
=======entity level========
Epoch:  18%|█▊        | 9/50 [00:40<03:03,  4.48s/it]P:  0.9134081254765276
R:  0.8940298507462686
F:  0.903615106944669

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  4.36it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.47it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.40it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.34it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.31it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.30it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.39it/s][A
100%|██████████| 8/8 [00:01<00:00,  4.95it/s][A100%|██████████| 8/8 [00:01<00:00,  4.57it/s]
OOV: 0.792691
GEO: 0.719266
=======entity level========

Epoch: 10, P: 0.904313, R: 0.900746, F: 0.902526, OOV: 0.792691, GEO: 0.719266
=======entity level========
Epoch:  20%|██        | 10/50 [00:44<02:52,  4.31s/it]P:  0.9043133897035214
R:  0.9007462686567164
F:  0.9025263045452117

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  4.28it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.26it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.26it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.37it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.33it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.35it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.41it/s][A
100%|██████████| 8/8 [00:01<00:00,  4.93it/s][A100%|██████████| 8/8 [00:01<00:00,  4.55it/s]
OOV: 0.794631
GEO: 0.795411
=======entity level========

Epoch: 11, P: 0.917104, R: 0.895203, F: 0.906021, OOV: 0.794631, GEO: 0.795411
=======entity level========
Epoch:  22%|██▏       | 11/50 [00:49<02:51,  4.39s/it]P:  0.9171035386631717
R:  0.8952025586353944
F:  0.9060207164436772

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  4.25it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.43it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.41it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.34it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.43it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.48it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.64it/s][A
100%|██████████| 8/8 [00:01<00:00,  5.10it/s][A100%|██████████| 8/8 [00:01<00:00,  4.68it/s]
OOV: 0.796248
GEO: 0.780519
=======entity level========

Epoch: 12, P: 0.912723, R: 0.898614, F: 0.905614, OOV: 0.796248, GEO: 0.780519
=======entity level========
Epoch:  24%|██▍       | 12/50 [00:53<02:40,  4.24s/it]P:  0.9127233351380617
R:  0.8986140724946695
F:  0.9056137523502552

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  4.32it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.28it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.42it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.40it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.62it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.49it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.41it/s][A
100%|██████████| 8/8 [00:01<00:00,  4.96it/s][A100%|██████████| 8/8 [00:01<00:00,  4.63it/s]
OOV: 0.799159
GEO: 0.763158
=======entity level========

Epoch: 13, P: 0.910946, R: 0.899680, F: 0.905278, OOV: 0.799159, GEO: 0.763158
=======entity level========
Epoch:  26%|██▌       | 13/50 [00:57<02:32,  4.13s/it]P:  0.9109455958549223
R:  0.8996801705756929
F:  0.9052778373739541

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  4.35it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.44it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.35it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.36it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.43it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.37it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.56it/s][A
100%|██████████| 8/8 [00:01<00:00,  5.10it/s][A100%|██████████| 8/8 [00:01<00:00,  4.66it/s]
OOV: 0.789780
GEO: 0.812339
=======entity level========

Epoch: 14, P: 0.922161, R: 0.891684, F: 0.906667, OOV: 0.789780, GEO: 0.812339
=======entity level========
Epoch:  28%|██▊       | 14/50 [01:01<02:34,  4.29s/it]P:  0.9221609702315325
R:  0.8916844349680171
F:  0.9066666666666667

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  5.02it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.54it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.41it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.37it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.58it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.49it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.42it/s][A
100%|██████████| 8/8 [00:01<00:00,  4.92it/s][A100%|██████████| 8/8 [00:01<00:00,  4.65it/s]
OOV: 0.793014
GEO: 0.782222
=======entity level========

Epoch: 15, P: 0.911822, R: 0.896269, F: 0.903978, OOV: 0.793014, GEO: 0.782222
=======entity level========
Epoch:  30%|███       | 15/50 [01:05<02:25,  4.17s/it]P:  0.911822125813449
R:  0.8962686567164179
F:  0.9039784946236559

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  4.25it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.26it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.36it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.35it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.60it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.73it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.56it/s][A
100%|██████████| 8/8 [00:01<00:00,  5.09it/s][A100%|██████████| 8/8 [00:01<00:00,  4.70it/s]
OOV: 0.797542
GEO: 0.782222
=======entity level========

Epoch: 16, P: 0.909032, R: 0.899147, F: 0.904063, OOV: 0.797542, GEO: 0.782222
=======entity level========
Epoch:  32%|███▏      | 16/50 [01:09<02:18,  4.08s/it]P:  0.9090321189911619
R:  0.8991471215351813
F:  0.9040626004930861

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  4.26it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.29it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.31it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.38it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.34it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.31it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.39it/s][A
100%|██████████| 8/8 [00:01<00:00,  4.89it/s][A100%|██████████| 8/8 [00:01<00:00,  4.54it/s]
OOV: 0.799483
GEO: 0.766437
=======entity level========

Epoch: 17, P: 0.905261, R: 0.902559, F: 0.903908, OOV: 0.799483, GEO: 0.766437
=======entity level========
Epoch:  34%|███▍      | 17/50 [01:13<02:13,  4.04s/it]P:  0.9052609067579127
R:  0.9025586353944562
F:  0.9039077514413837

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  4.24it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.42it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.40it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.34it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.43it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.37it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.43it/s][A
100%|██████████| 8/8 [00:01<00:00,  4.99it/s][A100%|██████████| 8/8 [00:01<00:00,  4.61it/s]
OOV: 0.796895
GEO: 0.775330
=======entity level========

Epoch: 18, P: 0.913876, R: 0.895949, F: 0.904823, OOV: 0.796895, GEO: 0.775330
=======entity level========
Epoch:  36%|███▌      | 18/50 [01:17<02:08,  4.01s/it]P:  0.9138755980861244
R:  0.8959488272921109
F:  0.9048234280792421

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  4.25it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.25it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.26it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.25it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.36it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.44it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.48it/s][A
100%|██████████| 8/8 [00:01<00:00,  5.02it/s][A100%|██████████| 8/8 [00:01<00:00,  4.59it/s]
OOV: 0.796248
GEO: 0.772613
=======entity level========

Epoch: 19, P: 0.911918, R: 0.897335, F: 0.904567, OOV: 0.796248, GEO: 0.772613
=======entity level========
Epoch:  38%|███▊      | 19/50 [01:21<02:03,  3.98s/it]P:  0.9119176598049837
R:  0.8973347547974414
F:  0.9045674368619022

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  4.25it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.44it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.40it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.34it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.30it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.31it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.39it/s][A
100%|██████████| 8/8 [00:01<00:00,  4.89it/s][A100%|██████████| 8/8 [00:01<00:00,  4.55it/s]
OOV: 0.794955
GEO: 0.769906
=======entity level========

Epoch: 20, P: 0.909778, R: 0.898721, F: 0.904215, OOV: 0.794955, GEO: 0.769906
=======entity level========
Epoch:  40%|████      | 20/50 [01:25<01:59,  3.98s/it]P:  0.909777681847615
R:  0.8987206823027718
F:  0.9042153813150273

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  4.25it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.45it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.35it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.34it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.43it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.45it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.39it/s][A
100%|██████████| 8/8 [00:01<00:00,  5.02it/s][A100%|██████████| 8/8 [00:01<00:00,  4.62it/s]
OOV: 0.797542
GEO: 0.788840
=======entity level========

Epoch: 21, P: 0.915081, R: 0.897228, F: 0.906067, OOV: 0.797542, GEO: 0.788840
=======entity level========
Epoch:  42%|████▏     | 21/50 [01:29<01:54,  3.96s/it]P:  0.9150810046754376
R:  0.897228144989339
F:  0.9060666415459977

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  4.23it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.32it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.34it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.30it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.31it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.40it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.46it/s][A
100%|██████████| 8/8 [00:01<00:00,  4.95it/s][A100%|██████████| 8/8 [00:01<00:00,  4.57it/s]
OOV: 0.801423
GEO: 0.802296
=======entity level========

Epoch: 22, P: 0.916612, R: 0.896482, F: 0.906435, OOV: 0.801423, GEO: 0.802296
=======entity level========
Epoch:  44%|████▍     | 22/50 [01:33<01:50,  3.95s/it]P:  0.9166121648136036
R:  0.8964818763326226
F:  0.9064352700226366

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  4.56it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.37it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.37it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.36it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.41it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.35it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.34it/s][A
100%|██████████| 8/8 [00:01<00:00,  4.93it/s][A100%|██████████| 8/8 [00:01<00:00,  4.58it/s]
OOV: 0.801423
GEO: 0.801532
=======entity level========

Epoch: 23, P: 0.914397, R: 0.898507, F: 0.906383, OOV: 0.801423, GEO: 0.801532
=======entity level========
Epoch:  46%|████▌     | 23/50 [01:36<01:46,  3.94s/it]P:  0.9143973093197353
R:  0.8985074626865671
F:  0.9063827499058987

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:01,  4.51it/s][A
 25%|██▌       | 2/8 [00:00<00:01,  4.55it/s][A
 38%|███▊      | 3/8 [00:00<00:01,  4.44it/s][A
 50%|█████     | 4/8 [00:00<00:00,  4.36it/s][A
 62%|██████▎   | 5/8 [00:01<00:00,  4.57it/s][A
 75%|███████▌  | 6/8 [00:01<00:00,  4.45it/s][A
 88%|████████▊ | 7/8 [00:01<00:00,  4.39it/s][A
100%|██████████| 8/8 [00:01<00:00,  4.89it/s][A100%|██████████| 8/8 [00:01<00:00,  4.62it/s]
OOV: 0.800776
GEO: 0.791878
=======entity level========

Epoch: 24, P: 0.911476, R: 0.900107, F: 0.905756, OOV: 0.800776, GEO: 0.791878
=======entity level========

Early stop triggered at epoch 23

Epoch:  46%|████▌     | 23/50 [01:40<01:58,  4.39s/it]

=======best f entity level========

Epoch: 14, P: 0.922161, R: 0.891684, F: 0.906667, OOV: 0.789780, GEO: 0.812339, GEO_N: 0.820261


=======best f entity level========
P:  0.9114757637914283
R:  0.9001066098081023
F:  0.9057555114520195
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:47,  1.28it/s]  3%|▎         | 2/62 [00:01<00:43,  1.37it/s]  5%|▍         | 3/62 [00:02<00:41,  1.42it/s]  6%|▋         | 4/62 [00:02<00:43,  1.32it/s]  8%|▊         | 5/62 [00:03<00:44,  1.29it/s] 10%|▉         | 6/62 [00:04<00:46,  1.21it/s] 11%|█▏        | 7/62 [00:05<00:40,  1.36it/s] 13%|█▎        | 8/62 [00:05<00:36,  1.48it/s] 15%|█▍        | 9/62 [00:06<00:38,  1.39it/s] 16%|█▌        | 10/62 [00:07<00:36,  1.42it/s] 18%|█▊        | 11/62 [00:08<00:41,  1.24it/s] 19%|█▉        | 12/62 [00:09<00:38,  1.31it/s] 21%|██        | 13/62 [00:09<00:38,  1.26it/s] 23%|██▎       | 14/62 [00:10<00:37,  1.29it/s] 24%|██▍       | 15/62 [00:11<00:34,  1.34it/s] 26%|██▌       | 16/62 [00:11<00:30,  1.52it/s] 27%|██▋       | 17/62 [00:12<00:27,  1.65it/s] 29%|██▉       | 18/62 [00:12<00:28,  1.56it/s] 31%|███       | 19/62 [00:14<00:33,  1.30it/s] 32%|███▏      | 20/62 [00:15<00:36,  1.15it/s] 34%|███▍      | 21/62 [00:16<00:42,  1.04s/it] 35%|███▌      | 22/62 [00:17<00:38,  1.03it/s] 37%|███▋      | 23/62 [00:17<00:32,  1.18it/s] 39%|███▊      | 24/62 [00:18<00:31,  1.20it/s] 40%|████      | 25/62 [00:20<00:38,  1.05s/it] 42%|████▏     | 26/62 [00:21<00:36,  1.01s/it] 44%|████▎     | 27/62 [00:21<00:32,  1.09it/s] 45%|████▌     | 28/62 [00:22<00:30,  1.10it/s] 47%|████▋     | 29/62 [00:23<00:29,  1.13it/s] 48%|████▊     | 30/62 [00:24<00:26,  1.20it/s] 50%|█████     | 31/62 [00:25<00:25,  1.24it/s] 52%|█████▏    | 32/62 [00:25<00:21,  1.37it/s] 53%|█████▎    | 33/62 [00:26<00:22,  1.32it/s] 55%|█████▍    | 34/62 [00:27<00:22,  1.25it/s] 56%|█████▋    | 35/62 [00:28<00:21,  1.28it/s] 58%|█████▊    | 36/62 [00:28<00:18,  1.41it/s] 60%|█████▉    | 37/62 [00:29<00:15,  1.64it/s] 61%|██████▏   | 38/62 [00:29<00:14,  1.61it/s] 63%|██████▎   | 39/62 [00:30<00:16,  1.39it/s] 65%|██████▍   | 40/62 [00:31<00:15,  1.39it/s] 66%|██████▌   | 41/62 [00:31<00:14,  1.42it/s] 68%|██████▊   | 42/62 [00:32<00:13,  1.43it/s] 69%|██████▉   | 43/62 [00:33<00:13,  1.40it/s] 71%|███████   | 44/62 [00:33<00:12,  1.49it/s] 73%|███████▎  | 45/62 [00:35<00:13,  1.23it/s] 74%|███████▍  | 46/62 [00:35<00:11,  1.34it/s] 76%|███████▌  | 47/62 [00:36<00:10,  1.46it/s] 77%|███████▋  | 48/62 [00:36<00:09,  1.46it/s] 79%|███████▉  | 49/62 [00:38<00:10,  1.23it/s] 81%|████████  | 50/62 [00:38<00:09,  1.26it/s] 82%|████████▏ | 51/62 [00:39<00:08,  1.24it/s] 84%|████████▍ | 52/62 [00:40<00:08,  1.22it/s] 85%|████████▌ | 53/62 [00:41<00:08,  1.04it/s] 87%|████████▋ | 54/62 [00:42<00:07,  1.13it/s] 89%|████████▊ | 55/62 [00:43<00:05,  1.21it/s] 90%|█████████ | 56/62 [00:43<00:04,  1.36it/s] 92%|█████████▏| 57/62 [00:44<00:03,  1.40it/s] 94%|█████████▎| 58/62 [00:45<00:02,  1.43it/s] 95%|█████████▌| 59/62 [00:45<00:02,  1.42it/s] 97%|█████████▋| 60/62 [00:46<00:01,  1.52it/s] 98%|█████████▊| 61/62 [00:47<00:00,  1.31it/s]100%|██████████| 62/62 [00:48<00:00,  1.33it/s]100%|██████████| 62/62 [00:48<00:00,  1.29it/s]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 2, 'av_threshold': 3, 'max_ngram_length': 5, 'model_name': 'self_bert_memory_softmax_score_0.7_0.81', 'use_memory': False, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of trainable parameters: 102273792
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.47s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.50s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.46s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.661061
GEO: 0.552273
=======entity level========

Epoch: 1, P: 0.822134, R: 0.798294, F: 0.810039, OOV: 0.661061, GEO: 0.552273
=======entity level========
Epoch:   2%|▏         | 1/50 [00:21<17:27, 21.39s/it]P:  0.8221343873517787
R:  0.7982942430703625
F:  0.8100389441800085

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.38s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.48s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.47s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.786869
GEO: 0.832468
=======entity level========

Epoch: 2, P: 0.914513, R: 0.882729, F: 0.898340, OOV: 0.786869, GEO: 0.832468
=======entity level========
Epoch:   4%|▍         | 2/50 [00:42<17:12, 21.51s/it]P:  0.9145129224652088
R:  0.8827292110874201
F:  0.8983400238689379

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.43s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.40s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.791721
GEO: 0.824368
=======entity level========

Epoch: 3, P: 0.919827, R: 0.884328, F: 0.901728, OOV: 0.791721, GEO: 0.824368
=======entity level========
Epoch:   6%|▌         | 3/50 [01:03<16:35, 21.18s/it]P:  0.9198270126413839
R:  0.8843283582089553
F:  0.9017284487444289

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.52s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.790427
GEO: 0.838542
=======entity level========

Epoch: 4, P: 0.925580, R: 0.888380, F: 0.906598, OOV: 0.790427, GEO: 0.838542
=======entity level========
Epoch:   8%|▊         | 4/50 [01:25<16:28, 21.50s/it]P:  0.9255803621015217
R:  0.8883795309168443
F:  0.9065984877332318

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.42s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.47s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.19s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.791074
GEO: 0.855091
=======entity level========

Epoch: 5, P: 0.926219, R: 0.884648, F: 0.904957, OOV: 0.791074, GEO: 0.855091
=======entity level========
Epoch:  10%|█         | 5/50 [01:47<16:17, 21.73s/it]P:  0.92621944413439
R:  0.8846481876332623
F:  0.9049566497628005

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.48s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.772639
GEO: 0.858273
=======entity level========

Epoch: 6, P: 0.921562, R: 0.878038, F: 0.899274, OOV: 0.772639, GEO: 0.858273
=======entity level========
Epoch:  12%|█▏        | 6/50 [02:09<15:54, 21.69s/it]P:  0.9215620454291149
R:  0.8780383795309168
F:  0.8992738985641753

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.43s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.796895
GEO: 0.833654
=======entity level========

Epoch: 7, P: 0.924368, R: 0.892537, F: 0.908174, OOV: 0.796895, GEO: 0.833654
=======entity level========
Epoch:  14%|█▍        | 7/50 [02:30<15:21, 21.43s/it]P:  0.9243678922380479
R:  0.8925373134328358
F:  0.9081737809838912

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.800453
GEO: 0.839043
=======entity level========

Epoch: 8, P: 0.923558, R: 0.897761, F: 0.910477, OOV: 0.800453, GEO: 0.839043
=======entity level========
Epoch:  16%|█▌        | 8/50 [02:51<14:52, 21.25s/it]P:  0.9235577977626672
R:  0.8977611940298508
F:  0.9104768083036003

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.50s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.49s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.21s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.797219
GEO: 0.838961
=======entity level========

Epoch: 9, P: 0.927201, R: 0.896162, F: 0.911417, OOV: 0.797219, GEO: 0.838961
=======entity level========
Epoch:  18%|█▊        | 9/50 [03:12<14:27, 21.16s/it]P:  0.9272005294506949
R:  0.8961620469083156
F:  0.911417109400412

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.40s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.42s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.794631
GEO: 0.828829
=======entity level========

Epoch: 10, P: 0.928809, R: 0.891578, F: 0.909813, OOV: 0.794631, GEO: 0.828829
=======entity level========
Epoch:  20%|██        | 10/50 [03:33<14:02, 21.06s/it]P:  0.9288094180364282
R:  0.8915778251599147
F:  0.9098128807658834

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.39s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.798512
GEO: 0.849351
=======entity level========

Epoch: 11, P: 0.924528, R: 0.893284, F: 0.908637, OOV: 0.798512, GEO: 0.849351
=======entity level========
Epoch:  22%|██▏       | 11/50 [03:53<13:36, 20.94s/it]P:  0.9245283018867925
R:  0.8932835820895523
F:  0.9086374234126768

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.40s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.797542
GEO: 0.848603
=======entity level========

Epoch: 12, P: 0.926991, R: 0.893390, F: 0.909881, OOV: 0.797542, GEO: 0.848603
=======entity level========
Epoch:  24%|██▍       | 12/50 [04:14<13:13, 20.88s/it]P:  0.9269911504424779
R:  0.8933901918976546
F:  0.9098805646036917

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.38s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.22s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.798836
GEO: 0.824134
=======entity level========

Epoch: 13, P: 0.923280, R: 0.895522, F: 0.909189, OOV: 0.798836, GEO: 0.824134
=======entity level========
Epoch:  26%|██▌       | 13/50 [04:35<12:52, 20.87s/it]P:  0.9232798417234557
R:  0.8955223880597015
F:  0.9091893062019699

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.48s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.795602
GEO: 0.836364
=======entity level========

Epoch: 14, P: 0.925287, R: 0.892537, F: 0.908617, OOV: 0.795602, GEO: 0.836364
=======entity level========
Epoch:  28%|██▊       | 14/50 [04:56<12:31, 20.89s/it]P:  0.9252873563218391
R:  0.8925373134328358
F:  0.9086173214673324

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.51s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.46s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.40s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.799483
GEO: 0.832258
=======entity level========

Epoch: 15, P: 0.926743, R: 0.895522, F: 0.910865, OOV: 0.799483, GEO: 0.832258
=======entity level========
Epoch:  30%|███       | 15/50 [05:17<12:10, 20.88s/it]P:  0.9267431597528685
R:  0.8955223880597015
F:  0.9108653220559532

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.53s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.798512
GEO: 0.823907
=======entity level========

Epoch: 16, P: 0.928485, R: 0.896908, F: 0.912423, OOV: 0.798512, GEO: 0.823907
=======entity level========

Early stop triggered at epoch 15

Epoch:  30%|███       | 15/50 [05:38<13:08, 22.54s/it]

=======best f entity level========

Epoch: 6, P: 0.921562, R: 0.878038, F: 0.899274, OOV: 0.772639, GEO: 0.858273, GEO_N: 0.829378


=======best f entity level========
P:  0.9284847147114005
R:  0.896908315565032
F:  0.9124234043706958
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:47,  1.28it/s]  3%|▎         | 2/62 [00:01<00:43,  1.37it/s]  5%|▍         | 3/62 [00:02<00:41,  1.41it/s]  6%|▋         | 4/62 [00:02<00:44,  1.32it/s]  8%|▊         | 5/62 [00:03<00:44,  1.28it/s] 10%|▉         | 6/62 [00:04<00:46,  1.21it/s] 11%|█▏        | 7/62 [00:05<00:40,  1.36it/s] 13%|█▎        | 8/62 [00:05<00:36,  1.48it/s] 15%|█▍        | 9/62 [00:06<00:38,  1.39it/s] 16%|█▌        | 10/62 [00:07<00:36,  1.42it/s] 18%|█▊        | 11/62 [00:08<00:41,  1.24it/s] 19%|█▉        | 12/62 [00:09<00:38,  1.31it/s] 21%|██        | 13/62 [00:09<00:38,  1.26it/s] 23%|██▎       | 14/62 [00:10<00:37,  1.29it/s] 24%|██▍       | 15/62 [00:11<00:35,  1.34it/s] 26%|██▌       | 16/62 [00:11<00:30,  1.52it/s] 27%|██▋       | 17/62 [00:12<00:27,  1.64it/s] 29%|██▉       | 18/62 [00:12<00:28,  1.56it/s] 31%|███       | 19/62 [00:14<00:33,  1.30it/s] 32%|███▏      | 20/62 [00:15<00:36,  1.15it/s] 34%|███▍      | 21/62 [00:16<00:42,  1.04s/it] 35%|███▌      | 22/62 [00:17<00:38,  1.03it/s] 37%|███▋      | 23/62 [00:17<00:32,  1.18it/s] 39%|███▊      | 24/62 [00:18<00:31,  1.20it/s] 40%|████      | 25/62 [00:20<00:38,  1.05s/it] 42%|████▏     | 26/62 [00:21<00:36,  1.01s/it] 44%|████▎     | 27/62 [00:21<00:32,  1.09it/s] 45%|████▌     | 28/62 [00:22<00:30,  1.10it/s] 47%|████▋     | 29/62 [00:23<00:29,  1.12it/s] 48%|████▊     | 30/62 [00:24<00:26,  1.19it/s] 50%|█████     | 31/62 [00:25<00:25,  1.24it/s] 52%|█████▏    | 32/62 [00:25<00:21,  1.37it/s] 53%|█████▎    | 33/62 [00:26<00:22,  1.31it/s] 55%|█████▍    | 34/62 [00:27<00:22,  1.24it/s] 56%|█████▋    | 35/62 [00:28<00:21,  1.28it/s] 58%|█████▊    | 36/62 [00:28<00:18,  1.41it/s] 60%|█████▉    | 37/62 [00:29<00:15,  1.64it/s] 61%|██████▏   | 38/62 [00:29<00:14,  1.61it/s] 63%|██████▎   | 39/62 [00:30<00:16,  1.39it/s] 65%|██████▍   | 40/62 [00:31<00:15,  1.39it/s] 66%|██████▌   | 41/62 [00:32<00:14,  1.42it/s] 68%|██████▊   | 42/62 [00:32<00:13,  1.43it/s] 69%|██████▉   | 43/62 [00:33<00:13,  1.40it/s] 71%|███████   | 44/62 [00:34<00:12,  1.48it/s] 73%|███████▎  | 45/62 [00:35<00:13,  1.23it/s] 74%|███████▍  | 46/62 [00:35<00:12,  1.33it/s] 76%|███████▌  | 47/62 [00:36<00:10,  1.45it/s] 77%|███████▋  | 48/62 [00:37<00:09,  1.46it/s] 79%|███████▉  | 49/62 [00:38<00:10,  1.23it/s] 81%|████████  | 50/62 [00:38<00:09,  1.26it/s] 82%|████████▏ | 51/62 [00:39<00:08,  1.23it/s] 84%|████████▍ | 52/62 [00:40<00:08,  1.22it/s] 85%|████████▌ | 53/62 [00:41<00:08,  1.04it/s] 87%|████████▋ | 54/62 [00:42<00:07,  1.13it/s] 89%|████████▊ | 55/62 [00:43<00:05,  1.21it/s] 90%|█████████ | 56/62 [00:43<00:04,  1.36it/s] 92%|█████████▏| 57/62 [00:44<00:03,  1.40it/s] 94%|█████████▎| 58/62 [00:45<00:02,  1.43it/s] 95%|█████████▌| 59/62 [00:45<00:02,  1.42it/s] 97%|█████████▋| 60/62 [00:46<00:01,  1.52it/s] 98%|█████████▊| 61/62 [00:47<00:00,  1.31it/s]100%|██████████| 62/62 [00:48<00:00,  1.33it/s]100%|██████████| 62/62 [00:48<00:00,  1.29it/s]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 2, 'av_threshold': 3, 'max_ngram_length': 5, 'model_name': 'self_bert_memory_softmax_score_0.7_0.82', 'use_memory': False, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of trainable parameters: 102273792
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.47s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.50s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.46s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.657503
GEO: 0.585113
=======entity level========

Epoch: 1, P: 0.815092, R: 0.789979, F: 0.802339, OOV: 0.657503, GEO: 0.585113
=======entity level========
Epoch:   2%|▏         | 1/50 [00:21<17:29, 21.41s/it]P:  0.8150918490815092
R:  0.7899786780383795
F:  0.8023388013643009

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.38s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.48s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.47s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.769405
GEO: 0.852825
=======entity level========

Epoch: 2, P: 0.912084, R: 0.868230, F: 0.889617, OOV: 0.769405, GEO: 0.852825
=======entity level========
Epoch:   4%|▍         | 2/50 [00:42<17:08, 21.42s/it]P:  0.912084219957442
R:  0.868230277185501
F:  0.8896171281883227

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.774903
GEO: 0.849441
=======entity level========

Epoch: 3, P: 0.919201, R: 0.873241, F: 0.895632, OOV: 0.774903, GEO: 0.849441
=======entity level========
Epoch:   6%|▌         | 3/50 [01:03<16:34, 21.17s/it]P:  0.9192009875434856
R:  0.8732409381663113
F:  0.8956317314526269

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.52s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.779431
GEO: 0.857898
=======entity level========

Epoch: 4, P: 0.920504, R: 0.880171, F: 0.899886, OOV: 0.779431, GEO: 0.857898
=======entity level========
Epoch:   8%|▊         | 4/50 [01:25<16:20, 21.31s/it]P:  0.9205039580778236
R:  0.8801705756929638
F:  0.8998855523461768

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.787516
GEO: 0.868421
=======entity level========

Epoch: 5, P: 0.925346, R: 0.882729, F: 0.903536, OOV: 0.787516, GEO: 0.868421
=======entity level========
Epoch:  10%|█         | 5/50 [01:46<16:01, 21.37s/it]P:  0.9253464461332142
R:  0.8827292110874201
F:  0.9035355739851594

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.48s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.775550
GEO: 0.875332
=======entity level========

Epoch: 6, P: 0.922870, R: 0.878891, F: 0.900344, OOV: 0.775550, GEO: 0.875332
=======entity level========
Epoch:  12%|█▏        | 6/50 [02:08<15:49, 21.58s/it]P:  0.922870256352849
R:  0.8788912579957356
F:  0.9003440179107738

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.43s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.789133
GEO: 0.858077
=======entity level========

Epoch: 7, P: 0.923702, R: 0.884115, F: 0.903475, OOV: 0.789133, GEO: 0.858077
=======entity level========
Epoch:  14%|█▍        | 7/50 [02:29<15:18, 21.37s/it]P:  0.9237023836043662
R:  0.8841151385927505
F:  0.9034753241093801

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.46s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.782342
GEO: 0.877565
=======entity level========

Epoch: 8, P: 0.921393, R: 0.879744, F: 0.900087, OOV: 0.782342, GEO: 0.877565
=======entity level========
Epoch:  16%|█▌        | 8/50 [02:51<15:06, 21.59s/it]P:  0.9213934792317999
R:  0.8797441364605544
F:  0.9000872600349041

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.38s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.50s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.49s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.21s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.782665
GEO: 0.873426
=======entity level========

Epoch: 9, P: 0.924503, R: 0.882516, F: 0.903022, OOV: 0.782665, GEO: 0.873426
=======entity level========
Epoch:  18%|█▊        | 9/50 [03:12<14:37, 21.41s/it]P:  0.9245030154121063
R:  0.8825159914712154
F:  0.9030217083015163

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.40s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.42s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.46s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.792367
GEO: 0.864440
=======entity level========

Epoch: 10, P: 0.925161, R: 0.888273, F: 0.906342, OOV: 0.792367, GEO: 0.864440
=======entity level========
Epoch:  20%|██        | 10/50 [03:33<14:09, 21.24s/it]P:  0.9251610037752609
R:  0.888272921108742
F:  0.9063417817904927

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.38s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.46s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.46s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.40s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.798836
GEO: 0.861438
=======entity level========

Epoch: 11, P: 0.923807, R: 0.891898, F: 0.907572, OOV: 0.798836, GEO: 0.861438
=======entity level========
Epoch:  22%|██▏       | 11/50 [03:54<13:42, 21.09s/it]P:  0.9238074204946997
R:  0.8918976545842218
F:  0.9075721414623563

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.42s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.788163
GEO: 0.865966
=======entity level========

Epoch: 12, P: 0.924992, R: 0.887420, F: 0.905816, OOV: 0.788163, GEO: 0.865966
=======entity level========
Epoch:  24%|██▍       | 12/50 [04:15<13:18, 21.00s/it]P:  0.9249916657406378
R:  0.8874200426439233
F:  0.9058164209151749

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.38s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.39s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.23s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.787193
GEO: 0.864829
=======entity level========

Epoch: 13, P: 0.925410, R: 0.884861, F: 0.904681, OOV: 0.787193, GEO: 0.864829
=======entity level========
Epoch:  26%|██▌       | 13/50 [04:36<12:55, 20.96s/it]P:  0.9254097446761066
R:  0.8848614072494669
F:  0.9046814540301924

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.48s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.48s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.790427
GEO: 0.860710
=======entity level========

Epoch: 14, P: 0.923435, R: 0.888486, F: 0.905623, OOV: 0.790427, GEO: 0.860710
=======entity level========
Epoch:  28%|██▊       | 14/50 [04:57<12:34, 20.97s/it]P:  0.9234349030470914
R:  0.8884861407249467
F:  0.9056234718826406

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.51s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.46s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.47s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.40s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.19s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.791074
GEO: 0.858077
=======entity level========

Epoch: 15, P: 0.924442, R: 0.888273, F: 0.905997, OOV: 0.791074, GEO: 0.858077
=======entity level========
Epoch:  30%|███       | 15/50 [05:17<12:13, 20.94s/it]P:  0.9244424719849107
R:  0.888272921108742
F:  0.905996846626434

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.53s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.50s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.36s/it]
OOV: 0.788810
GEO: 0.866359
=======entity level========

Epoch: 16, P: 0.927720, R: 0.888060, F: 0.907457, OOV: 0.788810, GEO: 0.866359
=======entity level========
Epoch:  32%|███▏      | 16/50 [05:38<11:53, 20.97s/it]P:  0.9277202361064707
R:  0.8880597014925373
F:  0.9074568331608476

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.50s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.47s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.783959
GEO: 0.860892
=======entity level========

Epoch: 17, P: 0.926641, R: 0.884755, F: 0.905214, OOV: 0.783959, GEO: 0.860892
=======entity level========
Epoch:  34%|███▍      | 17/50 [05:59<11:31, 20.97s/it]P:  0.9266413577489951
R:  0.8847547974413646
F:  0.9052137870855148

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.39s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.796248
GEO: 0.849707
=======entity level========

Epoch: 18, P: 0.923009, R: 0.890832, F: 0.906635, OOV: 0.796248, GEO: 0.849707
=======entity level========

Early stop triggered at epoch 17

Epoch:  34%|███▍      | 17/50 [06:20<12:18, 22.39s/it]

=======best f entity level========

Epoch: 8, P: 0.921393, R: 0.879744, F: 0.900087, OOV: 0.782342, GEO: 0.877565, GEO_N: 0.844055


=======best f entity level========
P:  0.9230089473102839
R:  0.8908315565031983
F:  0.9066348396896869
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:47,  1.28it/s]  3%|▎         | 2/62 [00:01<00:43,  1.37it/s]  5%|▍         | 3/62 [00:02<00:41,  1.41it/s]  6%|▋         | 4/62 [00:02<00:44,  1.32it/s]  8%|▊         | 5/62 [00:03<00:44,  1.28it/s] 10%|▉         | 6/62 [00:04<00:46,  1.21it/s] 11%|█▏        | 7/62 [00:05<00:40,  1.36it/s] 13%|█▎        | 8/62 [00:05<00:36,  1.48it/s] 15%|█▍        | 9/62 [00:06<00:38,  1.39it/s] 16%|█▌        | 10/62 [00:07<00:36,  1.42it/s] 18%|█▊        | 11/62 [00:08<00:41,  1.24it/s] 19%|█▉        | 12/62 [00:09<00:38,  1.31it/s] 21%|██        | 13/62 [00:09<00:38,  1.26it/s] 23%|██▎       | 14/62 [00:10<00:37,  1.29it/s] 24%|██▍       | 15/62 [00:11<00:35,  1.34it/s] 26%|██▌       | 16/62 [00:11<00:30,  1.52it/s] 27%|██▋       | 17/62 [00:12<00:27,  1.64it/s] 29%|██▉       | 18/62 [00:12<00:28,  1.56it/s] 31%|███       | 19/62 [00:14<00:33,  1.30it/s] 32%|███▏      | 20/62 [00:15<00:36,  1.15it/s] 34%|███▍      | 21/62 [00:16<00:42,  1.04s/it] 35%|███▌      | 22/62 [00:17<00:38,  1.03it/s] 37%|███▋      | 23/62 [00:17<00:32,  1.18it/s] 39%|███▊      | 24/62 [00:18<00:31,  1.20it/s] 40%|████      | 25/62 [00:20<00:38,  1.05s/it] 42%|████▏     | 26/62 [00:21<00:36,  1.01s/it] 44%|████▎     | 27/62 [00:21<00:32,  1.09it/s] 45%|████▌     | 28/62 [00:22<00:30,  1.10it/s] 47%|████▋     | 29/62 [00:23<00:29,  1.12it/s] 48%|████▊     | 30/62 [00:24<00:26,  1.19it/s] 50%|█████     | 31/62 [00:25<00:25,  1.24it/s] 52%|█████▏    | 32/62 [00:25<00:21,  1.37it/s] 53%|█████▎    | 33/62 [00:26<00:22,  1.31it/s] 55%|█████▍    | 34/62 [00:27<00:22,  1.24it/s] 56%|█████▋    | 35/62 [00:28<00:21,  1.27it/s] 58%|█████▊    | 36/62 [00:28<00:18,  1.40it/s] 60%|█████▉    | 37/62 [00:29<00:15,  1.64it/s] 61%|██████▏   | 38/62 [00:29<00:14,  1.61it/s] 63%|██████▎   | 39/62 [00:30<00:16,  1.39it/s] 65%|██████▍   | 40/62 [00:31<00:15,  1.39it/s] 66%|██████▌   | 41/62 [00:32<00:14,  1.42it/s] 68%|██████▊   | 42/62 [00:32<00:13,  1.43it/s] 69%|██████▉   | 43/62 [00:33<00:13,  1.40it/s] 71%|███████   | 44/62 [00:34<00:12,  1.49it/s] 73%|███████▎  | 45/62 [00:35<00:13,  1.23it/s] 74%|███████▍  | 46/62 [00:35<00:11,  1.34it/s] 76%|███████▌  | 47/62 [00:36<00:10,  1.46it/s] 77%|███████▋  | 48/62 [00:36<00:09,  1.46it/s] 79%|███████▉  | 49/62 [00:38<00:10,  1.23it/s] 81%|████████  | 50/62 [00:38<00:09,  1.26it/s] 82%|████████▏ | 51/62 [00:39<00:08,  1.23it/s] 84%|████████▍ | 52/62 [00:40<00:08,  1.22it/s] 85%|████████▌ | 53/62 [00:41<00:08,  1.04it/s] 87%|████████▋ | 54/62 [00:42<00:07,  1.13it/s] 89%|████████▊ | 55/62 [00:43<00:05,  1.21it/s] 90%|█████████ | 56/62 [00:43<00:04,  1.36it/s] 92%|█████████▏| 57/62 [00:44<00:03,  1.40it/s] 94%|█████████▎| 58/62 [00:45<00:02,  1.43it/s] 95%|█████████▌| 59/62 [00:45<00:02,  1.42it/s] 97%|█████████▋| 60/62 [00:46<00:01,  1.53it/s] 98%|█████████▊| 61/62 [00:47<00:00,  1.31it/s]100%|██████████| 62/62 [00:48<00:00,  1.33it/s]100%|██████████| 62/62 [00:48<00:00,  1.29it/s]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 2, 'av_threshold': 3, 'max_ngram_length': 5, 'model_name': 'self_bert_memory_softmax_score_0.7_0.83', 'use_memory': False, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of trainable parameters: 102273792
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.47s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.50s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.46s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.36s/it]
OOV: 0.655886
GEO: 0.582851
=======entity level========

Epoch: 1, P: 0.812404, R: 0.787633, F: 0.799827, OOV: 0.655886, GEO: 0.582851
=======entity level========
Epoch:   2%|▏         | 1/50 [00:21<17:30, 21.43s/it]P:  0.8124037827138773
R:  0.787633262260128
F:  0.799826783587745

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.38s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.49s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.47s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.46s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.765847
GEO: 0.853386
=======entity level========

Epoch: 2, P: 0.911084, R: 0.864072, F: 0.886956, OOV: 0.765847, GEO: 0.853386
=======entity level========
Epoch:   4%|▍         | 2/50 [00:42<17:10, 21.46s/it]P:  0.9110836330935251
R:  0.8640724946695096
F:  0.8869555701466404

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.46s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.769728
GEO: 0.855820
=======entity level========

Epoch: 3, P: 0.916077, R: 0.869296, F: 0.892074, OOV: 0.769728, GEO: 0.855820
=======entity level========
Epoch:   6%|▌         | 3/50 [01:04<16:54, 21.57s/it]P:  0.916076845298281
R:  0.8692963752665245
F:  0.8920737377605165

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.43s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.53s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.782018
GEO: 0.869048
=======entity level========

Epoch: 4, P: 0.919438, R: 0.878465, F: 0.898484, OOV: 0.782018, GEO: 0.869048
=======entity level========
Epoch:   8%|▊         | 4/50 [01:26<16:31, 21.55s/it]P:  0.9194376255300156
R:  0.8784648187633263
F:  0.8984843528513795

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.19s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.788486
GEO: 0.882859
=======entity level========

Epoch: 5, P: 0.923524, R: 0.881876, F: 0.902220, OOV: 0.788486, GEO: 0.882859
=======entity level========
Epoch:  10%|█         | 5/50 [01:47<16:11, 21.59s/it]P:  0.9235235011722674
R:  0.8818763326226012
F:  0.9022195560887821

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.46s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.49s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.48s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.768758
GEO: 0.879414
=======entity level========

Epoch: 6, P: 0.924729, R: 0.872281, F: 0.897740, OOV: 0.768758, GEO: 0.879414
=======entity level========
Epoch:  12%|█▏        | 6/50 [02:08<15:40, 21.38s/it]P:  0.9247287522603979
R:  0.8722814498933902
F:  0.8977397410577134

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.43s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.779107
GEO: 0.868820
=======entity level========

Epoch: 7, P: 0.921492, R: 0.877186, F: 0.898793, OOV: 0.779107, GEO: 0.868820
=======entity level========
Epoch:  14%|█▍        | 7/50 [02:29<15:12, 21.23s/it]P:  0.921491768395117
R:  0.877185501066098
F:  0.8987929433611884

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.53s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.46s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.784282
GEO: 0.861660
=======entity level========

Epoch: 8, P: 0.919568, R: 0.881237, F: 0.899995, OOV: 0.784282, GEO: 0.861660
=======entity level========
Epoch:  16%|█▌        | 8/50 [02:50<14:47, 21.13s/it]P:  0.9195683613305151
R:  0.8812366737739872
F:  0.8999945560455114

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.50s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.49s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.21s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.785899
GEO: 0.868421
=======entity level========

Epoch: 9, P: 0.921938, R: 0.882623, F: 0.901852, OOV: 0.785899, GEO: 0.868421
=======entity level========
Epoch:  18%|█▊        | 9/50 [03:11<14:24, 21.09s/it]P:  0.9219376391982183
R:  0.8826226012793177
F:  0.9018518518518518

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.40s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.42s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.792367
GEO: 0.854902
=======entity level========

Epoch: 10, P: 0.923701, R: 0.886674, F: 0.904809, OOV: 0.792367, GEO: 0.854902
=======entity level========
Epoch:  20%|██        | 10/50 [03:32<14:00, 21.02s/it]P:  0.9237005775211017
R:  0.8866737739872068
F:  0.9048085291557876

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.46s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.40s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.790103
GEO: 0.868248
=======entity level========

Epoch: 11, P: 0.924027, R: 0.885608, F: 0.904409, OOV: 0.790103, GEO: 0.868248
=======entity level========
Epoch:  22%|██▏       | 11/50 [03:53<13:36, 20.94s/it]P:  0.9240266963292547
R:  0.8856076759061834
F:  0.9044093630919978

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.42s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.787516
GEO: 0.863158
=======entity level========

Epoch: 12, P: 0.924106, R: 0.884009, F: 0.903612, OOV: 0.787516, GEO: 0.863158
=======entity level========
Epoch:  24%|██▍       | 12/50 [04:14<13:13, 20.89s/it]P:  0.9241056502841859
R:  0.8840085287846482
F:  0.9036124884215114

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.38s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.39s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.23s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.784605
GEO: 0.873016
=======entity level========

Epoch: 13, P: 0.925681, R: 0.880384, F: 0.902464, OOV: 0.784605, GEO: 0.873016
=======entity level========
Epoch:  26%|██▌       | 13/50 [04:34<12:52, 20.89s/it]P:  0.9256809774688937
R:  0.8803837953091684
F:  0.9024643462105897

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.48s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.785252
GEO: 0.870199
=======entity level========

Epoch: 14, P: 0.922726, R: 0.883475, F: 0.902674, OOV: 0.785252, GEO: 0.870199
=======entity level========
Epoch:  28%|██▊       | 14/50 [04:55<12:32, 20.91s/it]P:  0.9227257543703373
R:  0.8834754797441364
F:  0.9026741462883284

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.52s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.46s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.46s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.40s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.19s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.791397
GEO: 0.864829
=======entity level========

Epoch: 15, P: 0.924566, R: 0.885928, F: 0.904834, OOV: 0.791397, GEO: 0.864829
=======entity level========

Early stop triggered at epoch 14

Epoch:  28%|██▊       | 14/50 [05:16<13:34, 22.62s/it]

=======best f entity level========

Epoch: 5, P: 0.923524, R: 0.881876, F: 0.902220, OOV: 0.788486, GEO: 0.882859, GEO_N: 0.846269


=======best f entity level========
P:  0.92456608811749
R:  0.8859275053304904
F:  0.9048344947735192
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:47,  1.28it/s]  3%|▎         | 2/62 [00:01<00:43,  1.37it/s]  5%|▍         | 3/62 [00:02<00:41,  1.41it/s]  6%|▋         | 4/62 [00:02<00:44,  1.32it/s]  8%|▊         | 5/62 [00:03<00:44,  1.28it/s] 10%|▉         | 6/62 [00:04<00:46,  1.21it/s] 11%|█▏        | 7/62 [00:05<00:40,  1.36it/s] 13%|█▎        | 8/62 [00:05<00:36,  1.48it/s] 15%|█▍        | 9/62 [00:06<00:38,  1.39it/s] 16%|█▌        | 10/62 [00:07<00:36,  1.42it/s] 18%|█▊        | 11/62 [00:08<00:41,  1.24it/s] 19%|█▉        | 12/62 [00:09<00:38,  1.31it/s] 21%|██        | 13/62 [00:09<00:38,  1.26it/s] 23%|██▎       | 14/62 [00:10<00:37,  1.29it/s] 24%|██▍       | 15/62 [00:11<00:34,  1.34it/s] 26%|██▌       | 16/62 [00:11<00:30,  1.52it/s] 27%|██▋       | 17/62 [00:12<00:27,  1.65it/s] 29%|██▉       | 18/62 [00:12<00:28,  1.56it/s] 31%|███       | 19/62 [00:14<00:33,  1.30it/s] 32%|███▏      | 20/62 [00:15<00:36,  1.15it/s] 34%|███▍      | 21/62 [00:16<00:42,  1.04s/it] 35%|███▌      | 22/62 [00:17<00:38,  1.03it/s] 37%|███▋      | 23/62 [00:17<00:32,  1.18it/s] 39%|███▊      | 24/62 [00:18<00:31,  1.20it/s] 40%|████      | 25/62 [00:20<00:38,  1.05s/it] 42%|████▏     | 26/62 [00:21<00:36,  1.01s/it] 44%|████▎     | 27/62 [00:21<00:32,  1.09it/s] 45%|████▌     | 28/62 [00:22<00:30,  1.10it/s] 47%|████▋     | 29/62 [00:23<00:29,  1.12it/s] 48%|████▊     | 30/62 [00:24<00:26,  1.19it/s] 50%|█████     | 31/62 [00:25<00:25,  1.24it/s] 52%|█████▏    | 32/62 [00:25<00:21,  1.37it/s] 53%|█████▎    | 33/62 [00:26<00:22,  1.31it/s] 55%|█████▍    | 34/62 [00:27<00:22,  1.24it/s] 56%|█████▋    | 35/62 [00:28<00:21,  1.28it/s] 58%|█████▊    | 36/62 [00:28<00:18,  1.41it/s] 60%|█████▉    | 37/62 [00:29<00:15,  1.64it/s] 61%|██████▏   | 38/62 [00:29<00:14,  1.61it/s] 63%|██████▎   | 39/62 [00:30<00:16,  1.39it/s] 65%|██████▍   | 40/62 [00:31<00:15,  1.39it/s] 66%|██████▌   | 41/62 [00:32<00:14,  1.42it/s] 68%|██████▊   | 42/62 [00:32<00:13,  1.43it/s] 69%|██████▉   | 43/62 [00:33<00:13,  1.41it/s] 71%|███████   | 44/62 [00:34<00:12,  1.49it/s] 73%|███████▎  | 45/62 [00:35<00:13,  1.23it/s] 74%|███████▍  | 46/62 [00:35<00:11,  1.34it/s] 76%|███████▌  | 47/62 [00:36<00:10,  1.46it/s] 77%|███████▋  | 48/62 [00:36<00:09,  1.46it/s] 79%|███████▉  | 49/62 [00:38<00:10,  1.23it/s] 81%|████████  | 50/62 [00:38<00:09,  1.26it/s] 82%|████████▏ | 51/62 [00:39<00:08,  1.24it/s] 84%|████████▍ | 52/62 [00:40<00:08,  1.22it/s] 85%|████████▌ | 53/62 [00:41<00:08,  1.04it/s] 87%|████████▋ | 54/62 [00:42<00:07,  1.13it/s] 89%|████████▊ | 55/62 [00:43<00:05,  1.21it/s] 90%|█████████ | 56/62 [00:43<00:04,  1.36it/s] 92%|█████████▏| 57/62 [00:44<00:03,  1.40it/s] 94%|█████████▎| 58/62 [00:45<00:02,  1.43it/s] 95%|█████████▌| 59/62 [00:45<00:02,  1.42it/s] 97%|█████████▋| 60/62 [00:46<00:01,  1.53it/s] 98%|█████████▊| 61/62 [00:47<00:00,  1.31it/s]100%|██████████| 62/62 [00:48<00:00,  1.33it/s]100%|██████████| 62/62 [00:48<00:00,  1.29it/s]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 2, 'av_threshold': 3, 'max_ngram_length': 5, 'model_name': 'self_bert_memory_softmax_score_0.7_0.84', 'use_memory': False, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of trainable parameters: 102273792
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.47s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.50s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.46s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.660091
GEO: 0.600351
=======entity level========

Epoch: 1, P: 0.819411, R: 0.788486, F: 0.803651, OOV: 0.660091, GEO: 0.600351
=======entity level========
Epoch:   2%|▏         | 1/50 [00:21<17:28, 21.40s/it]P:  0.8194105916241967
R:  0.7884861407249467
F:  0.8036509833749865

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.38s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.48s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.767141
GEO: 0.855453
=======entity level========

Epoch: 2, P: 0.913607, R: 0.864712, F: 0.888487, OOV: 0.767141, GEO: 0.855453
=======entity level========
Epoch:   4%|▍         | 2/50 [00:43<17:12, 21.52s/it]P:  0.9136066681685064
R:  0.8647121535181237
F:  0.8884872384708074

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.46s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.767788
GEO: 0.859974
=======entity level========

Epoch: 3, P: 0.918066, R: 0.868443, F: 0.892566, OOV: 0.767788, GEO: 0.859974
=======entity level========
Epoch:   6%|▌         | 3/50 [01:05<17:03, 21.77s/it]P:  0.9180660430519554
R:  0.8684434968017057
F:  0.8925656056538651

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.43s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.42s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.53s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.786223
GEO: 0.873351
=======entity level========

Epoch: 4, P: 0.922365, R: 0.881557, F: 0.901499, OOV: 0.786223, GEO: 0.873351
=======entity level========
Epoch:   8%|▊         | 4/50 [01:26<16:37, 21.68s/it]P:  0.9223647518126046
R:  0.8815565031982943
F:  0.9014990460615971

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.38s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.782342
GEO: 0.872943
=======entity level========

Epoch: 5, P: 0.923154, R: 0.878571, F: 0.900311, OOV: 0.782342, GEO: 0.872943
=======entity level========
Epoch:  10%|█         | 5/50 [01:47<16:01, 21.36s/it]P:  0.923154475187633
R:  0.8785714285714286
F:  0.9003113563117934

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.48s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.776197
GEO: 0.883134
=======entity level========

Epoch: 6, P: 0.927187, R: 0.876972, F: 0.901381, OOV: 0.776197, GEO: 0.883134
=======entity level========
Epoch:  12%|█▏        | 6/50 [02:08<15:42, 21.43s/it]P:  0.9271866546438232
R:  0.8769722814498934
F:  0.9013806706114399

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.43s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.788486
GEO: 0.885073
=======entity level========

Epoch: 7, P: 0.924058, R: 0.880810, F: 0.901916, OOV: 0.788486, GEO: 0.885073
=======entity level========
Epoch:  14%|█▍        | 7/50 [02:30<15:24, 21.50s/it]P:  0.9240577116653618
R:  0.8808102345415778
F:  0.9019158342885213

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.53s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.46s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.790103
GEO: 0.884183
=======entity level========

Epoch: 8, P: 0.924883, R: 0.886034, F: 0.905042, OOV: 0.790103, GEO: 0.884183
=======entity level========
Epoch:  16%|█▌        | 8/50 [02:51<14:54, 21.31s/it]P:  0.9248831515691075
R:  0.8860341151385928
F:  0.905041925296744

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.50s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.49s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.21s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.795925
GEO: 0.866885
=======entity level========

Epoch: 9, P: 0.923051, R: 0.890085, F: 0.906269, OOV: 0.795925, GEO: 0.866885
=======entity level========
Epoch:  18%|█▊        | 9/50 [03:12<14:29, 21.20s/it]P:  0.9230514096185738
R:  0.8900852878464819
F:  0.906268656716418

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.40s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.42s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.793984
GEO: 0.868766
=======entity level========

Epoch: 10, P: 0.925337, R: 0.886567, F: 0.905537, OOV: 0.793984, GEO: 0.868766
=======entity level========
Epoch:  20%|██        | 10/50 [03:33<14:03, 21.10s/it]P:  0.9253365973072215
R:  0.8865671641791045
F:  0.9055371045897533

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.39s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.789133
GEO: 0.868993
=======entity level========

Epoch: 11, P: 0.923711, R: 0.884222, F: 0.903535, OOV: 0.789133, GEO: 0.868993
=======entity level========
Epoch:  22%|██▏       | 11/50 [03:54<13:38, 20.98s/it]P:  0.9237108809444259
R:  0.8842217484008529
F:  0.9035350509286999

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.40s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.42s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.785252
GEO: 0.881221
=======entity level========

Epoch: 12, P: 0.925561, R: 0.880171, F: 0.902295, OOV: 0.785252, GEO: 0.881221
=======entity level========
Epoch:  24%|██▍       | 12/50 [04:14<13:14, 20.92s/it]P:  0.9255605381165919
R:  0.8801705756929638
F:  0.9022950819672131

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.38s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.39s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.23s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.791397
GEO: 0.875826
=======entity level========

Epoch: 13, P: 0.925963, R: 0.884009, F: 0.904500, OOV: 0.791397, GEO: 0.875826
=======entity level========
Epoch:  26%|██▌       | 13/50 [04:35<12:53, 20.90s/it]P:  0.925963149078727
R:  0.8840085287846482
F:  0.9044995909462776

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.48s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.796248
GEO: 0.872775
=======entity level========

Epoch: 14, P: 0.925103, R: 0.887527, F: 0.905925, OOV: 0.796248, GEO: 0.872775
=======entity level========
Epoch:  28%|██▊       | 14/50 [04:56<12:32, 20.92s/it]P:  0.9251027891987998
R:  0.8875266524520256
F:  0.9059252407639152

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.51s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.46s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.46s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.40s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.19s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.789133
GEO: 0.870138
=======entity level========

Epoch: 15, P: 0.925765, R: 0.884115, F: 0.904461, OOV: 0.789133, GEO: 0.870138
=======entity level========
Epoch:  30%|███       | 15/50 [05:17<12:11, 20.90s/it]P:  0.9257646796159857
R:  0.8841151385927505
F:  0.9044606827353037

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.54s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.50s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.48s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.36s/it]
OOV: 0.791074
GEO: 0.872607
=======entity level========

Epoch: 16, P: 0.923917, R: 0.884222, F: 0.903633, OOV: 0.791074, GEO: 0.872607
=======entity level========
Epoch:  32%|███▏      | 16/50 [05:38<11:51, 20.94s/it]P:  0.9239166759496491
R:  0.8842217484008529
F:  0.9036334913112165

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.49s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.47s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.789133
GEO: 0.888005
=======entity level========

Epoch: 17, P: 0.925806, R: 0.881983, F: 0.903363, OOV: 0.789133, GEO: 0.888005
=======entity level========
Epoch:  34%|███▍      | 17/50 [06:00<11:41, 21.27s/it]P:  0.9258057296329454
R:  0.8819829424307036
F:  0.9033631797335663

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.39s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.791721
GEO: 0.882431
=======entity level========

Epoch: 18, P: 0.927248, R: 0.885928, F: 0.906117, OOV: 0.791721, GEO: 0.882431
=======entity level========
Epoch:  36%|███▌      | 18/50 [06:21<11:15, 21.12s/it]P:  0.9272483820575764
R:  0.8859275053304904
F:  0.9061171082760877

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.48s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.47s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.19s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.785576
GEO: 0.879048
=======entity level========

Epoch: 19, P: 0.925330, R: 0.882516, F: 0.903416, OOV: 0.785576, GEO: 0.879048
=======entity level========
Epoch:  38%|███▊      | 19/50 [06:42<10:53, 21.08s/it]P:  0.9253297563156718
R:  0.8825159914712154
F:  0.9034159118192732

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.46s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.47s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.792691
GEO: 0.873850
=======entity level========

Epoch: 20, P: 0.925250, R: 0.886780, F: 0.905607, OOV: 0.792691, GEO: 0.873850
=======entity level========
Epoch:  40%|████      | 20/50 [07:03<10:30, 21.03s/it]P:  0.9252502780867631
R:  0.8867803837953092
F:  0.905606967882417

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.35s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.35s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.42s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.47s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.20s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.796248
GEO: 0.871222
=======entity level========

Epoch: 21, P: 0.925489, R: 0.887207, F: 0.905944, OOV: 0.796248, GEO: 0.871222
=======entity level========
Epoch:  42%|████▏     | 21/50 [07:24<10:08, 20.97s/it]P:  0.9254893238434164
R:  0.8872068230277186
F:  0.905943827563684

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.40s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.42s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.42s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.49s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.19s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.789133
GEO: 0.870650
=======entity level========

Epoch: 22, P: 0.926968, R: 0.884968, F: 0.905481, OOV: 0.789133, GEO: 0.870650
=======entity level========
Epoch:  44%|████▍     | 22/50 [07:45<09:46, 20.96s/it]P:  0.9269681742043551
R:  0.8849680170575693
F:  0.9054813198800109

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.42s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.791074
GEO: 0.866710
=======entity level========

Epoch: 23, P: 0.925905, R: 0.885928, F: 0.905475, OOV: 0.791074, GEO: 0.866710
=======entity level========
Epoch:  46%|████▌     | 23/50 [08:05<09:24, 20.90s/it]P:  0.9259052924791087
R:  0.8859275053304904
F:  0.9054753473168073

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.43s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.43s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.37s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.22s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.790750
GEO: 0.875000
=======entity level========

Epoch: 24, P: 0.925022, R: 0.885181, F: 0.904663, OOV: 0.790750, GEO: 0.875000
=======entity level========
Epoch:  48%|████▊     | 24/50 [08:26<09:03, 20.90s/it]P:  0.9250222816399287
R:  0.885181236673774
F:  0.9046633253432121

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.792044
GEO: 0.870480
=======entity level========

Epoch: 25, P: 0.926207, R: 0.885821, F: 0.905564, OOV: 0.792044, GEO: 0.870480
=======entity level========
Epoch:  50%|█████     | 25/50 [08:47<08:42, 20.88s/it]P:  0.9262066659235314
R:  0.8858208955223881
F:  0.90556372949703

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.38s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.42s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.794955
GEO: 0.868594
=======entity level========

Epoch: 26, P: 0.925975, R: 0.890832, F: 0.908063, OOV: 0.794955, GEO: 0.868594
=======entity level========
Epoch:  52%|█████▏    | 26/50 [09:08<08:20, 20.85s/it]P:  0.9259751773049646
R:  0.8908315565031983
F:  0.908063464464247

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.47s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.46s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.19s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.798512
GEO: 0.866317
=======entity level========

Epoch: 27, P: 0.924294, R: 0.890299, F: 0.906978, OOV: 0.798512, GEO: 0.866317
=======entity level========

Early stop triggered at epoch 26

Epoch:  52%|█████▏    | 26/50 [09:29<08:45, 21.89s/it]

=======best f entity level========

Epoch: 17, P: 0.925806, R: 0.881983, F: 0.903363, OOV: 0.789133, GEO: 0.888005, GEO_N: 0.853420


=======best f entity level========
P:  0.9242944106253459
R:  0.8902985074626866
F:  0.9069780070594624
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:47,  1.28it/s]  3%|▎         | 2/62 [00:01<00:43,  1.37it/s]  5%|▍         | 3/62 [00:02<00:41,  1.42it/s]  6%|▋         | 4/62 [00:02<00:44,  1.32it/s]  8%|▊         | 5/62 [00:03<00:44,  1.29it/s] 10%|▉         | 6/62 [00:04<00:46,  1.21it/s] 11%|█▏        | 7/62 [00:05<00:40,  1.36it/s] 13%|█▎        | 8/62 [00:05<00:36,  1.48it/s] 15%|█▍        | 9/62 [00:06<00:38,  1.39it/s] 16%|█▌        | 10/62 [00:07<00:36,  1.42it/s] 18%|█▊        | 11/62 [00:08<00:40,  1.24it/s] 19%|█▉        | 12/62 [00:08<00:37,  1.32it/s] 21%|██        | 13/62 [00:09<00:38,  1.26it/s] 23%|██▎       | 14/62 [00:10<00:37,  1.29it/s] 24%|██▍       | 15/62 [00:11<00:34,  1.35it/s] 26%|██▌       | 16/62 [00:11<00:30,  1.52it/s] 27%|██▋       | 17/62 [00:12<00:27,  1.65it/s] 29%|██▉       | 18/62 [00:12<00:28,  1.56it/s] 31%|███       | 19/62 [00:14<00:33,  1.30it/s] 32%|███▏      | 20/62 [00:15<00:36,  1.15it/s] 34%|███▍      | 21/62 [00:16<00:42,  1.04s/it] 35%|███▌      | 22/62 [00:17<00:38,  1.03it/s] 37%|███▋      | 23/62 [00:17<00:32,  1.18it/s] 39%|███▊      | 24/62 [00:18<00:31,  1.20it/s] 40%|████      | 25/62 [00:20<00:38,  1.05s/it] 42%|████▏     | 26/62 [00:21<00:36,  1.01s/it] 44%|████▎     | 27/62 [00:21<00:32,  1.09it/s] 45%|████▌     | 28/62 [00:22<00:30,  1.10it/s] 47%|████▋     | 29/62 [00:23<00:29,  1.13it/s] 48%|████▊     | 30/62 [00:24<00:26,  1.19it/s] 50%|█████     | 31/62 [00:25<00:25,  1.24it/s] 52%|█████▏    | 32/62 [00:25<00:21,  1.37it/s] 53%|█████▎    | 33/62 [00:26<00:22,  1.31it/s] 55%|█████▍    | 34/62 [00:27<00:22,  1.24it/s] 56%|█████▋    | 35/62 [00:28<00:21,  1.28it/s] 58%|█████▊    | 36/62 [00:28<00:18,  1.41it/s] 60%|█████▉    | 37/62 [00:28<00:15,  1.64it/s] 61%|██████▏   | 38/62 [00:29<00:14,  1.61it/s] 63%|██████▎   | 39/62 [00:30<00:16,  1.39it/s] 65%|██████▍   | 40/62 [00:31<00:15,  1.39it/s] 66%|██████▌   | 41/62 [00:31<00:14,  1.42it/s] 68%|██████▊   | 42/62 [00:32<00:13,  1.44it/s] 69%|██████▉   | 43/62 [00:33<00:13,  1.41it/s] 71%|███████   | 44/62 [00:33<00:12,  1.49it/s] 73%|███████▎  | 45/62 [00:35<00:13,  1.23it/s] 74%|███████▍  | 46/62 [00:35<00:11,  1.34it/s] 76%|███████▌  | 47/62 [00:36<00:10,  1.46it/s] 77%|███████▋  | 48/62 [00:36<00:09,  1.46it/s] 79%|███████▉  | 49/62 [00:38<00:10,  1.23it/s] 81%|████████  | 50/62 [00:38<00:09,  1.27it/s] 82%|████████▏ | 51/62 [00:39<00:08,  1.24it/s] 84%|████████▍ | 52/62 [00:40<00:08,  1.22it/s] 85%|████████▌ | 53/62 [00:41<00:08,  1.04it/s] 87%|████████▋ | 54/62 [00:42<00:07,  1.13it/s] 89%|████████▊ | 55/62 [00:43<00:05,  1.21it/s] 90%|█████████ | 56/62 [00:43<00:04,  1.36it/s] 92%|█████████▏| 57/62 [00:44<00:03,  1.40it/s] 94%|█████████▎| 58/62 [00:45<00:02,  1.43it/s] 95%|█████████▌| 59/62 [00:45<00:02,  1.42it/s] 97%|█████████▋| 60/62 [00:46<00:01,  1.53it/s] 98%|█████████▊| 61/62 [00:47<00:00,  1.31it/s]100%|██████████| 62/62 [00:48<00:00,  1.33it/s]100%|██████████| 62/62 [00:48<00:00,  1.29it/s]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 2, 'av_threshold': 3, 'max_ngram_length': 5, 'model_name': 'self_bert_memory_softmax_score_0.7_0.85', 'use_memory': False, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of trainable parameters: 102273792
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.656210
GEO: 0.591041
=======entity level========

Epoch: 1, P: 0.817789, R: 0.787100, F: 0.802151, OOV: 0.656210, GEO: 0.591041
=======entity level========
Epoch:   2%|▏         | 1/50 [00:21<17:25, 21.34s/it]P:  0.8177891005759859
R:  0.7871002132196162
F:  0.8021512385919166

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.38s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.37s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.764554
GEO: 0.866183
=======entity level========

Epoch: 2, P: 0.913801, R: 0.861194, F: 0.886718, OOV: 0.764554, GEO: 0.866183
=======entity level========
Epoch:   4%|▍         | 2/50 [00:42<17:06, 21.38s/it]P:  0.9138009049773755
R:  0.8611940298507462
F:  0.8867178924259055

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.43s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.40s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.769082
GEO: 0.866976
=======entity level========

Epoch: 3, P: 0.919071, R: 0.869296, F: 0.893491, OOV: 0.769082, GEO: 0.866976
=======entity level========
Epoch:   6%|▌         | 3/50 [01:04<16:47, 21.44s/it]P:  0.9190712353471596
R:  0.8692963752665245
F:  0.8934911242603549

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.52s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.14s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.784605
GEO: 0.884336
=======entity level========

Epoch: 4, P: 0.921796, R: 0.879638, F: 0.900224, OOV: 0.784605, GEO: 0.884336
=======entity level========
Epoch:   8%|▊         | 4/50 [01:25<16:25, 21.42s/it]P:  0.9217964473243213
R:  0.879637526652452
F:  0.9002236648300693

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.38s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.791397
GEO: 0.884488
=======entity level========

Epoch: 5, P: 0.925185, R: 0.881983, F: 0.903067, OOV: 0.791397, GEO: 0.884488
=======entity level========
Epoch:  10%|█         | 5/50 [01:46<16:02, 21.39s/it]P:  0.9251845224781928
R:  0.8819829424307036
F:  0.9030673507259033

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.43s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.774256
GEO: 0.880478
=======entity level========

Epoch: 6, P: 0.922523, R: 0.874627, F: 0.897937, OOV: 0.774256, GEO: 0.880478
=======entity level========
Epoch:  12%|█▏        | 6/50 [02:07<15:32, 21.20s/it]P:  0.9225233329585066
R:  0.8746268656716418
F:  0.8979368467137306

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.42s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.780724
GEO: 0.867105
=======entity level========

Epoch: 7, P: 0.922947, R: 0.876013, F: 0.898868, OOV: 0.780724, GEO: 0.867105
=======entity level========
Epoch:  14%|█▍        | 7/50 [02:28<15:06, 21.08s/it]P:  0.9229473211277097
R:  0.8760127931769722
F:  0.8988678006891648

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.787840
GEO: 0.871053
=======entity level========

Epoch: 8, P: 0.923394, R: 0.882836, F: 0.902660, OOV: 0.787840, GEO: 0.871053
=======entity level========
Epoch:  16%|█▌        | 8/50 [02:49<14:41, 20.99s/it]P:  0.9233942908117752
R:  0.8828358208955224
F:  0.9026596904294747

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.49s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.48s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.20s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.782018
GEO: 0.865613
=======entity level========

Epoch: 9, P: 0.922922, R: 0.880810, F: 0.901375, OOV: 0.782018, GEO: 0.865613
=======entity level========
Epoch:  18%|█▊        | 9/50 [03:10<14:19, 20.96s/it]P:  0.9229222520107239
R:  0.8808102345415778
F:  0.9013746454287584

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.790427
GEO: 0.865966
=======entity level========

Epoch: 10, P: 0.921870, R: 0.883049, F: 0.902042, OOV: 0.790427, GEO: 0.865966
=======entity level========
Epoch:  20%|██        | 10/50 [03:31<13:55, 20.90s/it]P:  0.9218697829716194
R:  0.8830490405117271
F:  0.9020419275796351

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.39s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.38s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.793984
GEO: 0.855838
=======entity level========

Epoch: 11, P: 0.923350, R: 0.887420, F: 0.905029, OOV: 0.793984, GEO: 0.855838
=======entity level========
Epoch:  22%|██▏       | 11/50 [03:51<13:31, 20.81s/it]P:  0.9233499722684415
R:  0.8874200426439233
F:  0.9050285403642293

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.793014
GEO: 0.873276
=======entity level========

Epoch: 12, P: 0.926169, R: 0.886674, F: 0.905991, OOV: 0.793014, GEO: 0.873276
=======entity level========
Epoch:  24%|██▍       | 12/50 [04:12<13:09, 20.77s/it]P:  0.9261692650334076
R:  0.8866737739872068
F:  0.9059912854030502

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.38s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.22s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.778137
GEO: 0.882548
=======entity level========

Epoch: 13, P: 0.924685, R: 0.876972, F: 0.900197, OOV: 0.778137, GEO: 0.882548
=======entity level========
Epoch:  26%|██▌       | 13/50 [04:33<12:48, 20.77s/it]P:  0.9246852517985612
R:  0.8769722814498934
F:  0.9001969796454367

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:15,  2.50s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.47s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.795602
GEO: 0.873850
=======entity level========

Epoch: 14, P: 0.923486, R: 0.889126, F: 0.905980, OOV: 0.795602, GEO: 0.873850
=======entity level========
Epoch:  28%|██▊       | 14/50 [04:54<12:28, 20.80s/it]P:  0.9234857712324217
R:  0.8891257995735607
F:  0.905980120580088

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.50s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.40s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.39s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.793014
GEO: 0.871795
=======entity level========

Epoch: 15, P: 0.925699, R: 0.885928, F: 0.905377, OOV: 0.793014, GEO: 0.871795
=======entity level========

Early stop triggered at epoch 14

Epoch:  28%|██▊       | 14/50 [05:14<13:29, 22.49s/it]

=======best f entity level========

Epoch: 5, P: 0.925185, R: 0.881983, F: 0.903067, OOV: 0.791397, GEO: 0.884488, GEO_N: 0.848788


=======best f entity level========
P:  0.9256990085774758
R:  0.8859275053304904
F:  0.9053766955384867
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:48,  1.26it/s]  3%|▎         | 2/62 [00:01<00:44,  1.36it/s]  5%|▍         | 3/62 [00:02<00:41,  1.41it/s]  6%|▋         | 4/62 [00:03<00:44,  1.31it/s]  8%|▊         | 5/62 [00:03<00:44,  1.28it/s] 10%|▉         | 6/62 [00:04<00:46,  1.21it/s] 11%|█▏        | 7/62 [00:05<00:40,  1.36it/s] 13%|█▎        | 8/62 [00:05<00:36,  1.48it/s] 15%|█▍        | 9/62 [00:06<00:38,  1.39it/s] 16%|█▌        | 10/62 [00:07<00:36,  1.42it/s] 18%|█▊        | 11/62 [00:08<00:40,  1.24it/s] 19%|█▉        | 12/62 [00:09<00:38,  1.32it/s] 21%|██        | 13/62 [00:09<00:38,  1.26it/s] 23%|██▎       | 14/62 [00:10<00:37,  1.29it/s] 24%|██▍       | 15/62 [00:11<00:34,  1.35it/s] 26%|██▌       | 16/62 [00:11<00:30,  1.52it/s] 27%|██▋       | 17/62 [00:12<00:27,  1.65it/s] 29%|██▉       | 18/62 [00:12<00:28,  1.56it/s] 31%|███       | 19/62 [00:14<00:33,  1.30it/s] 32%|███▏      | 20/62 [00:15<00:36,  1.15it/s] 34%|███▍      | 21/62 [00:16<00:42,  1.04s/it] 35%|███▌      | 22/62 [00:17<00:38,  1.03it/s] 37%|███▋      | 23/62 [00:17<00:32,  1.18it/s] 39%|███▊      | 24/62 [00:18<00:31,  1.20it/s] 40%|████      | 25/62 [00:20<00:38,  1.05s/it] 42%|████▏     | 26/62 [00:21<00:36,  1.00s/it] 44%|████▎     | 27/62 [00:21<00:32,  1.09it/s] 45%|████▌     | 28/62 [00:22<00:30,  1.11it/s] 47%|████▋     | 29/62 [00:23<00:29,  1.13it/s] 48%|████▊     | 30/62 [00:24<00:26,  1.20it/s] 50%|█████     | 31/62 [00:25<00:24,  1.24it/s] 52%|█████▏    | 32/62 [00:25<00:21,  1.37it/s] 53%|█████▎    | 33/62 [00:26<00:22,  1.32it/s] 55%|█████▍    | 34/62 [00:27<00:22,  1.25it/s] 56%|█████▋    | 35/62 [00:28<00:21,  1.28it/s] 58%|█████▊    | 36/62 [00:28<00:18,  1.41it/s] 60%|█████▉    | 37/62 [00:28<00:15,  1.64it/s] 61%|██████▏   | 38/62 [00:29<00:14,  1.62it/s] 63%|██████▎   | 39/62 [00:30<00:16,  1.39it/s] 65%|██████▍   | 40/62 [00:31<00:15,  1.39it/s] 66%|██████▌   | 41/62 [00:31<00:14,  1.42it/s] 68%|██████▊   | 42/62 [00:32<00:13,  1.44it/s] 69%|██████▉   | 43/62 [00:33<00:13,  1.41it/s] 71%|███████   | 44/62 [00:33<00:12,  1.49it/s] 73%|███████▎  | 45/62 [00:35<00:13,  1.23it/s] 74%|███████▍  | 46/62 [00:35<00:11,  1.34it/s] 76%|███████▌  | 47/62 [00:36<00:10,  1.46it/s] 77%|███████▋  | 48/62 [00:36<00:09,  1.46it/s] 79%|███████▉  | 49/62 [00:38<00:10,  1.23it/s] 81%|████████  | 50/62 [00:38<00:09,  1.27it/s] 82%|████████▏ | 51/62 [00:39<00:08,  1.24it/s] 84%|████████▍ | 52/62 [00:40<00:08,  1.23it/s] 85%|████████▌ | 53/62 [00:41<00:08,  1.04it/s] 87%|████████▋ | 54/62 [00:42<00:07,  1.13it/s] 89%|████████▊ | 55/62 [00:43<00:05,  1.21it/s] 90%|█████████ | 56/62 [00:43<00:04,  1.36it/s] 92%|█████████▏| 57/62 [00:44<00:03,  1.40it/s] 94%|█████████▎| 58/62 [00:45<00:02,  1.43it/s] 95%|█████████▌| 59/62 [00:45<00:02,  1.42it/s] 97%|█████████▋| 60/62 [00:46<00:01,  1.53it/s] 98%|█████████▊| 61/62 [00:47<00:00,  1.31it/s]100%|██████████| 62/62 [00:48<00:00,  1.34it/s]100%|██████████| 62/62 [00:48<00:00,  1.29it/s]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 2, 'av_threshold': 3, 'max_ngram_length': 5, 'model_name': 'self_bert_memory_softmax_score_0.7_0.86', 'use_memory': False, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of trainable parameters: 102273792
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.657503
GEO: 0.594752
=======entity level========

Epoch: 1, P: 0.819787, R: 0.787100, F: 0.803111, OOV: 0.657503, GEO: 0.594752
=======entity level========
Epoch:   2%|▏         | 1/50 [00:21<17:25, 21.34s/it]P:  0.8197868087941372
R:  0.7871002132196162
F:  0.8031110627651474

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.38s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.37s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.766171
GEO: 0.855453
=======entity level========

Epoch: 2, P: 0.913122, R: 0.862793, F: 0.887244, OOV: 0.766171, GEO: 0.855453
=======entity level========
Epoch:   4%|▍         | 2/50 [00:43<17:13, 21.54s/it]P:  0.9131219677310166
R:  0.8627931769722814
F:  0.8872444225182261

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.43s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.40s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.778461
GEO: 0.864116
=======entity level========

Epoch: 3, P: 0.920126, R: 0.874414, F: 0.896687, OOV: 0.778461, GEO: 0.864116
=======entity level========
Epoch:   6%|▌         | 3/50 [01:04<16:52, 21.53s/it]P:  0.9201256450527261
R:  0.8744136460554371
F:  0.8966874385044277

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.52s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.14s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.785576
GEO: 0.883014
=======entity level========

Epoch: 4, P: 0.921409, R: 0.878678, F: 0.899536, OOV: 0.785576, GEO: 0.883014
=======entity level========
Epoch:   8%|▊         | 4/50 [01:26<16:31, 21.55s/it]P:  0.9214086081609838
R:  0.878678038379531
F:  0.8995361527967258

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.786869
GEO: 0.881848
=======entity level========

Epoch: 5, P: 0.922595, R: 0.879318, F: 0.900437, OOV: 0.786869, GEO: 0.881848
=======entity level========
Epoch:  10%|█         | 5/50 [01:46<15:56, 21.26s/it]P:  0.9225950782997763
R:  0.879317697228145
F:  0.9004366812227075

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.43s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.774903
GEO: 0.880795
=======entity level========

Epoch: 6, P: 0.923622, R: 0.875373, F: 0.898851, OOV: 0.774903, GEO: 0.880795
=======entity level========
Epoch:  12%|█▏        | 6/50 [02:07<15:29, 21.12s/it]P:  0.9236220472440945
R:  0.8753731343283582
F:  0.8988505747126435

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.42s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.784929
GEO: 0.868024
=======entity level========

Epoch: 7, P: 0.922002, R: 0.879638, F: 0.900322, OOV: 0.784929, GEO: 0.868024
=======entity level========
Epoch:  14%|█▍        | 7/50 [02:28<15:03, 21.02s/it]P:  0.9220024583752374
R:  0.879637526652452
F:  0.9003218942659174

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.791397
GEO: 0.870309
=======entity level========

Epoch: 8, P: 0.921750, R: 0.882836, F: 0.901873, OOV: 0.791397, GEO: 0.870309
=======entity level========
Epoch:  16%|█▌        | 8/50 [02:49<14:40, 20.96s/it]P:  0.9217497773820125
R:  0.8828358208955224
F:  0.9018732302330646

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.49s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.48s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.20s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.789133
GEO: 0.875164
=======entity level========

Epoch: 9, P: 0.924484, R: 0.883582, F: 0.903570, OOV: 0.789133, GEO: 0.875164
=======entity level========
Epoch:  18%|█▊        | 9/50 [03:10<14:18, 20.94s/it]P:  0.924484104852203
R:  0.8835820895522388
F:  0.903570455164895

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.787840
GEO: 0.871795
=======entity level========

Epoch: 10, P: 0.923661, R: 0.882303, F: 0.902508, OOV: 0.787840, GEO: 0.871795
=======entity level========
Epoch:  20%|██        | 10/50 [03:31<13:55, 20.89s/it]P:  0.9236607142857143
R:  0.8823027718550107
F:  0.9025081788440567

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.39s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.39s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.793984
GEO: 0.873443
=======entity level========

Epoch: 11, P: 0.925303, R: 0.886141, F: 0.905299, OOV: 0.793984, GEO: 0.873443
=======entity level========
Epoch:  22%|██▏       | 11/50 [03:51<13:31, 20.82s/it]P:  0.9253033507736836
R:  0.886140724946695
F:  0.9052986984697489

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.40s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.787193
GEO: 0.871053
=======entity level========

Epoch: 12, P: 0.925818, R: 0.883475, F: 0.904151, OOV: 0.787193, GEO: 0.871053
=======entity level========
Epoch:  24%|██▍       | 12/50 [04:12<13:09, 20.78s/it]P:  0.9258183443190705
R:  0.8834754797441364
F:  0.9041514374556762

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.38s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.22s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.782342
GEO: 0.881221
=======entity level========

Epoch: 13, P: 0.924543, R: 0.879104, F: 0.901251, OOV: 0.782342, GEO: 0.881221
=======entity level========
Epoch:  26%|██▌       | 13/50 [04:33<12:48, 20.78s/it]P:  0.9245431102141496
R:  0.8791044776119403
F:  0.9012514345046179

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:15,  2.50s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.47s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.782018
GEO: 0.876821
=======entity level========

Epoch: 14, P: 0.923301, R: 0.879104, F: 0.900661, OOV: 0.782018, GEO: 0.876821
=======entity level========

Early stop triggered at epoch 13

Epoch:  26%|██▌       | 13/50 [04:54<13:56, 22.62s/it]

=======best f entity level========

Epoch: 4, P: 0.921409, R: 0.878678, F: 0.899536, OOV: 0.785576, GEO: 0.883014, GEO_N: 0.844711


=======best f entity level========
P:  0.923300862165491
R:  0.8791044776119403
F:  0.9006608049806127
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:47,  1.28it/s]  3%|▎         | 2/62 [00:01<00:43,  1.37it/s]  5%|▍         | 3/62 [00:02<00:41,  1.41it/s]  6%|▋         | 4/62 [00:02<00:44,  1.32it/s]  8%|▊         | 5/62 [00:03<00:44,  1.29it/s] 10%|▉         | 6/62 [00:04<00:46,  1.21it/s] 11%|█▏        | 7/62 [00:05<00:40,  1.36it/s] 13%|█▎        | 8/62 [00:05<00:36,  1.48it/s] 15%|█▍        | 9/62 [00:06<00:38,  1.39it/s] 16%|█▌        | 10/62 [00:07<00:36,  1.42it/s] 18%|█▊        | 11/62 [00:08<00:41,  1.24it/s] 19%|█▉        | 12/62 [00:09<00:38,  1.31it/s] 21%|██        | 13/62 [00:09<00:38,  1.26it/s] 23%|██▎       | 14/62 [00:10<00:37,  1.29it/s] 24%|██▍       | 15/62 [00:11<00:34,  1.34it/s] 26%|██▌       | 16/62 [00:11<00:30,  1.52it/s] 27%|██▋       | 17/62 [00:12<00:27,  1.65it/s] 29%|██▉       | 18/62 [00:12<00:28,  1.56it/s] 31%|███       | 19/62 [00:14<00:33,  1.30it/s] 32%|███▏      | 20/62 [00:15<00:36,  1.15it/s] 34%|███▍      | 21/62 [00:16<00:42,  1.04s/it] 35%|███▌      | 22/62 [00:17<00:38,  1.03it/s] 37%|███▋      | 23/62 [00:17<00:32,  1.18it/s] 39%|███▊      | 24/62 [00:18<00:31,  1.20it/s] 40%|████      | 25/62 [00:20<00:38,  1.05s/it] 42%|████▏     | 26/62 [00:21<00:36,  1.01s/it] 44%|████▎     | 27/62 [00:21<00:32,  1.09it/s] 45%|████▌     | 28/62 [00:22<00:30,  1.10it/s] 47%|████▋     | 29/62 [00:23<00:29,  1.12it/s] 48%|████▊     | 30/62 [00:24<00:26,  1.19it/s] 50%|█████     | 31/62 [00:25<00:25,  1.24it/s] 52%|█████▏    | 32/62 [00:25<00:21,  1.37it/s] 53%|█████▎    | 33/62 [00:26<00:22,  1.31it/s] 55%|█████▍    | 34/62 [00:27<00:22,  1.24it/s] 56%|█████▋    | 35/62 [00:28<00:21,  1.28it/s] 58%|█████▊    | 36/62 [00:28<00:18,  1.41it/s] 60%|█████▉    | 37/62 [00:29<00:15,  1.64it/s] 61%|██████▏   | 38/62 [00:29<00:14,  1.61it/s] 63%|██████▎   | 39/62 [00:30<00:16,  1.39it/s] 65%|██████▍   | 40/62 [00:31<00:15,  1.39it/s] 66%|██████▌   | 41/62 [00:31<00:14,  1.42it/s] 68%|██████▊   | 42/62 [00:32<00:13,  1.43it/s] 69%|██████▉   | 43/62 [00:33<00:13,  1.40it/s] 71%|███████   | 44/62 [00:33<00:12,  1.49it/s] 73%|███████▎  | 45/62 [00:35<00:13,  1.23it/s] 74%|███████▍  | 46/62 [00:35<00:11,  1.34it/s] 76%|███████▌  | 47/62 [00:36<00:10,  1.46it/s] 77%|███████▋  | 48/62 [00:36<00:09,  1.46it/s] 79%|███████▉  | 49/62 [00:38<00:10,  1.23it/s] 81%|████████  | 50/62 [00:38<00:09,  1.26it/s] 82%|████████▏ | 51/62 [00:39<00:08,  1.24it/s] 84%|████████▍ | 52/62 [00:40<00:08,  1.22it/s] 85%|████████▌ | 53/62 [00:41<00:08,  1.04it/s] 87%|████████▋ | 54/62 [00:42<00:07,  1.13it/s] 89%|████████▊ | 55/62 [00:43<00:05,  1.21it/s] 90%|█████████ | 56/62 [00:43<00:04,  1.36it/s] 92%|█████████▏| 57/62 [00:44<00:03,  1.40it/s] 94%|█████████▎| 58/62 [00:45<00:02,  1.43it/s] 95%|█████████▌| 59/62 [00:45<00:02,  1.42it/s] 97%|█████████▋| 60/62 [00:46<00:01,  1.53it/s] 98%|█████████▊| 61/62 [00:47<00:00,  1.31it/s]100%|██████████| 62/62 [00:48<00:00,  1.33it/s]100%|██████████| 62/62 [00:48<00:00,  1.29it/s]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 2, 'av_threshold': 3, 'max_ngram_length': 5, 'model_name': 'self_bert_memory_softmax_score_0.7_0.87', 'use_memory': False, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of trainable parameters: 102273792
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.658150
GEO: 0.594626
=======entity level========

Epoch: 1, P: 0.815470, R: 0.786780, F: 0.800868, OOV: 0.658150, GEO: 0.594626
=======entity level========
Epoch:   2%|▏         | 1/50 [00:21<17:25, 21.33s/it]P:  0.8154696132596685
R:  0.7867803837953091
F:  0.8008681497558328

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.38s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.37s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.38s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.48s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.768111
GEO: 0.854892
=======entity level========

Epoch: 2, P: 0.912857, R: 0.864392, F: 0.887964, OOV: 0.768111, GEO: 0.854892
=======entity level========
Epoch:   4%|▍         | 2/50 [00:42<17:11, 21.48s/it]P:  0.9128574645350146
R:  0.8643923240938166
F:  0.8879640784141933

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.43s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.40s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.778784
GEO: 0.864295
=======entity level========

Epoch: 3, P: 0.919310, R: 0.874520, F: 0.896356, OOV: 0.778784, GEO: 0.864295
=======entity level========
Epoch:   6%|▌         | 3/50 [01:04<16:47, 21.44s/it]P:  0.919309649221114
R:  0.8745202558635394
F:  0.8963557886685243

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.52s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.14s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.780401
GEO: 0.875332
=======entity level========

Epoch: 4, P: 0.919073, R: 0.875373, F: 0.896691, OOV: 0.780401, GEO: 0.875332
=======entity level========
Epoch:   8%|▊         | 4/50 [01:25<16:25, 21.41s/it]P:  0.9190732034922767
R:  0.8753731343283582
F:  0.8966910560227149

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.785899
GEO: 0.871053
=======entity level========

Epoch: 5, P: 0.921957, R: 0.877825, F: 0.899350, OOV: 0.785899, GEO: 0.871053
=======entity level========
Epoch:  10%|█         | 5/50 [01:46<15:52, 21.16s/it]P:  0.9219572276340835
R:  0.8778251599147121
F:  0.899350117415761

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.43s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.48s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.772962
GEO: 0.889628
=======entity level========

Epoch: 6, P: 0.923424, R: 0.871642, F: 0.896786, OOV: 0.772962, GEO: 0.889628
=======entity level========
Epoch:  12%|█▏        | 6/50 [02:07<15:35, 21.27s/it]P:  0.9234244409306528
R:  0.8716417910447761
F:  0.8967862235384446

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.43s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.788486
GEO: 0.862924
=======entity level========

Epoch: 7, P: 0.921111, R: 0.883795, F: 0.902067, OOV: 0.788486, GEO: 0.862924
=======entity level========
Epoch:  14%|█▍        | 7/50 [02:28<15:08, 21.12s/it]P:  0.9211111111111111
R:  0.8837953091684435
F:  0.9020674646354734

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.780078
GEO: 0.880370
=======entity level========

Epoch: 8, P: 0.923456, R: 0.879744, F: 0.901070, OOV: 0.780078, GEO: 0.880370
=======entity level========
Epoch:  16%|█▌        | 8/50 [02:49<14:43, 21.03s/it]P:  0.923455684870188
R:  0.8797441364605544
F:  0.9010701026424984

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.49s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.48s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.20s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.790103
GEO: 0.870309
=======entity level========

Epoch: 9, P: 0.921614, R: 0.883689, F: 0.902253, OOV: 0.790103, GEO: 0.870309
=======entity level========
Epoch:  18%|█▊        | 9/50 [03:10<14:20, 20.98s/it]P:  0.9216144096064043
R:  0.8836886993603411
F:  0.9022531838467399

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.791397
GEO: 0.870079
=======entity level========

Epoch: 10, P: 0.923128, R: 0.884648, F: 0.903479, OOV: 0.791397, GEO: 0.870079
=======entity level========
Epoch:  20%|██        | 10/50 [03:31<13:56, 20.92s/it]P:  0.9231282678829681
R:  0.8846481876332623
F:  0.9034786869181775

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.39s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.38s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.801746
GEO: 0.867407
=======entity level========

Epoch: 11, P: 0.926249, R: 0.893070, F: 0.909357, OOV: 0.801746, GEO: 0.867407
=======entity level========
Epoch:  22%|██▏       | 11/50 [03:51<13:32, 20.83s/it]P:  0.92624944714728
R:  0.8930703624733476
F:  0.9093573599652628

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.40s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.784605
GEO: 0.880952
=======entity level========

Epoch: 12, P: 0.925204, R: 0.880917, F: 0.902518, OOV: 0.784605, GEO: 0.880952
=======entity level========
Epoch:  24%|██▍       | 12/50 [04:12<13:10, 20.79s/it]P:  0.9252043444183182
R:  0.8809168443496802
F:  0.9025176123641527

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.38s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.22s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.783312
GEO: 0.873184
=======entity level========

Epoch: 13, P: 0.924818, R: 0.879957, F: 0.901830, OOV: 0.783312, GEO: 0.873184
=======entity level========
Epoch:  26%|██▌       | 13/50 [04:33<12:49, 20.79s/it]P:  0.9248179271708683
R:  0.8799573560767591
F:  0.9018301010652827

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:15,  2.50s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.47s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.792691
GEO: 0.878947
=======entity level========

Epoch: 14, P: 0.924750, R: 0.888273, F: 0.906145, OOV: 0.792691, GEO: 0.878947
=======entity level========
Epoch:  28%|██▊       | 14/50 [04:54<12:29, 20.81s/it]P:  0.9247502774694784
R:  0.888272921108742
F:  0.9061446438281675

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.51s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.46s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.39s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.788486
GEO: 0.876153
=======entity level========

Epoch: 15, P: 0.926715, R: 0.885714, F: 0.905751, OOV: 0.788486, GEO: 0.876153
=======entity level========
Epoch:  30%|███       | 15/50 [05:14<12:08, 20.81s/it]P:  0.9267150027886224
R:  0.8857142857142857
F:  0.9057508857999454

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.53s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.791721
GEO: 0.877216
=======entity level========

Epoch: 16, P: 0.926728, R: 0.884542, F: 0.905144, OOV: 0.791721, GEO: 0.877216
=======entity level========

Early stop triggered at epoch 15

Epoch:  30%|███       | 15/50 [05:35<13:03, 22.40s/it]

=======best f entity level========

Epoch: 6, P: 0.923424, R: 0.871642, F: 0.896786, OOV: 0.772962, GEO: 0.889628, GEO_N: 0.845749


=======best f entity level========
P:  0.9267284709036078
R:  0.88454157782516
F:  0.905143729885998
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:47,  1.28it/s]  3%|▎         | 2/62 [00:01<00:43,  1.38it/s]  5%|▍         | 3/62 [00:02<00:41,  1.42it/s]  6%|▋         | 4/62 [00:02<00:43,  1.32it/s]  8%|▊         | 5/62 [00:03<00:44,  1.29it/s] 10%|▉         | 6/62 [00:04<00:46,  1.21it/s] 11%|█▏        | 7/62 [00:05<00:40,  1.37it/s] 13%|█▎        | 8/62 [00:05<00:36,  1.48it/s] 15%|█▍        | 9/62 [00:06<00:38,  1.39it/s] 16%|█▌        | 10/62 [00:07<00:36,  1.42it/s] 18%|█▊        | 11/62 [00:08<00:40,  1.25it/s] 19%|█▉        | 12/62 [00:08<00:37,  1.32it/s] 21%|██        | 13/62 [00:09<00:38,  1.26it/s] 23%|██▎       | 14/62 [00:10<00:37,  1.29it/s] 24%|██▍       | 15/62 [00:11<00:34,  1.35it/s] 26%|██▌       | 16/62 [00:11<00:30,  1.52it/s] 27%|██▋       | 17/62 [00:12<00:27,  1.65it/s] 29%|██▉       | 18/62 [00:12<00:28,  1.56it/s] 31%|███       | 19/62 [00:13<00:33,  1.30it/s] 32%|███▏      | 20/62 [00:15<00:36,  1.15it/s] 34%|███▍      | 21/62 [00:16<00:42,  1.04s/it] 35%|███▌      | 22/62 [00:17<00:38,  1.03it/s] 37%|███▋      | 23/62 [00:17<00:32,  1.18it/s] 39%|███▊      | 24/62 [00:18<00:31,  1.20it/s] 40%|████      | 25/62 [00:20<00:38,  1.05s/it] 42%|████▏     | 26/62 [00:21<00:36,  1.01s/it] 44%|████▎     | 27/62 [00:21<00:32,  1.09it/s] 45%|████▌     | 28/62 [00:22<00:30,  1.11it/s] 47%|████▋     | 29/62 [00:23<00:29,  1.13it/s] 48%|████▊     | 30/62 [00:24<00:26,  1.20it/s] 50%|█████     | 31/62 [00:25<00:25,  1.24it/s] 52%|█████▏    | 32/62 [00:25<00:21,  1.37it/s] 53%|█████▎    | 33/62 [00:26<00:22,  1.32it/s] 55%|█████▍    | 34/62 [00:27<00:22,  1.25it/s] 56%|█████▋    | 35/62 [00:28<00:21,  1.28it/s] 58%|█████▊    | 36/62 [00:28<00:18,  1.41it/s] 60%|█████▉    | 37/62 [00:28<00:15,  1.64it/s] 61%|██████▏   | 38/62 [00:29<00:14,  1.62it/s] 63%|██████▎   | 39/62 [00:30<00:16,  1.40it/s] 65%|██████▍   | 40/62 [00:31<00:15,  1.39it/s] 66%|██████▌   | 41/62 [00:31<00:14,  1.42it/s] 68%|██████▊   | 42/62 [00:32<00:13,  1.43it/s] 69%|██████▉   | 43/62 [00:33<00:13,  1.41it/s] 71%|███████   | 44/62 [00:33<00:12,  1.49it/s] 73%|███████▎  | 45/62 [00:35<00:13,  1.23it/s] 74%|███████▍  | 46/62 [00:35<00:11,  1.34it/s] 76%|███████▌  | 47/62 [00:36<00:10,  1.46it/s] 77%|███████▋  | 48/62 [00:36<00:09,  1.46it/s] 79%|███████▉  | 49/62 [00:38<00:10,  1.23it/s] 81%|████████  | 50/62 [00:38<00:09,  1.27it/s] 82%|████████▏ | 51/62 [00:39<00:08,  1.24it/s] 84%|████████▍ | 52/62 [00:40<00:08,  1.23it/s] 85%|████████▌ | 53/62 [00:41<00:08,  1.04it/s] 87%|████████▋ | 54/62 [00:42<00:07,  1.13it/s] 89%|████████▊ | 55/62 [00:43<00:05,  1.21it/s] 90%|█████████ | 56/62 [00:43<00:04,  1.36it/s] 92%|█████████▏| 57/62 [00:44<00:03,  1.40it/s] 94%|█████████▎| 58/62 [00:44<00:02,  1.43it/s] 95%|█████████▌| 59/62 [00:45<00:02,  1.42it/s] 97%|█████████▋| 60/62 [00:46<00:01,  1.53it/s] 98%|█████████▊| 61/62 [00:47<00:00,  1.31it/s]100%|██████████| 62/62 [00:47<00:00,  1.34it/s]100%|██████████| 62/62 [00:47<00:00,  1.29it/s]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 2, 'av_threshold': 3, 'max_ngram_length': 5, 'model_name': 'self_bert_memory_softmax_score_0.7_0.88', 'use_memory': False, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of trainable parameters: 102273792
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.652005
GEO: 0.600939
=======entity level========

Epoch: 1, P: 0.818162, R: 0.782836, F: 0.800109, OOV: 0.652005, GEO: 0.600939
=======entity level========
Epoch:   2%|▏         | 1/50 [00:21<17:25, 21.34s/it]P:  0.8181615598885794
R:  0.7828358208955224
F:  0.8001089621356579

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.38s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.48s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.767788
GEO: 0.869565
=======entity level========

Epoch: 2, P: 0.913892, R: 0.863326, F: 0.887890, OOV: 0.767788, GEO: 0.869565
=======entity level========
Epoch:   4%|▍         | 2/50 [00:42<17:07, 21.40s/it]P:  0.9138923372079901
R:  0.8633262260127932
F:  0.8878899183158818

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.40s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.771992
GEO: 0.870199
=======entity level========

Epoch: 3, P: 0.919095, R: 0.870789, F: 0.894290, OOV: 0.771992, GEO: 0.870199
=======entity level========
Epoch:   6%|▌         | 3/50 [01:04<16:56, 21.64s/it]P:  0.9190953077528975
R:  0.8707889125799574
F:  0.8942902501779165

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.52s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.780401
GEO: 0.873351
=======entity level========

Epoch: 4, P: 0.920617, R: 0.877825, F: 0.898712, OOV: 0.780401, GEO: 0.873351
=======entity level========
Epoch:   8%|▊         | 4/50 [01:26<16:31, 21.56s/it]P:  0.9206171735241503
R:  0.8778251599147121
F:  0.8987120716000873

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.781695
GEO: 0.883875
=======entity level========

Epoch: 5, P: 0.922757, R: 0.874947, F: 0.898216, OOV: 0.781695, GEO: 0.883875
=======entity level========
Epoch:  10%|█         | 5/50 [01:47<16:07, 21.50s/it]P:  0.9227569147740049
R:  0.8749466950959488
F:  0.8982160446536062

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.48s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.777490
GEO: 0.885638
=======entity level========

Epoch: 6, P: 0.924246, R: 0.875373, F: 0.899146, OOV: 0.777490, GEO: 0.885638
=======entity level========
Epoch:  12%|█▏        | 6/50 [02:09<15:46, 21.51s/it]P:  0.9242458352093651
R:  0.8753731343283582
F:  0.8991458607095926

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.43s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.782665
GEO: 0.888889
=======entity level========

Epoch: 7, P: 0.924817, R: 0.876013, F: 0.899754, OOV: 0.782665, GEO: 0.888889
=======entity level========
Epoch:  14%|█▍        | 7/50 [02:30<15:24, 21.50s/it]P:  0.9248171074845245
R:  0.8760127931769722
F:  0.8997536271557623

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.787193
GEO: 0.883014
=======entity level========

Epoch: 8, P: 0.926606, R: 0.882942, F: 0.904247, OOV: 0.787193, GEO: 0.883014
=======entity level========
Epoch:  16%|█▌        | 8/50 [02:51<14:54, 21.29s/it]P:  0.926605504587156
R:  0.8829424307036248
F:  0.9042471885577029

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.49s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.49s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.20s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.785576
GEO: 0.886243
=======entity level========

Epoch: 9, P: 0.926969, R: 0.880917, F: 0.903356, OOV: 0.785576, GEO: 0.886243
=======entity level========
Epoch:  18%|█▊        | 9/50 [03:12<14:28, 21.18s/it]P:  0.9269688131029841
R:  0.8809168443496802
F:  0.9033562916803324

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.791074
GEO: 0.871895
=======entity level========

Epoch: 10, P: 0.926249, R: 0.883689, F: 0.904468, OOV: 0.791074, GEO: 0.871895
=======entity level========
Epoch:  20%|██        | 10/50 [03:33<14:02, 21.06s/it]P:  0.926248742876299
R:  0.8836886993603411
F:  0.9044683288777347

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.39s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.39s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.791721
GEO: 0.876316
=======entity level========

Epoch: 11, P: 0.926062, R: 0.885288, F: 0.905216, OOV: 0.791721, GEO: 0.876316
=======entity level========
Epoch:  22%|██▏       | 11/50 [03:53<13:36, 20.93s/it]P:  0.9260622281699565
R:  0.8852878464818763
F:  0.9052161116258789

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.40s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.789780
GEO: 0.886830
=======entity level========

Epoch: 12, P: 0.926764, R: 0.882303, F: 0.903987, OOV: 0.789780, GEO: 0.886830
=======entity level========
Epoch:  24%|██▍       | 12/50 [04:14<13:13, 20.87s/it]P:  0.9267637178051512
R:  0.8823027718550107
F:  0.9039868924085199

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.38s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.22s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.778137
GEO: 0.884309
=======entity level========

Epoch: 13, P: 0.926703, R: 0.876119, F: 0.900701, OOV: 0.778137, GEO: 0.884309
=======entity level========
Epoch:  26%|██▌       | 13/50 [04:35<12:51, 20.85s/it]P:  0.9267027514659449
R:  0.8761194029850746
F:  0.9007014467338887

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.48s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.787193
GEO: 0.876730
=======entity level========

Epoch: 14, P: 0.924528, R: 0.882836, F: 0.903201, OOV: 0.787193, GEO: 0.876730
=======entity level========
Epoch:  28%|██▊       | 14/50 [04:56<12:31, 20.87s/it]P:  0.9245283018867925
R:  0.8828358208955224
F:  0.903201177946229

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.51s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.46s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.39s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.789133
GEO: 0.873927
=======entity level========

Epoch: 15, P: 0.928619, R: 0.883475, F: 0.905485, OOV: 0.789133, GEO: 0.873927
=======entity level========
Epoch:  30%|███       | 15/50 [05:17<12:09, 20.85s/it]P:  0.9286194531600179
R:  0.8834754797441364
F:  0.9054851398601398

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.53s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.786223
GEO: 0.877470
=======entity level========

Epoch: 16, P: 0.927328, R: 0.880171, F: 0.903134, OOV: 0.786223, GEO: 0.877470
=======entity level========
Epoch:  32%|███▏      | 16/50 [05:37<11:50, 20.88s/it]P:  0.9273278670111198
R:  0.8801705756929638
F:  0.9031340589618772

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.49s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.46s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.788163
GEO: 0.881848
=======entity level========

Epoch: 17, P: 0.926786, R: 0.881237, F: 0.903437, OOV: 0.788163, GEO: 0.881848
=======entity level========

Early stop triggered at epoch 16

Epoch:  32%|███▏      | 16/50 [05:58<12:42, 22.43s/it]

=======best f entity level========

Epoch: 7, P: 0.924817, R: 0.876013, F: 0.899754, OOV: 0.782665, GEO: 0.888889, GEO_N: 0.851703


=======best f entity level========
P:  0.9267855140710842
R:  0.8812366737739872
F:  0.9034373463030767
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:47,  1.28it/s]  3%|▎         | 2/62 [00:01<00:43,  1.37it/s]  5%|▍         | 3/62 [00:02<00:41,  1.42it/s]  6%|▋         | 4/62 [00:02<00:43,  1.32it/s]  8%|▊         | 5/62 [00:03<00:44,  1.29it/s] 10%|▉         | 6/62 [00:04<00:46,  1.21it/s] 11%|█▏        | 7/62 [00:05<00:40,  1.37it/s] 13%|█▎        | 8/62 [00:05<00:36,  1.48it/s] 15%|█▍        | 9/62 [00:06<00:38,  1.39it/s] 16%|█▌        | 10/62 [00:07<00:36,  1.42it/s] 18%|█▊        | 11/62 [00:08<00:40,  1.25it/s] 19%|█▉        | 12/62 [00:08<00:37,  1.32it/s] 21%|██        | 13/62 [00:09<00:38,  1.26it/s] 23%|██▎       | 14/62 [00:10<00:37,  1.29it/s] 24%|██▍       | 15/62 [00:11<00:34,  1.35it/s] 26%|██▌       | 16/62 [00:11<00:30,  1.52it/s] 27%|██▋       | 17/62 [00:12<00:27,  1.65it/s] 29%|██▉       | 18/62 [00:12<00:28,  1.56it/s] 31%|███       | 19/62 [00:13<00:33,  1.30it/s] 32%|███▏      | 20/62 [00:15<00:36,  1.15it/s] 34%|███▍      | 21/62 [00:16<00:42,  1.04s/it] 35%|███▌      | 22/62 [00:17<00:38,  1.03it/s] 37%|███▋      | 23/62 [00:17<00:32,  1.19it/s] 39%|███▊      | 24/62 [00:18<00:31,  1.20it/s] 40%|████      | 25/62 [00:20<00:38,  1.05s/it] 42%|████▏     | 26/62 [00:21<00:36,  1.00s/it] 44%|████▎     | 27/62 [00:21<00:32,  1.09it/s] 45%|████▌     | 28/62 [00:22<00:30,  1.11it/s] 47%|████▋     | 29/62 [00:23<00:29,  1.13it/s] 48%|████▊     | 30/62 [00:24<00:26,  1.20it/s] 50%|█████     | 31/62 [00:25<00:24,  1.24it/s] 52%|█████▏    | 32/62 [00:25<00:21,  1.37it/s] 53%|█████▎    | 33/62 [00:26<00:22,  1.32it/s] 55%|█████▍    | 34/62 [00:27<00:22,  1.25it/s] 56%|█████▋    | 35/62 [00:28<00:21,  1.28it/s] 58%|█████▊    | 36/62 [00:28<00:18,  1.41it/s] 60%|█████▉    | 37/62 [00:28<00:15,  1.64it/s] 61%|██████▏   | 38/62 [00:29<00:14,  1.62it/s] 63%|██████▎   | 39/62 [00:30<00:16,  1.40it/s] 65%|██████▍   | 40/62 [00:31<00:15,  1.39it/s] 66%|██████▌   | 41/62 [00:31<00:14,  1.42it/s] 68%|██████▊   | 42/62 [00:32<00:13,  1.44it/s] 69%|██████▉   | 43/62 [00:33<00:13,  1.41it/s] 71%|███████   | 44/62 [00:33<00:12,  1.49it/s] 73%|███████▎  | 45/62 [00:35<00:13,  1.23it/s] 74%|███████▍  | 46/62 [00:35<00:11,  1.34it/s] 76%|███████▌  | 47/62 [00:36<00:10,  1.46it/s] 77%|███████▋  | 48/62 [00:36<00:09,  1.46it/s] 79%|███████▉  | 49/62 [00:38<00:10,  1.23it/s] 81%|████████  | 50/62 [00:38<00:09,  1.27it/s] 82%|████████▏ | 51/62 [00:39<00:08,  1.24it/s] 84%|████████▍ | 52/62 [00:40<00:08,  1.23it/s] 85%|████████▌ | 53/62 [00:41<00:08,  1.04it/s] 87%|████████▋ | 54/62 [00:42<00:07,  1.13it/s] 89%|████████▊ | 55/62 [00:43<00:05,  1.22it/s] 90%|█████████ | 56/62 [00:43<00:04,  1.36it/s] 92%|█████████▏| 57/62 [00:44<00:03,  1.40it/s] 94%|█████████▎| 58/62 [00:44<00:02,  1.44it/s] 95%|█████████▌| 59/62 [00:45<00:02,  1.42it/s] 97%|█████████▋| 60/62 [00:46<00:01,  1.53it/s] 98%|█████████▊| 61/62 [00:47<00:00,  1.31it/s]100%|██████████| 62/62 [00:47<00:00,  1.34it/s]100%|██████████| 62/62 [00:47<00:00,  1.29it/s]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 2, 'av_threshold': 3, 'max_ngram_length': 5, 'model_name': 'self_bert_memory_softmax_score_0.7_0.89', 'use_memory': False, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of trainable parameters: 102273792
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:04<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.650065
GEO: 0.608952
=======entity level========

Epoch: 1, P: 0.817684, R: 0.780810, F: 0.798822, OOV: 0.650065, GEO: 0.608952
=======entity level========
Epoch:   2%|▏         | 1/50 [00:21<17:23, 21.30s/it]P:  0.8176844925756391
R:  0.7808102345415778
F:  0.798822053771064

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.38s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.37s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.766494
GEO: 0.863158
=======entity level========

Epoch: 2, P: 0.914095, R: 0.862154, F: 0.887365, OOV: 0.766494, GEO: 0.863158
=======entity level========
Epoch:   4%|▍         | 2/50 [00:42<17:07, 21.40s/it]P:  0.914095173505143
R:  0.8621535181236674
F:  0.8873648982279035

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.43s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.39s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.769405
GEO: 0.870199
=======entity level========

Epoch: 3, P: 0.918584, R: 0.868443, F: 0.892810, OOV: 0.769405, GEO: 0.870199
=======entity level========
Epoch:   6%|▌         | 3/50 [01:04<16:47, 21.43s/it]P:  0.9185836716283265
R:  0.8684434968017057
F:  0.8928101709776414

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.51s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.14s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.779107
GEO: 0.883875
=======entity level========

Epoch: 4, P: 0.921971, R: 0.875480, F: 0.898124, OOV: 0.779107, GEO: 0.883875
=======entity level========
Epoch:   8%|▊         | 4/50 [01:25<16:31, 21.55s/it]P:  0.9219714831031772
R:  0.8754797441364606
F:  0.8981243506315961

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.777814
GEO: 0.878146
=======entity level========

Epoch: 5, P: 0.923537, R: 0.873028, F: 0.897572, OOV: 0.777814, GEO: 0.878146
=======entity level========
Epoch:  10%|█         | 5/50 [01:46<15:56, 21.25s/it]P:  0.9235367091462727
R:  0.8730277185501066
F:  0.8975722036499151

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.43s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.777814
GEO: 0.880637
=======entity level========

Epoch: 6, P: 0.926524, R: 0.875160, F: 0.900110, OOV: 0.777814, GEO: 0.880637
=======entity level========
Epoch:  12%|█▏        | 6/50 [02:07<15:28, 21.10s/it]P:  0.9265237020316027
R:  0.8751599147121535
F:  0.900109649122807

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.42s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.786869
GEO: 0.875576
=======entity level========

Epoch: 7, P: 0.924188, R: 0.879851, F: 0.901475, OOV: 0.786869, GEO: 0.875576
=======entity level========
Epoch:  14%|█▍        | 7/50 [02:28<15:03, 21.00s/it]P:  0.9241881298992162
R:  0.8798507462686567
F:  0.9014746040415075

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.779431
GEO: 0.881535
=======entity level========

Epoch: 8, P: 0.925267, R: 0.876439, F: 0.900192, OOV: 0.779431, GEO: 0.881535
=======entity level========
Epoch:  16%|█▌        | 8/50 [02:49<14:39, 20.94s/it]P:  0.9252673044456949
R:  0.8764392324093817
F:  0.9001916233232959

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.49s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.48s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.20s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.783959
GEO: 0.875740
=======entity level========

Epoch: 9, P: 0.923309, R: 0.879211, F: 0.900721, OOV: 0.783959, GEO: 0.875740
=======entity level========
Epoch:  18%|█▊        | 9/50 [03:09<14:17, 20.92s/it]P:  0.9233094491715181
R:  0.8792110874200426
F:  0.9007208387942333

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.789457
GEO: 0.885095
=======entity level========

Epoch: 10, P: 0.922243, R: 0.880064, F: 0.900660, OOV: 0.789457, GEO: 0.885095
=======entity level========
Epoch:  20%|██        | 10/50 [03:31<14:02, 21.06s/it]P:  0.9222433247681823
R:  0.8800639658848614
F:  0.9006600840106921

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.39s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.38s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.791074
GEO: 0.873684
=======entity level========

Epoch: 11, P: 0.926162, R: 0.883902, F: 0.904539, OOV: 0.791074, GEO: 0.873684
=======entity level========
Epoch:  22%|██▏       | 11/50 [03:51<13:36, 20.92s/it]P:  0.9261617515638964
R:  0.8839019189765458
F:  0.9045385118917739

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.793661
GEO: 0.882469
=======entity level========

Epoch: 12, P: 0.926277, R: 0.885394, F: 0.905374, OOV: 0.793661, GEO: 0.882469
=======entity level========
Epoch:  24%|██▍       | 12/50 [04:12<13:12, 20.85s/it]P:  0.9262770466205665
R:  0.8853944562899787
F:  0.9053744685490025

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.38s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.22s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.785576
GEO: 0.878049
=======entity level========

Epoch: 13, P: 0.925457, R: 0.880171, F: 0.902246, OOV: 0.785576, GEO: 0.878049
=======entity level========
Epoch:  26%|██▌       | 13/50 [04:33<12:50, 20.82s/it]P:  0.9254567873556776
R:  0.8801705756929638
F:  0.9022457789191848

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:15,  2.50s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.47s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.790103
GEO: 0.885224
=======entity level========

Epoch: 14, P: 0.924126, R: 0.881663, F: 0.902395, OOV: 0.790103, GEO: 0.885224
=======entity level========
Epoch:  28%|██▊       | 14/50 [04:55<12:39, 21.10s/it]P:  0.9241256006257682
R:  0.8816631130063965
F:  0.9023951115718261

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.51s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.40s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.39s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.789133
GEO: 0.871795
=======entity level========

Epoch: 15, P: 0.924765, R: 0.880597, F: 0.902141, OOV: 0.789133, GEO: 0.871795
=======entity level========
Epoch:  30%|███       | 15/50 [05:15<12:15, 21.01s/it]P:  0.9247648902821317
R:  0.8805970149253731
F:  0.9021406727828746

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.790103
GEO: 0.876478
=======entity level========

Epoch: 16, P: 0.927587, R: 0.882196, F: 0.904322, OOV: 0.790103, GEO: 0.876478
=======entity level========
Epoch:  32%|███▏      | 16/50 [05:36<11:53, 20.98s/it]P:  0.9275865934312297
R:  0.8821961620469083
F:  0.9043221681875308

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.48s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.40s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.784605
GEO: 0.878049
=======entity level========

Epoch: 17, P: 0.925444, R: 0.878678, F: 0.901455, OOV: 0.784605, GEO: 0.878049
=======entity level========
Epoch:  34%|███▍      | 17/50 [05:57<11:30, 20.94s/it]P:  0.9254435212216483
R:  0.878678038379531
F:  0.9014546647708629

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.40s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.37s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.787840
GEO: 0.878369
=======entity level========

Epoch: 18, P: 0.925951, R: 0.882516, F: 0.903712, OOV: 0.787840, GEO: 0.878369
=======entity level========
Epoch:  36%|███▌      | 18/50 [06:18<11:07, 20.85s/it]P:  0.9259507829977629
R:  0.8825159914712154
F:  0.9037117903930131

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.35s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.47s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.46s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.789457
GEO: 0.882586
=======entity level========

Epoch: 19, P: 0.927149, R: 0.883262, F: 0.904674, OOV: 0.789457, GEO: 0.882586
=======entity level========
Epoch:  38%|███▊      | 19/50 [06:39<10:46, 20.86s/it]P:  0.9271486123545211
R:  0.8832622601279317
F:  0.9046735094998908

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.788486
GEO: 0.882159
=======entity level========

Epoch: 20, P: 0.927012, R: 0.882836, F: 0.904385, OOV: 0.788486, GEO: 0.882159
=======entity level========
Epoch:  40%|████      | 20/50 [07:00<10:25, 20.85s/it]P:  0.9270122019478338
R:  0.8828358208955224
F:  0.9043848632119259

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.34s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.34s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.46s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.19s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.789133
GEO: 0.875164
=======entity level========

Epoch: 21, P: 0.925752, R: 0.882623, F: 0.903673, OOV: 0.789133, GEO: 0.875164
=======entity level========
Epoch:  42%|████▏     | 21/50 [07:20<10:03, 20.81s/it]P:  0.9257519847925751
R:  0.8826226012793177
F:  0.9036729793156142

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.48s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.791721
GEO: 0.879526
=======entity level========

Epoch: 22, P: 0.924827, R: 0.884009, F: 0.903957, OOV: 0.791721, GEO: 0.879526
=======entity level========
Epoch:  44%|████▍     | 22/50 [07:41<09:42, 20.82s/it]P:  0.9248271246932858
R:  0.8840085287846482
F:  0.9039572658890221

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.38s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.37s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.40s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.786223
GEO: 0.882431
=======entity level========

Epoch: 23, P: 0.925930, R: 0.880917, F: 0.902863, OOV: 0.786223, GEO: 0.882431
=======entity level========
Epoch:  46%|████▌     | 23/50 [08:02<09:20, 20.78s/it]P:  0.9259300761990139
R:  0.8809168443496802
F:  0.9028627622377623

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.42s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.36s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.783312
GEO: 0.887417
=======entity level========

Epoch: 24, P: 0.924433, R: 0.877719, F: 0.900470, OOV: 0.783312, GEO: 0.887417
=======entity level========
Epoch:  48%|████▊     | 24/50 [08:23<09:04, 20.95s/it]P:  0.9244329665394116
R:  0.8777185501066098
F:  0.9004703051514821

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.37s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.785576
GEO: 0.884336
=======entity level========

Epoch: 25, P: 0.925515, R: 0.880917, F: 0.902666, OOV: 0.785576, GEO: 0.884336
=======entity level========
Epoch:  50%|█████     | 25/50 [08:44<08:42, 20.88s/it]P:  0.9255152329749103
R:  0.8809168443496802
F:  0.9026655014201442

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.38s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.789457
GEO: 0.883476
=======entity level========

Epoch: 26, P: 0.926216, R: 0.883262, F: 0.904229, OOV: 0.789457, GEO: 0.883476
=======entity level========
Epoch:  52%|█████▏    | 26/50 [09:05<08:20, 20.84s/it]P:  0.9262157629960872
R:  0.8832622601279317
F:  0.9042291950886766

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.38s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.47s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.787840
GEO: 0.882586
=======entity level========

Epoch: 27, P: 0.925963, R: 0.881343, F: 0.903102, OOV: 0.787840, GEO: 0.882586
=======entity level========
Epoch:  54%|█████▍    | 27/50 [09:25<07:59, 20.83s/it]P:  0.9259632616487455
R:  0.8813432835820896
F:  0.9031024688660694

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.38s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.37s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.39s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.783312
GEO: 0.881963
=======entity level========

Epoch: 28, P: 0.925651, R: 0.878678, F: 0.901553, OOV: 0.783312, GEO: 0.881963
=======entity level========
Epoch:  56%|█████▌    | 28/50 [09:46<07:37, 20.78s/it]P:  0.9256513926325247
R:  0.878678038379531
F:  0.9015532706191205

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.37s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.48s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.784929
GEO: 0.885942
=======entity level========

Epoch: 29, P: 0.926225, R: 0.880704, F: 0.902891, OOV: 0.784929, GEO: 0.885942
=======entity level========
Epoch:  58%|█████▊    | 29/50 [10:07<07:16, 20.78s/it]P:  0.9262249131068505
R:  0.8807036247334755
F:  0.9028908683534619

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:18,  2.61s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.53s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.39s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.39s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.40s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.40s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.790103
GEO: 0.883168
=======entity level========

Epoch: 30, P: 0.925537, R: 0.882516, F: 0.903515, OOV: 0.790103, GEO: 0.883168
=======entity level========
Epoch:  60%|██████    | 30/50 [10:28<06:55, 20.76s/it]P:  0.9255366726296959
R:  0.8825159914712154
F:  0.9035145164811178

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.50s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.50s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.40s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.14s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.785576
GEO: 0.882275
=======entity level========

Epoch: 31, P: 0.925025, R: 0.879957, F: 0.901929, OOV: 0.785576, GEO: 0.882275
=======entity level========
Epoch:  62%|██████▏   | 31/50 [10:48<06:34, 20.76s/it]P:  0.9250252157346184
R:  0.8799573560767591
F:  0.9019286455772277

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.42s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.38s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.38s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.787193
GEO: 0.880528
=======entity level========

Epoch: 32, P: 0.925213, R: 0.881023, F: 0.902578, OOV: 0.787193, GEO: 0.880528
=======entity level========
Epoch:  64%|██████▍   | 32/50 [11:09<06:12, 20.72s/it]P:  0.9252127183161666
R:  0.8810234541577825
F:  0.9025775447793797

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.49s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.48s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.47s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.40s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.14s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.788486
GEO: 0.878628
=======entity level========

Epoch: 33, P: 0.924298, R: 0.881237, F: 0.902254, OOV: 0.788486, GEO: 0.878628
=======entity level========
Epoch:  66%|██████▌   | 33/50 [11:30<05:52, 20.71s/it]P:  0.9242983338924299
R:  0.8812366737739872
F:  0.9022539977077989

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.35s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.37s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.786546
GEO: 0.882431
=======entity level========

Epoch: 34, P: 0.925395, R: 0.880704, F: 0.902496, OOV: 0.786546, GEO: 0.882431
=======entity level========

Early stop triggered at epoch 33

Epoch:  66%|██████▌   | 33/50 [11:50<06:06, 21.54s/it]

=======best f entity level========

Epoch: 24, P: 0.924433, R: 0.877719, F: 0.900470, OOV: 0.783312, GEO: 0.887417, GEO_N: 0.848409


=======best f entity level========
P:  0.9253948694970314
R:  0.8807036247334755
F:  0.9024963128857815
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:47,  1.28it/s]  3%|▎         | 2/62 [00:01<00:43,  1.37it/s]  5%|▍         | 3/62 [00:02<00:41,  1.42it/s]  6%|▋         | 4/62 [00:02<00:43,  1.32it/s]  8%|▊         | 5/62 [00:03<00:44,  1.29it/s] 10%|▉         | 6/62 [00:04<00:46,  1.21it/s] 11%|█▏        | 7/62 [00:05<00:40,  1.36it/s] 13%|█▎        | 8/62 [00:05<00:36,  1.48it/s] 15%|█▍        | 9/62 [00:06<00:38,  1.39it/s] 16%|█▌        | 10/62 [00:07<00:36,  1.42it/s] 18%|█▊        | 11/62 [00:08<00:41,  1.24it/s] 19%|█▉        | 12/62 [00:08<00:38,  1.32it/s] 21%|██        | 13/62 [00:09<00:38,  1.26it/s] 23%|██▎       | 14/62 [00:10<00:37,  1.29it/s] 24%|██▍       | 15/62 [00:11<00:34,  1.35it/s] 26%|██▌       | 16/62 [00:11<00:30,  1.52it/s] 27%|██▋       | 17/62 [00:12<00:27,  1.65it/s] 29%|██▉       | 18/62 [00:12<00:28,  1.56it/s] 31%|███       | 19/62 [00:14<00:33,  1.30it/s] 32%|███▏      | 20/62 [00:15<00:36,  1.15it/s] 34%|███▍      | 21/62 [00:16<00:42,  1.04s/it] 35%|███▌      | 22/62 [00:17<00:38,  1.03it/s] 37%|███▋      | 23/62 [00:17<00:32,  1.18it/s] 39%|███▊      | 24/62 [00:18<00:31,  1.20it/s] 40%|████      | 25/62 [00:20<00:38,  1.05s/it] 42%|████▏     | 26/62 [00:21<00:36,  1.01s/it] 44%|████▎     | 27/62 [00:21<00:32,  1.09it/s] 45%|████▌     | 28/62 [00:22<00:30,  1.10it/s] 47%|████▋     | 29/62 [00:23<00:29,  1.12it/s] 48%|████▊     | 30/62 [00:24<00:26,  1.19it/s] 50%|█████     | 31/62 [00:25<00:25,  1.24it/s] 52%|█████▏    | 32/62 [00:25<00:21,  1.37it/s] 53%|█████▎    | 33/62 [00:26<00:22,  1.31it/s] 55%|█████▍    | 34/62 [00:27<00:22,  1.24it/s] 56%|█████▋    | 35/62 [00:28<00:21,  1.28it/s] 58%|█████▊    | 36/62 [00:28<00:18,  1.41it/s] 60%|█████▉    | 37/62 [00:29<00:15,  1.64it/s] 61%|██████▏   | 38/62 [00:29<00:14,  1.61it/s] 63%|██████▎   | 39/62 [00:30<00:16,  1.39it/s] 65%|██████▍   | 40/62 [00:31<00:15,  1.39it/s] 66%|██████▌   | 41/62 [00:31<00:14,  1.42it/s] 68%|██████▊   | 42/62 [00:32<00:13,  1.43it/s] 69%|██████▉   | 43/62 [00:33<00:13,  1.40it/s] 71%|███████   | 44/62 [00:33<00:12,  1.49it/s] 73%|███████▎  | 45/62 [00:35<00:13,  1.23it/s] 74%|███████▍  | 46/62 [00:35<00:11,  1.34it/s] 76%|███████▌  | 47/62 [00:36<00:10,  1.46it/s] 77%|███████▋  | 48/62 [00:36<00:09,  1.46it/s] 79%|███████▉  | 49/62 [00:38<00:10,  1.23it/s] 81%|████████  | 50/62 [00:38<00:09,  1.27it/s] 82%|████████▏ | 51/62 [00:39<00:08,  1.24it/s] 84%|████████▍ | 52/62 [00:40<00:08,  1.22it/s] 85%|████████▌ | 53/62 [00:41<00:08,  1.04it/s] 87%|████████▋ | 54/62 [00:42<00:07,  1.13it/s] 89%|████████▊ | 55/62 [00:43<00:05,  1.21it/s] 90%|█████████ | 56/62 [00:43<00:04,  1.36it/s] 92%|█████████▏| 57/62 [00:44<00:03,  1.40it/s] 94%|█████████▎| 58/62 [00:45<00:02,  1.43it/s] 95%|█████████▌| 59/62 [00:45<00:02,  1.42it/s] 97%|█████████▋| 60/62 [00:46<00:01,  1.53it/s] 98%|█████████▊| 61/62 [00:47<00:00,  1.31it/s]100%|██████████| 62/62 [00:48<00:00,  1.33it/s]100%|██████████| 62/62 [00:48<00:00,  1.29it/s]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 2, 'av_threshold': 3, 'max_ngram_length': 5, 'model_name': 'self_bert_memory_softmax_score_0.7_0.810', 'use_memory': False, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of trainable parameters: 102273792
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.645860
GEO: 0.613932
=======entity level========

Epoch: 1, P: 0.816961, R: 0.778465, F: 0.797249, OOV: 0.645860, GEO: 0.613932
=======entity level========
Epoch:   2%|▏         | 1/50 [00:21<17:26, 21.35s/it]P:  0.8169612888789438
R:  0.7784648187633262
F:  0.7972486079266295

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.38s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.38s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.48s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.765524
GEO: 0.861842
=======entity level========

Epoch: 2, P: 0.911675, R: 0.861620, F: 0.885941, OOV: 0.765524, GEO: 0.861842
=======entity level========
Epoch:   4%|▍         | 2/50 [00:42<17:07, 21.40s/it]P:  0.9116751269035533
R:  0.8616204690831557
F:  0.8859413537955605

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.43s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.40s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.770699
GEO: 0.869623
=======entity level========

Epoch: 3, P: 0.918462, R: 0.868230, F: 0.892640, OOV: 0.770699, GEO: 0.869623
=======entity level========
Epoch:   6%|▌         | 3/50 [01:04<16:48, 21.46s/it]P:  0.9184617119657156
R:  0.868230277185501
F:  0.8926398860086588

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.52s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.779431
GEO: 0.880478
=======entity level========

Epoch: 4, P: 0.921824, R: 0.874947, F: 0.897774, OOV: 0.779431, GEO: 0.880478
=======entity level========
Epoch:   8%|▊         | 4/50 [01:25<16:24, 21.40s/it]P:  0.9218241042345277
R:  0.8749466950959488
F:  0.8977738883115463

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.782988
GEO: 0.888301
=======entity level========

Epoch: 5, P: 0.923985, R: 0.876013, F: 0.899360, OOV: 0.782988, GEO: 0.888301
=======entity level========
Epoch:  10%|█         | 5/50 [01:47<16:02, 21.39s/it]P:  0.92398515686495
R:  0.8760127931769722
F:  0.8993597110490887

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.43s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.48s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.767464
GEO: 0.878828
=======entity level========

Epoch: 6, P: 0.923982, R: 0.870789, F: 0.896597, OOV: 0.767464, GEO: 0.878828
=======entity level========
Epoch:  12%|█▏        | 6/50 [02:07<15:33, 21.21s/it]P:  0.9239819004524887
R:  0.8707889125799574
F:  0.8965971459934139

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.43s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.787840
GEO: 0.862182
=======entity level========

Epoch: 7, P: 0.921695, R: 0.880917, F: 0.900845, OOV: 0.787840, GEO: 0.862182
=======entity level========
Epoch:  14%|█▍        | 7/50 [02:28<15:07, 21.10s/it]P:  0.9216954824316788
R:  0.8809168443496802
F:  0.900844916871082

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.783635
GEO: 0.881110
=======entity level========

Epoch: 8, P: 0.924181, R: 0.878465, F: 0.900743, OOV: 0.783635, GEO: 0.881110
=======entity level========
Epoch:  16%|█▌        | 8/50 [02:49<14:42, 21.02s/it]P:  0.924181247196052
R:  0.8784648187633263
F:  0.9007433318758199

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.49s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.49s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.20s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.791721
GEO: 0.875164
=======entity level========

Epoch: 9, P: 0.926004, R: 0.884542, F: 0.904798, OOV: 0.791721, GEO: 0.875164
=======entity level========
Epoch:  18%|█▊        | 9/50 [03:10<14:20, 20.99s/it]P:  0.9260044642857143
R:  0.88454157782516
F:  0.9047982551799346

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.791074
GEO: 0.886544
=======entity level========

Epoch: 10, P: 0.925822, R: 0.882196, F: 0.903483, OOV: 0.791074, GEO: 0.886544
=======entity level========
Epoch:  20%|██        | 10/50 [03:31<13:57, 20.93s/it]P:  0.9258223316178116
R:  0.8821961620469083
F:  0.9034829129817666

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.39s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.39s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.793014
GEO: 0.869508
=======entity level========

Epoch: 11, P: 0.925975, R: 0.885501, F: 0.905286, OOV: 0.793014, GEO: 0.869508
=======entity level========
Epoch:  22%|██▏       | 11/50 [03:51<13:33, 20.85s/it]P:  0.9259754738015608
R:  0.885501066098081
F:  0.9052861035422344

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.40s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.786546
GEO: 0.879789
=======entity level========

Epoch: 12, P: 0.925229, R: 0.881237, F: 0.902697, OOV: 0.786546, GEO: 0.879789
=======entity level========
Epoch:  24%|██▍       | 12/50 [04:12<13:11, 20.82s/it]P:  0.9252294604880232
R:  0.8812366737739872
F:  0.9026973899748827

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.38s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.22s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.780724
GEO: 0.878567
=======entity level========

Epoch: 13, P: 0.925484, R: 0.876546, F: 0.900350, OOV: 0.780724, GEO: 0.878567
=======entity level========
Epoch:  26%|██▌       | 13/50 [04:33<12:50, 20.82s/it]P:  0.9254840162089149
R:  0.876545842217484
F:  0.9003504161191414

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.48s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.788810
GEO: 0.877470
=======entity level========

Epoch: 14, P: 0.926532, R: 0.881983, F: 0.903709, OOV: 0.788810, GEO: 0.877470
=======entity level========
Epoch:  28%|██▊       | 14/50 [04:54<12:30, 20.84s/it]P:  0.9265315264867287
R:  0.8819829424307036
F:  0.9037085586323667

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.51s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.46s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.39s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.786223
GEO: 0.878307
=======entity level========

Epoch: 15, P: 0.925333, R: 0.881237, F: 0.902747, OOV: 0.786223, GEO: 0.878307
=======entity level========

Early stop triggered at epoch 14

Epoch:  28%|██▊       | 14/50 [05:15<13:30, 22.52s/it]

=======best f entity level========

Epoch: 5, P: 0.923985, R: 0.876013, F: 0.899360, OOV: 0.782988, GEO: 0.888301, GEO_N: 0.849061


=======best f entity level========
P:  0.925333034814732
R:  0.8812366737739872
F:  0.9027466826844318
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:47,  1.28it/s]  3%|▎         | 2/62 [00:01<00:43,  1.37it/s]  5%|▍         | 3/62 [00:02<00:41,  1.42it/s]  6%|▋         | 4/62 [00:02<00:43,  1.32it/s]  8%|▊         | 5/62 [00:03<00:44,  1.29it/s] 10%|▉         | 6/62 [00:04<00:46,  1.21it/s] 11%|█▏        | 7/62 [00:05<00:40,  1.36it/s] 13%|█▎        | 8/62 [00:05<00:36,  1.48it/s] 15%|█▍        | 9/62 [00:06<00:38,  1.39it/s] 16%|█▌        | 10/62 [00:07<00:36,  1.42it/s] 18%|█▊        | 11/62 [00:08<00:41,  1.24it/s] 19%|█▉        | 12/62 [00:08<00:38,  1.32it/s] 21%|██        | 13/62 [00:09<00:38,  1.26it/s] 23%|██▎       | 14/62 [00:10<00:37,  1.29it/s] 24%|██▍       | 15/62 [00:11<00:34,  1.34it/s] 26%|██▌       | 16/62 [00:11<00:30,  1.52it/s] 27%|██▋       | 17/62 [00:12<00:27,  1.65it/s] 29%|██▉       | 18/62 [00:12<00:28,  1.56it/s] 31%|███       | 19/62 [00:14<00:33,  1.30it/s] 32%|███▏      | 20/62 [00:15<00:36,  1.15it/s] 34%|███▍      | 21/62 [00:16<00:42,  1.04s/it] 35%|███▌      | 22/62 [00:17<00:38,  1.03it/s] 37%|███▋      | 23/62 [00:17<00:32,  1.18it/s] 39%|███▊      | 24/62 [00:18<00:31,  1.20it/s] 40%|████      | 25/62 [00:20<00:38,  1.05s/it] 42%|████▏     | 26/62 [00:21<00:36,  1.01s/it] 44%|████▎     | 27/62 [00:21<00:32,  1.09it/s] 45%|████▌     | 28/62 [00:22<00:30,  1.10it/s] 47%|████▋     | 29/62 [00:23<00:29,  1.12it/s] 48%|████▊     | 30/62 [00:24<00:26,  1.19it/s] 50%|█████     | 31/62 [00:25<00:25,  1.24it/s] 52%|█████▏    | 32/62 [00:25<00:21,  1.37it/s] 53%|█████▎    | 33/62 [00:26<00:22,  1.31it/s] 55%|█████▍    | 34/62 [00:27<00:22,  1.24it/s] 56%|█████▋    | 35/62 [00:28<00:21,  1.28it/s] 58%|█████▊    | 36/62 [00:28<00:18,  1.41it/s] 60%|█████▉    | 37/62 [00:29<00:15,  1.64it/s] 61%|██████▏   | 38/62 [00:29<00:14,  1.61it/s] 63%|██████▎   | 39/62 [00:30<00:16,  1.39it/s] 65%|██████▍   | 40/62 [00:31<00:15,  1.39it/s] 66%|██████▌   | 41/62 [00:31<00:14,  1.42it/s] 68%|██████▊   | 42/62 [00:32<00:13,  1.44it/s] 69%|██████▉   | 43/62 [00:33<00:13,  1.41it/s] 71%|███████   | 44/62 [00:33<00:12,  1.49it/s] 73%|███████▎  | 45/62 [00:35<00:13,  1.23it/s] 74%|███████▍  | 46/62 [00:35<00:11,  1.34it/s] 76%|███████▌  | 47/62 [00:36<00:10,  1.46it/s] 77%|███████▋  | 48/62 [00:36<00:09,  1.46it/s] 79%|███████▉  | 49/62 [00:38<00:10,  1.23it/s] 81%|████████  | 50/62 [00:38<00:09,  1.27it/s] 82%|████████▏ | 51/62 [00:39<00:08,  1.24it/s] 84%|████████▍ | 52/62 [00:40<00:08,  1.22it/s] 85%|████████▌ | 53/62 [00:41<00:08,  1.04it/s] 87%|████████▋ | 54/62 [00:42<00:07,  1.13it/s] 89%|████████▊ | 55/62 [00:43<00:05,  1.21it/s] 90%|█████████ | 56/62 [00:43<00:04,  1.36it/s] 92%|█████████▏| 57/62 [00:44<00:03,  1.40it/s] 94%|█████████▎| 58/62 [00:45<00:02,  1.43it/s] 95%|█████████▌| 59/62 [00:45<00:02,  1.42it/s] 97%|█████████▋| 60/62 [00:46<00:01,  1.53it/s] 98%|█████████▊| 61/62 [00:47<00:00,  1.31it/s]100%|██████████| 62/62 [00:48<00:00,  1.33it/s]100%|██████████| 62/62 [00:48<00:00,  1.29it/s]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 2, 'av_threshold': 3, 'max_ngram_length': 5, 'model_name': 'self_bert_memory_softmax_score_0.7_0.811', 'use_memory': False, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of trainable parameters: 102273792
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.650065
GEO: 0.611209
=======entity level========

Epoch: 1, P: 0.818578, R: 0.780704, F: 0.799192, OOV: 0.650065, GEO: 0.611209
=======entity level========
Epoch:   2%|▏         | 1/50 [00:21<17:24, 21.33s/it]P:  0.818578135479544
R:  0.7807036247334754
F:  0.799192404234421

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.38s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.37s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.772316
GEO: 0.859580
=======entity level========

Epoch: 2, P: 0.914028, R: 0.864819, F: 0.888743, OOV: 0.772316, GEO: 0.859580
=======entity level========
Epoch:   4%|▍         | 2/50 [00:42<17:12, 21.52s/it]P:  0.9140281690140845
R:  0.864818763326226
F:  0.8887428101889894

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.43s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.40s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.771992
GEO: 0.870775
=======entity level========

Epoch: 3, P: 0.917708, R: 0.869083, F: 0.892734, OOV: 0.771992, GEO: 0.870775
=======entity level========
Epoch:   6%|▌         | 3/50 [01:04<16:48, 21.46s/it]P:  0.9177079815377688
R:  0.8690831556503198
F:  0.8927339429447517

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.52s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.14s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.776520
GEO: 0.879310
=======entity level========

Epoch: 4, P: 0.921035, R: 0.872921, F: 0.896333, OOV: 0.776520, GEO: 0.879310
=======entity level========
Epoch:   8%|▊         | 4/50 [01:25<16:26, 21.44s/it]P:  0.9210348706411698
R:  0.8729211087420042
F:  0.8963327859879583

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.38s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.782342
GEO: 0.878628
=======entity level========

Epoch: 5, P: 0.924242, R: 0.877932, F: 0.900492, OOV: 0.782342, GEO: 0.878628
=======entity level========
Epoch:  10%|█         | 5/50 [01:46<15:52, 21.18s/it]P:  0.9242424242424242
R:  0.8779317697228145
F:  0.900492072170585

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.43s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.771022
GEO: 0.880905
=======entity level========

Epoch: 6, P: 0.920886, R: 0.868657, F: 0.894009, OOV: 0.771022, GEO: 0.880905
=======entity level========
Epoch:  12%|█▏        | 6/50 [02:07<15:36, 21.28s/it]P:  0.9208860759493671
R:  0.8686567164179104
F:  0.8940092165898618

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.42s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.782988
GEO: 0.877470
=======entity level========

Epoch: 7, P: 0.921879, R: 0.876866, F: 0.898809, OOV: 0.782988, GEO: 0.877470
=======entity level========
Epoch:  14%|█▍        | 7/50 [02:28<15:08, 21.13s/it]P:  0.9218785025778974
R:  0.8768656716417911
F:  0.8988088733471751

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.783959
GEO: 0.878788
=======entity level========

Epoch: 8, P: 0.923896, R: 0.878785, F: 0.900776, OOV: 0.783959, GEO: 0.878788
=======entity level========
Epoch:  16%|█▌        | 8/50 [02:49<14:43, 21.03s/it]P:  0.9238959874467608
R:  0.8787846481876332
F:  0.9007758714894547

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.49s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.48s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.20s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.786546
GEO: 0.887129
=======entity level========

Epoch: 9, P: 0.923464, R: 0.879851, F: 0.901130, OOV: 0.786546, GEO: 0.887129
=======entity level========
Epoch:  18%|█▊        | 9/50 [03:11<14:28, 21.18s/it]P:  0.9234642497482377
R:  0.8798507462686567
F:  0.9011300977234263

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.783635
GEO: 0.886830
=======entity level========

Epoch: 10, P: 0.925185, R: 0.878038, F: 0.900996, OOV: 0.783635, GEO: 0.886830
=======entity level========
Epoch:  20%|██        | 10/50 [03:31<14:02, 21.06s/it]P:  0.9251853516063806
R:  0.8780383795309168
F:  0.9009955147139262

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.39s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.38s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.790427
GEO: 0.867280
=======entity level========

Epoch: 11, P: 0.925480, R: 0.884435, F: 0.904492, OOV: 0.790427, GEO: 0.867280
=======entity level========
Epoch:  22%|██▏       | 11/50 [03:52<13:36, 20.93s/it]P:  0.925479696564034
R:  0.8844349680170576
F:  0.9044919319668557

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.783635
GEO: 0.884768
=======entity level========

Epoch: 12, P: 0.924129, R: 0.879104, F: 0.901054, OOV: 0.783635, GEO: 0.884768
=======entity level========
Epoch:  24%|██▍       | 12/50 [04:13<13:12, 20.86s/it]P:  0.9241286562815196
R:  0.8791044776119403
F:  0.90105447194449

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.38s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.22s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.785899
GEO: 0.884183
=======entity level========

Epoch: 13, P: 0.923775, R: 0.878571, F: 0.900607, OOV: 0.785899, GEO: 0.884183
=======entity level========
Epoch:  26%|██▌       | 13/50 [04:34<12:50, 20.84s/it]P:  0.9237753615065576
R:  0.8785714285714286
F:  0.9006065242336485

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:15,  2.50s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.47s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.789133
GEO: 0.875903
=======entity level========

Epoch: 14, P: 0.923772, R: 0.882409, F: 0.902617, OOV: 0.789133, GEO: 0.875903
=======entity level========
Epoch:  28%|██▊       | 14/50 [04:54<12:30, 20.85s/it]P:  0.9237723214285715
R:  0.882409381663113
F:  0.9026172300981461

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.50s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.39s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.781048
GEO: 0.883134
=======entity level========

Epoch: 15, P: 0.925626, R: 0.878358, F: 0.901373, OOV: 0.781048, GEO: 0.883134
=======entity level========
Epoch:  30%|███       | 15/50 [05:15<12:09, 20.83s/it]P:  0.9256263341197618
R:  0.8783582089552239
F:  0.9013730102291997

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.781695
GEO: 0.881266
=======entity level========

Epoch: 16, P: 0.922240, R: 0.876226, F: 0.898644, OOV: 0.781695, GEO: 0.881266
=======entity level========
Epoch:  32%|███▏      | 16/50 [05:36<11:49, 20.87s/it]P:  0.9222396768402155
R:  0.876226012793177
F:  0.8986442160507327

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.48s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.40s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.782665
GEO: 0.883905
=======entity level========

Epoch: 17, P: 0.921938, R: 0.876333, F: 0.898557, OOV: 0.782665, GEO: 0.883905
=======entity level========
Epoch:  34%|███▍      | 17/50 [05:57<11:28, 20.86s/it]P:  0.9219380888290714
R:  0.8763326226012793
F:  0.8985570616528203

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.40s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.38s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.786869
GEO: 0.881266
=======entity level========

Epoch: 18, P: 0.925423, R: 0.879744, F: 0.902006, OOV: 0.786869, GEO: 0.881266
=======entity level========
Epoch:  36%|███▌      | 18/50 [06:18<11:05, 20.81s/it]P:  0.9254233486598632
R:  0.8797441364605544
F:  0.902005793299448

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.35s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.47s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.46s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.785899
GEO: 0.884768
=======entity level========

Epoch: 19, P: 0.924078, R: 0.878465, F: 0.900694, OOV: 0.785899, GEO: 0.884768
=======entity level========

Early stop triggered at epoch 18

Epoch:  36%|███▌      | 18/50 [06:39<11:49, 22.17s/it]

=======best f entity level========

Epoch: 9, P: 0.923464, R: 0.879851, F: 0.901130, OOV: 0.786546, GEO: 0.887129, GEO_N: 0.848424


=======best f entity level========
P:  0.9240776045755299
R:  0.8784648187633263
F:  0.9006941028583921
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:47,  1.28it/s]  3%|▎         | 2/62 [00:01<00:43,  1.37it/s]  5%|▍         | 3/62 [00:02<00:41,  1.42it/s]  6%|▋         | 4/62 [00:02<00:43,  1.32it/s]  8%|▊         | 5/62 [00:03<00:44,  1.29it/s] 10%|▉         | 6/62 [00:04<00:46,  1.21it/s] 11%|█▏        | 7/62 [00:05<00:40,  1.37it/s] 13%|█▎        | 8/62 [00:05<00:36,  1.48it/s] 15%|█▍        | 9/62 [00:06<00:38,  1.39it/s] 16%|█▌        | 10/62 [00:07<00:36,  1.42it/s] 18%|█▊        | 11/62 [00:08<00:40,  1.24it/s] 19%|█▉        | 12/62 [00:08<00:38,  1.32it/s] 21%|██        | 13/62 [00:09<00:38,  1.26it/s] 23%|██▎       | 14/62 [00:10<00:37,  1.29it/s] 24%|██▍       | 15/62 [00:11<00:34,  1.35it/s] 26%|██▌       | 16/62 [00:11<00:30,  1.52it/s] 27%|██▋       | 17/62 [00:12<00:27,  1.65it/s] 29%|██▉       | 18/62 [00:12<00:28,  1.56it/s] 31%|███       | 19/62 [00:13<00:33,  1.30it/s] 32%|███▏      | 20/62 [00:15<00:36,  1.15it/s] 34%|███▍      | 21/62 [00:16<00:42,  1.04s/it] 35%|███▌      | 22/62 [00:17<00:38,  1.03it/s] 37%|███▋      | 23/62 [00:17<00:32,  1.18it/s] 39%|███▊      | 24/62 [00:18<00:31,  1.20it/s] 40%|████      | 25/62 [00:20<00:38,  1.05s/it] 42%|████▏     | 26/62 [00:21<00:36,  1.00s/it] 44%|████▎     | 27/62 [00:21<00:32,  1.09it/s] 45%|████▌     | 28/62 [00:22<00:30,  1.11it/s] 47%|████▋     | 29/62 [00:23<00:29,  1.13it/s] 48%|████▊     | 30/62 [00:24<00:26,  1.20it/s] 50%|█████     | 31/62 [00:25<00:25,  1.24it/s] 52%|█████▏    | 32/62 [00:25<00:21,  1.37it/s] 53%|█████▎    | 33/62 [00:26<00:22,  1.32it/s] 55%|█████▍    | 34/62 [00:27<00:22,  1.25it/s] 56%|█████▋    | 35/62 [00:28<00:21,  1.28it/s] 58%|█████▊    | 36/62 [00:28<00:18,  1.41it/s] 60%|█████▉    | 37/62 [00:28<00:15,  1.64it/s] 61%|██████▏   | 38/62 [00:29<00:14,  1.62it/s] 63%|██████▎   | 39/62 [00:30<00:16,  1.39it/s] 65%|██████▍   | 40/62 [00:31<00:15,  1.39it/s] 66%|██████▌   | 41/62 [00:31<00:14,  1.42it/s] 68%|██████▊   | 42/62 [00:32<00:13,  1.43it/s] 69%|██████▉   | 43/62 [00:33<00:13,  1.41it/s] 71%|███████   | 44/62 [00:33<00:12,  1.49it/s] 73%|███████▎  | 45/62 [00:35<00:13,  1.23it/s] 74%|███████▍  | 46/62 [00:35<00:11,  1.34it/s] 76%|███████▌  | 47/62 [00:36<00:10,  1.46it/s] 77%|███████▋  | 48/62 [00:36<00:09,  1.46it/s] 79%|███████▉  | 49/62 [00:38<00:10,  1.23it/s] 81%|████████  | 50/62 [00:38<00:09,  1.27it/s] 82%|████████▏ | 51/62 [00:39<00:08,  1.24it/s] 84%|████████▍ | 52/62 [00:40<00:08,  1.22it/s] 85%|████████▌ | 53/62 [00:41<00:08,  1.04it/s] 87%|████████▋ | 54/62 [00:42<00:07,  1.13it/s] 89%|████████▊ | 55/62 [00:43<00:05,  1.21it/s] 90%|█████████ | 56/62 [00:43<00:04,  1.36it/s] 92%|█████████▏| 57/62 [00:44<00:03,  1.40it/s] 94%|█████████▎| 58/62 [00:45<00:02,  1.43it/s] 95%|█████████▌| 59/62 [00:45<00:02,  1.42it/s] 97%|█████████▋| 60/62 [00:46<00:01,  1.53it/s] 98%|█████████▊| 61/62 [00:47<00:00,  1.31it/s]100%|██████████| 62/62 [00:47<00:00,  1.33it/s]100%|██████████| 62/62 [00:47<00:00,  1.29it/s]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 2, 'av_threshold': 3, 'max_ngram_length': 5, 'model_name': 'self_bert_memory_softmax_score_0.7_0.812', 'use_memory': False, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of trainable parameters: 102273792
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.645860
GEO: 0.615839
=======entity level========

Epoch: 1, P: 0.815460, R: 0.778252, F: 0.796422, OOV: 0.645860, GEO: 0.615839
=======entity level========
Epoch:   2%|▏         | 1/50 [00:21<17:25, 21.34s/it]P:  0.8154602323503127
R:  0.7782515991471215
F:  0.7964215579314858

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.37s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.38s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.769082
GEO: 0.862409
=======entity level========

Epoch: 2, P: 0.911391, R: 0.864072, F: 0.887101, OOV: 0.769082, GEO: 0.862409
=======entity level========
Epoch:   4%|▍         | 2/50 [00:42<17:06, 21.39s/it]P:  0.9113909816709772
R:  0.8640724946695096
F:  0.8871011875444645

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.43s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.40s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.770052
GEO: 0.872101
=======entity level========

Epoch: 3, P: 0.917530, R: 0.868230, F: 0.892200, OOV: 0.770052, GEO: 0.872101
=======entity level========
Epoch:   6%|▌         | 3/50 [01:04<16:45, 21.39s/it]P:  0.9175304191077062
R:  0.868230277185501
F:  0.8921998247151621

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.52s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.14s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.778784
GEO: 0.877984
=======entity level========

Epoch: 4, P: 0.921868, R: 0.875480, F: 0.898075, OOV: 0.778784, GEO: 0.877984
=======entity level========
Epoch:   8%|▊         | 4/50 [01:25<16:23, 21.39s/it]P:  0.9218679838347553
R:  0.8754797441364606
F:  0.8980752405949256

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.781048
GEO: 0.883598
=======entity level========

Epoch: 5, P: 0.922973, R: 0.875053, F: 0.898375, OOV: 0.781048, GEO: 0.883598
=======entity level========
Epoch:  10%|█         | 5/50 [01:46<16:02, 21.38s/it]P:  0.9229731249297201
R:  0.8750533049040512
F:  0.89837465112461

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.43s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.769405
GEO: 0.888592
=======entity level========

Epoch: 6, P: 0.923791, R: 0.869723, F: 0.895942, OOV: 0.769405, GEO: 0.888592
=======entity level========
Epoch:  12%|█▏        | 6/50 [02:08<15:44, 21.45s/it]P:  0.9237911901256936
R:  0.8697228144989338
F:  0.8959420130690241

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.43s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.782988
GEO: 0.878369
=======entity level========

Epoch: 7, P: 0.921665, R: 0.878038, F: 0.899323, OOV: 0.782988, GEO: 0.878369
=======entity level========
Epoch:  14%|█▍        | 7/50 [02:29<15:13, 21.25s/it]P:  0.9216651745747538
R:  0.8780383795309168
F:  0.899322996287399

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.782018
GEO: 0.880952
=======entity level========

Epoch: 8, P: 0.925714, R: 0.878145, F: 0.901302, OOV: 0.782018, GEO: 0.880952
=======entity level========
Epoch:  16%|█▌        | 8/50 [02:50<14:46, 21.12s/it]P:  0.9257136435153968
R:  0.8781449893390192
F:  0.9013021118284276

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.49s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.48s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.20s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.783312
GEO: 0.867850
=======entity level========

Epoch: 9, P: 0.923550, R: 0.879638, F: 0.901059, OOV: 0.783312, GEO: 0.867850
=======entity level========
Epoch:  18%|█▊        | 9/50 [03:11<14:22, 21.05s/it]P:  0.9235504813073652
R:  0.879637526652452
F:  0.9010592988970186

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.783635
GEO: 0.869508
=======entity level========

Epoch: 10, P: 0.922174, R: 0.879211, F: 0.900180, OOV: 0.783635, GEO: 0.869508
=======entity level========
Epoch:  20%|██        | 10/50 [03:31<13:58, 20.97s/it]P:  0.9221737671922173
R:  0.8792110874200426
F:  0.9001801015117611

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.39s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.38s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.782342
GEO: 0.865220
=======entity level========

Epoch: 11, P: 0.923662, R: 0.879744, F: 0.901169, OOV: 0.782342, GEO: 0.865220
=======entity level========
Epoch:  22%|██▏       | 11/50 [03:52<13:33, 20.87s/it]P:  0.9236624132527423
R:  0.8797441364605544
F:  0.9011685049688763

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.780078
GEO: 0.884768
=======entity level========

Epoch: 12, P: 0.923500, R: 0.876439, F: 0.899355, OOV: 0.780078, GEO: 0.884768
=======entity level========
Epoch:  24%|██▍       | 12/50 [04:13<13:11, 20.82s/it]P:  0.9235003370029207
R:  0.8764392324093817
F:  0.8993545563942676

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.38s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.22s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.786223
GEO: 0.880952
=======entity level========

Epoch: 13, P: 0.924782, R: 0.880810, F: 0.902261, OOV: 0.786223, GEO: 0.880952
=======entity level========
Epoch:  26%|██▌       | 13/50 [04:34<12:50, 20.81s/it]P:  0.9247817327065144
R:  0.8808102345415778
F:  0.9022605656874522

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.48s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.789457
GEO: 0.878209
=======entity level========

Epoch: 14, P: 0.923892, R: 0.882623, F: 0.902786, OOV: 0.789457, GEO: 0.878209
=======entity level========
Epoch:  28%|██▊       | 14/50 [04:54<12:30, 20.83s/it]P:  0.9238924227206785
R:  0.8826226012793177
F:  0.9027861076277193

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.51s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.46s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.39s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.788163
GEO: 0.871626
=======entity level========

Epoch: 15, P: 0.923403, R: 0.882942, F: 0.902719, OOV: 0.788163, GEO: 0.871626
=======entity level========
Epoch:  30%|███       | 15/50 [05:15<12:08, 20.83s/it]P:  0.9234028319768091
R:  0.8829424307036248
F:  0.9027194942503679

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.53s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.786223
GEO: 0.874835
=======entity level========

Epoch: 16, P: 0.925868, R: 0.881450, F: 0.903113, OOV: 0.786223, GEO: 0.874835
=======entity level========

Early stop triggered at epoch 15

Epoch:  30%|███       | 15/50 [05:36<13:05, 22.44s/it]

=======best f entity level========

Epoch: 6, P: 0.923791, R: 0.869723, F: 0.895942, OOV: 0.769405, GEO: 0.888592, GEO_N: 0.845148


=======best f entity level========
P:  0.9258678611422172
R:  0.8814498933901919
F:  0.9031130529765156
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:47,  1.28it/s]  3%|▎         | 2/62 [00:01<00:43,  1.37it/s]  5%|▍         | 3/62 [00:02<00:41,  1.42it/s]  6%|▋         | 4/62 [00:02<00:43,  1.32it/s]  8%|▊         | 5/62 [00:03<00:44,  1.29it/s] 10%|▉         | 6/62 [00:04<00:46,  1.21it/s] 11%|█▏        | 7/62 [00:05<00:40,  1.37it/s] 13%|█▎        | 8/62 [00:05<00:36,  1.48it/s] 15%|█▍        | 9/62 [00:06<00:38,  1.39it/s] 16%|█▌        | 10/62 [00:07<00:36,  1.42it/s] 18%|█▊        | 11/62 [00:08<00:40,  1.25it/s] 19%|█▉        | 12/62 [00:08<00:37,  1.32it/s] 21%|██        | 13/62 [00:09<00:38,  1.27it/s] 23%|██▎       | 14/62 [00:10<00:37,  1.29it/s] 24%|██▍       | 15/62 [00:11<00:34,  1.35it/s] 26%|██▌       | 16/62 [00:11<00:30,  1.52it/s] 27%|██▋       | 17/62 [00:12<00:27,  1.65it/s] 29%|██▉       | 18/62 [00:12<00:28,  1.56it/s] 31%|███       | 19/62 [00:13<00:33,  1.30it/s] 32%|███▏      | 20/62 [00:15<00:36,  1.15it/s] 34%|███▍      | 21/62 [00:16<00:42,  1.04s/it] 35%|███▌      | 22/62 [00:17<00:38,  1.03it/s] 37%|███▋      | 23/62 [00:17<00:32,  1.19it/s] 39%|███▊      | 24/62 [00:18<00:31,  1.20it/s] 40%|████      | 25/62 [00:20<00:38,  1.05s/it] 42%|████▏     | 26/62 [00:21<00:36,  1.00s/it] 44%|████▎     | 27/62 [00:21<00:32,  1.09it/s] 45%|████▌     | 28/62 [00:22<00:30,  1.11it/s] 47%|████▋     | 29/62 [00:23<00:29,  1.13it/s] 48%|████▊     | 30/62 [00:24<00:26,  1.20it/s] 50%|█████     | 31/62 [00:25<00:24,  1.24it/s] 52%|█████▏    | 32/62 [00:25<00:21,  1.37it/s] 53%|█████▎    | 33/62 [00:26<00:22,  1.32it/s] 55%|█████▍    | 34/62 [00:27<00:22,  1.25it/s] 56%|█████▋    | 35/62 [00:28<00:21,  1.28it/s] 58%|█████▊    | 36/62 [00:28<00:18,  1.41it/s] 60%|█████▉    | 37/62 [00:28<00:15,  1.64it/s] 61%|██████▏   | 38/62 [00:29<00:14,  1.62it/s] 63%|██████▎   | 39/62 [00:30<00:16,  1.40it/s] 65%|██████▍   | 40/62 [00:31<00:15,  1.40it/s] 66%|██████▌   | 41/62 [00:31<00:14,  1.42it/s] 68%|██████▊   | 42/62 [00:32<00:13,  1.44it/s] 69%|██████▉   | 43/62 [00:33<00:13,  1.41it/s] 71%|███████   | 44/62 [00:33<00:12,  1.49it/s] 73%|███████▎  | 45/62 [00:35<00:13,  1.23it/s] 74%|███████▍  | 46/62 [00:35<00:11,  1.34it/s] 76%|███████▌  | 47/62 [00:36<00:10,  1.46it/s] 77%|███████▋  | 48/62 [00:36<00:09,  1.46it/s] 79%|███████▉  | 49/62 [00:37<00:10,  1.23it/s] 81%|████████  | 50/62 [00:38<00:09,  1.27it/s] 82%|████████▏ | 51/62 [00:39<00:08,  1.24it/s] 84%|████████▍ | 52/62 [00:40<00:08,  1.23it/s] 85%|████████▌ | 53/62 [00:41<00:08,  1.04it/s] 87%|████████▋ | 54/62 [00:42<00:07,  1.13it/s] 89%|████████▊ | 55/62 [00:43<00:05,  1.21it/s] 90%|█████████ | 56/62 [00:43<00:04,  1.36it/s] 92%|█████████▏| 57/62 [00:44<00:03,  1.40it/s] 94%|█████████▎| 58/62 [00:44<00:02,  1.43it/s] 95%|█████████▌| 59/62 [00:45<00:02,  1.42it/s] 97%|█████████▋| 60/62 [00:46<00:01,  1.53it/s] 98%|█████████▊| 61/62 [00:47<00:00,  1.31it/s]100%|██████████| 62/62 [00:47<00:00,  1.34it/s]100%|██████████| 62/62 [00:47<00:00,  1.29it/s]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 2, 'av_threshold': 3, 'max_ngram_length': 5, 'model_name': 'self_bert_memory_softmax_score_0.7_0.813', 'use_memory': False, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of trainable parameters: 102273792
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.643920
GEO: 0.619668
=======entity level========

Epoch: 1, P: 0.816939, R: 0.777399, F: 0.796679, OOV: 0.643920, GEO: 0.619668
=======entity level========
Epoch:   2%|▏         | 1/50 [00:21<17:25, 21.34s/it]P:  0.8169392785122115
R:  0.7773987206823028
F:  0.7966786845842894

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.38s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.37s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.766818
GEO: 0.866007
=======entity level========

Epoch: 2, P: 0.913614, R: 0.861407, F: 0.886743, OOV: 0.766818, GEO: 0.866007
=======entity level========
Epoch:   4%|▍         | 2/50 [00:42<17:06, 21.38s/it]P:  0.9136137494346449
R:  0.8614072494669509
F:  0.8867427568042143

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.43s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.39s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.768758
GEO: 0.869450
=======entity level========

Epoch: 3, P: 0.918589, R: 0.866098, F: 0.891572, OOV: 0.768758, GEO: 0.869450
=======entity level========
Epoch:   6%|▌         | 3/50 [01:04<16:49, 21.47s/it]P:  0.9185888738127544
R:  0.8660980810234542
F:  0.8915715539947323

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.51s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.14s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.778137
GEO: 0.874917
=======entity level========

Epoch: 4, P: 0.921177, R: 0.874627, F: 0.897298, OOV: 0.778137, GEO: 0.874917
=======entity level========
Epoch:   8%|▊         | 4/50 [01:26<16:31, 21.56s/it]P:  0.9211767347855379
R:  0.8746268656716418
F:  0.8972984797112544

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.780078
GEO: 0.890656
=======entity level========

Epoch: 5, P: 0.922999, R: 0.872814, F: 0.897205, OOV: 0.780078, GEO: 0.890656
=======entity level========
Epoch:  10%|█         | 5/50 [01:47<16:07, 21.50s/it]P:  0.9229988726042841
R:  0.872814498933902
F:  0.8972054794520549

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.43s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.774256
GEO: 0.894071
=======entity level========

Epoch: 6, P: 0.922912, R: 0.870469, F: 0.895924, OOV: 0.774256, GEO: 0.894071
=======entity level========
Epoch:  12%|█▏        | 6/50 [02:08<15:46, 21.52s/it]P:  0.9229117214875099
R:  0.8704690831556503
F:  0.8959236297799967

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.42s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.784929
GEO: 0.871053
=======entity level========

Epoch: 7, P: 0.923465, R: 0.878571, F: 0.900459, OOV: 0.784929, GEO: 0.871053
=======entity level========
Epoch:  14%|█▍        | 7/50 [02:29<15:15, 21.29s/it]P:  0.9234648139847602
R:  0.8785714285714286
F:  0.9004589160839161

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.779754
GEO: 0.874670
=======entity level========

Epoch: 8, P: 0.924055, R: 0.875586, F: 0.899168, OOV: 0.779754, GEO: 0.874670
=======entity level========
Epoch:  16%|█▌        | 8/50 [02:50<14:47, 21.14s/it]P:  0.924054905490549
R:  0.8755863539445629
F:  0.8991679439456973

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.49s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.48s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.20s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.780401
GEO: 0.877147
=======entity level========

Epoch: 9, P: 0.924276, R: 0.878358, F: 0.900732, OOV: 0.780401, GEO: 0.877147
=======entity level========
Epoch:  18%|█▊        | 9/50 [03:11<14:23, 21.07s/it]P:  0.9242764191159973
R:  0.8783582089552239
F:  0.9007324805947305

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.784605
GEO: 0.878307
=======entity level========

Epoch: 10, P: 0.925469, R: 0.878998, F: 0.901635, OOV: 0.784605, GEO: 0.878307
=======entity level========
Epoch:  20%|██        | 10/50 [03:32<13:59, 20.98s/it]P:  0.9254686272308901
R:  0.8789978678038379
F:  0.9016348624856471

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.39s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.38s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.789780
GEO: 0.877888
=======entity level========

Epoch: 11, P: 0.927020, R: 0.882942, F: 0.904445, OOV: 0.789780, GEO: 0.877888
=======entity level========
Epoch:  22%|██▏       | 11/50 [03:52<13:34, 20.88s/it]P:  0.9270203716140587
R:  0.8829424307036248
F:  0.9044446871246042

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.784282
GEO: 0.880952
=======entity level========

Epoch: 12, P: 0.926134, R: 0.879531, F: 0.902231, OOV: 0.784282, GEO: 0.880952
=======entity level========
Epoch:  24%|██▍       | 12/50 [04:13<13:11, 20.82s/it]P:  0.9261338123035474
R:  0.8795309168443497
F:  0.902230971128609

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.38s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.22s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.778784
GEO: 0.893191
=======entity level========

Epoch: 13, P: 0.926197, R: 0.876333, F: 0.900575, OOV: 0.778784, GEO: 0.893191
=======entity level========
Epoch:  26%|██▌       | 13/50 [04:34<12:50, 20.81s/it]P:  0.9261971830985916
R:  0.8763326226012793
F:  0.9005751848808545

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:15,  2.50s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.47s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.786223
GEO: 0.883598
=======entity level========

Epoch: 14, P: 0.926229, R: 0.882090, F: 0.903620, OOV: 0.786223, GEO: 0.883598
=======entity level========
Epoch:  28%|██▊       | 14/50 [04:55<12:29, 20.83s/it]P:  0.9262285906190529
R:  0.8820895522388059
F:  0.9036203789657621

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.50s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.40s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.39s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.784605
GEO: 0.887118
=======entity level========

Epoch: 15, P: 0.928836, R: 0.880810, F: 0.904186, OOV: 0.784605, GEO: 0.887118
=======entity level========
Epoch:  30%|███       | 15/50 [05:16<12:08, 20.82s/it]P:  0.9288364249578415
R:  0.8808102345415778
F:  0.9041860465116278

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.780724
GEO: 0.882119
=======entity level========

Epoch: 16, P: 0.925809, R: 0.878038, F: 0.901291, OOV: 0.780724, GEO: 0.882119
=======entity level========

Early stop triggered at epoch 15

Epoch:  30%|███       | 15/50 [05:37<13:06, 22.47s/it]

=======best f entity level========

Epoch: 6, P: 0.922912, R: 0.870469, F: 0.895924, OOV: 0.774256, GEO: 0.894071, GEO_N: 0.847526


=======best f entity level========
P:  0.9258093525179856
R:  0.8780383795309168
F:  0.9012913110089735
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:47,  1.28it/s]  3%|▎         | 2/62 [00:01<00:43,  1.37it/s]  5%|▍         | 3/62 [00:02<00:41,  1.42it/s]  6%|▋         | 4/62 [00:02<00:43,  1.32it/s]  8%|▊         | 5/62 [00:03<00:44,  1.29it/s] 10%|▉         | 6/62 [00:04<00:46,  1.21it/s] 11%|█▏        | 7/62 [00:05<00:40,  1.37it/s] 13%|█▎        | 8/62 [00:05<00:36,  1.48it/s] 15%|█▍        | 9/62 [00:06<00:38,  1.39it/s] 16%|█▌        | 10/62 [00:07<00:36,  1.42it/s] 18%|█▊        | 11/62 [00:08<00:40,  1.24it/s] 19%|█▉        | 12/62 [00:08<00:37,  1.32it/s] 21%|██        | 13/62 [00:09<00:38,  1.26it/s] 23%|██▎       | 14/62 [00:10<00:37,  1.29it/s] 24%|██▍       | 15/62 [00:11<00:34,  1.35it/s] 26%|██▌       | 16/62 [00:11<00:30,  1.52it/s] 27%|██▋       | 17/62 [00:12<00:27,  1.65it/s] 29%|██▉       | 18/62 [00:12<00:28,  1.56it/s] 31%|███       | 19/62 [00:13<00:33,  1.30it/s] 32%|███▏      | 20/62 [00:15<00:36,  1.15it/s] 34%|███▍      | 21/62 [00:16<00:42,  1.04s/it] 35%|███▌      | 22/62 [00:17<00:38,  1.03it/s] 37%|███▋      | 23/62 [00:17<00:32,  1.19it/s] 39%|███▊      | 24/62 [00:18<00:31,  1.20it/s] 40%|████      | 25/62 [00:20<00:38,  1.05s/it] 42%|████▏     | 26/62 [00:21<00:36,  1.00s/it] 44%|████▎     | 27/62 [00:21<00:32,  1.09it/s] 45%|████▌     | 28/62 [00:22<00:30,  1.11it/s] 47%|████▋     | 29/62 [00:23<00:29,  1.13it/s] 48%|████▊     | 30/62 [00:24<00:26,  1.20it/s] 50%|█████     | 31/62 [00:25<00:25,  1.24it/s] 52%|█████▏    | 32/62 [00:25<00:21,  1.37it/s] 53%|█████▎    | 33/62 [00:26<00:22,  1.32it/s] 55%|█████▍    | 34/62 [00:27<00:22,  1.25it/s] 56%|█████▋    | 35/62 [00:28<00:21,  1.28it/s] 58%|█████▊    | 36/62 [00:28<00:18,  1.41it/s] 60%|█████▉    | 37/62 [00:28<00:15,  1.64it/s] 61%|██████▏   | 38/62 [00:29<00:14,  1.62it/s] 63%|██████▎   | 39/62 [00:30<00:16,  1.39it/s] 65%|██████▍   | 40/62 [00:31<00:15,  1.39it/s] 66%|██████▌   | 41/62 [00:31<00:14,  1.42it/s] 68%|██████▊   | 42/62 [00:32<00:13,  1.44it/s] 69%|██████▉   | 43/62 [00:33<00:13,  1.41it/s] 71%|███████   | 44/62 [00:33<00:12,  1.49it/s] 73%|███████▎  | 45/62 [00:35<00:13,  1.23it/s] 74%|███████▍  | 46/62 [00:35<00:11,  1.34it/s] 76%|███████▌  | 47/62 [00:36<00:10,  1.46it/s] 77%|███████▋  | 48/62 [00:36<00:09,  1.46it/s] 79%|███████▉  | 49/62 [00:38<00:10,  1.23it/s] 81%|████████  | 50/62 [00:38<00:09,  1.27it/s] 82%|████████▏ | 51/62 [00:39<00:08,  1.24it/s] 84%|████████▍ | 52/62 [00:40<00:08,  1.23it/s] 85%|████████▌ | 53/62 [00:41<00:08,  1.04it/s] 87%|████████▋ | 54/62 [00:42<00:07,  1.13it/s] 89%|████████▊ | 55/62 [00:43<00:05,  1.22it/s] 90%|█████████ | 56/62 [00:43<00:04,  1.36it/s] 92%|█████████▏| 57/62 [00:44<00:03,  1.40it/s] 94%|█████████▎| 58/62 [00:44<00:02,  1.44it/s] 95%|█████████▌| 59/62 [00:45<00:02,  1.42it/s] 97%|█████████▋| 60/62 [00:46<00:01,  1.53it/s] 98%|█████████▊| 61/62 [00:47<00:00,  1.31it/s]100%|██████████| 62/62 [00:47<00:00,  1.34it/s]100%|██████████| 62/62 [00:47<00:00,  1.29it/s]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 2, 'av_threshold': 3, 'max_ngram_length': 5, 'model_name': 'self_bert_memory_softmax_score_0.7_0.814', 'use_memory': False, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of trainable parameters: 102273792
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.642626
GEO: 0.617751
=======entity level========

Epoch: 1, P: 0.815952, R: 0.776546, F: 0.795761, OOV: 0.642626, GEO: 0.617751
=======entity level========
Epoch:   2%|▏         | 1/50 [00:21<17:24, 21.32s/it]P:  0.815951607482917
R:  0.776545842217484
F:  0.795761184246463

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.38s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.37s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.763907
GEO: 0.859025
=======entity level========

Epoch: 2, P: 0.912293, R: 0.861620, F: 0.886233, OOV: 0.763907, GEO: 0.859025
=======entity level========
Epoch:   4%|▍         | 2/50 [00:42<17:08, 21.43s/it]P:  0.9122925838130714
R:  0.8616204690831557
F:  0.8862327978507593

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.43s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.40s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.765201
GEO: 0.871182
=======entity level========

Epoch: 3, P: 0.918044, R: 0.864606, F: 0.890524, OOV: 0.765201, GEO: 0.871182
=======entity level========
Epoch:   6%|▌         | 3/50 [01:04<16:46, 21.42s/it]P:  0.9180439212134933
R:  0.8646055437100213
F:  0.8905237729219283

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.51s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.14s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.774580
GEO: 0.875912
=======entity level========

Epoch: 4, P: 0.923570, R: 0.874733, F: 0.898489, OOV: 0.774580, GEO: 0.875912
=======entity level========
Epoch:   8%|▊         | 4/50 [01:25<16:23, 21.39s/it]P:  0.9235704637550652
R:  0.8747334754797441
F:  0.8984888304862024

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.773609
GEO: 0.882704
=======entity level========

Epoch: 5, P: 0.921338, R: 0.869083, F: 0.894448, OOV: 0.773609, GEO: 0.882704
=======entity level========
Epoch:  10%|█         | 5/50 [01:46<16:01, 21.37s/it]P:  0.9213381555153707
R:  0.8690831556503198
F:  0.8944481018213738

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.48s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.782342
GEO: 0.893165
=======entity level========

Epoch: 6, P: 0.925053, R: 0.878998, F: 0.901438, OOV: 0.782342, GEO: 0.893165
=======entity level========
Epoch:  12%|█▏        | 6/50 [02:08<15:43, 21.45s/it]P:  0.9250532929428924
R:  0.8789978678038379
F:  0.9014377084130542

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.43s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.778784
GEO: 0.878468
=======entity level========

Epoch: 7, P: 0.922930, R: 0.875800, F: 0.898747, OOV: 0.778784, GEO: 0.878468
=======entity level========
Epoch:  14%|█▍        | 7/50 [02:29<15:13, 21.24s/it]P:  0.9229300078642849
R:  0.8757995735607675
F:  0.8987473332968656

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.782988
GEO: 0.879048
=======entity level========

Epoch: 8, P: 0.923250, R: 0.877186, F: 0.899628, OOV: 0.782988, GEO: 0.879048
=======entity level========
Epoch:  16%|█▌        | 8/50 [02:50<14:46, 21.10s/it]P:  0.9232495511669659
R:  0.877185501066098
F:  0.8996282527881041

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.49s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.48s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.20s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.782342
GEO: 0.885506
=======entity level========

Epoch: 9, P: 0.924268, R: 0.878252, F: 0.900672, OOV: 0.782342, GEO: 0.885506
=======entity level========
Epoch:  18%|█▊        | 9/50 [03:11<14:22, 21.04s/it]P:  0.9242679232581622
R:  0.8782515991471216
F:  0.9006723883452687

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.780401
GEO: 0.885638
=======entity level========

Epoch: 10, P: 0.925476, R: 0.876439, F: 0.900290, OOV: 0.780401, GEO: 0.885638
=======entity level========
Epoch:  20%|██        | 10/50 [03:31<13:57, 20.95s/it]P:  0.9254756276032872
R:  0.8764392324093817
F:  0.900290204238077

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.39s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.38s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.791397
GEO: 0.884336
=======entity level========

Epoch: 11, P: 0.927157, R: 0.883369, F: 0.904733, OOV: 0.791397, GEO: 0.884336
=======entity level========
Epoch:  22%|██▏       | 11/50 [03:52<13:33, 20.85s/it]P:  0.9271567640147701
R:  0.8833688699360341
F:  0.9047333078560901

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.40s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.786546
GEO: 0.876984
=======entity level========

Epoch: 12, P: 0.926993, R: 0.881237, F: 0.903536, OOV: 0.786546, GEO: 0.876984
=======entity level========
Epoch:  24%|██▍       | 12/50 [04:13<13:10, 20.80s/it]P:  0.9269933834249187
R:  0.8812366737739872
F:  0.9035360988140132

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.38s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.22s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.770052
GEO: 0.880160
=======entity level========

Epoch: 13, P: 0.923912, R: 0.871215, F: 0.896790, OOV: 0.770052, GEO: 0.880160
=======entity level========
Epoch:  26%|██▌       | 13/50 [04:33<12:49, 20.79s/it]P:  0.923911814584511
R:  0.8712153518123668
F:  0.8967901234567901

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:15,  2.50s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.47s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.787193
GEO: 0.881692
=======entity level========

Epoch: 14, P: 0.924246, R: 0.881876, F: 0.902564, OOV: 0.787193, GEO: 0.881692
=======entity level========
Epoch:  28%|██▊       | 14/50 [04:54<12:29, 20.82s/it]P:  0.9242458100558659
R:  0.8818763326226012
F:  0.9025641025641027

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.50s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.40s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.39s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.785252
GEO: 0.880952
=======entity level========

Epoch: 15, P: 0.927048, R: 0.880597, F: 0.903226, OOV: 0.785252, GEO: 0.880952
=======entity level========
Epoch:  30%|███       | 15/50 [05:15<12:08, 20.81s/it]P:  0.9270482603815937
R:  0.8805970149253731
F:  0.9032258064516128

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.53s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.783959
GEO: 0.881110
=======entity level========

Epoch: 16, P: 0.926109, R: 0.879211, F: 0.902051, OOV: 0.783959, GEO: 0.881110
=======entity level========

Early stop triggered at epoch 15

Epoch:  30%|███       | 15/50 [05:36<13:05, 22.43s/it]

=======best f entity level========

Epoch: 6, P: 0.925053, R: 0.878998, F: 0.901438, OOV: 0.782342, GEO: 0.893165, GEO_N: 0.849699


=======best f entity level========
P:  0.9261089275687816
R:  0.8792110874200426
F:  0.9020508613617719
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:47,  1.28it/s]  3%|▎         | 2/62 [00:01<00:43,  1.37it/s]  5%|▍         | 3/62 [00:02<00:41,  1.41it/s]  6%|▋         | 4/62 [00:02<00:44,  1.32it/s]  8%|▊         | 5/62 [00:03<00:44,  1.28it/s] 10%|▉         | 6/62 [00:04<00:46,  1.20it/s] 11%|█▏        | 7/62 [00:05<00:40,  1.36it/s] 13%|█▎        | 8/62 [00:05<00:36,  1.48it/s] 15%|█▍        | 9/62 [00:06<00:38,  1.39it/s] 16%|█▌        | 10/62 [00:07<00:36,  1.42it/s] 18%|█▊        | 11/62 [00:08<00:41,  1.24it/s] 19%|█▉        | 12/62 [00:09<00:38,  1.31it/s] 21%|██        | 13/62 [00:09<00:38,  1.26it/s] 23%|██▎       | 14/62 [00:10<00:37,  1.29it/s] 24%|██▍       | 15/62 [00:11<00:35,  1.34it/s] 26%|██▌       | 16/62 [00:11<00:30,  1.52it/s] 27%|██▋       | 17/62 [00:12<00:27,  1.64it/s] 29%|██▉       | 18/62 [00:12<00:28,  1.56it/s] 31%|███       | 19/62 [00:14<00:33,  1.30it/s] 32%|███▏      | 20/62 [00:15<00:36,  1.15it/s] 34%|███▍      | 21/62 [00:16<00:42,  1.04s/it] 35%|███▌      | 22/62 [00:17<00:38,  1.03it/s] 37%|███▋      | 23/62 [00:17<00:32,  1.18it/s] 39%|███▊      | 24/62 [00:18<00:31,  1.20it/s] 40%|████      | 25/62 [00:20<00:38,  1.05s/it] 42%|████▏     | 26/62 [00:21<00:36,  1.01s/it] 44%|████▎     | 27/62 [00:21<00:32,  1.09it/s] 45%|████▌     | 28/62 [00:22<00:30,  1.10it/s] 47%|████▋     | 29/62 [00:23<00:29,  1.12it/s] 48%|████▊     | 30/62 [00:24<00:26,  1.19it/s] 50%|█████     | 31/62 [00:25<00:25,  1.24it/s] 52%|█████▏    | 32/62 [00:25<00:21,  1.37it/s] 53%|█████▎    | 33/62 [00:26<00:22,  1.31it/s] 55%|█████▍    | 34/62 [00:27<00:22,  1.24it/s] 56%|█████▋    | 35/62 [00:28<00:21,  1.28it/s] 58%|█████▊    | 36/62 [00:28<00:18,  1.41it/s] 60%|█████▉    | 37/62 [00:29<00:15,  1.64it/s] 61%|██████▏   | 38/62 [00:29<00:14,  1.61it/s] 63%|██████▎   | 39/62 [00:30<00:16,  1.39it/s] 65%|██████▍   | 40/62 [00:31<00:15,  1.39it/s] 66%|██████▌   | 41/62 [00:32<00:14,  1.42it/s] 68%|██████▊   | 42/62 [00:32<00:13,  1.43it/s] 69%|██████▉   | 43/62 [00:33<00:13,  1.40it/s] 71%|███████   | 44/62 [00:34<00:12,  1.48it/s] 73%|███████▎  | 45/62 [00:35<00:13,  1.23it/s] 74%|███████▍  | 46/62 [00:35<00:11,  1.33it/s] 76%|███████▌  | 47/62 [00:36<00:10,  1.46it/s] 77%|███████▋  | 48/62 [00:37<00:09,  1.46it/s] 79%|███████▉  | 49/62 [00:38<00:10,  1.23it/s] 81%|████████  | 50/62 [00:38<00:09,  1.26it/s] 82%|████████▏ | 51/62 [00:39<00:08,  1.24it/s] 84%|████████▍ | 52/62 [00:40<00:08,  1.22it/s] 85%|████████▌ | 53/62 [00:41<00:08,  1.04it/s] 87%|████████▋ | 54/62 [00:42<00:07,  1.12it/s] 89%|████████▊ | 55/62 [00:43<00:05,  1.21it/s] 90%|█████████ | 56/62 [00:43<00:04,  1.36it/s] 92%|█████████▏| 57/62 [00:44<00:03,  1.39it/s] 94%|█████████▎| 58/62 [00:45<00:02,  1.43it/s] 95%|█████████▌| 59/62 [00:45<00:02,  1.42it/s] 97%|█████████▋| 60/62 [00:46<00:01,  1.53it/s] 98%|█████████▊| 61/62 [00:47<00:00,  1.31it/s]100%|██████████| 62/62 [00:48<00:00,  1.33it/s]100%|██████████| 62/62 [00:48<00:00,  1.29it/s]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 2, 'av_threshold': 3, 'max_ngram_length': 5, 'model_name': 'self_bert_memory_softmax_score_0.7_0.815', 'use_memory': False, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of trainable parameters: 102273792
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.47s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.50s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.647477
GEO: 0.613569
=======entity level========

Epoch: 1, P: 0.816062, R: 0.779957, F: 0.797602, OOV: 0.647477, GEO: 0.613569
=======entity level========
Epoch:   2%|▏         | 1/50 [00:21<17:26, 21.36s/it]P:  0.8160624651422197
R:  0.7799573560767591
F:  0.7976015263014447

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.38s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.48s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.766494
GEO: 0.867327
=======entity level========

Epoch: 2, P: 0.913485, R: 0.862260, F: 0.887134, OOV: 0.766494, GEO: 0.867327
=======entity level========
Epoch:   4%|▍         | 2/50 [00:43<17:13, 21.53s/it]P:  0.9134854303139823
R:  0.8622601279317698
F:  0.8871339256334322

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.43s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.40s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.767464
GEO: 0.872510
=======entity level========

Epoch: 3, P: 0.917061, R: 0.868763, F: 0.892259, OOV: 0.767464, GEO: 0.872510
=======entity level========
Epoch:   6%|▌         | 3/50 [01:04<16:49, 21.48s/it]P:  0.91706054467702
R:  0.8687633262260128
F:  0.8922588415635606

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.52s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.779431
GEO: 0.876984
=======entity level========

Epoch: 4, P: 0.922732, R: 0.878465, F: 0.900055, OOV: 0.779431, GEO: 0.876984
=======entity level========
Epoch:   8%|▊         | 4/50 [01:25<16:26, 21.45s/it]P:  0.9227323628219485
R:  0.8784648187633263
F:  0.9000546149645002

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.777490
GEO: 0.882548
=======entity level========

Epoch: 5, P: 0.923008, R: 0.872921, F: 0.897266, OOV: 0.777490, GEO: 0.882548
=======entity level========
Epoch:  10%|█         | 5/50 [01:47<16:05, 21.46s/it]P:  0.9230075526998084
R:  0.8729211087420042
F:  0.8972659032381787

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.48s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.775550
GEO: 0.884897
=======entity level========

Epoch: 6, P: 0.922834, R: 0.872068, F: 0.896733, OOV: 0.775550, GEO: 0.884897
=======entity level========
Epoch:  12%|█▏        | 6/50 [02:08<15:44, 21.47s/it]P:  0.9228339350180506
R:  0.8720682302771855
F:  0.8967331725498794

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.43s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.785252
GEO: 0.873518
=======entity level========

Epoch: 7, P: 0.923352, R: 0.881023, F: 0.901691, OOV: 0.785252, GEO: 0.873518
=======entity level========
Epoch:  14%|█▍        | 7/50 [02:29<15:14, 21.27s/it]P:  0.9233519553072626
R:  0.8810234541577825
F:  0.9016912165848336

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.781695
GEO: 0.890066
=======entity level========

Epoch: 8, P: 0.923708, R: 0.876439, F: 0.899453, OOV: 0.781695, GEO: 0.890066
=======entity level========
Epoch:  16%|█▌        | 8/50 [02:51<14:56, 21.34s/it]P:  0.9237078651685393
R:  0.8764392324093817
F:  0.89945295404814

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.49s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.49s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.20s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.780724
GEO: 0.893023
=======entity level========

Epoch: 9, P: 0.927944, R: 0.878678, F: 0.902639, OOV: 0.780724, GEO: 0.893023
=======entity level========
Epoch:  18%|█▊        | 9/50 [03:12<14:39, 21.44s/it]P:  0.9279441567214591
R:  0.878678038379531
F:  0.9026393604205455

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.40s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.783635
GEO: 0.886394
=======entity level========

Epoch: 10, P: 0.927062, R: 0.879424, F: 0.902615, OOV: 0.783635, GEO: 0.886394
=======entity level========
Epoch:  20%|██        | 10/50 [03:33<14:09, 21.24s/it]P:  0.9270622611822882
R:  0.8794243070362473
F:  0.9026151657730607

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.39s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.792044
GEO: 0.874835
=======entity level========

Epoch: 11, P: 0.925142, R: 0.885394, F: 0.904832, OOV: 0.792044, GEO: 0.874835
=======entity level========
Epoch:  22%|██▏       | 11/50 [03:54<13:41, 21.07s/it]P:  0.9251420296312799
R:  0.8853944562899787
F:  0.9048319442174646

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.40s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.780078
GEO: 0.886093
=======entity level========

Epoch: 12, P: 0.924795, R: 0.878358, F: 0.900979, OOV: 0.780078, GEO: 0.886093
=======entity level========
Epoch:  24%|██▍       | 12/50 [04:15<13:16, 20.97s/it]P:  0.9247951509709282
R:  0.8783582089552239
F:  0.900978730384384

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.38s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.22s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.784605
GEO: 0.882859
=======entity level========

Epoch: 13, P: 0.925992, R: 0.880384, F: 0.902612, OOV: 0.784605, GEO: 0.882859
=======entity level========
Epoch:  26%|██▌       | 13/50 [04:35<12:53, 20.92s/it]P:  0.9259923749719668
R:  0.8803837953091684
F:  0.9026123073559953

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.48s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.785252
GEO: 0.874670
=======entity level========

Epoch: 14, P: 0.924815, R: 0.881237, F: 0.902500, OOV: 0.785252, GEO: 0.874670
=======entity level========
Epoch:  28%|██▊       | 14/50 [04:56<12:32, 20.91s/it]P:  0.9248153949429403
R:  0.8812366737739872
F:  0.9025002729555629

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.51s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.46s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.39s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.790750
GEO: 0.870989
=======entity level========

Epoch: 15, P: 0.924897, R: 0.883582, F: 0.903768, OOV: 0.790750, GEO: 0.870989
=======entity level========
Epoch:  30%|███       | 15/50 [05:17<12:11, 20.89s/it]P:  0.9248967749135141
R:  0.8835820895522388
F:  0.9037675154026499

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.53s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.782342
GEO: 0.881848
=======entity level========

Epoch: 16, P: 0.924045, R: 0.876759, F: 0.899781, OOV: 0.782342, GEO: 0.881848
=======entity level========
Epoch:  32%|███▏      | 16/50 [05:38<11:51, 20.92s/it]P:  0.9240449438202247
R:  0.8767590618336887
F:  0.8997811816192559

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.49s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.46s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.773609
GEO: 0.880478
=======entity level========

Epoch: 17, P: 0.922011, R: 0.872175, F: 0.896401, OOV: 0.773609, GEO: 0.880478
=======entity level========
Epoch:  34%|███▍      | 17/50 [05:59<11:29, 20.91s/it]P:  0.9220105939366617
R:  0.8721748400852879
F:  0.8964005916835589

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.40s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.38s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.783635
GEO: 0.878888
=======entity level========

Epoch: 18, P: 0.926720, R: 0.880384, F: 0.902958, OOV: 0.783635, GEO: 0.878888
=======entity level========
Epoch:  36%|███▌      | 18/50 [06:20<11:07, 20.85s/it]P:  0.9267197845359668
R:  0.8803837953091684
F:  0.9029577387786344

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.48s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.47s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.781695
GEO: 0.880212
=======entity level========

Epoch: 19, P: 0.926599, R: 0.880171, F: 0.902788, OOV: 0.781695, GEO: 0.880212
=======entity level========

Early stop triggered at epoch 18

Epoch:  36%|███▌      | 18/50 [06:41<11:53, 22.28s/it]

=======best f entity level========

Epoch: 9, P: 0.927944, R: 0.878678, F: 0.902639, OOV: 0.780724, GEO: 0.893023, GEO_N: 0.851768


=======best f entity level========
P:  0.9265993265993266
R:  0.8801705756929638
F:  0.9027884089666486
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:47,  1.28it/s]  3%|▎         | 2/62 [00:01<00:43,  1.37it/s]  5%|▍         | 3/62 [00:02<00:41,  1.42it/s]  6%|▋         | 4/62 [00:02<00:43,  1.32it/s]  8%|▊         | 5/62 [00:03<00:44,  1.29it/s] 10%|▉         | 6/62 [00:04<00:46,  1.21it/s] 11%|█▏        | 7/62 [00:05<00:40,  1.36it/s] 13%|█▎        | 8/62 [00:05<00:36,  1.48it/s] 15%|█▍        | 9/62 [00:06<00:38,  1.39it/s] 16%|█▌        | 10/62 [00:07<00:36,  1.42it/s] 18%|█▊        | 11/62 [00:08<00:40,  1.24it/s] 19%|█▉        | 12/62 [00:08<00:38,  1.32it/s] 21%|██        | 13/62 [00:09<00:38,  1.26it/s] 23%|██▎       | 14/62 [00:10<00:37,  1.29it/s] 24%|██▍       | 15/62 [00:11<00:34,  1.34it/s] 26%|██▌       | 16/62 [00:11<00:30,  1.52it/s] 27%|██▋       | 17/62 [00:12<00:27,  1.65it/s] 29%|██▉       | 18/62 [00:12<00:28,  1.56it/s] 31%|███       | 19/62 [00:14<00:33,  1.30it/s] 32%|███▏      | 20/62 [00:15<00:36,  1.15it/s] 34%|███▍      | 21/62 [00:16<00:42,  1.04s/it] 35%|███▌      | 22/62 [00:17<00:38,  1.03it/s] 37%|███▋      | 23/62 [00:17<00:32,  1.18it/s] 39%|███▊      | 24/62 [00:18<00:31,  1.20it/s] 40%|████      | 25/62 [00:20<00:38,  1.05s/it] 42%|████▏     | 26/62 [00:21<00:36,  1.01s/it] 44%|████▎     | 27/62 [00:21<00:32,  1.09it/s] 45%|████▌     | 28/62 [00:22<00:30,  1.10it/s] 47%|████▋     | 29/62 [00:23<00:29,  1.12it/s] 48%|████▊     | 30/62 [00:24<00:26,  1.19it/s] 50%|█████     | 31/62 [00:25<00:25,  1.24it/s] 52%|█████▏    | 32/62 [00:25<00:21,  1.37it/s] 53%|█████▎    | 33/62 [00:26<00:22,  1.32it/s] 55%|█████▍    | 34/62 [00:27<00:22,  1.24it/s] 56%|█████▋    | 35/62 [00:28<00:21,  1.28it/s] 58%|█████▊    | 36/62 [00:28<00:18,  1.41it/s] 60%|█████▉    | 37/62 [00:28<00:15,  1.64it/s] 61%|██████▏   | 38/62 [00:29<00:14,  1.62it/s] 63%|██████▎   | 39/62 [00:30<00:16,  1.39it/s] 65%|██████▍   | 40/62 [00:31<00:15,  1.39it/s] 66%|██████▌   | 41/62 [00:31<00:14,  1.42it/s] 68%|██████▊   | 42/62 [00:32<00:13,  1.44it/s] 69%|██████▉   | 43/62 [00:33<00:13,  1.41it/s] 71%|███████   | 44/62 [00:33<00:12,  1.49it/s] 73%|███████▎  | 45/62 [00:35<00:13,  1.23it/s] 74%|███████▍  | 46/62 [00:35<00:11,  1.34it/s] 76%|███████▌  | 47/62 [00:36<00:10,  1.46it/s] 77%|███████▋  | 48/62 [00:36<00:09,  1.46it/s] 79%|███████▉  | 49/62 [00:38<00:10,  1.23it/s] 81%|████████  | 50/62 [00:38<00:09,  1.27it/s] 82%|████████▏ | 51/62 [00:39<00:08,  1.24it/s] 84%|████████▍ | 52/62 [00:40<00:08,  1.23it/s] 85%|████████▌ | 53/62 [00:41<00:08,  1.04it/s] 87%|████████▋ | 54/62 [00:42<00:07,  1.13it/s] 89%|████████▊ | 55/62 [00:43<00:05,  1.21it/s] 90%|█████████ | 56/62 [00:43<00:04,  1.36it/s] 92%|█████████▏| 57/62 [00:44<00:03,  1.40it/s] 94%|█████████▎| 58/62 [00:45<00:02,  1.43it/s] 95%|█████████▌| 59/62 [00:45<00:02,  1.42it/s] 97%|█████████▋| 60/62 [00:46<00:01,  1.53it/s] 98%|█████████▊| 61/62 [00:47<00:00,  1.31it/s]100%|██████████| 62/62 [00:48<00:00,  1.33it/s]100%|██████████| 62/62 [00:48<00:00,  1.29it/s]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 2, 'av_threshold': 3, 'max_ngram_length': 5, 'model_name': 'self_bert_memory_softmax_score_0.7_0.816', 'use_memory': False, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of trainable parameters: 102273792
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.648448
GEO: 0.609053
=======entity level========

Epoch: 1, P: 0.817239, R: 0.781343, F: 0.798888, OOV: 0.648448, GEO: 0.609053
=======entity level========
Epoch:   2%|▏         | 1/50 [00:21<17:27, 21.38s/it]P:  0.8172390722569135
R:  0.7813432835820896
F:  0.7988881621975148

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.38s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.48s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.767464
GEO: 0.863546
=======entity level========

Epoch: 2, P: 0.912813, R: 0.862793, F: 0.887099, OOV: 0.767464, GEO: 0.863546
=======entity level========
Epoch:   4%|▍         | 2/50 [00:42<17:10, 21.47s/it]P:  0.9128129934581547
R:  0.8627931769722814
F:  0.8870985421462237

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.43s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.40s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.763583
GEO: 0.870604
=======entity level========

Epoch: 3, P: 0.917260, R: 0.865139, F: 0.890437, OOV: 0.763583, GEO: 0.870604
=======entity level========
Epoch:   6%|▌         | 3/50 [01:04<16:51, 21.52s/it]P:  0.9172600881654798
R:  0.8651385927505331
F:  0.8904372634004498

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.52s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.781048
GEO: 0.880370
=======entity level========

Epoch: 4, P: 0.921562, R: 0.878038, F: 0.899274, OOV: 0.781048, GEO: 0.880370
=======entity level========
Epoch:   8%|▊         | 4/50 [01:26<16:30, 21.52s/it]P:  0.9215620454291149
R:  0.8780383795309168
F:  0.8992738985641753

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.777167
GEO: 0.879310
=======entity level========

Epoch: 5, P: 0.921180, R: 0.872175, F: 0.896008, OOV: 0.777167, GEO: 0.879310
=======entity level========
Epoch:  10%|█         | 5/50 [01:46<15:55, 21.24s/it]P:  0.9211800472919717
R:  0.8721748400852879
F:  0.8960078856579596

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.48s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.770375
GEO: 0.890073
=======entity level========

Epoch: 6, P: 0.921831, R: 0.867484, F: 0.893832, OOV: 0.770375, GEO: 0.890073
=======entity level========
Epoch:  12%|█▏        | 6/50 [02:08<15:39, 21.36s/it]P:  0.9218307465730146
R:  0.8674840085287846
F:  0.8938320426209699

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.43s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.43s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.784929
GEO: 0.866492
=======entity level========

Epoch: 7, P: 0.922545, R: 0.881237, F: 0.901418, OOV: 0.784929, GEO: 0.866492
=======entity level========
Epoch:  14%|█▍        | 7/50 [02:29<15:11, 21.20s/it]P:  0.9225446428571429
R:  0.8812366737739872
F:  0.9014176663031624

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.787840
GEO: 0.874754
=======entity level========

Epoch: 8, P: 0.926402, R: 0.884328, F: 0.904876, OOV: 0.787840, GEO: 0.874754
=======entity level========
Epoch:  16%|█▌        | 8/50 [02:50<14:45, 21.09s/it]P:  0.92640160821979
R:  0.8843283582089553
F:  0.9048761863204975

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.49s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.49s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.20s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.781048
GEO: 0.884615
=======entity level========

Epoch: 9, P: 0.924520, R: 0.877505, F: 0.900399, OOV: 0.781048, GEO: 0.884615
=======entity level========
Epoch:  18%|█▊        | 9/50 [03:11<14:22, 21.04s/it]P:  0.9245198247781646
R:  0.8775053304904051
F:  0.9003992780178308

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.783959
GEO: 0.881266
=======entity level========

Epoch: 10, P: 0.928290, R: 0.880490, F: 0.903759, OOV: 0.783959, GEO: 0.881266
=======entity level========
Epoch:  20%|██        | 10/50 [03:31<13:58, 20.97s/it]P:  0.9282904349780825
R:  0.8804904051172708
F:  0.9037588225638781

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.39s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.786223
GEO: 0.882431
=======entity level========

Epoch: 11, P: 0.926187, R: 0.881557, F: 0.903321, OOV: 0.786223, GEO: 0.882431
=======entity level========
Epoch:  22%|██▏       | 11/50 [03:52<13:34, 20.88s/it]P:  0.9261872759856631
R:  0.8815565031982943
F:  0.9033209525890322

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.40s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.42s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.778784
GEO: 0.883444
=======entity level========

Epoch: 12, P: 0.925514, R: 0.878252, F: 0.901264, OOV: 0.778784, GEO: 0.883444
=======entity level========
Epoch:  24%|██▍       | 12/50 [04:13<13:11, 20.84s/it]P:  0.9255139871924503
R:  0.8782515991471216
F:  0.9012636070236858

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.38s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.22s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.778461
GEO: 0.883598
=======entity level========

Epoch: 13, P: 0.925506, R: 0.878145, F: 0.901204, OOV: 0.778461, GEO: 0.883598
=======entity level========
Epoch:  26%|██▌       | 13/50 [04:34<12:50, 20.83s/it]P:  0.9255056179775281
R:  0.8781449893390192
F:  0.9012035010940919

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.48s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.782665
GEO: 0.888594
=======entity level========

Epoch: 14, P: 0.924482, R: 0.879638, F: 0.901502, OOV: 0.782665, GEO: 0.888594
=======entity level========
Epoch:  28%|██▊       | 14/50 [04:54<12:30, 20.86s/it]P:  0.9244817927170869
R:  0.879637526652452
F:  0.9015023217700082

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.51s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.46s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.39s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.783959
GEO: 0.873850
=======entity level========

Epoch: 15, P: 0.925341, R: 0.881343, F: 0.902807, OOV: 0.783959, GEO: 0.873850
=======entity level========
Epoch:  30%|███       | 15/50 [05:15<12:09, 20.85s/it]P:  0.9253413924334005
R:  0.8813432835820896
F:  0.9028065960467402

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.53s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.777167
GEO: 0.892881
=======entity level========

Epoch: 16, P: 0.927628, R: 0.875906, F: 0.901025, OOV: 0.777167, GEO: 0.892881
=======entity level========
Epoch:  32%|███▏      | 16/50 [05:37<12:02, 21.25s/it]P:  0.9276278649655639
R:  0.8759061833688699
F:  0.9010253879475791

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.49s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.46s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.773286
GEO: 0.884309
=======entity level========

Epoch: 17, P: 0.925437, R: 0.874627, F: 0.899315, OOV: 0.773286, GEO: 0.884309
=======entity level========
Epoch:  34%|███▍      | 17/50 [05:58<11:37, 21.14s/it]P:  0.9254371122391427
R:  0.8746268656716418
F:  0.8993148807892573

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.40s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.38s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.780078
GEO: 0.885790
=======entity level========

Epoch: 18, P: 0.927301, R: 0.878465, F: 0.902223, OOV: 0.780078, GEO: 0.885790
=======entity level========
Epoch:  36%|███▌      | 18/50 [06:19<11:12, 21.02s/it]P:  0.9273013729462075
R:  0.8784648187633263
F:  0.9022227088579876

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.48s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.47s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.782342
GEO: 0.884615
=======entity level========

Epoch: 19, P: 0.926766, R: 0.879638, F: 0.902587, OOV: 0.782342, GEO: 0.884615
=======entity level========
Epoch:  38%|███▊      | 19/50 [06:40<10:50, 20.99s/it]P:  0.9267662585645288
R:  0.879637526652452
F:  0.9025871027730678

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.790103
GEO: 0.851756
=======entity level========

Epoch: 20, P: 0.924928, R: 0.885288, F: 0.904674, OOV: 0.790103, GEO: 0.851756
=======entity level========
Epoch:  40%|████      | 20/50 [07:01<10:28, 20.95s/it]P:  0.9249276008019603
R:  0.8852878464818763
F:  0.9046737117333044

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.34s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.34s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.47s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.20s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.786223
GEO: 0.883598
=======entity level========

Epoch: 21, P: 0.926611, R: 0.881663, F: 0.903578, OOV: 0.786223, GEO: 0.883598
=======entity level========
Epoch:  42%|████▏     | 21/50 [07:22<10:06, 20.91s/it]P:  0.9266106442577031
R:  0.8816631130063965
F:  0.9035782573067468

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.42s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.49s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.19s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.786546
GEO: 0.871795
=======entity level========

Epoch: 22, P: 0.924263, R: 0.882090, F: 0.902684, OOV: 0.786546, GEO: 0.871795
=======entity level========
Epoch:  44%|████▍     | 22/50 [07:43<09:45, 20.90s/it]P:  0.9242627345844504
R:  0.8820895522388059
F:  0.9026838315513857

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.38s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.783959
GEO: 0.884183
=======entity level========

Epoch: 23, P: 0.925938, R: 0.881023, F: 0.902923, OOV: 0.783959, GEO: 0.884183
=======entity level========
Epoch:  46%|████▌     | 23/50 [08:03<09:22, 20.85s/it]P:  0.92593837535014
R:  0.8810234541577825
F:  0.9029226987161977

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.42s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.37s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.770375
GEO: 0.880905
=======entity level========

Epoch: 24, P: 0.924390, R: 0.871962, F: 0.897411, OOV: 0.770375, GEO: 0.880905
=======entity level========
Epoch:  48%|████▊     | 24/50 [08:24<09:01, 20.82s/it]P:  0.9243896925858951
R:  0.8719616204690832
F:  0.8974105771340793

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.782665
GEO: 0.877726
=======entity level========

Epoch: 25, P: 0.924647, R: 0.879104, F: 0.901301, OOV: 0.782665, GEO: 0.877726
=======entity level========
Epoch:  50%|█████     | 25/50 [08:45<08:40, 20.81s/it]P:  0.9246467817896389
R:  0.8791044776119403
F:  0.9013006885998469

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.38s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.42s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.781371
GEO: 0.884768
=======entity level========

Epoch: 26, P: 0.925967, R: 0.880064, F: 0.902432, OOV: 0.781371, GEO: 0.884768
=======entity level========

Early stop triggered at epoch 25

Epoch:  50%|█████     | 25/50 [09:06<09:06, 21.85s/it]

=======best f entity level========

Epoch: 16, P: 0.927628, R: 0.875906, F: 0.901025, OOV: 0.777167, GEO: 0.892881, GEO_N: 0.848896


=======best f entity level========
P:  0.925967470555244
R:  0.8800639658848614
F:  0.9024323585679147
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:47,  1.28it/s]  3%|▎         | 2/62 [00:01<00:43,  1.38it/s]  5%|▍         | 3/62 [00:02<00:41,  1.42it/s]  6%|▋         | 4/62 [00:02<00:43,  1.32it/s]  8%|▊         | 5/62 [00:03<00:44,  1.29it/s] 10%|▉         | 6/62 [00:04<00:46,  1.21it/s] 11%|█▏        | 7/62 [00:05<00:40,  1.37it/s] 13%|█▎        | 8/62 [00:05<00:36,  1.48it/s] 15%|█▍        | 9/62 [00:06<00:38,  1.39it/s] 16%|█▌        | 10/62 [00:07<00:36,  1.42it/s] 18%|█▊        | 11/62 [00:08<00:40,  1.24it/s] 19%|█▉        | 12/62 [00:08<00:37,  1.32it/s] 21%|██        | 13/62 [00:09<00:38,  1.27it/s] 23%|██▎       | 14/62 [00:10<00:37,  1.29it/s] 24%|██▍       | 15/62 [00:11<00:34,  1.35it/s] 26%|██▌       | 16/62 [00:11<00:30,  1.52it/s] 27%|██▋       | 17/62 [00:12<00:27,  1.65it/s] 29%|██▉       | 18/62 [00:12<00:28,  1.56it/s] 31%|███       | 19/62 [00:13<00:33,  1.30it/s] 32%|███▏      | 20/62 [00:15<00:36,  1.15it/s] 34%|███▍      | 21/62 [00:16<00:42,  1.04s/it] 35%|███▌      | 22/62 [00:17<00:38,  1.03it/s] 37%|███▋      | 23/62 [00:17<00:32,  1.19it/s] 39%|███▊      | 24/62 [00:18<00:31,  1.20it/s] 40%|████      | 25/62 [00:20<00:38,  1.05s/it] 42%|████▏     | 26/62 [00:21<00:36,  1.00s/it] 44%|████▎     | 27/62 [00:21<00:32,  1.09it/s] 45%|████▌     | 28/62 [00:22<00:30,  1.11it/s] 47%|████▋     | 29/62 [00:23<00:29,  1.13it/s] 48%|████▊     | 30/62 [00:24<00:26,  1.20it/s] 50%|█████     | 31/62 [00:25<00:24,  1.24it/s] 52%|█████▏    | 32/62 [00:25<00:21,  1.37it/s] 53%|█████▎    | 33/62 [00:26<00:22,  1.32it/s] 55%|█████▍    | 34/62 [00:27<00:22,  1.25it/s] 56%|█████▋    | 35/62 [00:28<00:21,  1.28it/s] 58%|█████▊    | 36/62 [00:28<00:18,  1.41it/s] 60%|█████▉    | 37/62 [00:28<00:15,  1.64it/s] 61%|██████▏   | 38/62 [00:29<00:14,  1.62it/s] 63%|██████▎   | 39/62 [00:30<00:16,  1.40it/s] 65%|██████▍   | 40/62 [00:31<00:15,  1.39it/s] 66%|██████▌   | 41/62 [00:31<00:14,  1.42it/s] 68%|██████▊   | 42/62 [00:32<00:13,  1.44it/s] 69%|██████▉   | 43/62 [00:33<00:13,  1.41it/s] 71%|███████   | 44/62 [00:33<00:12,  1.49it/s] 73%|███████▎  | 45/62 [00:35<00:13,  1.23it/s] 74%|███████▍  | 46/62 [00:35<00:11,  1.34it/s] 76%|███████▌  | 47/62 [00:36<00:10,  1.46it/s] 77%|███████▋  | 48/62 [00:36<00:09,  1.46it/s] 79%|███████▉  | 49/62 [00:37<00:10,  1.23it/s] 81%|████████  | 50/62 [00:38<00:09,  1.27it/s] 82%|████████▏ | 51/62 [00:39<00:08,  1.24it/s] 84%|████████▍ | 52/62 [00:40<00:08,  1.23it/s] 85%|████████▌ | 53/62 [00:41<00:08,  1.04it/s] 87%|████████▋ | 54/62 [00:42<00:07,  1.13it/s] 89%|████████▊ | 55/62 [00:43<00:05,  1.22it/s] 90%|█████████ | 56/62 [00:43<00:04,  1.36it/s] 92%|█████████▏| 57/62 [00:44<00:03,  1.40it/s] 94%|█████████▎| 58/62 [00:44<00:02,  1.44it/s] 95%|█████████▌| 59/62 [00:45<00:02,  1.42it/s] 97%|█████████▋| 60/62 [00:46<00:01,  1.53it/s] 98%|█████████▊| 61/62 [00:47<00:00,  1.31it/s]100%|██████████| 62/62 [00:47<00:00,  1.34it/s]100%|██████████| 62/62 [00:47<00:00,  1.29it/s]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 2, 'av_threshold': 3, 'max_ngram_length': 5, 'model_name': 'self_bert_memory_softmax_score_0.7_0.817', 'use_memory': False, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of trainable parameters: 102273792
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.647154
GEO: 0.613208
=======entity level========

Epoch: 1, P: 0.816810, R: 0.779104, F: 0.797512, OOV: 0.647154, GEO: 0.613208
=======entity level========
Epoch:   2%|▏         | 1/50 [00:21<17:24, 21.32s/it]P:  0.8168101039454566
R:  0.7791044776119403
F:  0.797511867736127

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.38s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.37s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.48s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.769728
GEO: 0.862228
=======entity level========

Epoch: 2, P: 0.911669, R: 0.863753, F: 0.887064, OOV: 0.769728, GEO: 0.862228
=======entity level========
Epoch:   4%|▍         | 2/50 [00:42<17:06, 21.38s/it]P:  0.9116687296050411
R:  0.8637526652452026
F:  0.8870641046696228

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.43s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.40s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.763260
GEO: 0.875748
=======entity level========

Epoch: 3, P: 0.915887, R: 0.865991, F: 0.890241, OOV: 0.763260, GEO: 0.875748
=======entity level========
Epoch:   6%|▌         | 3/50 [01:04<16:45, 21.39s/it]P:  0.9158867967076333
R:  0.8659914712153518
F:  0.8902405611266372

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.51s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.14s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.777490
GEO: 0.871523
=======entity level========

Epoch: 4, P: 0.921522, R: 0.875053, F: 0.897687, OOV: 0.777490, GEO: 0.871523
=======entity level========
Epoch:   8%|▊         | 4/50 [01:24<16:11, 21.13s/it]P:  0.9215223981138431
R:  0.8750533049040512
F:  0.8976868813911522

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.777814
GEO: 0.878888
=======entity level========

Epoch: 5, P: 0.922270, R: 0.871535, F: 0.896185, OOV: 0.777814, GEO: 0.878888
=======entity level========
Epoch:  10%|█         | 5/50 [01:46<15:54, 21.21s/it]P:  0.9222698555956679
R:  0.8715351812366737
F:  0.8961850471387853

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.43s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.775550
GEO: 0.892738
=======entity level========

Epoch: 6, P: 0.923434, R: 0.870469, F: 0.896169, OOV: 0.775550, GEO: 0.892738
=======entity level========
Epoch:  12%|█▏        | 6/50 [02:08<15:44, 21.45s/it]P:  0.9234336123049084
R:  0.8704690831556503
F:  0.8961694654812864

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.43s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.784282
GEO: 0.872368
=======entity level========

Epoch: 7, P: 0.922896, R: 0.880490, F: 0.901195, OOV: 0.784282, GEO: 0.872368
=======entity level========
Epoch:  14%|█▍        | 7/50 [02:28<15:13, 21.25s/it]P:  0.9228964130070398
R:  0.8804904051172708
F:  0.9011948278684053

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.781371
GEO: 0.873850
=======entity level========

Epoch: 8, P: 0.923086, R: 0.878998, F: 0.900502, OOV: 0.781371, GEO: 0.873850
=======entity level========
Epoch:  16%|█▌        | 8/50 [02:49<14:46, 21.11s/it]P:  0.9230855351545006
R:  0.8789978678038379
F:  0.9005024027959807

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.49s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.48s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.20s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.778461
GEO: 0.879789
=======entity level========

Epoch: 9, P: 0.923414, R: 0.876652, F: 0.899426, OOV: 0.778461, GEO: 0.879789
=======entity level========
Epoch:  18%|█▊        | 9/50 [03:10<14:22, 21.05s/it]P:  0.9234138124649074
R:  0.8766524520255864
F:  0.899425758818704

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.784605
GEO: 0.875164
=======entity level========

Epoch: 10, P: 0.923438, R: 0.880810, F: 0.901621, OOV: 0.784605, GEO: 0.875164
=======entity level========
Epoch:  20%|██        | 10/50 [03:31<13:58, 20.96s/it]P:  0.923438023918632
R:  0.8808102345415778
F:  0.9016205598297593

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.39s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.38s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.784929
GEO: 0.871053
=======entity level========

Epoch: 11, P: 0.923438, R: 0.880810, F: 0.901621, OOV: 0.784929, GEO: 0.871053
=======entity level========
Epoch:  22%|██▏       | 11/50 [03:52<13:33, 20.86s/it]P:  0.923438023918632
R:  0.8808102345415778
F:  0.9016205598297593

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.40s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.779107
GEO: 0.879630
=======entity level========

Epoch: 12, P: 0.924310, R: 0.878785, F: 0.900973, OOV: 0.779107, GEO: 0.879630
=======entity level========
Epoch:  24%|██▍       | 12/50 [04:12<13:11, 20.82s/it]P:  0.9243103834940569
R:  0.8787846481876332
F:  0.90097278391081

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.38s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.22s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.780401
GEO: 0.880795
=======entity level========

Epoch: 13, P: 0.925056, R: 0.877719, F: 0.900766, OOV: 0.780401, GEO: 0.880795
=======entity level========
Epoch:  26%|██▌       | 13/50 [04:33<12:49, 20.81s/it]P:  0.9250561797752809
R:  0.8777185501066098
F:  0.9007658643326039

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:15,  2.50s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.47s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.782988
GEO: 0.866142
=======entity level========

Epoch: 14, P: 0.922338, R: 0.879957, F: 0.900649, OOV: 0.782988, GEO: 0.866142
=======entity level========
Epoch:  28%|██▊       | 14/50 [04:54<12:29, 20.83s/it]P:  0.9223376913621634
R:  0.8799573560767591
F:  0.9006492443668502

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.50s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.40s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.39s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.788163
GEO: 0.865359
=======entity level========

Epoch: 15, P: 0.925059, R: 0.884328, F: 0.904235, OOV: 0.788163, GEO: 0.865359
=======entity level========
Epoch:  30%|███       | 15/50 [05:15<12:08, 20.82s/it]P:  0.9250585480093677
R:  0.8843283582089553
F:  0.9042350247996949

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.782018
GEO: 0.871963
=======entity level========

Epoch: 16, P: 0.925258, R: 0.880277, F: 0.902207, OOV: 0.782018, GEO: 0.871963
=======entity level========

Early stop triggered at epoch 15

Epoch:  30%|███       | 15/50 [05:36<13:04, 22.42s/it]

=======best f entity level========

Epoch: 6, P: 0.923434, R: 0.870469, F: 0.896169, OOV: 0.775550, GEO: 0.892738, GEO_N: 0.845729


=======best f entity level========
P:  0.9252577319587629
R:  0.8802771855010662
F:  0.9022071678321679
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:48,  1.27it/s]  3%|▎         | 2/62 [00:01<00:43,  1.37it/s]  5%|▍         | 3/62 [00:02<00:41,  1.41it/s]  6%|▋         | 4/62 [00:02<00:44,  1.32it/s]  8%|▊         | 5/62 [00:03<00:44,  1.28it/s] 10%|▉         | 6/62 [00:04<00:46,  1.21it/s] 11%|█▏        | 7/62 [00:05<00:40,  1.36it/s] 13%|█▎        | 8/62 [00:05<00:36,  1.48it/s] 15%|█▍        | 9/62 [00:06<00:38,  1.39it/s] 16%|█▌        | 10/62 [00:07<00:36,  1.42it/s] 18%|█▊        | 11/62 [00:08<00:40,  1.24it/s] 19%|█▉        | 12/62 [00:09<00:38,  1.32it/s] 21%|██        | 13/62 [00:09<00:38,  1.26it/s] 23%|██▎       | 14/62 [00:10<00:37,  1.29it/s] 24%|██▍       | 15/62 [00:11<00:34,  1.35it/s] 26%|██▌       | 16/62 [00:11<00:30,  1.52it/s] 27%|██▋       | 17/62 [00:12<00:27,  1.65it/s] 29%|██▉       | 18/62 [00:12<00:28,  1.56it/s] 31%|███       | 19/62 [00:14<00:33,  1.30it/s] 32%|███▏      | 20/62 [00:15<00:36,  1.15it/s] 34%|███▍      | 21/62 [00:16<00:42,  1.04s/it] 35%|███▌      | 22/62 [00:17<00:38,  1.03it/s] 37%|███▋      | 23/62 [00:17<00:32,  1.18it/s] 39%|███▊      | 24/62 [00:18<00:31,  1.20it/s] 40%|████      | 25/62 [00:20<00:38,  1.05s/it] 42%|████▏     | 26/62 [00:21<00:36,  1.01s/it] 44%|████▎     | 27/62 [00:21<00:32,  1.09it/s] 45%|████▌     | 28/62 [00:22<00:30,  1.11it/s] 47%|████▋     | 29/62 [00:23<00:29,  1.13it/s] 48%|████▊     | 30/62 [00:24<00:26,  1.20it/s] 50%|█████     | 31/62 [00:25<00:24,  1.24it/s] 52%|█████▏    | 32/62 [00:25<00:21,  1.37it/s] 53%|█████▎    | 33/62 [00:26<00:22,  1.32it/s] 55%|█████▍    | 34/62 [00:27<00:22,  1.25it/s] 56%|█████▋    | 35/62 [00:28<00:21,  1.28it/s] 58%|█████▊    | 36/62 [00:28<00:18,  1.41it/s] 60%|█████▉    | 37/62 [00:28<00:15,  1.64it/s] 61%|██████▏   | 38/62 [00:29<00:14,  1.62it/s] 63%|██████▎   | 39/62 [00:30<00:16,  1.39it/s] 65%|██████▍   | 40/62 [00:31<00:15,  1.39it/s] 66%|██████▌   | 41/62 [00:31<00:14,  1.42it/s] 68%|██████▊   | 42/62 [00:32<00:13,  1.44it/s] 69%|██████▉   | 43/62 [00:33<00:13,  1.41it/s] 71%|███████   | 44/62 [00:33<00:12,  1.49it/s] 73%|███████▎  | 45/62 [00:35<00:13,  1.23it/s] 74%|███████▍  | 46/62 [00:35<00:11,  1.34it/s] 76%|███████▌  | 47/62 [00:36<00:10,  1.46it/s] 77%|███████▋  | 48/62 [00:36<00:09,  1.46it/s] 79%|███████▉  | 49/62 [00:38<00:10,  1.23it/s] 81%|████████  | 50/62 [00:38<00:09,  1.27it/s] 82%|████████▏ | 51/62 [00:39<00:08,  1.24it/s] 84%|████████▍ | 52/62 [00:40<00:08,  1.23it/s] 85%|████████▌ | 53/62 [00:41<00:08,  1.04it/s] 87%|████████▋ | 54/62 [00:42<00:07,  1.13it/s] 89%|████████▊ | 55/62 [00:43<00:05,  1.21it/s] 90%|█████████ | 56/62 [00:43<00:04,  1.36it/s] 92%|█████████▏| 57/62 [00:44<00:03,  1.40it/s] 94%|█████████▎| 58/62 [00:45<00:02,  1.43it/s] 95%|█████████▌| 59/62 [00:45<00:02,  1.42it/s] 97%|█████████▋| 60/62 [00:46<00:01,  1.53it/s] 98%|█████████▊| 61/62 [00:47<00:00,  1.31it/s]100%|██████████| 62/62 [00:47<00:00,  1.34it/s]100%|██████████| 62/62 [00:47<00:00,  1.29it/s]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 2, 'av_threshold': 3, 'max_ngram_length': 5, 'model_name': 'self_bert_memory_softmax_score_0.7_0.818', 'use_memory': False, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of trainable parameters: 102273792
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.642626
GEO: 0.621958
=======entity level========

Epoch: 1, P: 0.816235, R: 0.776119, F: 0.795672, OOV: 0.642626, GEO: 0.621958
=======entity level========
Epoch:   2%|▏         | 1/50 [00:21<17:25, 21.33s/it]P:  0.8162350039242068
R:  0.7761194029850746
F:  0.7956718946390513

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.768435
GEO: 0.860910
=======entity level========

Epoch: 2, P: 0.912759, R: 0.863326, F: 0.887355, OOV: 0.768435, GEO: 0.860910
=======entity level========
Epoch:   4%|▍         | 2/50 [00:42<17:09, 21.44s/it]P:  0.9127592425608656
R:  0.8633262260127932
F:  0.8873548104317335

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.43s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.40s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.764554
GEO: 0.874834
=======entity level========

Epoch: 3, P: 0.918074, R: 0.863753, F: 0.890085, OOV: 0.764554, GEO: 0.874834
=======entity level========
Epoch:   6%|▌         | 3/50 [01:04<16:47, 21.43s/it]P:  0.9180736543909348
R:  0.8637526652452026
F:  0.890085141444658

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.52s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.14s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.776197
GEO: 0.882392
=======entity level========

Epoch: 4, P: 0.920887, R: 0.872388, F: 0.895982, OOV: 0.776197, GEO: 0.882392
=======entity level========
Epoch:   8%|▊         | 4/50 [01:25<16:25, 21.42s/it]P:  0.920886788206167
R:  0.8723880597014926
F:  0.8959816051680719

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.774256
GEO: 0.876494
=======entity level========

Epoch: 5, P: 0.921166, R: 0.869510, F: 0.894593, OOV: 0.774256, GEO: 0.876494
=======entity level========
Epoch:  10%|█         | 5/50 [01:46<15:52, 21.17s/it]P:  0.9211655748814095
R:  0.8695095948827292
F:  0.8945925194691237

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.43s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.766494
GEO: 0.881063
=======entity level========

Epoch: 6, P: 0.919683, R: 0.866738, F: 0.892426, OOV: 0.766494, GEO: 0.881063
=======entity level========
Epoch:  12%|█▏        | 6/50 [02:07<15:26, 21.06s/it]P:  0.919683257918552
R:  0.8667377398720683
F:  0.8924259055982438

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.42s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.779107
GEO: 0.876984
=======entity level========

Epoch: 7, P: 0.922930, R: 0.875800, F: 0.898747, OOV: 0.779107, GEO: 0.876984
=======entity level========
Epoch:  14%|█▍        | 7/50 [02:28<15:02, 20.99s/it]P:  0.9229300078642849
R:  0.8757995735607675
F:  0.8987473332968656

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.784282
GEO: 0.870079
=======entity level========

Epoch: 8, P: 0.923912, R: 0.880277, F: 0.901567, OOV: 0.784282, GEO: 0.870079
=======entity level========
Epoch:  16%|█▌        | 8/50 [02:48<14:39, 20.94s/it]P:  0.92391182723509
R:  0.8802771855010662
F:  0.9015668504667795

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.49s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.48s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.20s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.777490
GEO: 0.875497
=======entity level========

Epoch: 9, P: 0.923198, R: 0.875267, F: 0.898594, OOV: 0.777490, GEO: 0.875497
=======entity level========
Epoch:  18%|█▊        | 9/50 [03:09<14:18, 20.93s/it]P:  0.9231980209153267
R:  0.8752665245202559
F:  0.8985935533300498

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.780401
GEO: 0.884615
=======entity level========

Epoch: 10, P: 0.923951, R: 0.875586, F: 0.899119, OOV: 0.780401, GEO: 0.884615
=======entity level========
Epoch:  20%|██        | 10/50 [03:31<14:03, 21.09s/it]P:  0.9239509506131174
R:  0.8755863539445629
F:  0.8991187257102194

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.39s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.39s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.793014
GEO: 0.879947
=======entity level========

Epoch: 11, P: 0.926484, R: 0.885394, F: 0.905473, OOV: 0.793014, GEO: 0.879947
=======entity level========
Epoch:  22%|██▏       | 11/50 [03:51<13:37, 20.96s/it]P:  0.926483712628291
R:  0.8853944562899787
F:  0.9054731792411689

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.40s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.778137
GEO: 0.876077
=======entity level========

Epoch: 12, P: 0.926035, R: 0.875586, F: 0.900104, OOV: 0.778137, GEO: 0.876077
=======entity level========
Epoch:  24%|██▍       | 12/50 [04:12<13:13, 20.88s/it]P:  0.9260345021986696
R:  0.8755863539445629
F:  0.9001041152939887

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.38s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.22s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.780724
GEO: 0.881806
=======entity level========

Epoch: 13, P: 0.925152, R: 0.877612, F: 0.900755, OOV: 0.780724, GEO: 0.881806
=======entity level========
Epoch:  26%|██▌       | 13/50 [04:33<12:51, 20.86s/it]P:  0.9251517194875253
R:  0.8776119402985074
F:  0.9007550060181639

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.37s/it][A
 25%|██▌       | 2/8 [00:04<00:15,  2.50s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.47s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.790750
GEO: 0.884336
=======entity level========

Epoch: 14, P: 0.926025, R: 0.883475, F: 0.904250, OOV: 0.790750, GEO: 0.884336
=======entity level========
Epoch:  28%|██▊       | 14/50 [04:54<12:31, 20.87s/it]P:  0.9260252542183485
R:  0.8834754797441364
F:  0.9042500954771128

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.50s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.46s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.43s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.39s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.782342
GEO: 0.881806
=======entity level========

Epoch: 15, P: 0.927021, R: 0.878891, F: 0.902315, OOV: 0.782342, GEO: 0.881806
=======entity level========
Epoch:  30%|███       | 15/50 [05:15<12:09, 20.85s/it]P:  0.9270212526706398
R:  0.8788912579957356
F:  0.9023148908225249

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.778784
GEO: 0.884309
=======entity level========

Epoch: 16, P: 0.926502, R: 0.876226, F: 0.900663, OOV: 0.778784, GEO: 0.884309
=======entity level========
Epoch:  32%|███▏      | 16/50 [05:36<11:49, 20.88s/it]P:  0.926502085446962
R:  0.876226012793177
F:  0.9006629773711029

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.48s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.46s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.775873
GEO: 0.875497
=======entity level========

Epoch: 17, P: 0.925446, R: 0.874733, F: 0.899375, OOV: 0.775873, GEO: 0.875497
=======entity level========
Epoch:  34%|███▍      | 17/50 [05:56<11:28, 20.87s/it]P:  0.9254455222197158
R:  0.8747334754797441
F:  0.8993752055244986

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.40s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.38s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.781048
GEO: 0.882548
=======entity level========

Epoch: 18, P: 0.926067, R: 0.878678, F: 0.901751, OOV: 0.781048, GEO: 0.882548
=======entity level========
Epoch:  36%|███▌      | 18/50 [06:17<11:06, 20.82s/it]P:  0.9260674157303371
R:  0.878678038379531
F:  0.901750547045952

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.35s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.47s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.46s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.787840
GEO: 0.883014
=======entity level========

Epoch: 19, P: 0.924701, R: 0.882409, F: 0.903060, OOV: 0.787840, GEO: 0.883014
=======entity level========
Epoch:  38%|███▊      | 19/50 [06:38<10:46, 20.85s/it]P:  0.9247011507094179
R:  0.882409381663113
F:  0.9030603895041187

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.782342
GEO: 0.883444
=======entity level========

Epoch: 20, P: 0.926076, R: 0.878785, F: 0.901811, OOV: 0.782342, GEO: 0.883444
=======entity level========

Early stop triggered at epoch 19

Epoch:  38%|███▊      | 19/50 [06:59<11:24, 22.07s/it]

=======best f entity level========

Epoch: 10, P: 0.923951, R: 0.875586, F: 0.899119, OOV: 0.780401, GEO: 0.884615, GEO_N: 0.846404


=======best f entity level========
P:  0.926075721829008
R:  0.8787846481876332
F:  0.9018106230512554
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:47,  1.28it/s]  3%|▎         | 2/62 [00:01<00:43,  1.37it/s]  5%|▍         | 3/62 [00:02<00:41,  1.42it/s]  6%|▋         | 4/62 [00:02<00:43,  1.32it/s]  8%|▊         | 5/62 [00:03<00:44,  1.29it/s] 10%|▉         | 6/62 [00:04<00:46,  1.21it/s] 11%|█▏        | 7/62 [00:05<00:40,  1.36it/s] 13%|█▎        | 8/62 [00:05<00:36,  1.48it/s] 15%|█▍        | 9/62 [00:06<00:38,  1.39it/s] 16%|█▌        | 10/62 [00:07<00:36,  1.42it/s] 18%|█▊        | 11/62 [00:08<00:41,  1.24it/s] 19%|█▉        | 12/62 [00:08<00:38,  1.32it/s] 21%|██        | 13/62 [00:09<00:38,  1.26it/s] 23%|██▎       | 14/62 [00:10<00:37,  1.29it/s] 24%|██▍       | 15/62 [00:11<00:34,  1.35it/s] 26%|██▌       | 16/62 [00:11<00:30,  1.52it/s] 27%|██▋       | 17/62 [00:12<00:27,  1.65it/s] 29%|██▉       | 18/62 [00:12<00:28,  1.56it/s] 31%|███       | 19/62 [00:14<00:33,  1.30it/s] 32%|███▏      | 20/62 [00:15<00:36,  1.15it/s] 34%|███▍      | 21/62 [00:16<00:42,  1.04s/it] 35%|███▌      | 22/62 [00:17<00:38,  1.03it/s] 37%|███▋      | 23/62 [00:17<00:32,  1.18it/s] 39%|███▊      | 24/62 [00:18<00:31,  1.20it/s] 40%|████      | 25/62 [00:20<00:38,  1.05s/it] 42%|████▏     | 26/62 [00:21<00:36,  1.01s/it] 44%|████▎     | 27/62 [00:21<00:32,  1.09it/s] 45%|████▌     | 28/62 [00:22<00:30,  1.10it/s] 47%|████▋     | 29/62 [00:23<00:29,  1.12it/s] 48%|████▊     | 30/62 [00:24<00:26,  1.19it/s] 50%|█████     | 31/62 [00:25<00:25,  1.24it/s] 52%|█████▏    | 32/62 [00:25<00:21,  1.37it/s] 53%|█████▎    | 33/62 [00:26<00:22,  1.32it/s] 55%|█████▍    | 34/62 [00:27<00:22,  1.24it/s] 56%|█████▋    | 35/62 [00:28<00:21,  1.28it/s] 58%|█████▊    | 36/62 [00:28<00:18,  1.41it/s] 60%|█████▉    | 37/62 [00:28<00:15,  1.64it/s] 61%|██████▏   | 38/62 [00:29<00:14,  1.61it/s] 63%|██████▎   | 39/62 [00:30<00:16,  1.39it/s] 65%|██████▍   | 40/62 [00:31<00:15,  1.39it/s] 66%|██████▌   | 41/62 [00:31<00:14,  1.42it/s] 68%|██████▊   | 42/62 [00:32<00:13,  1.43it/s] 69%|██████▉   | 43/62 [00:33<00:13,  1.40it/s] 71%|███████   | 44/62 [00:33<00:12,  1.49it/s] 73%|███████▎  | 45/62 [00:35<00:13,  1.23it/s] 74%|███████▍  | 46/62 [00:35<00:11,  1.34it/s] 76%|███████▌  | 47/62 [00:36<00:10,  1.46it/s] 77%|███████▋  | 48/62 [00:36<00:09,  1.46it/s] 79%|███████▉  | 49/62 [00:38<00:10,  1.23it/s] 81%|████████  | 50/62 [00:38<00:09,  1.26it/s] 82%|████████▏ | 51/62 [00:39<00:08,  1.24it/s] 84%|████████▍ | 52/62 [00:40<00:08,  1.22it/s] 85%|████████▌ | 53/62 [00:41<00:08,  1.04it/s] 87%|████████▋ | 54/62 [00:42<00:07,  1.13it/s] 89%|████████▊ | 55/62 [00:43<00:05,  1.21it/s] 90%|█████████ | 56/62 [00:43<00:04,  1.36it/s] 92%|█████████▏| 57/62 [00:44<00:03,  1.40it/s] 94%|█████████▎| 58/62 [00:45<00:02,  1.43it/s] 95%|█████████▌| 59/62 [00:45<00:02,  1.42it/s] 97%|█████████▋| 60/62 [00:46<00:01,  1.53it/s] 98%|█████████▊| 61/62 [00:47<00:00,  1.31it/s]100%|██████████| 62/62 [00:48<00:00,  1.33it/s]100%|██████████| 62/62 [00:48<00:00,  1.29it/s]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 2, 'av_threshold': 3, 'max_ngram_length': 5, 'model_name': 'self_bert_memory_softmax_score_0.7_0.819', 'use_memory': False, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of trainable parameters: 102273792
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.45s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.649094
GEO: 0.606702
=======entity level========

Epoch: 1, P: 0.816875, R: 0.781343, F: 0.798714, OOV: 0.649094, GEO: 0.606702
=======entity level========
Epoch:   2%|▏         | 1/50 [00:21<17:24, 21.31s/it]P:  0.8168747213553277
R:  0.7813432835820896
F:  0.7987140366172624

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.38s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.37s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.770052
GEO: 0.865435
=======entity level========

Epoch: 2, P: 0.912593, R: 0.863753, F: 0.887501, OOV: 0.770052, GEO: 0.865435
=======entity level========
Epoch:   4%|▍         | 2/50 [00:42<17:08, 21.43s/it]P:  0.9125929263347601
R:  0.8637526652452026
F:  0.8875013692627889

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.43s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.40s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.763583
GEO: 0.866844
=======entity level========

Epoch: 3, P: 0.917516, R: 0.863326, F: 0.889597, OOV: 0.763583, GEO: 0.866844
=======entity level========
Epoch:   6%|▌         | 3/50 [01:04<16:46, 21.41s/it]P:  0.917516428733288
R:  0.8633262260127932
F:  0.8895968362078436

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.51s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.42s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.14s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.771345
GEO: 0.872510
=======entity level========

Epoch: 4, P: 0.921100, R: 0.871215, F: 0.895464, OOV: 0.771345, GEO: 0.872510
=======entity level========
Epoch:   8%|▊         | 4/50 [01:25<16:23, 21.38s/it]P:  0.9211000901713255
R:  0.8712153518123668
F:  0.8954635108481263

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.774256
GEO: 0.874917
=======entity level========

Epoch: 5, P: 0.919464, R: 0.870256, F: 0.894183, OOV: 0.774256, GEO: 0.874917
=======entity level========
Epoch:  10%|█         | 5/50 [01:46<16:01, 21.37s/it]P:  0.9194638432079297
R:  0.8702558635394456
F:  0.8941833716726914

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.43s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.770052
GEO: 0.891406
=======entity level========

Epoch: 6, P: 0.919647, R: 0.866311, F: 0.892183, OOV: 0.770052, GEO: 0.891406
=======entity level========
Epoch:  12%|█▏        | 6/50 [02:08<15:41, 21.40s/it]P:  0.9196468990493436
R:  0.8663113006396589
F:  0.8921826965305226

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.42s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.43s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.782342
GEO: 0.864084
=======entity level========

Epoch: 7, P: 0.921847, R: 0.878998, F: 0.899913, OOV: 0.782342, GEO: 0.864084
=======entity level========
Epoch:  14%|█▍        | 7/50 [02:29<15:11, 21.21s/it]P:  0.9218470483005367
R:  0.8789978678038379
F:  0.8999126828203448

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.779431
GEO: 0.879630
=======entity level========

Epoch: 8, P: 0.924806, R: 0.877186, F: 0.900367, OOV: 0.779431, GEO: 0.879630
=======entity level========
Epoch:  16%|█▌        | 8/50 [02:49<14:45, 21.08s/it]P:  0.9248061144205912
R:  0.877185501066098
F:  0.9003665809487335

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.49s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.48s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.20s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.777814
GEO: 0.877402
=======entity level========

Epoch: 9, P: 0.922316, R: 0.874627, F: 0.897839, OOV: 0.777814, GEO: 0.877402
=======entity level========
Epoch:  18%|█▊        | 9/50 [03:10<14:21, 21.02s/it]P:  0.9223159078133784
R:  0.8746268656716418
F:  0.8978385772913817

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.779107
GEO: 0.873184
=======entity level========

Epoch: 10, P: 0.923544, R: 0.875693, F: 0.898982, OOV: 0.779107, GEO: 0.873184
=======entity level========
Epoch:  20%|██        | 10/50 [03:31<13:57, 20.94s/it]P:  0.9235439622217225
R:  0.8756929637526653
F:  0.898982160446536

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.39s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.38s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.787516
GEO: 0.869967
=======entity level========

Epoch: 11, P: 0.924280, R: 0.882303, F: 0.902804, OOV: 0.787516, GEO: 0.869967
=======entity level========
Epoch:  22%|██▏       | 11/50 [03:52<13:32, 20.84s/it]P:  0.9242796515523788
R:  0.8823027718550107
F:  0.9028035344169303

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.783959
GEO: 0.877984
=======entity level========

Epoch: 12, P: 0.924414, R: 0.878785, F: 0.901022, OOV: 0.783959, GEO: 0.877984
=======entity level========
Epoch:  24%|██▍       | 12/50 [04:12<13:10, 20.80s/it]P:  0.9244140405966133
R:  0.8787846481876332
F:  0.901022025468656

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.38s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.22s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.784282
GEO: 0.878049
=======entity level========

Epoch: 13, P: 0.924188, R: 0.879851, F: 0.901475, OOV: 0.784282, GEO: 0.878049
=======entity level========
Epoch:  26%|██▌       | 13/50 [04:33<12:49, 20.79s/it]P:  0.9241881298992162
R:  0.8798507462686567
F:  0.9014746040415075

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:15,  2.50s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.47s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.779754
GEO: 0.879894
=======entity level========

Epoch: 14, P: 0.921619, R: 0.876226, F: 0.898350, OOV: 0.779754, GEO: 0.879894
=======entity level========
Epoch:  28%|██▊       | 14/50 [04:54<12:29, 20.81s/it]P:  0.9216191971294012
R:  0.876226012793177
F:  0.8983495463985136

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.50s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.40s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.39s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.782342
GEO: 0.869393
=======entity level========

Epoch: 15, P: 0.925216, R: 0.879744, F: 0.901907, OOV: 0.782342, GEO: 0.869393
=======entity level========
Epoch:  30%|███       | 15/50 [05:15<12:07, 20.80s/it]P:  0.92521583137123
R:  0.8797441364605544
F:  0.9019072080441555

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.777490
GEO: 0.871693
=======entity level========

Epoch: 16, P: 0.925205, R: 0.876972, F: 0.900443, OOV: 0.777490, GEO: 0.871693
=======entity level========

Early stop triggered at epoch 15

Epoch:  30%|███       | 15/50 [05:36<13:04, 22.42s/it]

=======best f entity level========

Epoch: 6, P: 0.919647, R: 0.866311, F: 0.892183, OOV: 0.770052, GEO: 0.891406, GEO_N: 0.845729


=======best f entity level========
P:  0.9252052637498595
R:  0.8769722814498934
F:  0.900443325488479
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:47,  1.28it/s]  3%|▎         | 2/62 [00:01<00:43,  1.38it/s]  5%|▍         | 3/62 [00:02<00:41,  1.42it/s]  6%|▋         | 4/62 [00:02<00:43,  1.32it/s]  8%|▊         | 5/62 [00:03<00:44,  1.29it/s] 10%|▉         | 6/62 [00:04<00:46,  1.21it/s] 11%|█▏        | 7/62 [00:05<00:40,  1.37it/s] 13%|█▎        | 8/62 [00:05<00:36,  1.48it/s] 15%|█▍        | 9/62 [00:06<00:38,  1.39it/s] 16%|█▌        | 10/62 [00:07<00:36,  1.42it/s] 18%|█▊        | 11/62 [00:08<00:40,  1.24it/s] 19%|█▉        | 12/62 [00:08<00:37,  1.32it/s] 21%|██        | 13/62 [00:09<00:38,  1.26it/s] 23%|██▎       | 14/62 [00:10<00:37,  1.29it/s] 24%|██▍       | 15/62 [00:11<00:34,  1.35it/s] 26%|██▌       | 16/62 [00:11<00:30,  1.52it/s] 27%|██▋       | 17/62 [00:12<00:27,  1.65it/s] 29%|██▉       | 18/62 [00:12<00:28,  1.56it/s] 31%|███       | 19/62 [00:13<00:33,  1.30it/s] 32%|███▏      | 20/62 [00:15<00:36,  1.15it/s] 34%|███▍      | 21/62 [00:16<00:42,  1.04s/it] 35%|███▌      | 22/62 [00:17<00:38,  1.03it/s] 37%|███▋      | 23/62 [00:17<00:32,  1.18it/s] 39%|███▊      | 24/62 [00:18<00:31,  1.20it/s] 40%|████      | 25/62 [00:20<00:38,  1.05s/it] 42%|████▏     | 26/62 [00:21<00:36,  1.00s/it] 44%|████▎     | 27/62 [00:21<00:32,  1.09it/s] 45%|████▌     | 28/62 [00:22<00:30,  1.11it/s] 47%|████▋     | 29/62 [00:23<00:29,  1.13it/s] 48%|████▊     | 30/62 [00:24<00:26,  1.20it/s] 50%|█████     | 31/62 [00:25<00:25,  1.24it/s] 52%|█████▏    | 32/62 [00:25<00:21,  1.37it/s] 53%|█████▎    | 33/62 [00:26<00:22,  1.32it/s] 55%|█████▍    | 34/62 [00:27<00:22,  1.24it/s] 56%|█████▋    | 35/62 [00:28<00:21,  1.28it/s] 58%|█████▊    | 36/62 [00:28<00:18,  1.41it/s] 60%|█████▉    | 37/62 [00:28<00:15,  1.64it/s] 61%|██████▏   | 38/62 [00:29<00:14,  1.62it/s] 63%|██████▎   | 39/62 [00:30<00:16,  1.39it/s] 65%|██████▍   | 40/62 [00:31<00:15,  1.39it/s] 66%|██████▌   | 41/62 [00:31<00:14,  1.42it/s] 68%|██████▊   | 42/62 [00:32<00:13,  1.44it/s] 69%|██████▉   | 43/62 [00:33<00:13,  1.41it/s] 71%|███████   | 44/62 [00:33<00:12,  1.49it/s] 73%|███████▎  | 45/62 [00:35<00:13,  1.23it/s] 74%|███████▍  | 46/62 [00:35<00:11,  1.34it/s] 76%|███████▌  | 47/62 [00:36<00:10,  1.46it/s] 77%|███████▋  | 48/62 [00:36<00:09,  1.46it/s] 79%|███████▉  | 49/62 [00:38<00:10,  1.23it/s] 81%|████████  | 50/62 [00:38<00:09,  1.27it/s] 82%|████████▏ | 51/62 [00:39<00:08,  1.24it/s] 84%|████████▍ | 52/62 [00:40<00:08,  1.23it/s] 85%|████████▌ | 53/62 [00:41<00:08,  1.04it/s] 87%|████████▋ | 54/62 [00:42<00:07,  1.13it/s] 89%|████████▊ | 55/62 [00:43<00:05,  1.21it/s] 90%|█████████ | 56/62 [00:43<00:04,  1.36it/s] 92%|█████████▏| 57/62 [00:44<00:03,  1.40it/s] 94%|█████████▎| 58/62 [00:44<00:02,  1.43it/s] 95%|█████████▌| 59/62 [00:45<00:02,  1.42it/s] 97%|█████████▋| 60/62 [00:46<00:01,  1.53it/s] 98%|█████████▊| 61/62 [00:47<00:00,  1.31it/s]100%|██████████| 62/62 [00:47<00:00,  1.34it/s]100%|██████████| 62/62 [00:47<00:00,  1.29it/s]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 2, 'av_threshold': 3, 'max_ngram_length': 5, 'model_name': 'self_bert_memory_softmax_score_0.7_0.820', 'use_memory': False, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of trainable parameters: 102273792
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.46s/it][A
 25%|██▌       | 2/8 [00:04<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.49s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.642626
GEO: 0.613932
=======entity level========

Epoch: 1, P: 0.815595, R: 0.776119, F: 0.795368, OOV: 0.642626, GEO: 0.613932
=======entity level========
Epoch:   2%|▏         | 1/50 [00:21<17:24, 21.31s/it]P:  0.8155948913287027
R:  0.7761194029850746
F:  0.795367639025456

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.38s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.37s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.47s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.46s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.769405
GEO: 0.853770
=======entity level========

Epoch: 2, P: 0.911626, R: 0.864392, F: 0.887381, OOV: 0.769405, GEO: 0.853770
=======entity level========
Epoch:   4%|▍         | 2/50 [00:42<17:08, 21.43s/it]P:  0.9116258151562852
R:  0.8643923240938166
F:  0.8873809784393126

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.43s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.44s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.39s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.763583
GEO: 0.875582
=======entity level========

Epoch: 3, P: 0.917442, R: 0.862473, F: 0.889109, OOV: 0.763583, GEO: 0.875582
=======entity level========
Epoch:   6%|▌         | 3/50 [01:04<16:46, 21.42s/it]P:  0.9174415967339533
R:  0.8624733475479744
F:  0.889108693262996

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.51s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.44s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.14s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.775873
GEO: 0.882392
=======entity level========

Epoch: 4, P: 0.919680, R: 0.870362, F: 0.894342, OOV: 0.775873, GEO: 0.882392
=======entity level========
Epoch:   8%|▊         | 4/50 [01:25<16:25, 21.43s/it]P:  0.919680072096429
R:  0.870362473347548
F:  0.8943418962589692

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.39s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.38s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.770052
GEO: 0.882236
=======entity level========

Epoch: 5, P: 0.918723, R: 0.865245, F: 0.891183, OOV: 0.770052, GEO: 0.882236
=======entity level========
Epoch:  10%|█         | 5/50 [01:46<15:52, 21.17s/it]P:  0.9187231152365859
R:  0.8652452025586354
F:  0.8911826067859887

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.45s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.43s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.47s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.16s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.772962
GEO: 0.886530
=======entity level========

Epoch: 6, P: 0.921151, R: 0.870576, F: 0.895149, OOV: 0.772962, GEO: 0.886530
=======entity level========
Epoch:  12%|█▏        | 6/50 [02:07<15:35, 21.27s/it]P:  0.921150592216582
R:  0.8705756929637527
F:  0.8951493559879419

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.42s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.783959
GEO: 0.878468
=======entity level========

Epoch: 7, P: 0.923120, R: 0.878145, F: 0.900071, OOV: 0.783959, GEO: 0.878468
=======entity level========
Epoch:  14%|█▍        | 7/50 [02:28<15:08, 21.12s/it]P:  0.9231200268967836
R:  0.8781449893390192
F:  0.9000710266076599

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.51s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.781048
GEO: 0.874670
=======entity level========

Epoch: 8, P: 0.921593, R: 0.875906, F: 0.898169, OOV: 0.781048, GEO: 0.874670
=======entity level========
Epoch:  16%|█▌        | 8/50 [02:49<14:42, 21.02s/it]P:  0.9215928210880538
R:  0.8759061833688699
F:  0.8981688986061765

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.38s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.40s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.49s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.48s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.20s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.774256
GEO: 0.876330
=======entity level========

Epoch: 9, P: 0.923042, R: 0.872068, F: 0.896831, OOV: 0.774256, GEO: 0.876330
=======entity level========
Epoch:  18%|█▊        | 9/50 [03:10<14:20, 20.98s/it]P:  0.9230422026630557
R:  0.8720682302771855
F:  0.8968314877754633

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.41s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.41s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.44s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.32s/it]
OOV: 0.778461
GEO: 0.867502
=======entity level========

Epoch: 10, P: 0.925361, R: 0.873667, F: 0.898772, OOV: 0.778461, GEO: 0.867502
=======entity level========
Epoch:  20%|██        | 10/50 [03:31<13:56, 20.91s/it]P:  0.9253613369467028
R:  0.8736673773987207
F:  0.8987716604518534

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.44s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.44s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.41s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.39s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.38s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.787840
GEO: 0.877984
=======entity level========

Epoch: 11, P: 0.923998, R: 0.880064, F: 0.901496, OOV: 0.787840, GEO: 0.877984
=======entity level========
Epoch:  22%|██▏       | 11/50 [03:51<13:32, 20.83s/it]P:  0.923998209088874
R:  0.8800639658848614
F:  0.901496123184449

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.39s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.41s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.39s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.45s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.43s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.43s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.15s/it][A100%|██████████| 8/8 [00:18<00:00,  2.31s/it]
OOV: 0.785576
GEO: 0.879894
=======entity level========

Epoch: 12, P: 0.924000, R: 0.878785, F: 0.900825, OOV: 0.785576, GEO: 0.879894
=======entity level========
Epoch:  24%|██▍       | 12/50 [04:12<13:09, 20.78s/it]P:  0.9239995516197735
R:  0.8787846481876332
F:  0.9008250915250533

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.41s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.40s/it][A
 38%|███▊      | 3/8 [00:07<00:11,  2.37s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.37s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.40s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.41s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.22s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.781048
GEO: 0.875661
=======entity level========

Epoch: 13, P: 0.924011, R: 0.876333, F: 0.899540, OOV: 0.781048, GEO: 0.875661
=======entity level========
Epoch:  26%|██▌       | 13/50 [04:33<12:48, 20.78s/it]P:  0.9240107913669064
R:  0.8763326226012793
F:  0.8995403808273146

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:16,  2.36s/it][A
 25%|██▌       | 2/8 [00:04<00:15,  2.50s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.47s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.45s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.44s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.41s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.34s/it]
OOV: 0.788486
GEO: 0.885355
=======entity level========

Epoch: 14, P: 0.922501, R: 0.880704, F: 0.901118, OOV: 0.788486, GEO: 0.885355
=======entity level========
Epoch:  28%|██▊       | 14/50 [04:54<12:28, 20.81s/it]P:  0.92250139586823
R:  0.8807036247334755
F:  0.9011180801745297

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.50s/it][A
 25%|██▌       | 2/8 [00:04<00:14,  2.45s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.45s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.42s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.42s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.40s/it][A
 88%|████████▊ | 7/8 [00:16<00:02,  2.39s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.18s/it][A100%|██████████| 8/8 [00:18<00:00,  2.33s/it]
OOV: 0.784929
GEO: 0.886093
=======entity level========

Epoch: 15, P: 0.924319, R: 0.878891, F: 0.901033, OOV: 0.784929, GEO: 0.886093
=======entity level========
Epoch:  30%|███       | 15/50 [05:14<12:07, 20.80s/it]P:  0.9243188698284561
R:  0.8788912579957356
F:  0.901032843324772

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:02<00:17,  2.44s/it][A
 25%|██▌       | 2/8 [00:05<00:15,  2.52s/it][A
 38%|███▊      | 3/8 [00:07<00:12,  2.48s/it][A
 50%|█████     | 4/8 [00:09<00:09,  2.46s/it][A
 62%|██████▎   | 5/8 [00:12<00:07,  2.46s/it][A
 75%|███████▌  | 6/8 [00:14<00:04,  2.45s/it][A
 88%|████████▊ | 7/8 [00:17<00:02,  2.42s/it][A
100%|██████████| 8/8 [00:18<00:00,  2.17s/it][A100%|██████████| 8/8 [00:18<00:00,  2.35s/it]
OOV: 0.782988
GEO: 0.886379
=======entity level========

Epoch: 16, P: 0.925301, R: 0.876866, F: 0.900432, OOV: 0.782988, GEO: 0.886379
=======entity level========

Early stop triggered at epoch 15

Epoch:  30%|███       | 15/50 [05:35<13:03, 22.39s/it]

=======best f entity level========

Epoch: 6, P: 0.921151, R: 0.870576, F: 0.895149, OOV: 0.772962, GEO: 0.886530, GEO_N: 0.843609


=======best f entity level========
P:  0.9253009337383282
R:  0.8768656716417911
F:  0.9004324265148612
