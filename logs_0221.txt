{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': None, 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.5, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'bert_wm_av_3_score_0_0.8', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 4056
# of trainable parameters: 105396480
***** Running training *****
  Num examples = 120
  Batch size = 16
  Num steps = 350
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  1.91it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.95it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.12it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.37it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.46it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.29it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.29it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.68it/s][A100%|██████████| 8/8 [00:03<00:00,  2.39it/s]
OOV: 0.008409
GEO: 0.000000
=======entity level========

Epoch: 1, P: 0.256272, R: 0.137207, F: 0.178725, OOV: 0.008409, GEO: 0.000000
=======entity level========
/opt/DevEnvs/anaconda3/envs/WM/lib/python3.6/site-packages/seqeval/metrics/sequence_labeling.py:171: UserWarning: [SEP] seems not to be NE tag.
  warnings.warn('{} seems not to be NE tag.'.format(chunk))
/opt/DevEnvs/anaconda3/envs/WM/lib/python3.6/site-packages/seqeval/metrics/sequence_labeling.py:171: UserWarning: [CLS] seems not to be NE tag.
  warnings.warn('{} seems not to be NE tag.'.format(chunk))
/opt/DevEnvs/anaconda3/envs/WM/lib/python3.6/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Epoch:   2%|▏         | 1/50 [00:06<05:38,  6.91s/it]P:  0.25627240143369173
R:  0.13720682302771856
F:  0.17872517705874186

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  2.12it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.06it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.13it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.28it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.28it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.35it/s][A
 88%|████████▊ | 7/8 [00:02<00:00,  2.53it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.84it/s][A100%|██████████| 8/8 [00:03<00:00,  2.47it/s]
OOV: 0.152329
GEO: 0.036909
=======entity level========

Epoch: 2, P: 0.536728, R: 0.441684, F: 0.484590, OOV: 0.152329, GEO: 0.036909
=======entity level========
Epoch:   4%|▍         | 2/50 [00:14<05:37,  7.03s/it]P:  0.5367275553828216
R:  0.44168443496801707
F:  0.4845897420901807

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:02,  2.36it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.40it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.33it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.30it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.26it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.27it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.17it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.56it/s][A100%|██████████| 8/8 [00:03<00:00,  2.38it/s]
OOV: 0.603493
GEO: 0.465842
=======entity level========

Epoch: 3, P: 0.816214, R: 0.755650, F: 0.784765, OOV: 0.603493, GEO: 0.465842
=======entity level========
Epoch:   6%|▌         | 3/50 [00:21<05:34,  7.13s/it]P:  0.8162137263933671
R:  0.7556503198294243
F:  0.7847652790079717

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  1.98it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.26it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.47it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.42it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.23it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.31it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.24it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.61it/s][A100%|██████████| 8/8 [00:03<00:00,  2.40it/s]
OOV: 0.699871
GEO: 0.502198
=======entity level========

Epoch: 4, P: 0.854820, R: 0.846162, F: 0.850469, OOV: 0.699871, GEO: 0.502198
=======entity level========
Epoch:   8%|▊         | 4/50 [00:28<05:27,  7.12s/it]P:  0.8548196015078083
R:  0.8461620469083155
F:  0.8504687918564158

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:02,  2.74it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.68it/s][A
 38%|███▊      | 3/8 [00:01<00:01,  2.53it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.36it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.22it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.25it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.26it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.58it/s][A100%|██████████| 8/8 [00:03<00:00,  2.44it/s]
OOV: 0.770052
GEO: 0.636256
=======entity level========

Epoch: 5, P: 0.871587, R: 0.881343, F: 0.876438, OOV: 0.770052, GEO: 0.636256
=======entity level========
Epoch:  10%|█         | 5/50 [00:35<05:21,  7.15s/it]P:  0.8715867158671586
R:  0.8813432835820896
F:  0.8764378478664192

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:02,  2.34it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.43it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.49it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.50it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.29it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.34it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.22it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.71it/s][A100%|██████████| 8/8 [00:03<00:00,  2.48it/s]
OOV: 0.785252
GEO: 0.756281
=======entity level========

Epoch: 6, P: 0.901227, R: 0.885181, F: 0.893132, OOV: 0.785252, GEO: 0.756281
=======entity level========
Epoch:  12%|█▏        | 6/50 [00:42<05:10,  7.06s/it]P:  0.9012265277325519
R:  0.885181236673774
F:  0.8931318238046576

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  1.98it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.19it/s][A
 38%|███▊      | 3/8 [00:01<00:01,  2.52it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.40it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.46it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.47it/s][A
 88%|████████▊ | 7/8 [00:02<00:00,  2.37it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.69it/s][A100%|██████████| 8/8 [00:03<00:00,  2.49it/s]
OOV: 0.776197
GEO: 0.835821
=======entity level========

Epoch: 7, P: 0.914420, R: 0.871429, F: 0.892407, OOV: 0.776197, GEO: 0.835821
=======entity level========
Epoch:  14%|█▍        | 7/50 [00:48<04:53,  6.82s/it]P:  0.9144199574896521
R:  0.8714285714285714
F:  0.892406790763688

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:02,  3.08it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.79it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.33it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.17it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.21it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.25it/s][A
 88%|████████▊ | 7/8 [00:02<00:00,  2.38it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.75it/s][A100%|██████████| 8/8 [00:03<00:00,  2.49it/s]
OOV: 0.777490
GEO: 0.681159
=======entity level========

Epoch: 8, P: 0.899026, R: 0.895096, F: 0.897056, OOV: 0.777490, GEO: 0.681159
=======entity level========
Epoch:  16%|█▌        | 8/50 [00:55<04:50,  6.91s/it]P:  0.8990255916050969
R:  0.8950959488272922
F:  0.8970564666915967

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  2.10it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.08it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.12it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.24it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.34it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.34it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.22it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.66it/s][A100%|██████████| 8/8 [00:03<00:00,  2.38it/s]
OOV: 0.776843
GEO: 0.792862
=======entity level========

Epoch: 9, P: 0.907468, R: 0.883475, F: 0.895311, OOV: 0.776843, GEO: 0.792862
=======entity level========
Epoch:  18%|█▊        | 9/50 [01:02<04:37,  6.78s/it]P:  0.9074682435392029
R:  0.8834754797441364
F:  0.8953111495246326

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  2.19it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.36it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.36it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.17it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.11it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.22it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.30it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.71it/s][A100%|██████████| 8/8 [00:03<00:00,  2.40it/s]
OOV: 0.783635
GEO: 0.767296
=======entity level========

Epoch: 10, P: 0.906186, R: 0.897974, F: 0.902062, OOV: 0.783635, GEO: 0.767296
=======entity level========
Epoch:  20%|██        | 10/50 [01:09<04:36,  6.91s/it]P:  0.906186121570737
R:  0.8979744136460555
F:  0.9020615796519411

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  2.11it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.30it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.10it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.26it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.27it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.30it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.42it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.78it/s][A100%|██████████| 8/8 [00:03<00:00,  2.45it/s]
OOV: 0.791074
GEO: 0.808974
=======entity level========

Epoch: 11, P: 0.919073, R: 0.892324, F: 0.905501, OOV: 0.791074, GEO: 0.808974
=======entity level========
Epoch:  22%|██▏       | 11/50 [01:16<04:31,  6.95s/it]P:  0.9190732403645547
R:  0.8923240938166311
F:  0.905501162979391

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  2.17it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.52it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.48it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.41it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.53it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.51it/s][A
 88%|████████▊ | 7/8 [00:02<00:00,  2.52it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.75it/s][A100%|██████████| 8/8 [00:03<00:00,  2.57it/s]
OOV: 0.789780
GEO: 0.817772
=======entity level========

Epoch: 12, P: 0.918931, R: 0.894243, F: 0.906419, OOV: 0.789780, GEO: 0.817772
=======entity level========
Epoch:  24%|██▍       | 12/50 [01:23<04:24,  6.96s/it]P:  0.9189307624890447
R:  0.8942430703624733
F:  0.9064188459044739

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  2.33it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.11it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.40it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.40it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.54it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.38it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.25it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.66it/s][A100%|██████████| 8/8 [00:03<00:00,  2.46it/s]
OOV: 0.793984
GEO: 0.780519
=======entity level========

Epoch: 13, P: 0.909844, R: 0.901599, F: 0.905703, OOV: 0.793984, GEO: 0.780519
=======entity level========
Epoch:  26%|██▌       | 13/50 [01:29<04:10,  6.78s/it]P:  0.9098440021516945
R:  0.9015991471215352
F:  0.90570281124498

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  2.06it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.32it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.38it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.37it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.36it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.23it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.34it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.78it/s][A100%|██████████| 8/8 [00:03<00:00,  2.47it/s]
OOV: 0.793984
GEO: 0.815434
=======entity level========

Epoch: 14, P: 0.917673, R: 0.891258, F: 0.904273, OOV: 0.793984, GEO: 0.815434
=======entity level========
Epoch:  28%|██▊       | 14/50 [01:36<04:04,  6.79s/it]P:  0.9176728869374314
R:  0.8912579957356077
F:  0.9042725797728501

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:02,  2.61it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.55it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.33it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.21it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.38it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.43it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.23it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.57it/s][A100%|██████████| 8/8 [00:03<00:00,  2.43it/s]
OOV: 0.797542
GEO: 0.799235
=======entity level========

Epoch: 15, P: 0.913185, R: 0.899360, F: 0.906220, OOV: 0.797542, GEO: 0.799235
=======entity level========
Epoch:  30%|███       | 15/50 [01:43<03:53,  6.68s/it]P:  0.9131846720069279
R:  0.899360341151386
F:  0.9062197873026103

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  2.19it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.23it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.40it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.42it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.44it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.60it/s][A
 88%|████████▊ | 7/8 [00:02<00:00,  2.38it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.75it/s][A100%|██████████| 8/8 [00:03<00:00,  2.53it/s]
OOV: 0.797219
GEO: 0.775174
=======entity level========

Epoch: 16, P: 0.910599, R: 0.901279, F: 0.905915, OOV: 0.797219, GEO: 0.775174
=======entity level========
Epoch:  32%|███▏      | 16/50 [01:49<03:42,  6.56s/it]P:  0.9105988797931925
R:  0.9012793176972281
F:  0.9059151307329619

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  2.19it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.14it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.24it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.38it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.21it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.30it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.35it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.73it/s][A100%|██████████| 8/8 [00:03<00:00,  2.43it/s]
OOV: 0.799483
GEO: 0.797710
=======entity level========

Epoch: 17, P: 0.915979, R: 0.899574, F: 0.907702, OOV: 0.799483, GEO: 0.797710
=======entity level========
Epoch:  34%|███▍      | 17/50 [01:56<03:41,  6.72s/it]P:  0.915979157620495
R:  0.8995735607675907
F:  0.9077022375215146

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  2.02it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.31it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.42it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.40it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.40it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.35it/s][A
 88%|████████▊ | 7/8 [00:02<00:00,  2.35it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.67it/s][A100%|██████████| 8/8 [00:03<00:00,  2.46it/s]
OOV: 0.798836
GEO: 0.786076
=======entity level========

Epoch: 18, P: 0.917274, R: 0.899574, F: 0.908337, OOV: 0.798836, GEO: 0.786076
=======entity level========
Epoch:  36%|███▌      | 18/50 [02:03<03:38,  6.81s/it]P:  0.9172736166974671
R:  0.8995735607675907
F:  0.908337370149093

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  2.02it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.13it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.21it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.11it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.29it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.40it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.46it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.85it/s][A100%|██████████| 8/8 [00:03<00:00,  2.46it/s]
OOV: 0.799159
GEO: 0.783818
=======entity level========

Epoch: 19, P: 0.916224, R: 0.901279, F: 0.908690, OOV: 0.799159, GEO: 0.783818
=======entity level========
Epoch:  38%|███▊      | 19/50 [02:10<03:34,  6.91s/it]P:  0.9162241248509808
R:  0.9012793176972281
F:  0.9086902778524211

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  1.94it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.22it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.35it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.42it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.39it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.39it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.32it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.61it/s][A100%|██████████| 8/8 [00:03<00:00,  2.43it/s]
OOV: 0.800776
GEO: 0.793651
=======entity level========

Epoch: 20, P: 0.916857, R: 0.900533, F: 0.908622, OOV: 0.800776, GEO: 0.793651
=======entity level========
Epoch:  40%|████      | 20/50 [02:17<03:22,  6.76s/it]P:  0.9168566156517963
R:  0.9005330490405117
F:  0.9086215242295488

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:02,  2.46it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.48it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.23it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.25it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.47it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.49it/s][A
 88%|████████▊ | 7/8 [00:02<00:00,  2.41it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.74it/s][A100%|██████████| 8/8 [00:03<00:00,  2.52it/s]
OOV: 0.799159
GEO: 0.794921
=======entity level========

Epoch: 21, P: 0.916875, R: 0.900746, F: 0.908739, OOV: 0.799159, GEO: 0.794921
=======entity level========
Epoch:  42%|████▏     | 21/50 [02:24<03:19,  6.87s/it]P:  0.9168746608790016
R:  0.9007462686567164
F:  0.9087389083086851

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:02,  2.56it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.25it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.29it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.17it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.18it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.35it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.42it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.80it/s][A100%|██████████| 8/8 [00:03<00:00,  2.47it/s]
OOV: 0.795278
GEO: 0.803059
=======entity level========

Epoch: 22, P: 0.919730, R: 0.899041, F: 0.909267, OOV: 0.795278, GEO: 0.803059
=======entity level========
Epoch:  44%|████▍     | 22/50 [02:31<03:13,  6.90s/it]P:  0.9197295233940451
R:  0.8990405117270789
F:  0.9092673459485686

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  2.14it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.25it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.29it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.32it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.29it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.19it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.24it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.69it/s][A100%|██████████| 8/8 [00:03<00:00,  2.41it/s]
OOV: 0.798189
GEO: 0.821865
=======entity level========

Epoch: 23, P: 0.920087, R: 0.898507, F: 0.909169, OOV: 0.798189, GEO: 0.821865
=======entity level========
Epoch:  46%|████▌     | 23/50 [02:37<03:02,  6.77s/it]P:  0.9200873362445415
R:  0.8985074626865671
F:  0.9091693635382956

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:02,  2.75it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.42it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.30it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.18it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.28it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.33it/s][A
 88%|████████▊ | 7/8 [00:02<00:00,  2.37it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.72it/s][A100%|██████████| 8/8 [00:03<00:00,  2.47it/s]
OOV: 0.798836
GEO: 0.823681
=======entity level========

Epoch: 24, P: 0.918804, R: 0.897548, F: 0.908052, OOV: 0.798836, GEO: 0.823681
=======entity level========
Epoch:  48%|████▊     | 24/50 [02:44<02:52,  6.65s/it]P:  0.9188038851904398
R:  0.8975479744136461
F:  0.9080515558431754

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  2.17it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.43it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.22it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.21it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.41it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.44it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.27it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.71it/s][A100%|██████████| 8/8 [00:03<00:00,  2.46it/s]
OOV: 0.800453
GEO: 0.821865
=======entity level========

Epoch: 25, P: 0.918045, R: 0.899254, F: 0.908552, OOV: 0.800453, GEO: 0.821865
=======entity level========
Epoch:  50%|█████     | 25/50 [02:50<02:44,  6.57s/it]P:  0.9180452764475403
R:  0.8992537313432836
F:  0.908552348125808

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:02,  3.16it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.52it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.41it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.21it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.17it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.33it/s][A
 88%|████████▊ | 7/8 [00:02<00:00,  2.38it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.80it/s][A100%|██████████| 8/8 [00:03<00:00,  2.51it/s]
OOV: 0.803364
GEO: 0.823907
=======entity level========

Epoch: 26, P: 0.917897, R: 0.901066, F: 0.909404, OOV: 0.803364, GEO: 0.823907
=======entity level========
Epoch:  52%|█████▏    | 26/50 [02:57<02:40,  6.71s/it]P:  0.9178974804517811
R:  0.9010660980810234
F:  0.9094039165052723

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:02,  2.36it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.21it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.27it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.33it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.21it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.38it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.34it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.73it/s][A100%|██████████| 8/8 [00:03<00:00,  2.45it/s]
OOV: 0.804981
GEO: 0.819987
=======entity level========

Epoch: 27, P: 0.917931, R: 0.902665, F: 0.910234, OOV: 0.804981, GEO: 0.819987
=======entity level========
Epoch:  54%|█████▍    | 27/50 [03:04<02:36,  6.81s/it]P:  0.9179314830875975
R:  0.9026652452025586
F:  0.9102343582025371

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  2.29it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.23it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.47it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.55it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.41it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.23it/s][A
 88%|████████▊ | 7/8 [00:02<00:00,  2.34it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.64it/s][A100%|██████████| 8/8 [00:03<00:00,  2.46it/s]
OOV: 0.804334
GEO: 0.807913
=======entity level========

Epoch: 28, P: 0.916811, R: 0.902345, F: 0.909521, OOV: 0.804334, GEO: 0.807913
=======entity level========
Epoch:  56%|█████▌    | 28/50 [03:10<02:26,  6.68s/it]P:  0.9168110918544194
R:  0.9023454157782516
F:  0.9095207393079733

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  2.02it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.24it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.33it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.43it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.41it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.22it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.25it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.64it/s][A100%|██████████| 8/8 [00:03<00:00,  2.41it/s]
OOV: 0.807568
GEO: 0.791878
=======entity level========

Epoch: 29, P: 0.915758, R: 0.903945, F: 0.909813, OOV: 0.807568, GEO: 0.791878
=======entity level========
Epoch:  58%|█████▊    | 29/50 [03:17<02:19,  6.63s/it]P:  0.915757641213954
R:  0.9039445628997868
F:  0.9098127581951821

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:02,  2.48it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.13it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.34it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.34it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.35it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.32it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.33it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.71it/s][A100%|██████████| 8/8 [00:03<00:00,  2.46it/s]
OOV: 0.806598
GEO: 0.782059
=======entity level========

Epoch: 30, P: 0.913892, R: 0.904051, F: 0.908945, OOV: 0.806598, GEO: 0.782059
=======entity level========
Epoch:  60%|██████    | 30/50 [03:23<02:11,  6.56s/it]P:  0.9138915831447354
R:  0.9040511727078892
F:  0.9089447451631921

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  2.01it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.16it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.11it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.30it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.36it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.27it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.30it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.71it/s][A100%|██████████| 8/8 [00:03<00:00,  2.41it/s]
OOV: 0.804981
GEO: 0.772040
=======entity level========

Epoch: 31, P: 0.910672, R: 0.904264, F: 0.907457, OOV: 0.804981, GEO: 0.772040
=======entity level========
Epoch:  62%|██████▏   | 31/50 [03:30<02:03,  6.52s/it]P:  0.9106721065063346
R:  0.9042643923240938
F:  0.907456938054991

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  1.97it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.33it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.35it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.38it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.46it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.37it/s][A
 88%|████████▊ | 7/8 [00:02<00:00,  2.36it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.76it/s][A100%|██████████| 8/8 [00:03<00:00,  2.49it/s]
OOV: 0.805304
GEO: 0.773300
=======entity level========

Epoch: 32, P: 0.910281, R: 0.904264, F: 0.907263, OOV: 0.805304, GEO: 0.773300
=======entity level========
Epoch:  64%|██████▍   | 32/50 [03:36<01:56,  6.47s/it]P:  0.9102811762180726
R:  0.9042643923240938
F:  0.9072628088565621

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:02,  2.64it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.24it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.28it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.23it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.23it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.22it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.35it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.71it/s][A100%|██████████| 8/8 [00:03<00:00,  2.43it/s]
OOV: 0.806274
GEO: 0.777287
=======entity level========

Epoch: 33, P: 0.910634, R: 0.903838, F: 0.907223, OOV: 0.806274, GEO: 0.777287
=======entity level========
Epoch:  66%|██████▌   | 33/50 [03:43<01:49,  6.46s/it]P:  0.9106337271750805
R:  0.9038379530916845
F:  0.907223113964687

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  2.17it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.17it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.06it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.29it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.33it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.35it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.34it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.73it/s][A100%|██████████| 8/8 [00:03<00:00,  2.42it/s]
OOV: 0.803687
GEO: 0.813581
=======entity level========

Epoch: 34, P: 0.916848, R: 0.900426, F: 0.908563, OOV: 0.803687, GEO: 0.813581
=======entity level========
Epoch:  68%|██████▊   | 34/50 [03:49<01:43,  6.46s/it]P:  0.9168475900998697
R:  0.9004264392324094
F:  0.9085628227194492

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  2.00it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.06it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.18it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.22it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.23it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.31it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.35it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.81it/s][A100%|██████████| 8/8 [00:03<00:00,  2.42it/s]
OOV: 0.799483
GEO: 0.825048
=======entity level========

Epoch: 35, P: 0.920611, R: 0.893817, F: 0.907016, OOV: 0.799483, GEO: 0.825048
=======entity level========
Epoch:  70%|███████   | 35/50 [03:55<01:36,  6.45s/it]P:  0.9206105193806962
R:  0.8938166311300639
F:  0.907015740790826

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  2.16it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.27it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.35it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.38it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.31it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.20it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.27it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.65it/s][A100%|██████████| 8/8 [00:03<00:00,  2.42it/s]
OOV: 0.803040
GEO: 0.816956
=======entity level========

Epoch: 36, P: 0.920756, R: 0.898081, F: 0.909277, OOV: 0.803040, GEO: 0.816956
=======entity level========
Epoch:  72%|███████▏  | 36/50 [04:02<01:30,  6.45s/it]P:  0.9207563668160454
R:  0.8980810234541577
F:  0.9092773490204544

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  1.97it/s][A
 25%|██▌       | 2/8 [00:00<00:02,  2.29it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  2.16it/s][A
 50%|█████     | 4/8 [00:01<00:01,  2.33it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  2.34it/s][A
 75%|███████▌  | 6/8 [00:02<00:00,  2.43it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  2.33it/s][A
100%|██████████| 8/8 [00:03<00:00,  2.75it/s][A100%|██████████| 8/8 [00:03<00:00,  2.45it/s]
OOV: 0.804981
GEO: 0.800000
=======entity level========

Epoch: 37, P: 0.918423, R: 0.901386, F: 0.909825, OOV: 0.804981, GEO: 0.800000
=======entity level========

Early stop triggered at epoch 36

Epoch:  72%|███████▏  | 36/50 [04:08<01:36,  6.91s/it]

=======best f entity level========

Epoch: 27, P: 0.917931, R: 0.902665, F: 0.910234, OOV: 0.804981, GEO: 0.819987, GEO_N: 0.822695


=======best f entity level========
P:  0.9184227677601564
R:  0.9013859275053305
F:  0.9098245991606585
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:56,  1.09it/s]  3%|▎         | 2/62 [00:01<00:52,  1.14it/s]  5%|▍         | 3/62 [00:02<00:50,  1.17it/s]  6%|▋         | 4/62 [00:03<00:52,  1.10it/s]  8%|▊         | 5/62 [00:04<00:53,  1.06it/s] 10%|▉         | 6/62 [00:05<00:55,  1.01it/s] 11%|█▏        | 7/62 [00:06<00:47,  1.15it/s] 13%|█▎        | 8/62 [00:06<00:43,  1.23it/s] 15%|█▍        | 9/62 [00:07<00:46,  1.15it/s] 16%|█▌        | 10/62 [00:08<00:43,  1.18it/s] 18%|█▊        | 11/62 [00:09<00:48,  1.04it/s] 19%|█▉        | 12/62 [00:10<00:44,  1.12it/s] 21%|██        | 13/62 [00:11<00:48,  1.01it/s] 23%|██▎       | 14/62 [00:12<00:47,  1.01it/s] 24%|██▍       | 15/62 [00:13<00:44,  1.05it/s] 26%|██▌       | 16/62 [00:14<00:38,  1.21it/s] 27%|██▋       | 17/62 [00:14<00:34,  1.31it/s] 29%|██▉       | 18/62 [00:15<00:35,  1.23it/s] 31%|███       | 19/62 [00:17<00:41,  1.04it/s] 32%|███▏      | 20/62 [00:18<00:45,  1.07s/it] 34%|███▍      | 21/62 [00:20<00:52,  1.28s/it] 35%|███▌      | 22/62 [00:21<00:46,  1.17s/it] 37%|███▋      | 23/62 [00:21<00:38,  1.00it/s] 39%|███▊      | 24/62 [00:22<00:38,  1.03s/it] 40%|████      | 25/62 [00:24<00:49,  1.35s/it] 42%|████▏     | 26/62 [00:26<00:45,  1.27s/it] 44%|████▎     | 27/62 [00:26<00:40,  1.15s/it] 45%|████▌     | 28/62 [00:27<00:37,  1.11s/it] 47%|████▋     | 29/62 [00:29<00:36,  1.10s/it] 48%|████▊     | 30/62 [00:29<00:32,  1.02s/it] 50%|█████     | 31/62 [00:30<00:30,  1.01it/s] 52%|█████▏    | 32/62 [00:31<00:26,  1.15it/s] 53%|█████▎    | 33/62 [00:32<00:26,  1.08it/s] 55%|█████▍    | 34/62 [00:33<00:27,  1.01it/s] 56%|█████▋    | 35/62 [00:34<00:25,  1.05it/s] 58%|█████▊    | 36/62 [00:35<00:22,  1.16it/s] 60%|█████▉    | 37/62 [00:35<00:18,  1.34it/s] 61%|██████▏   | 38/62 [00:36<00:18,  1.31it/s] 63%|██████▎   | 39/62 [00:37<00:19,  1.15it/s] 65%|██████▍   | 40/62 [00:38<00:18,  1.16it/s] 66%|██████▌   | 41/62 [00:39<00:17,  1.18it/s] 68%|██████▊   | 42/62 [00:39<00:16,  1.20it/s] 69%|██████▉   | 43/62 [00:40<00:16,  1.12it/s] 71%|███████   | 44/62 [00:41<00:14,  1.20it/s] 73%|███████▎  | 45/62 [00:43<00:17,  1.01s/it] 74%|███████▍  | 46/62 [00:43<00:14,  1.10it/s] 76%|███████▌  | 47/62 [00:44<00:13,  1.12it/s] 77%|███████▋  | 48/62 [00:45<00:12,  1.14it/s] 79%|███████▉  | 49/62 [00:46<00:13,  1.01s/it] 81%|████████  | 50/62 [00:47<00:11,  1.05it/s] 82%|████████▏ | 51/62 [00:48<00:10,  1.02it/s] 84%|████████▍ | 52/62 [00:49<00:10,  1.00s/it] 85%|████████▌ | 53/62 [00:51<00:10,  1.20s/it] 87%|████████▋ | 54/62 [00:52<00:08,  1.07s/it] 89%|████████▊ | 55/62 [00:53<00:07,  1.01s/it] 90%|█████████ | 56/62 [00:53<00:05,  1.09it/s] 92%|█████████▏| 57/62 [00:54<00:04,  1.14it/s] 94%|█████████▎| 58/62 [00:55<00:03,  1.18it/s] 95%|█████████▌| 59/62 [00:56<00:02,  1.18it/s] 97%|█████████▋| 60/62 [00:56<00:01,  1.28it/s] 98%|█████████▊| 61/62 [00:58<00:00,  1.07it/s]100%|██████████| 62/62 [00:58<00:00,  1.11it/s]100%|██████████| 62/62 [00:58<00:00,  1.05it/s]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0_0.81', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.96s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.24s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.21s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.15s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.12s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.22s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.667529
GEO: 0.559351
=======entity level========

Epoch: 1, P: 0.823497, R: 0.786887, F: 0.804776, OOV: 0.667529, GEO: 0.559351
=======entity level========
Epoch:   2%|▏         | 1/50 [00:43<35:41, 43.71s/it]P:  0.8234965971214995
R:  0.7868869936034115
F:  0.8047756637409367

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.98s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.90s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.93s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.11s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.14s/it][A
100%|██████████| 8/8 [00:38<00:00,  4.51s/it][A100%|██████████| 8/8 [00:38<00:00,  4.86s/it]
OOV: 0.792367
GEO: 0.811333
=======entity level========

Epoch: 2, P: 0.916152, R: 0.885288, F: 0.900455, OOV: 0.792367, GEO: 0.811333
=======entity level========
Epoch:   4%|▍         | 2/50 [01:26<34:40, 43.34s/it]P:  0.9161518093556928
R:  0.8852878464818763
F:  0.9004554326610279

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.05s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.47s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.21s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.26s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.24s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.23s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.07s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.58s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.799806
GEO: 0.804084
=======entity level========

Epoch: 3, P: 0.920276, R: 0.897122, F: 0.908551, OOV: 0.799806, GEO: 0.804084
=======entity level========
Epoch:   6%|▌         | 3/50 [02:10<33:54, 43.28s/it]P:  0.9202755905511811
R:  0.8971215351812367
F:  0.9085510688836105

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.02s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.07s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.46s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.19s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.22s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.12s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.10s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.46s/it][A100%|██████████| 8/8 [00:39<00:00,  4.90s/it]
OOV: 0.808538
GEO: 0.789640
=======entity level========

Epoch: 4, P: 0.915280, R: 0.902985, F: 0.909091, OOV: 0.808538, GEO: 0.789640
=======entity level========
Epoch:   8%|▊         | 4/50 [02:52<32:58, 43.02s/it]P:  0.9152798789712556
R:  0.9029850746268657
F:  0.9090909090909091

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.02s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.99s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.96s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.07s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.18s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.13s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.62s/it][A100%|██████████| 8/8 [00:39<00:00,  4.90s/it]
OOV: 0.803040
GEO: 0.816956
=======entity level========

Epoch: 5, P: 0.920826, R: 0.898934, F: 0.909748, OOV: 0.803040, GEO: 0.816956
=======entity level========
Epoch:  10%|█         | 5/50 [03:36<32:22, 43.17s/it]P:  0.9208255979032435
R:  0.8989339019189766
F:  0.9097480714247183

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.89s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.07s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.06s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.30s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.25s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.27s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.807891
GEO: 0.807643
=======entity level========

Epoch: 6, P: 0.916306, R: 0.903412, F: 0.909813, OOV: 0.807891, GEO: 0.807643
=======entity level========
Epoch:  12%|█▏        | 6/50 [04:19<31:40, 43.20s/it]P:  0.9163062283737025
R:  0.9034115138592751
F:  0.9098131844535109

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.10s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.11s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.02s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.29s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.25s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.17s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.53s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.804334
GEO: 0.818533
=======entity level========

Epoch: 7, P: 0.921564, R: 0.899360, F: 0.910327, OOV: 0.804334, GEO: 0.818533
=======entity level========
Epoch:  14%|█▍        | 7/50 [05:02<31:04, 43.35s/it]P:  0.9215643434564125
R:  0.899360341151386
F:  0.9103269666558756

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.19s/it][A
 25%|██▌       | 2/8 [00:10<00:33,  5.53s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.15s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.09s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.18s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.07s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.57s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.810479
GEO: 0.815621
=======entity level========

Epoch: 8, P: 0.917839, R: 0.903945, F: 0.910839, OOV: 0.810479, GEO: 0.815621
=======entity level========
Epoch:  16%|█▌        | 8/50 [05:45<30:15, 43.22s/it]P:  0.9178393591686512
R:  0.9039445628997868
F:  0.910838973036846

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.07s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.92s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.17s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.10s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.24s/it][A
 75%|███████▌  | 6/8 [00:31<00:11,  5.50s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.39s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.72s/it][A100%|██████████| 8/8 [00:40<00:00,  5.04s/it]
OOV: 0.805951
GEO: 0.832041
=======entity level========

Epoch: 9, P: 0.918127, R: 0.899041, F: 0.908484, OOV: 0.805951, GEO: 0.832041
=======entity level========
Epoch:  18%|█▊        | 9/50 [06:30<29:47, 43.60s/it]P:  0.9181273816004355
R:  0.8990405117270789
F:  0.9084837058981955

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.81s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.93s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.30s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.19s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.12s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.22s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.26s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.804334
GEO: 0.815335
=======entity level========

Epoch: 10, P: 0.922909, R: 0.901066, F: 0.911857, OOV: 0.804334, GEO: 0.815335
=======entity level========
Epoch:  20%|██        | 10/50 [07:13<28:57, 43.44s/it]P:  0.9229089320812405
R:  0.9010660980810234
F:  0.9118567267234869

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.94s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.24s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.28s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.10s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.02s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.07s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.18s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.807245
GEO: 0.792668
=======entity level========

Epoch: 11, P: 0.916190, R: 0.904371, F: 0.910242, OOV: 0.807245, GEO: 0.792668
=======entity level========
Epoch:  22%|██▏       | 11/50 [07:56<28:07, 43.28s/it]P:  0.9161896533102927
R:  0.9043710021321961
F:  0.9102419657706959

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.26s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.13s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.12s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.24s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.16s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.28s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.19s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.54s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.808538
GEO: 0.823303
=======entity level========

Epoch: 12, P: 0.921729, R: 0.902665, F: 0.912097, OOV: 0.808538, GEO: 0.823303
=======entity level========
Epoch:  24%|██▍       | 12/50 [08:39<27:21, 43.19s/it]P:  0.9217287176137601
R:  0.9026652452025586
F:  0.9120973823117526

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.64s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.31s/it][A
 38%|███▊      | 3/8 [00:15<00:24,  4.97s/it][A
 50%|█████     | 4/8 [00:20<00:19,  4.95s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.03s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.09s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.11s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.78s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.799483
GEO: 0.801532
=======entity level========

Epoch: 13, P: 0.922765, R: 0.897974, F: 0.910201, OOV: 0.799483, GEO: 0.801532
=======entity level========
Epoch:  26%|██▌       | 13/50 [09:22<26:38, 43.21s/it]P:  0.9227651183172656
R:  0.8979744136460555
F:  0.9102009941646855

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.94s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.46s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.34s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.28s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.20s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.16s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.67s/it][A100%|██████████| 8/8 [00:40<00:00,  5.00s/it]
OOV: 0.808862
GEO: 0.810466
=======entity level========

Epoch: 14, P: 0.918620, R: 0.902559, F: 0.910518, OOV: 0.808862, GEO: 0.810466
=======entity level========
Epoch:  28%|██▊       | 14/50 [10:06<25:58, 43.29s/it]P:  0.9186197916666666
R:  0.9025586353944562
F:  0.9105183910518391

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.52s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.35s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.47s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.18s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.12s/it][A
 88%|████████▊ | 7/8 [00:35<00:04,  4.98s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.806598
GEO: 0.813060
=======entity level========

Epoch: 15, P: 0.919678, R: 0.900853, F: 0.910168, OOV: 0.806598, GEO: 0.813060
=======entity level========
Epoch:  30%|███       | 15/50 [10:49<25:15, 43.30s/it]P:  0.9196778406617327
R:  0.9008528784648188
F:  0.9101680310211117

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.24s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.66s/it][A
 38%|███▊      | 3/8 [00:16<00:26,  5.39s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.30s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.22s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:04,  4.99s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.50s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.807568
GEO: 0.814341
=======entity level========

Epoch: 16, P: 0.915351, R: 0.902665, F: 0.908964, OOV: 0.807568, GEO: 0.814341
=======entity level========
Epoch:  32%|███▏      | 16/50 [11:32<24:30, 43.24s/it]P:  0.9153513513513514
R:  0.9026652452025586
F:  0.9089640365002685

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.65s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.41s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.25s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.24s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.19s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.61s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.806274
GEO: 0.818533
=======entity level========

Epoch: 17, P: 0.919660, R: 0.900640, F: 0.910051, OOV: 0.806274, GEO: 0.818533
=======entity level========
Epoch:  34%|███▍      | 17/50 [12:15<23:48, 43.29s/it]P:  0.9196603527106466
R:  0.9006396588486141
F:  0.9100506301842077

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.56s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.04s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.07s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.20s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.04s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.23s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.808862
GEO: 0.812540
=======entity level========

Epoch: 18, P: 0.920835, R: 0.902772, F: 0.911714, OOV: 0.808862, GEO: 0.812540
=======entity level========
Epoch:  36%|███▌      | 18/50 [12:59<23:04, 43.26s/it]P:  0.9208351457155285
R:  0.9027718550106609
F:  0.9117140396210164

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.81s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.18s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.35s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.37s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.24s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.56s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.808862
GEO: 0.807398
=======entity level========

Epoch: 19, P: 0.918038, R: 0.903945, F: 0.910937, OOV: 0.808862, GEO: 0.807398
=======entity level========

Early stop triggered at epoch 18

Epoch:  36%|███▌      | 18/50 [13:42<24:21, 45.68s/it]

=======best f entity level========

Epoch: 9, P: 0.918127, R: 0.899041, F: 0.908484, OOV: 0.805951, GEO: 0.832041, GEO_N: 0.833005


=======best f entity level========
P:  0.9180381117366826
R:  0.9039445628997868
F:  0.9109368285345939
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:01<01:02,  1.02s/it]  3%|▎         | 2/62 [00:01<00:59,  1.01it/s]  5%|▍         | 3/62 [00:02<00:55,  1.06it/s]  6%|▋         | 4/62 [00:03<00:56,  1.02it/s]  8%|▊         | 5/62 [00:05<00:59,  1.04s/it] 10%|▉         | 6/62 [00:06<01:00,  1.09s/it] 11%|█▏        | 7/62 [00:06<00:51,  1.06it/s] 13%|█▎        | 8/62 [00:07<00:46,  1.15it/s] 15%|█▍        | 9/62 [00:08<00:48,  1.08it/s] 16%|█▌        | 10/62 [00:09<00:47,  1.10it/s] 18%|█▊        | 11/62 [00:10<00:53,  1.05s/it] 19%|█▉        | 12/62 [00:11<00:48,  1.03it/s] 21%|██        | 13/62 [00:12<00:52,  1.06s/it] 23%|██▎       | 14/62 [00:14<00:51,  1.07s/it] 24%|██▍       | 15/62 [00:14<00:48,  1.03s/it] 26%|██▌       | 16/62 [00:15<00:40,  1.12it/s] 27%|██▋       | 17/62 [00:16<00:37,  1.20it/s] 29%|██▉       | 18/62 [00:17<00:39,  1.12it/s] 31%|███       | 19/62 [00:18<00:45,  1.07s/it] 32%|███▏      | 20/62 [00:20<00:49,  1.19s/it] 34%|███▍      | 21/62 [00:22<00:57,  1.41s/it] 35%|███▌      | 22/62 [00:23<00:51,  1.28s/it] 37%|███▋      | 23/62 [00:23<00:42,  1.09s/it] 39%|███▊      | 24/62 [00:24<00:42,  1.12s/it] 40%|████      | 25/62 [00:27<00:53,  1.45s/it] 42%|████▏     | 26/62 [00:28<00:49,  1.38s/it] 44%|████▎     | 27/62 [00:29<00:44,  1.26s/it] 45%|████▌     | 28/62 [00:30<00:41,  1.21s/it] 47%|████▋     | 29/62 [00:31<00:39,  1.20s/it] 48%|████▊     | 30/62 [00:32<00:35,  1.11s/it] 50%|█████     | 31/62 [00:33<00:33,  1.08s/it] 52%|█████▏    | 32/62 [00:34<00:28,  1.05it/s] 53%|█████▎    | 33/62 [00:35<00:30,  1.04s/it] 55%|█████▍    | 34/62 [00:36<00:30,  1.10s/it] 56%|█████▋    | 35/62 [00:37<00:28,  1.05s/it] 58%|█████▊    | 36/62 [00:38<00:24,  1.05it/s] 60%|█████▉    | 37/62 [00:38<00:20,  1.24it/s] 61%|██████▏   | 38/62 [00:39<00:20,  1.19it/s] 63%|██████▎   | 39/62 [00:41<00:22,  1.02it/s] 65%|██████▍   | 40/62 [00:42<00:21,  1.03it/s] 66%|██████▌   | 41/62 [00:42<00:19,  1.05it/s] 68%|██████▊   | 42/62 [00:43<00:18,  1.07it/s] 69%|██████▉   | 43/62 [00:44<00:18,  1.02it/s] 71%|███████   | 44/62 [00:45<00:16,  1.07it/s] 73%|███████▎  | 45/62 [00:47<00:19,  1.14s/it] 74%|███████▍  | 46/62 [00:48<00:16,  1.01s/it] 76%|███████▌  | 47/62 [00:48<00:14,  1.03it/s] 77%|███████▋  | 48/62 [00:49<00:13,  1.06it/s] 79%|███████▉  | 49/62 [00:51<00:14,  1.11s/it] 81%|████████  | 50/62 [00:52<00:12,  1.03s/it] 82%|████████▏ | 51/62 [00:53<00:11,  1.05s/it] 84%|████████▍ | 52/62 [00:54<00:10,  1.08s/it] 85%|████████▌ | 53/62 [00:56<00:11,  1.29s/it] 87%|████████▋ | 54/62 [00:57<00:09,  1.17s/it] 89%|████████▊ | 55/62 [00:57<00:07,  1.09s/it] 90%|█████████ | 56/62 [00:58<00:05,  1.01it/s] 92%|█████████▏| 57/62 [00:59<00:04,  1.06it/s] 94%|█████████▎| 58/62 [01:00<00:03,  1.09it/s] 95%|█████████▌| 59/62 [01:01<00:02,  1.10it/s] 97%|█████████▋| 60/62 [01:02<00:01,  1.17it/s] 98%|█████████▊| 61/62 [01:03<00:01,  1.00s/it]100%|██████████| 62/62 [01:04<00:00,  1.03it/s]100%|██████████| 62/62 [01:04<00:00,  1.04s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0_0.82', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.97s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.27s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.23s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.14s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.11s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.22s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.61s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.665589
GEO: 0.557035
=======entity level========

Epoch: 1, P: 0.822316, R: 0.786461, F: 0.803989, OOV: 0.665589, GEO: 0.557035
=======entity level========
Epoch:   2%|▏         | 1/50 [00:43<35:31, 43.51s/it]P:  0.8223163526920075
R:  0.7864605543710022
F:  0.8039888834395945

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.96s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.92s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.94s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.13s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.20s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.23s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.52s/it][A100%|██████████| 8/8 [00:39<00:00,  4.88s/it]
OOV: 0.791721
GEO: 0.812862
=======entity level========

Epoch: 2, P: 0.913431, R: 0.885288, F: 0.899139, OOV: 0.791721, GEO: 0.812862
=======entity level========
Epoch:   4%|▍         | 2/50 [01:26<34:42, 43.39s/it]P:  0.9134308656913431
R:  0.8852878464818763
F:  0.8991391911645281

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.11s/it][A
 25%|██▌       | 2/8 [00:10<00:33,  5.51s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.18s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.24s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.08s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.59s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.805304
GEO: 0.802037
=======entity level========

Epoch: 3, P: 0.919154, R: 0.899360, F: 0.909150, OOV: 0.805304, GEO: 0.802037
=======entity level========
Epoch:   6%|▌         | 3/50 [02:10<33:55, 43.30s/it]P:  0.9191544998910438
R:  0.899360341151386
F:  0.9091496928548335

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.99s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.07s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.49s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.24s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.15s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.49s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.806598
GEO: 0.800000
=======entity level========

Epoch: 4, P: 0.915981, R: 0.901919, F: 0.908896, OOV: 0.806598, GEO: 0.800000
=======entity level========
Epoch:   8%|▊         | 4/50 [02:52<33:02, 43.11s/it]P:  0.9159809441316588
R:  0.9019189765458422
F:  0.9088955737000429

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.10s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.03s/it][A
 38%|███▊      | 3/8 [00:15<00:24,  4.98s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.08s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.16s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.13s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.800453
GEO: 0.821935
=======entity level========

Epoch: 5, P: 0.918245, R: 0.899254, F: 0.908650, OOV: 0.800453, GEO: 0.821935
=======entity level========
Epoch:  10%|█         | 5/50 [03:36<32:28, 43.31s/it]P:  0.9182451556716743
R:  0.8992537313432836
F:  0.9086502208337821

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.90s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.11s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.08s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.32s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.25s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.30s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.29s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.69s/it][A100%|██████████| 8/8 [00:40<00:00,  5.01s/it]
OOV: 0.808538
GEO: 0.806616
=======entity level========

Epoch: 6, P: 0.915561, R: 0.905117, F: 0.910309, OOV: 0.808538, GEO: 0.806616
=======entity level========
Epoch:  12%|█▏        | 6/50 [04:20<31:48, 43.38s/it]P:  0.9155613070203817
R:  0.9051172707889126
F:  0.910309333619257

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.05s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.10s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.02s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.30s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.26s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.18s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.53s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.803040
GEO: 0.814103
=======entity level========

Epoch: 7, P: 0.922673, R: 0.899360, F: 0.910868, OOV: 0.803040, GEO: 0.814103
=======entity level========
Epoch:  14%|█▍        | 7/50 [05:02<30:57, 43.20s/it]P:  0.9226730832330745
R:  0.899360341151386
F:  0.9108675700480484

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.20s/it][A
 25%|██▌       | 2/8 [00:10<00:33,  5.55s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.15s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.12s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.17s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.08s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.58s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.808862
GEO: 0.800000
=======entity level========

Epoch: 8, P: 0.915093, R: 0.904264, F: 0.909647, OOV: 0.808862, GEO: 0.800000
=======entity level========
Epoch:  16%|█▌        | 8/50 [05:45<30:12, 43.16s/it]P:  0.9150933218254397
R:  0.9042643923240938
F:  0.9096466298461044

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.06s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.95s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.14s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.10s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.26s/it][A
 75%|███████▌  | 6/8 [00:31<00:11,  5.52s/it][A
 88%|████████▊ | 7/8 [00:37<00:05,  5.43s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.76s/it][A100%|██████████| 8/8 [00:40<00:00,  5.06s/it]
OOV: 0.808862
GEO: 0.811576
=======entity level========

Epoch: 9, P: 0.917146, R: 0.901599, F: 0.909306, OOV: 0.808862, GEO: 0.811576
=======entity level========
Epoch:  18%|█▊        | 9/50 [06:29<29:39, 43.41s/it]P:  0.9171456458084807
R:  0.9015991471215352
F:  0.9093059512929412

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.81s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.93s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.27s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.19s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.13s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.23s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.27s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.807891
GEO: 0.815385
=======entity level========

Epoch: 10, P: 0.921004, R: 0.903625, F: 0.912232, OOV: 0.807891, GEO: 0.815385
=======entity level========
Epoch:  20%|██        | 10/50 [07:12<28:52, 43.32s/it]P:  0.9210040204281212
R:  0.9036247334754798
F:  0.912231609535597

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.95s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.22s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.30s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.11s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.01s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.06s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.810479
GEO: 0.786885
=======entity level========

Epoch: 11, P: 0.912824, R: 0.907569, F: 0.910189, OOV: 0.810479, GEO: 0.786885
=======entity level========
Epoch:  22%|██▏       | 11/50 [07:55<28:04, 43.18s/it]P:  0.9128243619987133
R:  0.9075692963752665
F:  0.9101892440928044

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.19s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.14s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.10s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.20s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.12s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.23s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.53s/it][A100%|██████████| 8/8 [00:39<00:00,  4.91s/it]
OOV: 0.806274
GEO: 0.817191
=======entity level========

Epoch: 12, P: 0.920640, R: 0.901599, F: 0.911020, OOV: 0.806274, GEO: 0.817191
=======entity level========
Epoch:  24%|██▍       | 12/50 [08:38<27:16, 43.06s/it]P:  0.9206401045068583
R:  0.9015991471215352
F:  0.911020144349887

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:40,  5.72s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.32s/it][A
 38%|███▊      | 3/8 [00:15<00:24,  4.98s/it][A
 50%|█████     | 4/8 [00:20<00:19,  4.96s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.04s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.08s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.79s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.810802
GEO: 0.816901
=======entity level========

Epoch: 13, P: 0.921513, R: 0.903731, F: 0.912536, OOV: 0.810802, GEO: 0.816901
=======entity level========
Epoch:  26%|██▌       | 13/50 [09:22<26:36, 43.15s/it]P:  0.9215132079573867
R:  0.9037313432835821
F:  0.9125356585392109

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.93s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.45s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.26s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.13s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.12s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.08s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.810479
GEO: 0.817949
=======entity level========

Epoch: 14, P: 0.918713, R: 0.901279, F: 0.909913, OOV: 0.810479, GEO: 0.817949
=======entity level========
Epoch:  28%|██▊       | 14/50 [10:05<25:53, 43.15s/it]P:  0.9187133231906107
R:  0.9012793176972281
F:  0.9099128188569584

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.50s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.32s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.47s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.19s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.16s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.16s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.03s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.70s/it][A100%|██████████| 8/8 [00:40<00:00,  5.02s/it]
OOV: 0.810155
GEO: 0.819693
=======entity level========

Epoch: 15, P: 0.918358, R: 0.901812, F: 0.910010, OOV: 0.810155, GEO: 0.819693
=======entity level========

Early stop triggered at epoch 14

Epoch:  28%|██▊       | 14/50 [10:48<27:48, 46.34s/it]

=======best f entity level========

Epoch: 5, P: 0.918245, R: 0.899254, F: 0.908650, OOV: 0.800453, GEO: 0.821935, GEO_N: 0.820236


=======best f entity level========
P:  0.9183584844208013
R:  0.9018123667377399
F:  0.9100102199989243
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:01<01:02,  1.02s/it]  3%|▎         | 2/62 [00:01<00:59,  1.01it/s]  5%|▍         | 3/62 [00:02<00:55,  1.07it/s]  6%|▋         | 4/62 [00:03<00:56,  1.02it/s]  8%|▊         | 5/62 [00:05<00:59,  1.04s/it] 10%|▉         | 6/62 [00:06<01:00,  1.09s/it] 11%|█▏        | 7/62 [00:06<00:51,  1.06it/s] 13%|█▎        | 8/62 [00:07<00:46,  1.16it/s] 15%|█▍        | 9/62 [00:08<00:48,  1.09it/s] 16%|█▌        | 10/62 [00:09<00:47,  1.10it/s] 18%|█▊        | 11/62 [00:10<00:53,  1.05s/it] 19%|█▉        | 12/62 [00:11<00:48,  1.03it/s] 21%|██        | 13/62 [00:12<00:51,  1.06s/it] 23%|██▎       | 14/62 [00:14<00:51,  1.07s/it] 24%|██▍       | 15/62 [00:14<00:48,  1.03s/it] 26%|██▌       | 16/62 [00:15<00:40,  1.12it/s] 27%|██▋       | 17/62 [00:16<00:37,  1.20it/s] 29%|██▉       | 18/62 [00:17<00:39,  1.12it/s] 31%|███       | 19/62 [00:18<00:46,  1.07s/it] 32%|███▏      | 20/62 [00:20<00:49,  1.19s/it] 34%|███▍      | 21/62 [00:22<00:57,  1.41s/it] 35%|███▌      | 22/62 [00:23<00:51,  1.28s/it] 37%|███▋      | 23/62 [00:23<00:42,  1.09s/it] 39%|███▊      | 24/62 [00:24<00:42,  1.13s/it] 40%|████      | 25/62 [00:27<00:53,  1.45s/it] 42%|████▏     | 26/62 [00:28<00:49,  1.38s/it] 44%|████▎     | 27/62 [00:29<00:44,  1.27s/it] 45%|████▌     | 28/62 [00:30<00:41,  1.21s/it] 47%|████▋     | 29/62 [00:31<00:39,  1.20s/it] 48%|████▊     | 30/62 [00:32<00:35,  1.11s/it] 50%|█████     | 31/62 [00:33<00:33,  1.08s/it] 52%|█████▏    | 32/62 [00:34<00:28,  1.05it/s] 53%|█████▎    | 33/62 [00:35<00:30,  1.04s/it] 55%|█████▍    | 34/62 [00:36<00:30,  1.10s/it] 56%|█████▋    | 35/62 [00:37<00:28,  1.05s/it] 58%|█████▊    | 36/62 [00:38<00:24,  1.05it/s] 60%|█████▉    | 37/62 [00:38<00:20,  1.24it/s] 61%|██████▏   | 38/62 [00:39<00:20,  1.19it/s] 63%|██████▎   | 39/62 [00:40<00:21,  1.05it/s] 65%|██████▍   | 40/62 [00:41<00:20,  1.06it/s] 66%|██████▌   | 41/62 [00:42<00:19,  1.08it/s] 68%|██████▊   | 42/62 [00:43<00:18,  1.09it/s] 69%|██████▉   | 43/62 [00:44<00:18,  1.03it/s] 71%|███████   | 44/62 [00:45<00:16,  1.07it/s] 73%|███████▎  | 45/62 [00:47<00:19,  1.14s/it] 74%|███████▍  | 46/62 [00:47<00:15,  1.00it/s] 76%|███████▌  | 47/62 [00:48<00:14,  1.07it/s] 77%|███████▋  | 48/62 [00:49<00:12,  1.08it/s] 79%|███████▉  | 49/62 [00:51<00:14,  1.10s/it] 81%|████████  | 50/62 [00:51<00:12,  1.02s/it] 82%|████████▏ | 51/62 [00:53<00:11,  1.04s/it] 84%|████████▍ | 52/62 [00:54<00:10,  1.07s/it] 85%|████████▌ | 53/62 [00:55<00:11,  1.28s/it] 87%|████████▋ | 54/62 [00:56<00:09,  1.17s/it] 89%|████████▊ | 55/62 [00:57<00:07,  1.09s/it] 90%|█████████ | 56/62 [00:58<00:05,  1.01it/s] 92%|█████████▏| 57/62 [00:59<00:04,  1.06it/s] 94%|█████████▎| 58/62 [01:00<00:03,  1.10it/s] 95%|█████████▌| 59/62 [01:01<00:02,  1.10it/s] 97%|█████████▋| 60/62 [01:01<00:01,  1.18it/s] 98%|█████████▊| 61/62 [01:03<00:01,  1.00s/it]100%|██████████| 62/62 [01:04<00:00,  1.03it/s]100%|██████████| 62/62 [01:04<00:00,  1.03s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0_0.83', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.95s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.23s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.20s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.13s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.10s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.17s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.21s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.60s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.666235
GEO: 0.554593
=======entity level========

Epoch: 1, P: 0.821834, R: 0.787313, F: 0.804203, OOV: 0.666235, GEO: 0.554593
=======entity level========
Epoch:   2%|▏         | 1/50 [00:43<35:25, 43.38s/it]P:  0.8218339639439127
R:  0.7873134328358209
F:  0.8042034193618643

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.94s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.93s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.95s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.10s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.22s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.14s/it][A
100%|██████████| 8/8 [00:38<00:00,  4.52s/it][A100%|██████████| 8/8 [00:38<00:00,  4.87s/it]
OOV: 0.790750
GEO: 0.814433
=======entity level========

Epoch: 2, P: 0.914997, R: 0.885928, F: 0.900227, OOV: 0.790750, GEO: 0.814433
=======entity level========
Epoch:   4%|▍         | 2/50 [01:26<34:35, 43.24s/it]P:  0.9149966967628276
R:  0.8859275053304904
F:  0.9002274943126423

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.09s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.49s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.16s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.23s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.22s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.07s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.59s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.799806
GEO: 0.811538
=======entity level========

Epoch: 3, P: 0.920753, R: 0.896802, F: 0.908620, OOV: 0.799806, GEO: 0.811538
=======entity level========
Epoch:   6%|▌         | 3/50 [02:09<33:50, 43.20s/it]P:  0.920753064798599
R:  0.8968017057569296
F:  0.9086195722618275

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.01s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.06s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.52s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.23s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.26s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.16s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.11s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.47s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.805951
GEO: 0.800000
=======entity level========

Epoch: 4, P: 0.915153, R: 0.902665, F: 0.908866, OOV: 0.805951, GEO: 0.800000
=======entity level========
Epoch:   8%|▊         | 4/50 [02:52<32:59, 43.04s/it]P:  0.9151534803285776
R:  0.9026652452025586
F:  0.908866466294547

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.07s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.03s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.03s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.12s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.17s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.13s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.62s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.803687
GEO: 0.837873
=======entity level========

Epoch: 5, P: 0.918345, R: 0.899254, F: 0.908699, OOV: 0.803687, GEO: 0.837873
=======entity level========
Epoch:  10%|█         | 5/50 [03:36<32:26, 43.26s/it]P:  0.9183451279259662
R:  0.8992537313432836
F:  0.90869916509561

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.91s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.13s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.11s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.37s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.31s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.31s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.29s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.65s/it][A100%|██████████| 8/8 [00:40<00:00,  5.01s/it]
OOV: 0.803040
GEO: 0.818006
=======entity level========

Epoch: 6, P: 0.915412, R: 0.901066, F: 0.908182, OOV: 0.803040, GEO: 0.818006
=======entity level========
Epoch:  12%|█▏        | 6/50 [04:19<31:47, 43.35s/it]P:  0.9154121087403877
R:  0.9010660980810234
F:  0.9081824531241605

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.07s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.11s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.03s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.32s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.28s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.18s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.55s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.808538
GEO: 0.820051
=======entity level========

Epoch: 7, P: 0.921133, R: 0.905224, F: 0.913109, OOV: 0.808538, GEO: 0.820051
=======entity level========
Epoch:  14%|█▍        | 7/50 [05:02<30:58, 43.22s/it]P:  0.9211325667172923
R:  0.905223880597015
F:  0.9131089364447791

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.18s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.56s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.15s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.12s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.17s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.08s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.58s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.809185
GEO: 0.831504
=======entity level========

Epoch: 8, P: 0.920017, R: 0.902559, F: 0.911204, OOV: 0.809185, GEO: 0.831504
=======entity level========
Epoch:  16%|█▌        | 8/50 [05:45<30:12, 43.16s/it]P:  0.9200173875244512
R:  0.9025586353944562
F:  0.9112043913464642

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.02s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.94s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.13s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.08s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.49s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.38s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.71s/it][A100%|██████████| 8/8 [00:40<00:00,  5.02s/it]
OOV: 0.811449
GEO: 0.813060
=======entity level========

Epoch: 9, P: 0.918595, R: 0.905864, F: 0.912185, OOV: 0.811449, GEO: 0.813060
=======entity level========
Epoch:  18%|█▊        | 9/50 [06:29<29:35, 43.31s/it]P:  0.9185945945945946
R:  0.905863539445629
F:  0.9121846484165324

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.87s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.96s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.28s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.19s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.11s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.26s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.62s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.810155
GEO: 0.833118
=======entity level========

Epoch: 10, P: 0.922016, R: 0.905011, F: 0.913434, OOV: 0.810155, GEO: 0.833118
=======entity level========
Epoch:  20%|██        | 10/50 [07:12<28:49, 43.23s/it]P:  0.9220158574997285
R:  0.9050106609808103
F:  0.9134341206219401

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.96s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.23s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.26s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.09s/it][A
 62%|██████▎   | 5/8 [00:25<00:14,  4.98s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.04s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.18s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.66s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.804334
GEO: 0.799746
=======entity level========

Epoch: 11, P: 0.916775, R: 0.904264, F: 0.910477, OOV: 0.804334, GEO: 0.799746
=======entity level========
Epoch:  22%|██▏       | 11/50 [07:55<28:02, 43.13s/it]P:  0.9167747514051016
R:  0.9042643923240938
F:  0.9104765993988835

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.28s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.15s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.09s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.14s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.26s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.55s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.806274
GEO: 0.818182
=======entity level========

Epoch: 12, P: 0.918237, R: 0.903945, F: 0.911035, OOV: 0.806274, GEO: 0.818182
=======entity level========
Epoch:  24%|██▍       | 12/50 [08:38<27:18, 43.11s/it]P:  0.9182369504006931
R:  0.9039445628997868
F:  0.9110347050607069

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.70s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.31s/it][A
 38%|███▊      | 3/8 [00:15<00:24,  4.97s/it][A
 50%|█████     | 4/8 [00:20<00:19,  4.96s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.05s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.08s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.10s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.78s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.804657
GEO: 0.815908
=======entity level========

Epoch: 13, P: 0.920680, R: 0.900853, F: 0.910658, OOV: 0.804657, GEO: 0.815908
=======entity level========
Epoch:  26%|██▌       | 13/50 [09:21<26:36, 43.16s/it]P:  0.9206798866855525
R:  0.9008528784648188
F:  0.9106584761288933

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.95s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.48s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.28s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.23s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.17s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.14s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.11s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.66s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.807568
GEO: 0.826031
=======entity level========

Epoch: 14, P: 0.916811, R: 0.902345, F: 0.909521, OOV: 0.807568, GEO: 0.826031
=======entity level========
Epoch:  28%|██▊       | 14/50 [10:04<25:55, 43.21s/it]P:  0.9168110918544194
R:  0.9023454157782516
F:  0.9095207393079733

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.53s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.40s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.49s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.18s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.15s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.00s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.66s/it][A100%|██████████| 8/8 [00:40<00:00,  5.00s/it]
OOV: 0.807245
GEO: 0.838626
=======entity level========

Epoch: 15, P: 0.919086, R: 0.900959, F: 0.909933, OOV: 0.807245, GEO: 0.838626
=======entity level========
Epoch:  30%|███       | 15/50 [10:49<25:23, 43.52s/it]P:  0.9190864600326264
R:  0.9009594882729212
F:  0.9099327052489906

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.25s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.62s/it][A
 38%|███▊      | 3/8 [00:16<00:26,  5.37s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.27s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.20s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:04,  5.00s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.52s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.805951
GEO: 0.808184
=======entity level========

Epoch: 16, P: 0.913990, R: 0.904051, F: 0.908993, OOV: 0.805951, GEO: 0.808184
=======entity level========
Epoch:  32%|███▏      | 16/50 [11:32<24:35, 43.41s/it]P:  0.9139900840698426
R:  0.9040511727078892
F:  0.908993461249866

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.65s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.38s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.23s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.12s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.61s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.801746
GEO: 0.807668
=======entity level========

Epoch: 17, P: 0.919199, R: 0.899893, F: 0.909444, OOV: 0.801746, GEO: 0.807668
=======entity level========
Epoch:  34%|███▍      | 17/50 [12:15<23:52, 43.39s/it]P:  0.9191985190025046
R:  0.8998933901918976
F:  0.9094435166729515

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.55s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.03s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.05s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.19s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.04s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.22s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.805304
GEO: 0.806122
=======entity level========

Epoch: 18, P: 0.919805, R: 0.903625, F: 0.911643, OOV: 0.805304, GEO: 0.806122
=======entity level========
Epoch:  36%|███▌      | 18/50 [12:58<23:05, 43.29s/it]P:  0.9198046663049376
R:  0.9036247334754798
F:  0.9116429147620329

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.85s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.21s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.31s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.35s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.21s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.57s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.802393
GEO: 0.825048
=======entity level========

Epoch: 19, P: 0.917942, R: 0.901599, F: 0.909697, OOV: 0.802393, GEO: 0.825048
=======entity level========
Epoch:  38%|███▊      | 19/50 [13:41<22:20, 43.23s/it]P:  0.9179420384239662
R:  0.9015991471215352
F:  0.9096971978701662

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.01s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.04s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.19s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.30s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.30s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.35s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.30s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.59s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.806274
GEO: 0.807939
=======entity level========

Epoch: 20, P: 0.917930, R: 0.903838, F: 0.910829, OOV: 0.806274, GEO: 0.807939
=======entity level========
Epoch:  40%|████      | 20/50 [14:25<21:38, 43.27s/it]P:  0.9179298397574708
R:  0.9038379530916845
F:  0.9108293940696176

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.76s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.92s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.96s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.13s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.19s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.18s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.30s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.70s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.806598
GEO: 0.823757
=======entity level========

Epoch: 21, P: 0.919110, R: 0.902452, F: 0.910705, OOV: 0.806598, GEO: 0.823757
=======entity level========
Epoch:  42%|████▏     | 21/50 [15:08<20:52, 43.20s/it]P:  0.9191096634093376
R:  0.902452025586354
F:  0.9107046799354491

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.10s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.08s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.10s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.25s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.806598
GEO: 0.806122
=======entity level========

Epoch: 22, P: 0.916162, R: 0.904051, F: 0.910067, OOV: 0.806598, GEO: 0.806122
=======entity level========
Epoch:  44%|████▍     | 22/50 [15:51<20:08, 43.17s/it]P:  0.916162489196197
R:  0.9040511727078892
F:  0.9100665378836661

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.88s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.91s/it][A
 38%|███▊      | 3/8 [00:14<00:25,  5.01s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.18s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.02s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.11s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.89s/it]
OOV: 0.803040
GEO: 0.803834
=======entity level========

Epoch: 23, P: 0.916495, R: 0.902132, F: 0.909257, OOV: 0.803040, GEO: 0.803834
=======entity level========
Epoch:  46%|████▌     | 23/50 [16:33<19:20, 42.99s/it]P:  0.9164951803314199
R:  0.9021321961620469
F:  0.9092569709342931

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:37,  5.42s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.09s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.14s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.08s/it][A
 62%|██████▎   | 5/8 [00:25<00:14,  4.91s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.12s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.21s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.70s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.800453
GEO: 0.815196
=======entity level========

Epoch: 24, P: 0.917065, R: 0.900640, F: 0.908778, OOV: 0.800453, GEO: 0.815196
=======entity level========
Epoch:  48%|████▊     | 24/50 [17:16<18:38, 43.01s/it]P:  0.9170646982197134
R:  0.9006396588486141
F:  0.9087779690189328

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.09s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.90s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.98s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.07s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.21s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.30s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.18s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.62s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.804981
GEO: 0.818827
=======entity level========

Epoch: 25, P: 0.916892, R: 0.902132, F: 0.909452, OOV: 0.804981, GEO: 0.818827
=======entity level========

Early stop triggered at epoch 24

Epoch:  48%|████▊     | 24/50 [17:59<19:29, 44.99s/it]

=======best f entity level========

Epoch: 15, P: 0.919086, R: 0.900959, F: 0.909933, OOV: 0.807245, GEO: 0.838626, GEO_N: 0.829929


=======best f entity level========
P:  0.9168924043775057
R:  0.9021321961620469
F:  0.9094524154978774
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:01<01:02,  1.02s/it]  3%|▎         | 2/62 [00:01<00:59,  1.01it/s]  5%|▍         | 3/62 [00:02<00:55,  1.07it/s]  6%|▋         | 4/62 [00:03<00:56,  1.02it/s]  8%|▊         | 5/62 [00:05<00:59,  1.04s/it] 10%|▉         | 6/62 [00:06<01:00,  1.09s/it] 11%|█▏        | 7/62 [00:06<00:51,  1.06it/s] 13%|█▎        | 8/62 [00:07<00:46,  1.15it/s] 15%|█▍        | 9/62 [00:08<00:48,  1.08it/s] 16%|█▌        | 10/62 [00:09<00:47,  1.10it/s] 18%|█▊        | 11/62 [00:10<00:53,  1.05s/it] 19%|█▉        | 12/62 [00:11<00:48,  1.03it/s] 21%|██        | 13/62 [00:12<00:51,  1.06s/it] 23%|██▎       | 14/62 [00:14<00:51,  1.07s/it] 24%|██▍       | 15/62 [00:14<00:48,  1.03s/it] 26%|██▌       | 16/62 [00:15<00:40,  1.12it/s] 27%|██▋       | 17/62 [00:16<00:37,  1.21it/s] 29%|██▉       | 18/62 [00:17<00:39,  1.12it/s] 31%|███       | 19/62 [00:18<00:45,  1.07s/it] 32%|███▏      | 20/62 [00:20<00:49,  1.18s/it] 34%|███▍      | 21/62 [00:22<00:57,  1.41s/it] 35%|███▌      | 22/62 [00:23<00:50,  1.27s/it] 37%|███▋      | 23/62 [00:23<00:42,  1.09s/it] 39%|███▊      | 24/62 [00:24<00:42,  1.12s/it] 40%|████      | 25/62 [00:27<00:53,  1.45s/it] 42%|████▏     | 26/62 [00:28<00:49,  1.38s/it] 44%|████▎     | 27/62 [00:29<00:44,  1.26s/it] 45%|████▌     | 28/62 [00:30<00:41,  1.21s/it] 47%|████▋     | 29/62 [00:31<00:39,  1.20s/it] 48%|████▊     | 30/62 [00:32<00:35,  1.11s/it] 50%|█████     | 31/62 [00:33<00:33,  1.08s/it] 52%|█████▏    | 32/62 [00:34<00:28,  1.06it/s] 53%|█████▎    | 33/62 [00:35<00:30,  1.04s/it] 55%|█████▍    | 34/62 [00:36<00:30,  1.10s/it] 56%|█████▋    | 35/62 [00:37<00:28,  1.04s/it] 58%|█████▊    | 36/62 [00:38<00:24,  1.05it/s] 60%|█████▉    | 37/62 [00:38<00:20,  1.24it/s] 61%|██████▏   | 38/62 [00:39<00:20,  1.20it/s] 63%|██████▎   | 39/62 [00:40<00:21,  1.05it/s] 65%|██████▍   | 40/62 [00:41<00:20,  1.06it/s] 66%|██████▌   | 41/62 [00:42<00:19,  1.08it/s] 68%|██████▊   | 42/62 [00:43<00:18,  1.09it/s] 69%|██████▉   | 43/62 [00:44<00:18,  1.03it/s] 71%|███████   | 44/62 [00:45<00:16,  1.08it/s] 73%|███████▎  | 45/62 [00:47<00:19,  1.13s/it] 74%|███████▍  | 46/62 [00:47<00:15,  1.01it/s] 76%|███████▌  | 47/62 [00:48<00:14,  1.07it/s] 77%|███████▋  | 48/62 [00:49<00:12,  1.09it/s] 79%|███████▉  | 49/62 [00:50<00:14,  1.09s/it] 81%|████████  | 50/62 [00:51<00:12,  1.02s/it] 82%|████████▏ | 51/62 [00:52<00:11,  1.04s/it] 84%|████████▍ | 52/62 [00:54<00:10,  1.07s/it] 85%|████████▌ | 53/62 [00:55<00:11,  1.28s/it] 87%|████████▋ | 54/62 [00:56<00:09,  1.17s/it] 89%|████████▊ | 55/62 [00:57<00:07,  1.08s/it] 90%|█████████ | 56/62 [00:58<00:05,  1.01it/s] 92%|█████████▏| 57/62 [00:59<00:04,  1.06it/s] 94%|█████████▎| 58/62 [01:00<00:03,  1.10it/s] 95%|█████████▌| 59/62 [01:00<00:02,  1.10it/s] 97%|█████████▋| 60/62 [01:01<00:01,  1.18it/s] 98%|█████████▊| 61/62 [01:03<00:00,  1.00it/s]100%|██████████| 62/62 [01:03<00:00,  1.04it/s]100%|██████████| 62/62 [01:03<00:00,  1.03s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0_0.84', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.94s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.24s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.21s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.13s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.10s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.18s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.23s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.60s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.665589
GEO: 0.553437
=======entity level========

Epoch: 1, P: 0.822069, R: 0.787100, F: 0.804205, OOV: 0.665589, GEO: 0.553437
=======entity level========
Epoch:   2%|▏         | 1/50 [00:43<35:26, 43.41s/it]P:  0.82206881193631
R:  0.7871002132196162
F:  0.8042045640215674

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.98s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.93s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.95s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.12s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.20s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.22s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.53s/it][A100%|██████████| 8/8 [00:39<00:00,  4.88s/it]
OOV: 0.790427
GEO: 0.814958
=======entity level========

Epoch: 2, P: 0.915041, R: 0.885288, F: 0.899919, OOV: 0.790427, GEO: 0.814958
=======entity level========
Epoch:   4%|▍         | 2/50 [01:26<34:38, 43.31s/it]P:  0.9150413223140496
R:  0.8852878464818763
F:  0.8999187212137632

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.10s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.45s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.16s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.21s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.06s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.57s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.799806
GEO: 0.805627
=======entity level========

Epoch: 3, P: 0.919580, R: 0.897228, F: 0.908267, OOV: 0.799806, GEO: 0.805627
=======entity level========
Epoch:   6%|▌         | 3/50 [02:09<33:49, 43.18s/it]P:  0.9195804195804196
R:  0.897228144989339
F:  0.908266781782862

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.05s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.09s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.49s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.14s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.11s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.51s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.804334
GEO: 0.801017
=======entity level========

Epoch: 4, P: 0.913912, R: 0.902026, F: 0.907930, OOV: 0.804334, GEO: 0.801017
=======entity level========
Epoch:   8%|▊         | 4/50 [02:52<33:00, 43.05s/it]P:  0.9139122920717218
R:  0.9020255863539446
F:  0.9079300354115248

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.07s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.99s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.98s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.07s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.18s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.11s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.60s/it][A100%|██████████| 8/8 [00:39<00:00,  4.90s/it]
OOV: 0.800453
GEO: 0.803059
=======entity level========

Epoch: 5, P: 0.913034, R: 0.899893, F: 0.906416, OOV: 0.800453, GEO: 0.803059
=======entity level========
Epoch:  10%|█         | 5/50 [03:35<32:10, 42.90s/it]P:  0.9130340724716063
R:  0.8998933901918976
F:  0.9064161073825503

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.89s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.12s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.10s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.33s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.24s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.27s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.28s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.807568
GEO: 0.806369
=======entity level========

Epoch: 6, P: 0.914012, R: 0.905437, F: 0.909704, OOV: 0.807568, GEO: 0.806369
=======entity level========
Epoch:  12%|█▏        | 6/50 [04:18<31:34, 43.06s/it]P:  0.914012053379251
R:  0.9054371002132197
F:  0.9097043701799485

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.06s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.09s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.03s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.29s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.26s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.18s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.18s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.56s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.802393
GEO: 0.829142
=======entity level========

Epoch: 7, P: 0.922657, R: 0.900426, F: 0.911406, OOV: 0.802393, GEO: 0.829142
=======entity level========
Epoch:  14%|█▍        | 7/50 [05:02<30:59, 43.24s/it]P:  0.9226567620712257
R:  0.9004264392324094
F:  0.9114060645300528

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.14s/it][A
 25%|██▌       | 2/8 [00:10<00:33,  5.56s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.18s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.12s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.19s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.08s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.58s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.807568
GEO: 0.818182
=======entity level========

Epoch: 8, P: 0.917534, R: 0.902665, F: 0.910039, OOV: 0.807568, GEO: 0.818182
=======entity level========
Epoch:  16%|█▌        | 8/50 [05:45<30:13, 43.18s/it]P:  0.9175335934113568
R:  0.9026652452025586
F:  0.9100386930352536

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.03s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.93s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.12s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.10s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.49s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.39s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.74s/it][A100%|██████████| 8/8 [00:40<00:00,  5.03s/it]
OOV: 0.806598
GEO: 0.799489
=======entity level========

Epoch: 9, P: 0.915577, R: 0.902985, F: 0.909237, OOV: 0.806598, GEO: 0.799489
=======entity level========
Epoch:  18%|█▊        | 9/50 [06:28<29:37, 43.35s/it]P:  0.915576694411415
R:  0.9029850746268657
F:  0.909237292684236

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.81s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.95s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.28s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.18s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.13s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.23s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.30s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.805951
GEO: 0.812020
=======entity level========

Epoch: 10, P: 0.917143, R: 0.906290, F: 0.911684, OOV: 0.805951, GEO: 0.812020
=======entity level========
Epoch:  20%|██        | 10/50 [07:12<28:52, 43.30s/it]P:  0.9171431653900097
R:  0.9062899786780384
F:  0.9116842726151536

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.99s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.26s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.32s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.13s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.02s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.06s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.806921
GEO: 0.806883
=======entity level========

Epoch: 11, P: 0.915652, R: 0.906183, F: 0.910893, OOV: 0.806921, GEO: 0.806883
=======entity level========
Epoch:  22%|██▏       | 11/50 [07:55<28:05, 43.21s/it]P:  0.9156522675859097
R:  0.906183368869936
F:  0.910893211166479

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.19s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.11s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.07s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.19s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.13s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.27s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.54s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.804334
GEO: 0.816431
=======entity level========

Epoch: 12, P: 0.919357, R: 0.901812, F: 0.910500, OOV: 0.804334, GEO: 0.816431
=======entity level========
Epoch:  24%|██▍       | 12/50 [08:37<27:17, 43.09s/it]P:  0.919356591674818
R:  0.9018123667377399
F:  0.9104999730907917

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.62s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.28s/it][A
 38%|███▊      | 3/8 [00:15<00:24,  4.96s/it][A
 50%|█████     | 4/8 [00:20<00:19,  4.96s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.04s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.11s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.13s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.79s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.804657
GEO: 0.827853
=======entity level========

Epoch: 13, P: 0.921354, R: 0.899254, F: 0.910170, OOV: 0.804657, GEO: 0.827853
=======entity level========
Epoch:  26%|██▌       | 13/50 [09:21<26:36, 43.15s/it]P:  0.9213544511196068
R:  0.8992537313432836
F:  0.9101699487456164

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.93s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.46s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.27s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.25s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.16s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.11s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.69s/it][A100%|██████████| 8/8 [00:40<00:00,  5.00s/it]
OOV: 0.809185
GEO: 0.821039
=======entity level========

Epoch: 14, P: 0.918502, R: 0.902345, F: 0.910352, OOV: 0.809185, GEO: 0.821039
=======entity level========
Epoch:  28%|██▊       | 14/50 [10:04<25:56, 43.24s/it]P:  0.9185024416711883
R:  0.9023454157782516
F:  0.9103522452272116

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.56s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.37s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.49s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.16s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:04,  5.00s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.67s/it][A100%|██████████| 8/8 [00:40<00:00,  5.01s/it]
OOV: 0.811125
GEO: 0.831403
=======entity level========

Epoch: 15, P: 0.918781, R: 0.903305, F: 0.910977, OOV: 0.811125, GEO: 0.831403
=======entity level========
Epoch:  30%|███       | 15/50 [10:48<25:24, 43.55s/it]P:  0.9187811754500108
R:  0.9033049040511727
F:  0.9109773142672831

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.28s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.61s/it][A
 38%|███▊      | 3/8 [00:16<00:26,  5.38s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.30s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.19s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.00s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.50s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.811772
GEO: 0.813820
=======entity level========

Epoch: 16, P: 0.915804, R: 0.905650, F: 0.910699, OOV: 0.811772, GEO: 0.813820
=======entity level========
Epoch:  32%|███▏      | 16/50 [11:31<24:35, 43.40s/it]P:  0.9158042259594653
R:  0.9056503198294243
F:  0.9106989708404803

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.67s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.41s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.23s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.22s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.20s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.14s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.61s/it][A100%|██████████| 8/8 [00:39<00:00,  5.00s/it]
OOV: 0.806921
GEO: 0.820743
=======entity level========

Epoch: 17, P: 0.918887, R: 0.900959, F: 0.909835, OOV: 0.806921, GEO: 0.820743
=======entity level========
Epoch:  34%|███▍      | 17/50 [12:15<23:52, 43.41s/it]P:  0.9188865934543873
R:  0.9009594882729212
F:  0.9098347418851267

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.51s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.01s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.02s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.16s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.01s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.17s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.21s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.806921
GEO: 0.812500
=======entity level========

Epoch: 18, P: 0.920100, R: 0.904797, F: 0.912384, OOV: 0.806921, GEO: 0.812500
=======entity level========
Epoch:  36%|███▌      | 18/50 [12:58<23:04, 43.28s/it]P:  0.9200997398091935
R:  0.9047974413646055
F:  0.9123844334551708

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.82s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.25s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.33s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.35s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.24s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.59s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.805304
GEO: 0.825723
=======entity level========

Epoch: 19, P: 0.917825, R: 0.901386, F: 0.909531, OOV: 0.805304, GEO: 0.825723
=======entity level========
Epoch:  38%|███▊      | 19/50 [13:41<22:21, 43.27s/it]P:  0.9178245766391663
R:  0.9013859275053305
F:  0.9095309810671257

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.10s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.05s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.22s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.36s/it][A
 62%|██████▎   | 5/8 [00:26<00:16,  5.40s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.40s/it][A
 88%|████████▊ | 7/8 [00:37<00:05,  5.34s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.61s/it][A100%|██████████| 8/8 [00:40<00:00,  5.03s/it]
OOV: 0.807245
GEO: 0.820743
=======entity level========

Epoch: 20, P: 0.917859, R: 0.902985, F: 0.910361, OOV: 0.807245, GEO: 0.820743
=======entity level========
Epoch:  40%|████      | 20/50 [14:25<21:42, 43.40s/it]P:  0.9178586909406156
R:  0.9029850746268657
F:  0.9103611349957007

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.78s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.93s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.98s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.14s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.20s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.18s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.31s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.69s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.801423
GEO: 0.815434
=======entity level========

Epoch: 21, P: 0.918596, R: 0.901066, F: 0.909747, OOV: 0.801423, GEO: 0.815434
=======entity level========
Epoch:  42%|████▏     | 21/50 [15:08<20:55, 43.31s/it]P:  0.9185958048038256
R:  0.9010660980810234
F:  0.9097465152575211

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.11s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.07s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.12s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.24s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.804334
GEO: 0.797452
=======entity level========

Epoch: 22, P: 0.913442, R: 0.903412, F: 0.908399, OOV: 0.804334, GEO: 0.797452
=======entity level========
Epoch:  44%|████▍     | 22/50 [15:51<20:10, 43.25s/it]P:  0.9134418454241673
R:  0.9034115138592751
F:  0.9083989923353165

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.90s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.94s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.04s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.04s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.15s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.14s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.802393
GEO: 0.806390
=======entity level========

Epoch: 23, P: 0.917380, R: 0.902026, F: 0.909638, OOV: 0.802393, GEO: 0.806390
=======entity level========
Epoch:  46%|████▌     | 23/50 [16:34<19:23, 43.11s/it]P:  0.9173804618887563
R:  0.9020255863539446
F:  0.9096382303929474

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:37,  5.40s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.18s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.21s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.12s/it][A
 62%|██████▎   | 5/8 [00:25<00:14,  4.96s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.16s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.23s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.72s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.798836
GEO: 0.808456
=======entity level========

Epoch: 24, P: 0.914134, R: 0.901173, F: 0.907607, OOV: 0.798836, GEO: 0.808456
=======entity level========
Epoch:  48%|████▊     | 24/50 [17:17<18:42, 43.17s/it]P:  0.9141343138315129
R:  0.9011727078891258
F:  0.9076072368067858

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.12s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.94s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.99s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.08s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.21s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.34s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.20s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.801746
GEO: 0.812862
=======entity level========

Epoch: 25, P: 0.916486, R: 0.900853, F: 0.908602, OOV: 0.801746, GEO: 0.812862
=======entity level========

Early stop triggered at epoch 24

Epoch:  48%|████▊     | 24/50 [18:00<19:30, 45.03s/it]

=======best f entity level========

Epoch: 15, P: 0.918781, R: 0.903305, F: 0.910977, OOV: 0.811125, GEO: 0.831403, GEO_N: 0.829532


=======best f entity level========
P:  0.9164859002169198
R:  0.9008528784648188
F:  0.9086021505376344
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:01<01:02,  1.02s/it]  3%|▎         | 2/62 [00:01<00:59,  1.01it/s]  5%|▍         | 3/62 [00:02<00:55,  1.07it/s]  6%|▋         | 4/62 [00:03<00:56,  1.02it/s]  8%|▊         | 5/62 [00:05<00:59,  1.04s/it] 10%|▉         | 6/62 [00:06<01:00,  1.08s/it] 11%|█▏        | 7/62 [00:06<00:51,  1.07it/s] 13%|█▎        | 8/62 [00:07<00:46,  1.16it/s] 15%|█▍        | 9/62 [00:08<00:48,  1.09it/s] 16%|█▌        | 10/62 [00:09<00:47,  1.10it/s] 18%|█▊        | 11/62 [00:10<00:53,  1.05s/it] 19%|█▉        | 12/62 [00:11<00:48,  1.03it/s] 21%|██        | 13/62 [00:12<00:51,  1.06s/it] 23%|██▎       | 14/62 [00:13<00:51,  1.07s/it] 24%|██▍       | 15/62 [00:14<00:48,  1.03s/it] 26%|██▌       | 16/62 [00:15<00:40,  1.12it/s] 27%|██▋       | 17/62 [00:16<00:37,  1.21it/s] 29%|██▉       | 18/62 [00:17<00:39,  1.12it/s] 31%|███       | 19/62 [00:18<00:45,  1.07s/it] 32%|███▏      | 20/62 [00:20<00:49,  1.18s/it] 34%|███▍      | 21/62 [00:22<00:57,  1.41s/it] 35%|███▌      | 22/62 [00:23<00:51,  1.28s/it] 37%|███▋      | 23/62 [00:23<00:42,  1.09s/it] 39%|███▊      | 24/62 [00:24<00:42,  1.12s/it] 40%|████      | 25/62 [00:27<00:53,  1.45s/it] 42%|████▏     | 26/62 [00:28<00:49,  1.38s/it] 44%|████▎     | 27/62 [00:29<00:44,  1.26s/it] 45%|████▌     | 28/62 [00:30<00:41,  1.21s/it] 47%|████▋     | 29/62 [00:31<00:39,  1.20s/it] 48%|████▊     | 30/62 [00:32<00:35,  1.11s/it] 50%|█████     | 31/62 [00:33<00:33,  1.08s/it] 52%|█████▏    | 32/62 [00:34<00:28,  1.06it/s] 53%|█████▎    | 33/62 [00:35<00:30,  1.04s/it] 55%|█████▍    | 34/62 [00:36<00:30,  1.10s/it] 56%|█████▋    | 35/62 [00:37<00:28,  1.04s/it] 58%|█████▊    | 36/62 [00:38<00:24,  1.05it/s] 60%|█████▉    | 37/62 [00:38<00:20,  1.24it/s] 61%|██████▏   | 38/62 [00:39<00:20,  1.20it/s] 63%|██████▎   | 39/62 [00:40<00:21,  1.05it/s] 65%|██████▍   | 40/62 [00:41<00:20,  1.07it/s] 66%|██████▌   | 41/62 [00:42<00:19,  1.08it/s] 68%|██████▊   | 42/62 [00:43<00:18,  1.09it/s] 69%|██████▉   | 43/62 [00:44<00:18,  1.03it/s] 71%|███████   | 44/62 [00:45<00:16,  1.08it/s] 73%|███████▎  | 45/62 [00:47<00:19,  1.13s/it] 74%|███████▍  | 46/62 [00:47<00:15,  1.01it/s] 76%|███████▌  | 47/62 [00:48<00:14,  1.07it/s] 77%|███████▋  | 48/62 [00:49<00:12,  1.09it/s] 79%|███████▉  | 49/62 [00:50<00:14,  1.09s/it] 81%|████████  | 50/62 [00:51<00:12,  1.02s/it] 82%|████████▏ | 51/62 [00:52<00:11,  1.04s/it] 84%|████████▍ | 52/62 [00:53<00:10,  1.07s/it] 85%|████████▌ | 53/62 [00:55<00:11,  1.28s/it] 87%|████████▋ | 54/62 [00:56<00:09,  1.17s/it] 89%|████████▊ | 55/62 [00:57<00:07,  1.08s/it] 90%|█████████ | 56/62 [00:58<00:05,  1.01it/s] 92%|█████████▏| 57/62 [00:59<00:04,  1.06it/s] 94%|█████████▎| 58/62 [00:59<00:03,  1.10it/s] 95%|█████████▌| 59/62 [01:00<00:02,  1.10it/s] 97%|█████████▋| 60/62 [01:01<00:01,  1.18it/s] 98%|█████████▊| 61/62 [01:02<00:00,  1.00it/s]100%|██████████| 62/62 [01:03<00:00,  1.04it/s]100%|██████████| 62/62 [01:03<00:00,  1.03s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0_0.85', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.97s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.24s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.22s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.12s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.12s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.17s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.21s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.59s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.665589
GEO: 0.553437
=======entity level========

Epoch: 1, P: 0.822750, R: 0.787313, F: 0.804642, OOV: 0.665589, GEO: 0.553437
=======entity level========
Epoch:   2%|▏         | 1/50 [00:43<35:25, 43.37s/it]P:  0.8227495543672014
R:  0.7873134328358209
F:  0.8046415341032905

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.95s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.91s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.95s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.10s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.17s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:38<00:00,  4.53s/it][A100%|██████████| 8/8 [00:38<00:00,  4.87s/it]
OOV: 0.790427
GEO: 0.814958
=======entity level========

Epoch: 2, P: 0.915656, R: 0.885394, F: 0.900271, OOV: 0.790427, GEO: 0.814958
=======entity level========
Epoch:   4%|▍         | 2/50 [01:26<34:38, 43.30s/it]P:  0.9156560088202866
R:  0.8853944562899787
F:  0.900271002710027

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.05s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.50s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.16s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.22s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.22s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.09s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.60s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.799483
GEO: 0.806142
=======entity level========

Epoch: 3, P: 0.919554, R: 0.896908, F: 0.908090, OOV: 0.799483, GEO: 0.806142
=======entity level========
Epoch:   6%|▌         | 3/50 [02:09<33:53, 43.26s/it]P:  0.9195540496229097
R:  0.896908315565032
F:  0.9080900210480868

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.00s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.08s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.48s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.20s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.10s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.47s/it][A100%|██████████| 8/8 [00:39<00:00,  4.90s/it]
OOV: 0.805627
GEO: 0.805856
=======entity level========

Epoch: 4, P: 0.914560, R: 0.902665, F: 0.908574, OOV: 0.805627, GEO: 0.805856
=======entity level========
Epoch:   8%|▊         | 4/50 [02:52<32:59, 43.02s/it]P:  0.9145603802117088
R:  0.9026652452025586
F:  0.9085738813177379

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.08s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.03s/it][A
 38%|███▊      | 3/8 [00:15<00:24,  5.00s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.09s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.16s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.802070
GEO: 0.829677
=======entity level========

Epoch: 5, P: 0.916920, R: 0.898934, F: 0.907838, OOV: 0.802070, GEO: 0.829677
=======entity level========
Epoch:  10%|█         | 5/50 [03:36<32:25, 43.23s/it]P:  0.9169204001739887
R:  0.8989339019189766
F:  0.9078380706287684

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.87s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.08s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.07s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.28s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.24s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.27s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.27s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.803687
GEO: 0.806122
=======entity level========

Epoch: 6, P: 0.914141, R: 0.903518, F: 0.908798, OOV: 0.803687, GEO: 0.806122
=======entity level========
Epoch:  12%|█▏        | 6/50 [04:19<31:43, 43.25s/it]P:  0.9141408693776292
R:  0.9035181236673774
F:  0.9087984558468715

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.10s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.14s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.06s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.30s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.27s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.19s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.55s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.803040
GEO: 0.827853
=======entity level========

Epoch: 7, P: 0.921443, R: 0.901599, F: 0.911413, OOV: 0.803040, GEO: 0.827853
=======entity level========
Epoch:  14%|█▍        | 7/50 [05:02<30:55, 43.16s/it]P:  0.9214425800828067
R:  0.9015991471215352
F:  0.911412867765923

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.13s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.58s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.17s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.11s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.08s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.57s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.805627
GEO: 0.798479
=======entity level========

Epoch: 8, P: 0.916270, R: 0.902985, F: 0.909579, OOV: 0.805627, GEO: 0.798479
=======entity level========
Epoch:  16%|█▌        | 8/50 [05:45<30:10, 43.11s/it]P:  0.9162700129813933
R:  0.9029850746268657
F:  0.9095790378006873

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.04s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.93s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.14s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.08s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.22s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.49s/it][A
 88%|████████▊ | 7/8 [00:37<00:05,  5.41s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.74s/it][A100%|██████████| 8/8 [00:40<00:00,  5.04s/it]
OOV: 0.807568
GEO: 0.808701
=======entity level========

Epoch: 9, P: 0.917244, R: 0.902772, F: 0.909951, OOV: 0.807568, GEO: 0.808701
=======entity level========
Epoch:  18%|█▊        | 9/50 [06:29<29:36, 43.32s/it]P:  0.9172443674176777
R:  0.9027718550106609
F:  0.9099505695250375

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.80s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.94s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.29s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.20s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.14s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.26s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.29s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.805627
GEO: 0.825806
=======entity level========

Epoch: 10, P: 0.920790, R: 0.904691, F: 0.912669, OOV: 0.805627, GEO: 0.825806
=======entity level========
Epoch:  20%|██        | 10/50 [07:12<28:51, 43.28s/it]P:  0.9207899305555556
R:  0.9046908315565032
F:  0.9126693912669391

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.95s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.23s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.28s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.11s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.01s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.06s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.18s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.800776
GEO: 0.785082
=======entity level========

Epoch: 11, P: 0.913695, R: 0.904051, F: 0.908847, OOV: 0.800776, GEO: 0.785082
=======entity level========
Epoch:  22%|██▏       | 11/50 [07:55<28:04, 43.19s/it]P:  0.913694644973602
R:  0.9040511727078892
F:  0.9088473286533412

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:37,  5.33s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.17s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.12s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.24s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.27s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.19s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.55s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.804981
GEO: 0.816092
=======entity level========

Epoch: 12, P: 0.918347, R: 0.902878, F: 0.910547, OOV: 0.804981, GEO: 0.816092
=======entity level========
Epoch:  24%|██▍       | 12/50 [08:38<27:19, 43.14s/it]P:  0.9183474300585557
R:  0.9028784648187633
F:  0.9105472529835502

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.64s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.29s/it][A
 38%|███▊      | 3/8 [00:15<00:24,  4.96s/it][A
 50%|█████     | 4/8 [00:20<00:19,  4.94s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.04s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.09s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.11s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.80s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.804334
GEO: 0.822094
=======entity level========

Epoch: 13, P: 0.921892, R: 0.899680, F: 0.910651, OOV: 0.804334, GEO: 0.822094
=======entity level========
Epoch:  26%|██▌       | 13/50 [09:21<26:37, 43.18s/it]P:  0.9218920690408564
R:  0.8996801705756929
F:  0.9106506960181288

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.96s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.50s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.30s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.24s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.17s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.15s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.10s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.806598
GEO: 0.817191
=======entity level========

Epoch: 14, P: 0.918992, R: 0.902239, F: 0.910538, OOV: 0.806598, GEO: 0.817191
=======entity level========
Epoch:  28%|██▊       | 14/50 [10:04<25:56, 43.22s/it]P:  0.9189922901509393
R:  0.9022388059701493
F:  0.9105384905051375

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.59s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.38s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.47s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.19s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.14s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.01s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.67s/it][A100%|██████████| 8/8 [00:40<00:00,  5.01s/it]
OOV: 0.804657
GEO: 0.820809
=======entity level========

Epoch: 15, P: 0.918605, R: 0.901173, F: 0.909805, OOV: 0.804657, GEO: 0.820809
=======entity level========

Early stop triggered at epoch 14

Epoch:  28%|██▊       | 14/50 [10:48<27:47, 46.32s/it]

=======best f entity level========

Epoch: 5, P: 0.916920, R: 0.898934, F: 0.907838, OOV: 0.802070, GEO: 0.829677, GEO_N: 0.823674


=======best f entity level========
P:  0.9186046511627907
R:  0.9011727078891258
F:  0.9098051878161663
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:01<01:02,  1.02s/it]  3%|▎         | 2/62 [00:01<00:59,  1.01it/s]  5%|▍         | 3/62 [00:02<00:55,  1.07it/s]  6%|▋         | 4/62 [00:03<00:56,  1.02it/s]  8%|▊         | 5/62 [00:05<00:59,  1.04s/it] 10%|▉         | 6/62 [00:06<01:00,  1.09s/it] 11%|█▏        | 7/62 [00:06<00:51,  1.06it/s] 13%|█▎        | 8/62 [00:07<00:46,  1.15it/s] 15%|█▍        | 9/62 [00:08<00:48,  1.08it/s] 16%|█▌        | 10/62 [00:09<00:47,  1.10it/s] 18%|█▊        | 11/62 [00:10<00:53,  1.05s/it] 19%|█▉        | 12/62 [00:11<00:48,  1.03it/s] 21%|██        | 13/62 [00:12<00:52,  1.06s/it] 23%|██▎       | 14/62 [00:14<00:51,  1.07s/it] 24%|██▍       | 15/62 [00:14<00:48,  1.03s/it] 26%|██▌       | 16/62 [00:15<00:40,  1.12it/s] 27%|██▋       | 17/62 [00:16<00:37,  1.20it/s] 29%|██▉       | 18/62 [00:17<00:39,  1.12it/s] 31%|███       | 19/62 [00:18<00:45,  1.07s/it] 32%|███▏      | 20/62 [00:20<00:49,  1.18s/it] 34%|███▍      | 21/62 [00:22<00:57,  1.41s/it] 35%|███▌      | 22/62 [00:23<00:51,  1.28s/it] 37%|███▋      | 23/62 [00:23<00:42,  1.09s/it] 39%|███▊      | 24/62 [00:24<00:42,  1.12s/it] 40%|████      | 25/62 [00:27<00:53,  1.45s/it] 42%|████▏     | 26/62 [00:28<00:49,  1.38s/it] 44%|████▎     | 27/62 [00:29<00:44,  1.26s/it] 45%|████▌     | 28/62 [00:30<00:41,  1.21s/it] 47%|████▋     | 29/62 [00:31<00:39,  1.20s/it] 48%|████▊     | 30/62 [00:32<00:35,  1.11s/it] 50%|█████     | 31/62 [00:33<00:33,  1.08s/it] 52%|█████▏    | 32/62 [00:34<00:28,  1.06it/s] 53%|█████▎    | 33/62 [00:35<00:30,  1.04s/it] 55%|█████▍    | 34/62 [00:36<00:30,  1.10s/it] 56%|█████▋    | 35/62 [00:37<00:28,  1.04s/it] 58%|█████▊    | 36/62 [00:38<00:24,  1.05it/s] 60%|█████▉    | 37/62 [00:38<00:20,  1.24it/s] 61%|██████▏   | 38/62 [00:39<00:20,  1.19it/s] 63%|██████▎   | 39/62 [00:40<00:21,  1.05it/s] 65%|██████▍   | 40/62 [00:41<00:20,  1.06it/s] 66%|██████▌   | 41/62 [00:42<00:19,  1.08it/s] 68%|██████▊   | 42/62 [00:43<00:18,  1.09it/s] 69%|██████▉   | 43/62 [00:44<00:18,  1.03it/s] 71%|███████   | 44/62 [00:45<00:16,  1.08it/s] 73%|███████▎  | 45/62 [00:47<00:19,  1.13s/it] 74%|███████▍  | 46/62 [00:47<00:15,  1.01it/s] 76%|███████▌  | 47/62 [00:48<00:14,  1.07it/s] 77%|███████▋  | 48/62 [00:49<00:12,  1.09it/s] 79%|███████▉  | 49/62 [00:51<00:14,  1.09s/it] 81%|████████  | 50/62 [00:51<00:12,  1.02s/it] 82%|████████▏ | 51/62 [00:52<00:11,  1.04s/it] 84%|████████▍ | 52/62 [00:54<00:10,  1.07s/it] 85%|████████▌ | 53/62 [00:55<00:11,  1.28s/it] 87%|████████▋ | 54/62 [00:56<00:09,  1.17s/it] 89%|████████▊ | 55/62 [00:57<00:07,  1.08s/it] 90%|█████████ | 56/62 [00:58<00:05,  1.01it/s] 92%|█████████▏| 57/62 [00:59<00:04,  1.06it/s] 94%|█████████▎| 58/62 [01:00<00:03,  1.10it/s] 95%|█████████▌| 59/62 [01:00<00:02,  1.10it/s] 97%|█████████▋| 60/62 [01:01<00:01,  1.18it/s] 98%|█████████▊| 61/62 [01:03<00:01,  1.00s/it]100%|██████████| 62/62 [01:03<00:00,  1.04it/s]100%|██████████| 62/62 [01:03<00:00,  1.03s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0_0.86', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.94s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.23s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.20s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.12s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.10s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.17s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.20s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.59s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.664618
GEO: 0.556713
=======entity level========

Epoch: 1, P: 0.822081, R: 0.786674, F: 0.803988, OOV: 0.664618, GEO: 0.556713
=======entity level========
Epoch:   2%|▏         | 1/50 [00:43<35:22, 43.32s/it]P:  0.8220811051693404
R:  0.7866737739872068
F:  0.8039877969056439

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.99s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.93s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.94s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.11s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:38<00:00,  4.50s/it][A100%|██████████| 8/8 [00:38<00:00,  4.86s/it]
OOV: 0.787840
GEO: 0.809003
=======entity level========

Epoch: 2, P: 0.914078, R: 0.884648, F: 0.899122, OOV: 0.787840, GEO: 0.809003
=======entity level========
Epoch:   4%|▍         | 2/50 [01:26<34:32, 43.18s/it]P:  0.9140779907468606
R:  0.8846481876332623
F:  0.8991223317802578

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.09s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.46s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.15s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.23s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.22s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.08s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.59s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.799806
GEO: 0.807422
=======entity level========

Epoch: 3, P: 0.918031, R: 0.896695, F: 0.907238, OOV: 0.799806, GEO: 0.807422
=======entity level========
Epoch:   6%|▌         | 3/50 [02:09<33:48, 43.16s/it]P:  0.9180309975987776
R:  0.8966950959488273
F:  0.9072376226944235

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.02s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.07s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.46s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.20s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.22s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.14s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.11s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.48s/it][A100%|██████████| 8/8 [00:39<00:00,  4.91s/it]
OOV: 0.806921
GEO: 0.806616
=======entity level========

Epoch: 4, P: 0.914381, R: 0.902878, F: 0.908593, OOV: 0.806921, GEO: 0.806616
=======entity level========
Epoch:   8%|▊         | 4/50 [02:52<32:57, 42.98s/it]P:  0.9143813431224358
R:  0.9028784648187633
F:  0.9085934985516575

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.08s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.02s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.00s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.07s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.18s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.62s/it][A100%|██████████| 8/8 [00:39<00:00,  4.91s/it]
OOV: 0.803687
GEO: 0.816431
=======entity level========

Epoch: 5, P: 0.915537, R: 0.900213, F: 0.907811, OOV: 0.803687, GEO: 0.816431
=======entity level========
Epoch:  10%|█         | 5/50 [03:35<32:24, 43.20s/it]P:  0.9155372438469045
R:  0.9002132196162047
F:  0.9078105681879267

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.91s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.14s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.12s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.31s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.24s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.27s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.27s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.804010
GEO: 0.807398
=======entity level========

Epoch: 6, P: 0.914616, R: 0.903305, F: 0.908925, OOV: 0.804010, GEO: 0.807398
=======entity level========
Epoch:  12%|█▏        | 6/50 [04:19<31:43, 43.26s/it]P:  0.9146157167530224
R:  0.9033049040511727
F:  0.908925123364085

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.08s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.11s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.05s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.31s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.27s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.18s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.55s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.807245
GEO: 0.819231
=======entity level========

Epoch: 7, P: 0.919154, R: 0.902985, F: 0.910998, OOV: 0.807245, GEO: 0.819231
=======entity level========
Epoch:  14%|█▍        | 7/50 [05:02<31:07, 43.43s/it]P:  0.919153553988063
R:  0.9029850746268657
F:  0.9109975799946222

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.15s/it][A
 25%|██▌       | 2/8 [00:10<00:33,  5.53s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.14s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.11s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.17s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.09s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.61s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.807245
GEO: 0.805079
=======entity level========

Epoch: 8, P: 0.915287, R: 0.901919, F: 0.908554, OOV: 0.807245, GEO: 0.805079
=======entity level========
Epoch:  16%|█▌        | 8/50 [05:46<30:19, 43.33s/it]P:  0.9152872444011685
R:  0.9019189765458422
F:  0.9085539386779788

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.05s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.92s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.12s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.10s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.25s/it][A
 75%|███████▌  | 6/8 [00:31<00:11,  5.50s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.39s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.72s/it][A100%|██████████| 8/8 [00:40<00:00,  5.03s/it]
OOV: 0.807891
GEO: 0.828608
=======entity level========

Epoch: 9, P: 0.917790, R: 0.899787, F: 0.908699, OOV: 0.807891, GEO: 0.828608
=======entity level========
Epoch:  18%|█▊        | 9/50 [06:30<29:51, 43.69s/it]P:  0.9177903436276642
R:  0.8997867803837953
F:  0.9086993970714901

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.81s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.97s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.28s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.20s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.12s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.23s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.28s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.66s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.809185
GEO: 0.829049
=======entity level========

Epoch: 10, P: 0.921224, R: 0.905117, F: 0.913100, OOV: 0.809185, GEO: 0.829049
=======entity level========
Epoch:  20%|██        | 10/50 [07:14<29:12, 43.80s/it]P:  0.9212239583333334
R:  0.9051172707889126
F:  0.9130995913099592

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.92s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.22s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.27s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.10s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.02s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.06s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.805627
GEO: 0.813538
=======entity level========

Epoch: 11, P: 0.920921, R: 0.903838, F: 0.912300, OOV: 0.805627, GEO: 0.813538
=======entity level========
Epoch:  22%|██▏       | 11/50 [07:57<28:17, 43.52s/it]P:  0.9209211383880078
R:  0.9038379530916845
F:  0.91229958032928

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.21s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.12s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.10s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.22s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.14s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.26s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.53s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.810479
GEO: 0.795699
=======entity level========

Epoch: 12, P: 0.915054, R: 0.907249, F: 0.911135, OOV: 0.810479, GEO: 0.795699
=======entity level========
Epoch:  24%|██▍       | 12/50 [08:40<27:25, 43.30s/it]P:  0.9150537634408602
R:  0.9072494669509595
F:  0.9111349036402571

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.69s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.33s/it][A
 38%|███▊      | 3/8 [00:15<00:24,  4.97s/it][A
 50%|█████     | 4/8 [00:20<00:19,  4.98s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.05s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.10s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.81s/it][A100%|██████████| 8/8 [00:39<00:00,  5.00s/it]
OOV: 0.804981
GEO: 0.826564
=======entity level========

Epoch: 13, P: 0.922741, R: 0.900213, F: 0.911338, OOV: 0.804981, GEO: 0.826564
=======entity level========
Epoch:  26%|██▌       | 13/50 [09:23<26:43, 43.34s/it]P:  0.9227406840782428
R:  0.9002132196162047
F:  0.9113377583508715

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.96s/it][A
 25%|██▌       | 2/8 [00:10<00:33,  5.53s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.33s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.27s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.16s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.11s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.66s/it][A100%|██████████| 8/8 [00:39<00:00,  5.00s/it]
OOV: 0.811125
GEO: 0.817425
=======entity level========

Epoch: 14, P: 0.917334, R: 0.903838, F: 0.910536, OOV: 0.811125, GEO: 0.817425
=======entity level========
Epoch:  28%|██▊       | 14/50 [10:07<26:01, 43.37s/it]P:  0.9173339104090024
R:  0.9038379530916845
F:  0.9105359252497046

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.54s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.33s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.43s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.17s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.13s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.12s/it][A
 88%|████████▊ | 7/8 [00:35<00:04,  4.97s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.66s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.811772
GEO: 0.828829
=======entity level========

Epoch: 15, P: 0.918963, R: 0.903092, F: 0.910958, OOV: 0.811772, GEO: 0.828829
=======entity level========
Epoch:  30%|███       | 15/50 [10:50<25:17, 43.35s/it]P:  0.9189628986765025
R:  0.903091684434968
F:  0.9109581675448973

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.28s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.62s/it][A
 38%|███▊      | 3/8 [00:16<00:26,  5.37s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.29s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.19s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.12s/it][A
 88%|████████▊ | 7/8 [00:36<00:04,  4.98s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.47s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.814036
GEO: 0.793430
=======entity level========

Epoch: 16, P: 0.915879, R: 0.908849, F: 0.912350, OOV: 0.814036, GEO: 0.793430
=======entity level========
Epoch:  32%|███▏      | 16/50 [11:33<24:29, 43.22s/it]P:  0.9158788139235067
R:  0.9088486140724946
F:  0.9123501712328768

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.65s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.39s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.22s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.19s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.12s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.62s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.812096
GEO: 0.827232
=======entity level========

Epoch: 17, P: 0.921033, R: 0.905224, F: 0.913060, OOV: 0.812096, GEO: 0.827232
=======entity level========
Epoch:  34%|███▍      | 17/50 [12:16<23:48, 43.28s/it]P:  0.9210326499620349
R:  0.905223880597015
F:  0.9130598419269853

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.55s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.02s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.01s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.14s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.01s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.18s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.21s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.805627
GEO: 0.822622
=======entity level========

Epoch: 18, P: 0.921861, R: 0.901812, F: 0.911727, OOV: 0.805627, GEO: 0.822622
=======entity level========
Epoch:  36%|███▌      | 18/50 [12:59<23:01, 43.18s/it]P:  0.9218613775065388
R:  0.9018123667377399
F:  0.9117266652295754

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.84s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.22s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.32s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.36s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.22s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.57s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.810155
GEO: 0.818182
=======entity level========

Epoch: 19, P: 0.917441, R: 0.905117, F: 0.911238, OOV: 0.810155, GEO: 0.818182
=======entity level========
Epoch:  38%|███▊      | 19/50 [13:42<22:18, 43.18s/it]P:  0.9174411065485195
R:  0.9051172707889126
F:  0.9112375228077707

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.01s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.02s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.18s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.31s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.31s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.34s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.28s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.57s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.805304
GEO: 0.810433
=======entity level========

Epoch: 20, P: 0.922222, R: 0.902559, F: 0.912284, OOV: 0.805304, GEO: 0.810433
=======entity level========

Early stop triggered at epoch 19

Epoch:  38%|███▊      | 19/50 [14:26<23:33, 45.59s/it]

=======best f entity level========

Epoch: 10, P: 0.921224, R: 0.905117, F: 0.913100, OOV: 0.809185, GEO: 0.829049, GEO_N: 0.825117


=======best f entity level========
P:  0.9222222222222223
R:  0.9025586353944562
F:  0.9122844827586206
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:01<01:02,  1.02s/it]  3%|▎         | 2/62 [00:01<00:59,  1.01it/s]  5%|▍         | 3/62 [00:02<00:55,  1.07it/s]  6%|▋         | 4/62 [00:03<00:56,  1.02it/s]  8%|▊         | 5/62 [00:05<00:59,  1.04s/it] 10%|▉         | 6/62 [00:06<01:00,  1.09s/it] 11%|█▏        | 7/62 [00:06<00:51,  1.06it/s] 13%|█▎        | 8/62 [00:07<00:46,  1.15it/s] 15%|█▍        | 9/62 [00:08<00:48,  1.08it/s] 16%|█▌        | 10/62 [00:09<00:47,  1.10it/s] 18%|█▊        | 11/62 [00:10<00:53,  1.05s/it] 19%|█▉        | 12/62 [00:11<00:48,  1.03it/s] 21%|██        | 13/62 [00:12<00:52,  1.06s/it] 23%|██▎       | 14/62 [00:14<00:51,  1.07s/it] 24%|██▍       | 15/62 [00:14<00:48,  1.03s/it] 26%|██▌       | 16/62 [00:15<00:40,  1.12it/s] 27%|██▋       | 17/62 [00:16<00:37,  1.20it/s] 29%|██▉       | 18/62 [00:17<00:39,  1.12it/s] 31%|███       | 19/62 [00:18<00:45,  1.07s/it] 32%|███▏      | 20/62 [00:20<00:49,  1.18s/it] 34%|███▍      | 21/62 [00:22<00:57,  1.41s/it] 35%|███▌      | 22/62 [00:23<00:51,  1.28s/it] 37%|███▋      | 23/62 [00:23<00:42,  1.09s/it] 39%|███▊      | 24/62 [00:24<00:42,  1.12s/it] 40%|████      | 25/62 [00:27<00:53,  1.45s/it] 42%|████▏     | 26/62 [00:28<00:49,  1.38s/it] 44%|████▎     | 27/62 [00:29<00:44,  1.26s/it] 45%|████▌     | 28/62 [00:30<00:41,  1.21s/it] 47%|████▋     | 29/62 [00:31<00:39,  1.20s/it] 48%|████▊     | 30/62 [00:32<00:35,  1.11s/it] 50%|█████     | 31/62 [00:33<00:33,  1.08s/it] 52%|█████▏    | 32/62 [00:34<00:28,  1.05it/s] 53%|█████▎    | 33/62 [00:35<00:30,  1.04s/it] 55%|█████▍    | 34/62 [00:36<00:30,  1.10s/it] 56%|█████▋    | 35/62 [00:37<00:28,  1.05s/it] 58%|█████▊    | 36/62 [00:38<00:24,  1.05it/s] 60%|█████▉    | 37/62 [00:38<00:20,  1.24it/s] 61%|██████▏   | 38/62 [00:39<00:20,  1.19it/s] 63%|██████▎   | 39/62 [00:40<00:21,  1.05it/s] 65%|██████▍   | 40/62 [00:41<00:20,  1.06it/s] 66%|██████▌   | 41/62 [00:42<00:19,  1.08it/s] 68%|██████▊   | 42/62 [00:43<00:18,  1.09it/s] 69%|██████▉   | 43/62 [00:44<00:18,  1.03it/s] 71%|███████   | 44/62 [00:45<00:16,  1.08it/s] 73%|███████▎  | 45/62 [00:47<00:19,  1.14s/it] 74%|███████▍  | 46/62 [00:47<00:15,  1.00it/s] 76%|███████▌  | 47/62 [00:48<00:14,  1.07it/s] 77%|███████▋  | 48/62 [00:49<00:12,  1.08it/s] 79%|███████▉  | 49/62 [00:51<00:14,  1.09s/it] 81%|████████  | 50/62 [00:51<00:12,  1.02s/it] 82%|████████▏ | 51/62 [00:52<00:11,  1.04s/it] 84%|████████▍ | 52/62 [00:54<00:10,  1.07s/it] 85%|████████▌ | 53/62 [00:55<00:11,  1.28s/it] 87%|████████▋ | 54/62 [00:56<00:09,  1.17s/it] 89%|████████▊ | 55/62 [00:57<00:07,  1.09s/it] 90%|█████████ | 56/62 [00:58<00:05,  1.01it/s] 92%|█████████▏| 57/62 [00:59<00:04,  1.06it/s] 94%|█████████▎| 58/62 [01:00<00:03,  1.10it/s] 95%|█████████▌| 59/62 [01:01<00:02,  1.10it/s] 97%|█████████▋| 60/62 [01:01<00:01,  1.18it/s] 98%|█████████▊| 61/62 [01:03<00:00,  1.00it/s]100%|██████████| 62/62 [01:03<00:00,  1.03it/s]100%|██████████| 62/62 [01:03<00:00,  1.03s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0_0.87', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.97s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.26s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.22s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.14s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.10s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.16s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.20s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.59s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.664295
GEO: 0.556522
=======entity level========

Epoch: 1, P: 0.821870, R: 0.786034, F: 0.803553, OOV: 0.664295, GEO: 0.556522
=======entity level========
Epoch:   2%|▏         | 1/50 [00:43<35:23, 43.34s/it]P:  0.8218704715193401
R:  0.7860341151385928
F:  0.8035529398942838

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.94s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.90s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.94s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.08s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.16s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:38<00:00,  4.50s/it][A100%|██████████| 8/8 [00:38<00:00,  4.85s/it]
OOV: 0.786546
GEO: 0.815484
=======entity level========

Epoch: 2, P: 0.914286, R: 0.883582, F: 0.898672, OOV: 0.786546, GEO: 0.815484
=======entity level========
Epoch:   4%|▍         | 2/50 [01:26<34:30, 43.13s/it]P:  0.9142857142857143
R:  0.8835820895522388
F:  0.8986717267552181

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.04s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.47s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.17s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.24s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.22s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.22s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.08s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.59s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.798512
GEO: 0.810256
=======entity level========

Epoch: 3, P: 0.917677, R: 0.896055, F: 0.906737, OOV: 0.798512, GEO: 0.810256
=======entity level========
Epoch:   6%|▌         | 3/50 [02:09<33:46, 43.12s/it]P:  0.9176766022491538
R:  0.8960554371002132
F:  0.9067371487135227

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.01s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.09s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.50s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.22s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.24s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.15s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.47s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.805951
GEO: 0.800761
=======entity level========

Epoch: 4, P: 0.915027, R: 0.902345, F: 0.908642, OOV: 0.805951, GEO: 0.800761
=======entity level========
Epoch:   8%|▊         | 4/50 [02:52<32:56, 42.97s/it]P:  0.915027027027027
R:  0.9023454157782516
F:  0.908641975308642

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.03s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.98s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.99s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.07s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.14s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.17s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.11s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.61s/it][A100%|██████████| 8/8 [00:39<00:00,  4.90s/it]
OOV: 0.803364
GEO: 0.812780
=======entity level========

Epoch: 5, P: 0.915080, R: 0.901812, F: 0.908398, OOV: 0.803364, GEO: 0.812780
=======entity level========
Epoch:  10%|█         | 5/50 [03:34<32:08, 42.85s/it]P:  0.9150800519255733
R:  0.9018123667377399
F:  0.908397766323024

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.88s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.08s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.07s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.29s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.28s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.29s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.805951
GEO: 0.811780
=======entity level========

Epoch: 6, P: 0.915020, R: 0.903412, F: 0.909179, OOV: 0.805951, GEO: 0.811780
=======entity level========
Epoch:  12%|█▏        | 6/50 [04:18<31:32, 43.01s/it]P:  0.9150199762444661
R:  0.9034115138592751
F:  0.9091786921302506

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.07s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.10s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.01s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.31s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.27s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.55s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.808215
GEO: 0.815335
=======entity level========

Epoch: 7, P: 0.919584, R: 0.904584, F: 0.912022, OOV: 0.808215, GEO: 0.815335
=======entity level========
Epoch:  14%|█▍        | 7/50 [05:01<30:47, 42.97s/it]P:  0.9195838300639427
R:  0.9045842217484008
F:  0.9120223571774063

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.12s/it][A
 25%|██▌       | 2/8 [00:10<00:33,  5.53s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.16s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.11s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.16s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.07s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.57s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.806274
GEO: 0.834839
=======entity level========

Epoch: 8, P: 0.921165, R: 0.900640, F: 0.910786, OOV: 0.806274, GEO: 0.834839
=======entity level========
Epoch:  16%|█▌        | 8/50 [05:44<30:15, 43.23s/it]P:  0.921164540399084
R:  0.9006396588486141
F:  0.9107864805131799

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.04s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.94s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.15s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.07s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.50s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.39s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.73s/it][A100%|██████████| 8/8 [00:40<00:00,  5.03s/it]
OOV: 0.808215
GEO: 0.806103
=======entity level========

Epoch: 9, P: 0.917471, R: 0.901919, F: 0.909629, OOV: 0.808215, GEO: 0.806103
=======entity level========
Epoch:  18%|█▊        | 9/50 [06:28<29:38, 43.38s/it]P:  0.9174709901312222
R:  0.9019189765458422
F:  0.9096285145959896

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.79s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.94s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.30s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.19s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.12s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.22s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.26s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.811449
GEO: 0.820513
=======entity level========

Epoch: 10, P: 0.919308, R: 0.906077, F: 0.912644, OOV: 0.811449, GEO: 0.820513
=======entity level========
Epoch:  20%|██        | 10/50 [07:11<28:50, 43.27s/it]P:  0.9193077339102217
R:  0.9060767590618337
F:  0.9126442953020134

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.94s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.22s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.29s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.11s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.00s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.04s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.805951
GEO: 0.809917
=======entity level========

Epoch: 11, P: 0.914937, R: 0.902452, F: 0.908652, OOV: 0.805951, GEO: 0.809917
=======entity level========
Epoch:  22%|██▏       | 11/50 [07:54<28:02, 43.15s/it]P:  0.9149373108517077
R:  0.902452025586354
F:  0.9086517818806353

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.18s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.13s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.10s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.14s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.25s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.53s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.807245
GEO: 0.796203
=======entity level========

Epoch: 12, P: 0.913726, R: 0.905544, F: 0.909617, OOV: 0.807245, GEO: 0.796203
=======entity level========
Epoch:  24%|██▍       | 12/50 [08:37<27:15, 43.03s/it]P:  0.9137263339070568
R:  0.905543710021322
F:  0.9096166202612981

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.63s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.27s/it][A
 38%|███▊      | 3/8 [00:15<00:24,  4.95s/it][A
 50%|█████     | 4/8 [00:20<00:19,  4.93s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.02s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.07s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.80s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.807568
GEO: 0.830334
=======entity level========

Epoch: 13, P: 0.923362, R: 0.901706, F: 0.912406, OOV: 0.807568, GEO: 0.830334
=======entity level========
Epoch:  26%|██▌       | 13/50 [09:20<26:34, 43.09s/it]P:  0.9233624454148471
R:  0.9017057569296375
F:  0.9124056094929881

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.91s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.44s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.27s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.25s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.16s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.14s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.09s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.808862
GEO: 0.806349
=======entity level========

Epoch: 14, P: 0.915082, R: 0.902985, F: 0.908993, OOV: 0.808862, GEO: 0.806349
=======entity level========
Epoch:  28%|██▊       | 14/50 [10:03<25:52, 43.13s/it]P:  0.9150821089023337
R:  0.9029850746268657
F:  0.9089933462116333

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.53s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.36s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.44s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.16s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.12s/it][A
 88%|████████▊ | 7/8 [00:35<00:04,  4.99s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.808862
GEO: 0.818646
=======entity level========

Epoch: 15, P: 0.916234, R: 0.903731, F: 0.909940, OOV: 0.808862, GEO: 0.818646
=======entity level========
Epoch:  30%|███       | 15/50 [10:46<25:11, 43.18s/it]P:  0.9162343277129269
R:  0.9037313432835821
F:  0.9099398883641048

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.24s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.63s/it][A
 38%|███▊      | 3/8 [00:16<00:26,  5.39s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.28s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.20s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.12s/it][A
 88%|████████▊ | 7/8 [00:36<00:04,  4.98s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.48s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.807245
GEO: 0.823077
=======entity level========

Epoch: 16, P: 0.918354, R: 0.904158, F: 0.911201, OOV: 0.807245, GEO: 0.823077
=======entity level========
Epoch:  32%|███▏      | 16/50 [11:29<24:25, 43.11s/it]P:  0.9183540877097996
R:  0.9041577825159914
F:  0.9112006446414183

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.64s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.37s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.20s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.20s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.19s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.62s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.807568
GEO: 0.819169
=======entity level========

Epoch: 17, P: 0.919395, R: 0.901066, F: 0.910138, OOV: 0.807568, GEO: 0.819169
=======entity level========
Epoch:  34%|███▍      | 17/50 [12:13<23:44, 43.18s/it]P:  0.9193951919939084
R:  0.9010660980810234
F:  0.9101383729069078

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.52s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.01s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.02s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.14s/it][A
 62%|██████▎   | 5/8 [00:25<00:14,  5.00s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.17s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.21s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.809508
GEO: 0.830116
=======entity level========

Epoch: 18, P: 0.921955, R: 0.902985, F: 0.912371, OOV: 0.809508, GEO: 0.830116
=======entity level========

Early stop triggered at epoch 17

Epoch:  34%|███▍      | 17/50 [12:56<25:06, 45.66s/it]

=======best f entity level========

Epoch: 8, P: 0.921165, R: 0.900640, F: 0.910786, OOV: 0.806274, GEO: 0.834839, GEO_N: 0.824281


=======best f entity level========
P:  0.9219549363230652
R:  0.9029850746268657
F:  0.9123714116443152
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:01<01:02,  1.02s/it]  3%|▎         | 2/62 [00:01<00:59,  1.01it/s]  5%|▍         | 3/62 [00:02<00:55,  1.06it/s]  6%|▋         | 4/62 [00:03<00:56,  1.02it/s]  8%|▊         | 5/62 [00:05<00:59,  1.04s/it] 10%|▉         | 6/62 [00:06<01:00,  1.09s/it] 11%|█▏        | 7/62 [00:06<00:51,  1.06it/s] 13%|█▎        | 8/62 [00:07<00:46,  1.15it/s] 15%|█▍        | 9/62 [00:08<00:48,  1.08it/s] 16%|█▌        | 10/62 [00:09<00:47,  1.10it/s] 18%|█▊        | 11/62 [00:10<00:53,  1.05s/it] 19%|█▉        | 12/62 [00:11<00:48,  1.03it/s] 21%|██        | 13/62 [00:12<00:52,  1.06s/it] 23%|██▎       | 14/62 [00:14<00:51,  1.07s/it] 24%|██▍       | 15/62 [00:14<00:48,  1.03s/it] 26%|██▌       | 16/62 [00:15<00:40,  1.12it/s] 27%|██▋       | 17/62 [00:16<00:37,  1.20it/s] 29%|██▉       | 18/62 [00:17<00:39,  1.12it/s] 31%|███       | 19/62 [00:18<00:46,  1.07s/it] 32%|███▏      | 20/62 [00:20<00:49,  1.19s/it] 34%|███▍      | 21/62 [00:22<00:57,  1.41s/it] 35%|███▌      | 22/62 [00:23<00:51,  1.28s/it] 37%|███▋      | 23/62 [00:23<00:42,  1.09s/it] 39%|███▊      | 24/62 [00:24<00:42,  1.12s/it] 40%|████      | 25/62 [00:27<00:53,  1.45s/it] 42%|████▏     | 26/62 [00:28<00:49,  1.38s/it] 44%|████▎     | 27/62 [00:29<00:44,  1.26s/it] 45%|████▌     | 28/62 [00:30<00:41,  1.21s/it] 47%|████▋     | 29/62 [00:31<00:39,  1.20s/it] 48%|████▊     | 30/62 [00:32<00:35,  1.11s/it] 50%|█████     | 31/62 [00:33<00:33,  1.08s/it] 52%|█████▏    | 32/62 [00:34<00:28,  1.05it/s] 53%|█████▎    | 33/62 [00:35<00:30,  1.04s/it] 55%|█████▍    | 34/62 [00:36<00:30,  1.10s/it] 56%|█████▋    | 35/62 [00:37<00:28,  1.05s/it] 58%|█████▊    | 36/62 [00:38<00:24,  1.05it/s] 60%|█████▉    | 37/62 [00:38<00:20,  1.24it/s] 61%|██████▏   | 38/62 [00:39<00:20,  1.19it/s] 63%|██████▎   | 39/62 [00:40<00:21,  1.05it/s] 65%|██████▍   | 40/62 [00:41<00:20,  1.06it/s] 66%|██████▌   | 41/62 [00:42<00:19,  1.08it/s] 68%|██████▊   | 42/62 [00:43<00:18,  1.09it/s] 69%|██████▉   | 43/62 [00:44<00:18,  1.03it/s] 71%|███████   | 44/62 [00:45<00:16,  1.07it/s] 73%|███████▎  | 45/62 [00:47<00:19,  1.14s/it] 74%|███████▍  | 46/62 [00:47<00:15,  1.00it/s] 76%|███████▌  | 47/62 [00:48<00:14,  1.07it/s] 77%|███████▋  | 48/62 [00:49<00:12,  1.08it/s] 79%|███████▉  | 49/62 [00:51<00:14,  1.10s/it] 81%|████████  | 50/62 [00:51<00:12,  1.02s/it] 82%|████████▏ | 51/62 [00:53<00:11,  1.04s/it] 84%|████████▍ | 52/62 [00:54<00:10,  1.07s/it] 85%|████████▌ | 53/62 [00:55<00:11,  1.28s/it] 87%|████████▋ | 54/62 [00:56<00:09,  1.17s/it] 89%|████████▊ | 55/62 [00:57<00:07,  1.08s/it] 90%|█████████ | 56/62 [00:58<00:05,  1.01it/s] 92%|█████████▏| 57/62 [00:59<00:04,  1.06it/s] 94%|█████████▎| 58/62 [01:00<00:03,  1.10it/s] 95%|█████████▌| 59/62 [01:01<00:02,  1.10it/s] 97%|█████████▋| 60/62 [01:01<00:01,  1.18it/s] 98%|█████████▊| 61/62 [01:03<00:01,  1.00s/it]100%|██████████| 62/62 [01:04<00:00,  1.03it/s]100%|██████████| 62/62 [01:04<00:00,  1.03s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0_0.88', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.94s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.25s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.23s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.13s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.10s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.17s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.19s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.59s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.663325
GEO: 0.555877
=======entity level========

Epoch: 1, P: 0.822361, R: 0.785714, F: 0.803620, OOV: 0.663325, GEO: 0.555877
=======entity level========
Epoch:   2%|▏         | 1/50 [00:43<35:24, 43.35s/it]P:  0.8223610801160455
R:  0.7857142857142857
F:  0.8036201068585759

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.97s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.94s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.95s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.13s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:38<00:00,  4.52s/it][A100%|██████████| 8/8 [00:38<00:00,  4.87s/it]
OOV: 0.790427
GEO: 0.812621
=======entity level========

Epoch: 2, P: 0.914216, R: 0.885075, F: 0.899410, OOV: 0.790427, GEO: 0.812621
=======entity level========
Epoch:   4%|▍         | 2/50 [01:26<34:38, 43.30s/it]P:  0.9142164959806188
R:  0.8850746268656716
F:  0.8994095661123449

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.08s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.47s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.15s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.20s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.18s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.06s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.57s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.799159
GEO: 0.822997
=======entity level========

Epoch: 3, P: 0.919908, R: 0.895096, F: 0.907332, OOV: 0.799159, GEO: 0.822997
=======entity level========
Epoch:   6%|▌         | 3/50 [02:10<34:05, 43.53s/it]P:  0.9199079653774516
R:  0.8950959488272922
F:  0.907332360728373

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.04s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.11s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.51s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.23s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.25s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.17s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.13s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.49s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.806598
GEO: 0.801014
=======entity level========

Epoch: 4, P: 0.913484, R: 0.902772, F: 0.908097, OOV: 0.806598, GEO: 0.801014
=======entity level========
Epoch:   8%|▊         | 4/50 [02:53<33:10, 43.28s/it]P:  0.9134843581445523
R:  0.9027718550106609
F:  0.9080965147453084

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.03s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.98s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.99s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.06s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.14s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.62s/it][A100%|██████████| 8/8 [00:39<00:00,  4.90s/it]
OOV: 0.807891
GEO: 0.810707
=======entity level========

Epoch: 5, P: 0.915703, R: 0.903305, F: 0.909462, OOV: 0.807891, GEO: 0.810707
=======entity level========
Epoch:  10%|█         | 5/50 [03:35<32:17, 43.06s/it]P:  0.9157030152383011
R:  0.9033049040511727
F:  0.9094617077228572

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.91s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.10s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.10s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.30s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.25s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.26s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.27s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.806274
GEO: 0.814103
=======entity level========

Epoch: 6, P: 0.914841, R: 0.903625, F: 0.909198, OOV: 0.806274, GEO: 0.814103
=======entity level========
Epoch:  12%|█▏        | 6/50 [04:19<31:38, 43.15s/it]P:  0.9148407987048031
R:  0.9036247334754798
F:  0.9091981764548137

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.07s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.08s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.02s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.30s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.25s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.18s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.53s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.805627
GEO: 0.817425
=======entity level========

Epoch: 7, P: 0.920436, R: 0.900320, F: 0.910267, OOV: 0.805627, GEO: 0.817425
=======entity level========
Epoch:  14%|█▍        | 7/50 [05:02<30:50, 43.03s/it]P:  0.9204359673024524
R:  0.900319829424307
F:  0.9102667744543249

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.15s/it][A
 25%|██▌       | 2/8 [00:10<00:33,  5.52s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.14s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.09s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.16s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.08s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.58s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.808538
GEO: 0.836129
=======entity level========

Epoch: 8, P: 0.919439, R: 0.901599, F: 0.910432, OOV: 0.808538, GEO: 0.836129
=======entity level========
Epoch:  16%|█▌        | 8/50 [05:45<30:17, 43.28s/it]P:  0.9194390084801044
R:  0.9015991471215352
F:  0.9104316934007967

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.08s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.93s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.13s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.08s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.25s/it][A
 75%|███████▌  | 6/8 [00:31<00:11,  5.50s/it][A
 88%|████████▊ | 7/8 [00:37<00:05,  5.40s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.72s/it][A100%|██████████| 8/8 [00:40<00:00,  5.04s/it]
OOV: 0.805627
GEO: 0.826873
=======entity level========

Epoch: 9, P: 0.919394, R: 0.898614, F: 0.908885, OOV: 0.805627, GEO: 0.826873
=======entity level========
Epoch:  18%|█▊        | 9/50 [06:29<29:40, 43.42s/it]P:  0.9193935427574171
R:  0.8986140724946695
F:  0.908885054992452

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.78s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.96s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.32s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.14s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.23s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.28s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.809832
GEO: 0.814578
=======entity level========

Epoch: 10, P: 0.919273, R: 0.905650, F: 0.912411, OOV: 0.809832, GEO: 0.814578
=======entity level========
Epoch:  20%|██        | 10/50 [07:12<28:54, 43.36s/it]P:  0.9192728059733795
R:  0.9056503198294243
F:  0.9124107190806079

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.96s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.22s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.27s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.10s/it][A
 62%|██████▎   | 5/8 [00:25<00:14,  5.00s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.05s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.19s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.809185
GEO: 0.819923
=======entity level========

Epoch: 11, P: 0.919042, R: 0.904051, F: 0.911485, OOV: 0.809185, GEO: 0.819923
=======entity level========
Epoch:  22%|██▏       | 11/50 [07:55<28:05, 43.22s/it]P:  0.9190419421263682
R:  0.9040511727078892
F:  0.9114849250282153

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.24s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.12s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.10s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.22s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.14s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.25s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.54s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.807245
GEO: 0.813257
=======entity level========

Epoch: 12, P: 0.918084, R: 0.903305, F: 0.910635, OOV: 0.807245, GEO: 0.813257
=======entity level========
Epoch:  24%|██▍       | 12/50 [08:38<27:18, 43.11s/it]P:  0.9180842994907358
R:  0.9033049040511727
F:  0.9106346391530978

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.65s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.30s/it][A
 38%|███▊      | 3/8 [00:15<00:24,  4.97s/it][A
 50%|█████     | 4/8 [00:20<00:19,  4.95s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.04s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.07s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.10s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.77s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.808862
GEO: 0.829268
=======entity level========

Epoch: 13, P: 0.922624, R: 0.902559, F: 0.912481, OOV: 0.808862, GEO: 0.829268
=======entity level========
Epoch:  26%|██▌       | 13/50 [09:21<26:36, 43.15s/it]P:  0.9226242371403661
R:  0.9025586353944562
F:  0.9124811381763309

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.95s/it][A
 25%|██▌       | 2/8 [00:10<00:33,  5.50s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.31s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.25s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.17s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.14s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.09s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.809832
GEO: 0.806616
=======entity level========

Epoch: 14, P: 0.914841, R: 0.903625, F: 0.909198, OOV: 0.809832, GEO: 0.806616
=======entity level========
Epoch:  28%|██▊       | 14/50 [10:05<25:55, 43.20s/it]P:  0.9148407987048031
R:  0.9036247334754798
F:  0.9091981764548137

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.51s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.35s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.44s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.16s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.14s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:35<00:04,  4.98s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.811125
GEO: 0.834839
=======entity level========

Epoch: 15, P: 0.919630, R: 0.901493, F: 0.910471, OOV: 0.811125, GEO: 0.834839
=======entity level========
Epoch:  30%|███       | 15/50 [10:48<25:12, 43.23s/it]P:  0.9196302338227298
R:  0.9014925373134328
F:  0.910471063257066

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:37,  5.30s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.65s/it][A
 38%|███▊      | 3/8 [00:16<00:26,  5.39s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.29s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.22s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:04,  4.99s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.49s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.811449
GEO: 0.831836
=======entity level========

Epoch: 16, P: 0.919372, R: 0.905650, F: 0.912460, OOV: 0.811449, GEO: 0.831836
=======entity level========
Epoch:  32%|███▏      | 16/50 [11:31<24:27, 43.18s/it]P:  0.9193722943722944
R:  0.9056503198294243
F:  0.9124597207303975

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.65s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.39s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.21s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.18s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.62s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.812419
GEO: 0.823529
=======entity level========

Epoch: 17, P: 0.921564, R: 0.904371, F: 0.912887, OOV: 0.812419, GEO: 0.823529
=======entity level========
Epoch:  34%|███▍      | 17/50 [12:14<23:46, 43.24s/it]P:  0.9215643671917436
R:  0.9043710021321961
F:  0.9128867366155501

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.54s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.05s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.04s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.16s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.01s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.16s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.21s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.804657
GEO: 0.832902
=======entity level========

Epoch: 18, P: 0.920344, R: 0.900426, F: 0.910276, OOV: 0.804657, GEO: 0.832902
=======entity level========

Early stop triggered at epoch 17

Epoch:  34%|███▍      | 17/50 [12:57<25:10, 45.76s/it]

=======best f entity level========

Epoch: 8, P: 0.919439, R: 0.901599, F: 0.910432, OOV: 0.808538, GEO: 0.836129, GEO_N: 0.826824


=======best f entity level========
P:  0.9203443391086412
R:  0.9004264392324094
F:  0.910276445546155
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:01<01:02,  1.03s/it]  3%|▎         | 2/62 [00:01<00:59,  1.01it/s]  5%|▍         | 3/62 [00:02<00:55,  1.06it/s]  6%|▋         | 4/62 [00:03<00:56,  1.02it/s]  8%|▊         | 5/62 [00:05<00:59,  1.04s/it] 10%|▉         | 6/62 [00:06<01:00,  1.09s/it] 11%|█▏        | 7/62 [00:06<00:51,  1.06it/s] 13%|█▎        | 8/62 [00:07<00:46,  1.15it/s] 15%|█▍        | 9/62 [00:08<00:48,  1.08it/s] 16%|█▌        | 10/62 [00:09<00:47,  1.10it/s] 18%|█▊        | 11/62 [00:10<00:53,  1.05s/it] 19%|█▉        | 12/62 [00:11<00:48,  1.03it/s] 21%|██        | 13/62 [00:12<00:52,  1.06s/it] 23%|██▎       | 14/62 [00:14<00:51,  1.07s/it] 24%|██▍       | 15/62 [00:14<00:48,  1.03s/it] 26%|██▌       | 16/62 [00:15<00:41,  1.12it/s] 27%|██▋       | 17/62 [00:16<00:37,  1.20it/s] 29%|██▉       | 18/62 [00:17<00:39,  1.12it/s] 31%|███       | 19/62 [00:18<00:45,  1.07s/it] 32%|███▏      | 20/62 [00:20<00:49,  1.18s/it] 34%|███▍      | 21/62 [00:22<00:57,  1.41s/it] 35%|███▌      | 22/62 [00:23<00:51,  1.28s/it] 37%|███▋      | 23/62 [00:23<00:42,  1.09s/it] 39%|███▊      | 24/62 [00:24<00:42,  1.12s/it] 40%|████      | 25/62 [00:27<00:53,  1.45s/it] 42%|████▏     | 26/62 [00:28<00:49,  1.38s/it] 44%|████▎     | 27/62 [00:29<00:44,  1.26s/it] 45%|████▌     | 28/62 [00:30<00:41,  1.21s/it] 47%|████▋     | 29/62 [00:31<00:39,  1.20s/it] 48%|████▊     | 30/62 [00:32<00:35,  1.11s/it] 50%|█████     | 31/62 [00:33<00:33,  1.08s/it] 52%|█████▏    | 32/62 [00:34<00:28,  1.05it/s] 53%|█████▎    | 33/62 [00:35<00:30,  1.04s/it] 55%|█████▍    | 34/62 [00:36<00:30,  1.10s/it] 56%|█████▋    | 35/62 [00:37<00:28,  1.05s/it] 58%|█████▊    | 36/62 [00:38<00:24,  1.05it/s] 60%|█████▉    | 37/62 [00:38<00:20,  1.24it/s] 61%|██████▏   | 38/62 [00:39<00:20,  1.19it/s] 63%|██████▎   | 39/62 [00:40<00:21,  1.05it/s] 65%|██████▍   | 40/62 [00:41<00:20,  1.06it/s] 66%|██████▌   | 41/62 [00:42<00:19,  1.08it/s] 68%|██████▊   | 42/62 [00:43<00:18,  1.09it/s] 69%|██████▉   | 43/62 [00:44<00:18,  1.03it/s] 71%|███████   | 44/62 [00:45<00:16,  1.08it/s] 73%|███████▎  | 45/62 [00:47<00:19,  1.14s/it] 74%|███████▍  | 46/62 [00:47<00:15,  1.00it/s] 76%|███████▌  | 47/62 [00:48<00:14,  1.07it/s] 77%|███████▋  | 48/62 [00:49<00:12,  1.08it/s] 79%|███████▉  | 49/62 [00:51<00:14,  1.09s/it] 81%|████████  | 50/62 [00:51<00:12,  1.02s/it] 82%|████████▏ | 51/62 [00:53<00:11,  1.04s/it] 84%|████████▍ | 52/62 [00:54<00:10,  1.07s/it] 85%|████████▌ | 53/62 [00:55<00:11,  1.28s/it] 87%|████████▋ | 54/62 [00:56<00:09,  1.17s/it] 89%|████████▊ | 55/62 [00:57<00:07,  1.09s/it] 90%|█████████ | 56/62 [00:58<00:05,  1.01it/s] 92%|█████████▏| 57/62 [00:59<00:04,  1.06it/s] 94%|█████████▎| 58/62 [01:00<00:03,  1.10it/s] 95%|█████████▌| 59/62 [01:01<00:02,  1.10it/s] 97%|█████████▋| 60/62 [01:01<00:01,  1.18it/s] 98%|█████████▊| 61/62 [01:03<00:01,  1.00s/it]100%|██████████| 62/62 [01:04<00:00,  1.03it/s]100%|██████████| 62/62 [01:04<00:00,  1.03s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0_0.89', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.92s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.22s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.21s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.12s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.10s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.17s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.19s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.59s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.663648
GEO: 0.556522
=======entity level========

Epoch: 1, P: 0.821791, R: 0.785608, F: 0.803292, OOV: 0.663648, GEO: 0.556522
=======entity level========
Epoch:   2%|▏         | 1/50 [00:43<35:22, 43.31s/it]P:  0.8217910114865619
R:  0.7856076759061834
F:  0.8032920913500845

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.96s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.93s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.95s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.12s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.14s/it][A
100%|██████████| 8/8 [00:38<00:00,  4.52s/it][A100%|██████████| 8/8 [00:38<00:00,  4.87s/it]
OOV: 0.788486
GEO: 0.807198
=======entity level========

Epoch: 2, P: 0.913786, R: 0.884755, F: 0.899036, OOV: 0.788486, GEO: 0.807198
=======entity level========
Epoch:   4%|▍         | 2/50 [01:26<34:36, 43.26s/it]P:  0.9137855097996036
R:  0.8847547974413646
F:  0.8990358574368974

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.15s/it][A
 25%|██▌       | 2/8 [00:10<00:33,  5.52s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.17s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.25s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.22s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.06s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.58s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.798189
GEO: 0.821636
=======entity level========

Epoch: 3, P: 0.919281, R: 0.893603, F: 0.906260, OOV: 0.798189, GEO: 0.821636
=======entity level========
Epoch:   6%|▌         | 3/50 [02:10<34:06, 43.54s/it]P:  0.9192805439789428
R:  0.8936034115138592
F:  0.9062601362309439

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.01s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.06s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.46s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.24s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.14s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.11s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.48s/it][A100%|██████████| 8/8 [00:39<00:00,  4.91s/it]
OOV: 0.806921
GEO: 0.796707
=======entity level========

Epoch: 4, P: 0.914255, R: 0.902559, F: 0.908369, OOV: 0.806921, GEO: 0.796707
=======entity level========
Epoch:   8%|▊         | 4/50 [02:53<33:08, 43.22s/it]P:  0.9142548596112311
R:  0.9025586353944562
F:  0.9083690987124463

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.07s/it][A
 25%|██▌       | 2/8 [00:10<00:29,  4.99s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.97s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.05s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.14s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.17s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.10s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.60s/it][A100%|██████████| 8/8 [00:39<00:00,  4.89s/it]
OOV: 0.808215
GEO: 0.812500
=======entity level========

Epoch: 5, P: 0.915361, R: 0.902772, F: 0.909023, OOV: 0.808215, GEO: 0.812500
=======entity level========
Epoch:  10%|█         | 5/50 [03:35<32:14, 43.00s/it]P:  0.9153605015673981
R:  0.9027718550106609
F:  0.9090225967473566

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.91s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.11s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.07s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.29s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.22s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.25s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.24s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.801423
GEO: 0.821935
=======entity level========

Epoch: 6, P: 0.913924, R: 0.899893, F: 0.906854, OOV: 0.801423, GEO: 0.821935
=======entity level========
Epoch:  12%|█▏        | 6/50 [04:19<31:46, 43.32s/it]P:  0.9139237765266349
R:  0.8998933901918976
F:  0.9068543188654921

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.05s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.10s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.03s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.30s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.25s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.55s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.804334
GEO: 0.813776
=======entity level========

Epoch: 7, P: 0.917091, R: 0.902132, F: 0.909550, OOV: 0.804334, GEO: 0.813776
=======entity level========
Epoch:  14%|█▍        | 7/50 [05:02<30:56, 43.17s/it]P:  0.9170911455511
R:  0.9021321961620469
F:  0.9095501692911271

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.14s/it][A
 25%|██▌       | 2/8 [00:10<00:33,  5.54s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.15s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.10s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.16s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.07s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.56s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.805304
GEO: 0.820447
=======entity level========

Epoch: 8, P: 0.918279, R: 0.900853, F: 0.909482, OOV: 0.805304, GEO: 0.820447
=======entity level========
Epoch:  16%|█▌        | 8/50 [05:45<30:09, 43.09s/it]P:  0.9182786350793306
R:  0.9008528784648188
F:  0.9094822946937896

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.06s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.92s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.13s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.08s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:31<00:11,  5.52s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.40s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.73s/it][A100%|██████████| 8/8 [00:40<00:00,  5.04s/it]
OOV: 0.806598
GEO: 0.834087
=======entity level========

Epoch: 9, P: 0.918530, R: 0.897868, F: 0.908081, OOV: 0.806598, GEO: 0.834087
=======entity level========
Epoch:  18%|█▊        | 9/50 [06:30<29:45, 43.55s/it]P:  0.9185298287708583
R:  0.8978678038379531
F:  0.9080812981831904

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.83s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.96s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.28s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.18s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.11s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.23s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.29s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.66s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.804334
GEO: 0.827763
=======entity level========

Epoch: 10, P: 0.919513, R: 0.901279, F: 0.910305, OOV: 0.804334, GEO: 0.827763
=======entity level========
Epoch:  20%|██        | 10/50 [07:13<28:57, 43.44s/it]P:  0.9195127256906678
R:  0.9012793176972281
F:  0.9103047270377946

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.90s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.20s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.29s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.10s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.01s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.05s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.806274
GEO: 0.801522
=======entity level========

Epoch: 11, P: 0.916892, R: 0.903305, F: 0.910048, OOV: 0.806274, GEO: 0.801522
=======entity level========
Epoch:  22%|██▏       | 11/50 [07:56<28:07, 43.26s/it]P:  0.9168921112433719
R:  0.9033049040511727
F:  0.9100477954997046

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.19s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.09s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.09s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.22s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.27s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.54s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.806274
GEO: 0.816613
=======entity level========

Epoch: 12, P: 0.918102, R: 0.903518, F: 0.910752, OOV: 0.806274, GEO: 0.816613
=======entity level========
Epoch:  24%|██▍       | 12/50 [08:38<27:19, 43.13s/it]P:  0.9181020474488137
R:  0.9035181236673774
F:  0.9107517059803341

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.65s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.32s/it][A
 38%|███▊      | 3/8 [00:15<00:24,  4.98s/it][A
 50%|█████     | 4/8 [00:20<00:19,  4.97s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.05s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.08s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.11s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.79s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.810802
GEO: 0.833226
=======entity level========

Epoch: 13, P: 0.921855, R: 0.902985, F: 0.912322, OOV: 0.810802, GEO: 0.833226
=======entity level========
Epoch:  26%|██▌       | 13/50 [09:22<26:38, 43.19s/it]P:  0.9218545929473226
R:  0.9029850746268657
F:  0.9123222748815167

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.93s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.46s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.27s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.16s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.17s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.67s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.813066
GEO: 0.793430
=======entity level========

Epoch: 14, P: 0.914843, R: 0.904797, F: 0.909793, OOV: 0.813066, GEO: 0.793430
=======entity level========
Epoch:  28%|██▊       | 14/50 [10:05<25:56, 43.23s/it]P:  0.9148431605044735
R:  0.9047974413646055
F:  0.9097925711529185

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.52s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.37s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.46s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.17s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:04,  4.99s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.810802
GEO: 0.825864
=======entity level========

Epoch: 15, P: 0.918095, R: 0.902239, F: 0.910098, OOV: 0.810802, GEO: 0.825864
=======entity level========
Epoch:  30%|███       | 15/50 [10:49<25:15, 43.29s/it]P:  0.9180950314601866
R:  0.9022388059701493
F:  0.9100978599849445

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.27s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.66s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.40s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.30s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.14s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.00s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.50s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.806598
GEO: 0.820972
=======entity level========

Epoch: 16, P: 0.920157, R: 0.901812, F: 0.910892, OOV: 0.806598, GEO: 0.820972
=======entity level========
Epoch:  32%|███▏      | 16/50 [11:32<24:30, 43.24s/it]P:  0.920156640922441
R:  0.9018123667377399
F:  0.9108921552791687

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.64s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.40s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.24s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.61s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.811449
GEO: 0.825641
=======entity level========

Epoch: 17, P: 0.920987, R: 0.903412, F: 0.912115, OOV: 0.811449, GEO: 0.825641
=======entity level========
Epoch:  34%|███▍      | 17/50 [12:15<23:48, 43.27s/it]P:  0.9209868492555157
R:  0.9034115138592751
F:  0.9121145255906572

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.54s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.05s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.03s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.17s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.02s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.21s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.808215
GEO: 0.828205
=======entity level========

Epoch: 18, P: 0.922081, R: 0.903305, F: 0.912596, OOV: 0.808215, GEO: 0.828205
=======entity level========
Epoch:  36%|███▌      | 18/50 [12:58<23:02, 43.19s/it]P:  0.9220807487212972
R:  0.9033049040511727
F:  0.9125962625881846

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.86s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.20s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.32s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.37s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.22s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.56s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.809185
GEO: 0.815335
=======entity level========

Epoch: 19, P: 0.916208, R: 0.904584, F: 0.910359, OOV: 0.809185, GEO: 0.815335
=======entity level========

Early stop triggered at epoch 18

Epoch:  36%|███▌      | 18/50 [13:41<24:20, 45.65s/it]

=======best f entity level========

Epoch: 9, P: 0.918530, R: 0.897868, F: 0.908081, OOV: 0.806598, GEO: 0.834087, GEO_N: 0.828909


=======best f entity level========
P:  0.9162077529424468
R:  0.9045842217484008
F:  0.9103588863258408
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:01<01:02,  1.02s/it]  3%|▎         | 2/62 [00:01<00:59,  1.01it/s]  5%|▍         | 3/62 [00:02<00:55,  1.07it/s]  6%|▋         | 4/62 [00:03<00:56,  1.02it/s]  8%|▊         | 5/62 [00:05<00:59,  1.04s/it] 10%|▉         | 6/62 [00:06<01:00,  1.09s/it] 11%|█▏        | 7/62 [00:06<00:51,  1.06it/s] 13%|█▎        | 8/62 [00:07<00:46,  1.16it/s] 15%|█▍        | 9/62 [00:08<00:48,  1.08it/s] 16%|█▌        | 10/62 [00:09<00:47,  1.10it/s] 18%|█▊        | 11/62 [00:10<00:53,  1.05s/it] 19%|█▉        | 12/62 [00:11<00:48,  1.03it/s] 21%|██        | 13/62 [00:12<00:51,  1.06s/it] 23%|██▎       | 14/62 [00:14<00:51,  1.07s/it] 24%|██▍       | 15/62 [00:14<00:48,  1.03s/it] 26%|██▌       | 16/62 [00:15<00:40,  1.12it/s] 27%|██▋       | 17/62 [00:16<00:37,  1.20it/s] 29%|██▉       | 18/62 [00:17<00:39,  1.12it/s] 31%|███       | 19/62 [00:18<00:45,  1.07s/it] 32%|███▏      | 20/62 [00:20<00:49,  1.18s/it] 34%|███▍      | 21/62 [00:22<00:57,  1.41s/it] 35%|███▌      | 22/62 [00:23<00:51,  1.28s/it] 37%|███▋      | 23/62 [00:23<00:42,  1.09s/it] 39%|███▊      | 24/62 [00:24<00:42,  1.12s/it] 40%|████      | 25/62 [00:27<00:53,  1.45s/it] 42%|████▏     | 26/62 [00:28<00:49,  1.38s/it] 44%|████▎     | 27/62 [00:29<00:44,  1.26s/it] 45%|████▌     | 28/62 [00:30<00:41,  1.21s/it] 47%|████▋     | 29/62 [00:31<00:39,  1.20s/it] 48%|████▊     | 30/62 [00:32<00:35,  1.11s/it] 50%|█████     | 31/62 [00:33<00:33,  1.08s/it] 52%|█████▏    | 32/62 [00:34<00:28,  1.06it/s] 53%|█████▎    | 33/62 [00:35<00:30,  1.04s/it] 55%|█████▍    | 34/62 [00:36<00:30,  1.10s/it] 56%|█████▋    | 35/62 [00:37<00:28,  1.05s/it] 58%|█████▊    | 36/62 [00:38<00:24,  1.05it/s] 60%|█████▉    | 37/62 [00:38<00:20,  1.24it/s] 61%|██████▏   | 38/62 [00:39<00:20,  1.19it/s] 63%|██████▎   | 39/62 [00:40<00:21,  1.05it/s] 65%|██████▍   | 40/62 [00:41<00:20,  1.06it/s] 66%|██████▌   | 41/62 [00:42<00:19,  1.08it/s] 68%|██████▊   | 42/62 [00:43<00:18,  1.09it/s] 69%|██████▉   | 43/62 [00:44<00:18,  1.03it/s] 71%|███████   | 44/62 [00:45<00:16,  1.08it/s] 73%|███████▎  | 45/62 [00:47<00:19,  1.13s/it] 74%|███████▍  | 46/62 [00:47<00:15,  1.01it/s] 76%|███████▌  | 47/62 [00:48<00:14,  1.07it/s] 77%|███████▋  | 48/62 [00:49<00:12,  1.09it/s] 79%|███████▉  | 49/62 [00:51<00:14,  1.09s/it] 81%|████████  | 50/62 [00:51<00:12,  1.02s/it] 82%|████████▏ | 51/62 [00:52<00:11,  1.04s/it] 84%|████████▍ | 52/62 [00:54<00:10,  1.07s/it] 85%|████████▌ | 53/62 [00:55<00:11,  1.28s/it] 87%|████████▋ | 54/62 [00:56<00:09,  1.17s/it] 89%|████████▊ | 55/62 [00:57<00:07,  1.08s/it] 90%|█████████ | 56/62 [00:58<00:05,  1.01it/s] 92%|█████████▏| 57/62 [00:59<00:04,  1.06it/s] 94%|█████████▎| 58/62 [01:00<00:03,  1.10it/s] 95%|█████████▌| 59/62 [01:00<00:02,  1.10it/s] 97%|█████████▋| 60/62 [01:01<00:01,  1.18it/s] 98%|█████████▊| 61/62 [01:03<00:00,  1.00it/s]100%|██████████| 62/62 [01:03<00:00,  1.04it/s]100%|██████████| 62/62 [01:03<00:00,  1.03s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0_0.810', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.98s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.25s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.21s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.12s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.10s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.21s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.61s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.663648
GEO: 0.556522
=======entity level========

Epoch: 1, P: 0.821903, R: 0.785714, F: 0.803401, OOV: 0.663648, GEO: 0.556522
=======entity level========
Epoch:   2%|▏         | 1/50 [00:43<35:27, 43.41s/it]P:  0.8219025315044051
R:  0.7857142857142857
F:  0.8034011009974383

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.98s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.92s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.95s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.12s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.20s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.22s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.13s/it][A
100%|██████████| 8/8 [00:38<00:00,  4.50s/it][A100%|██████████| 8/8 [00:38<00:00,  4.87s/it]
OOV: 0.787840
GEO: 0.804110
=======entity level========

Epoch: 2, P: 0.913565, R: 0.884542, F: 0.898819, OOV: 0.787840, GEO: 0.804110
=======entity level========
Epoch:   4%|▍         | 2/50 [01:26<34:35, 43.23s/it]P:  0.9135652939881084
R:  0.88454157782516
F:  0.898819196186762

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.08s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.49s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.19s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.24s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.21s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.06s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.57s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.799806
GEO: 0.820809
=======entity level========

Epoch: 3, P: 0.919479, R: 0.894776, F: 0.906959, OOV: 0.799806, GEO: 0.820809
=======entity level========
Epoch:   6%|▌         | 3/50 [02:10<34:03, 43.47s/it]P:  0.9194785276073619
R:  0.8947761194029851
F:  0.9069591527987896

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.03s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.08s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.45s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.18s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.22s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.14s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.49s/it][A100%|██████████| 8/8 [00:39<00:00,  4.91s/it]
OOV: 0.806921
GEO: 0.801522
=======entity level========

Epoch: 4, P: 0.914641, R: 0.902452, F: 0.908506, OOV: 0.806921, GEO: 0.801522
=======entity level========
Epoch:   8%|▊         | 4/50 [02:53<33:06, 43.18s/it]P:  0.9146407347379795
R:  0.902452025586354
F:  0.9085055004024685

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.06s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.98s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.96s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.09s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.17s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.805304
GEO: 0.812261
=======entity level========

Epoch: 5, P: 0.916242, R: 0.901493, F: 0.908808, OOV: 0.805304, GEO: 0.812261
=======entity level========
Epoch:  10%|█         | 5/50 [03:35<32:17, 43.05s/it]P:  0.9162422797702893
R:  0.9014925373134328
F:  0.9088075662313934

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.90s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.11s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.09s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.32s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.24s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.26s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.26s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.803040
GEO: 0.829897
=======entity level========

Epoch: 6, P: 0.914521, R: 0.901066, F: 0.907744, OOV: 0.803040, GEO: 0.829897
=======entity level========
Epoch:  12%|█▏        | 6/50 [04:19<31:49, 43.40s/it]P:  0.9145206665223977
R:  0.9010660980810234
F:  0.9077435291590591

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.07s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.10s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.02s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.30s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.27s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.18s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.55s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.804981
GEO: 0.818182
=======entity level========

Epoch: 7, P: 0.919787, R: 0.900959, F: 0.910276, OOV: 0.804981, GEO: 0.818182
=======entity level========
Epoch:  14%|█▍        | 7/50 [05:02<30:59, 43.24s/it]P:  0.9197866782760122
R:  0.9009594882729212
F:  0.9102757432141318

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.21s/it][A
 25%|██▌       | 2/8 [00:10<00:33,  5.54s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.16s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.13s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.17s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.07s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.58s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.809185
GEO: 0.838501
=======entity level========

Epoch: 8, P: 0.922506, R: 0.901066, F: 0.911660, OOV: 0.809185, GEO: 0.838501
=======entity level========
Epoch:  16%|█▌        | 8/50 [05:46<30:23, 43.41s/it]P:  0.9225060030561013
R:  0.9010660980810234
F:  0.911660015100852

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.07s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.95s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.14s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.08s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.22s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.49s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.37s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.71s/it][A100%|██████████| 8/8 [00:40<00:00,  5.03s/it]
OOV: 0.805951
GEO: 0.844156
=======entity level========

Epoch: 9, P: 0.920525, R: 0.896482, F: 0.908345, OOV: 0.805951, GEO: 0.844156
=======entity level========
Epoch:  18%|█▊        | 9/50 [06:30<29:52, 43.72s/it]P:  0.9205254515599344
R:  0.8964818763326226
F:  0.9083445854712395

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.83s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.94s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.28s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.18s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.10s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.27s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.811449
GEO: 0.823378
=======entity level========

Epoch: 10, P: 0.919393, R: 0.904691, F: 0.911983, OOV: 0.811449, GEO: 0.823378
=======entity level========
Epoch:  20%|██        | 10/50 [07:14<29:00, 43.51s/it]P:  0.9193932827735645
R:  0.9046908315565032
F:  0.9119828049435788

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.97s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.22s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.27s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.10s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.00s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.05s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.810802
GEO: 0.810707
=======entity level========

Epoch: 11, P: 0.918022, R: 0.902559, F: 0.910225, OOV: 0.810802, GEO: 0.810707
=======entity level========
Epoch:  22%|██▏       | 11/50 [07:56<28:09, 43.31s/it]P:  0.9180221210149642
R:  0.9025586353944562
F:  0.9102247070207504

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.22s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.11s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.08s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.14s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.25s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.52s/it][A100%|██████████| 8/8 [00:39<00:00,  4.91s/it]
OOV: 0.805304
GEO: 0.820809
=======entity level========

Epoch: 12, P: 0.920074, R: 0.902026, F: 0.910960, OOV: 0.805304, GEO: 0.820809
=======entity level========
Epoch:  24%|██▍       | 12/50 [08:39<27:19, 43.14s/it]P:  0.9200739451935624
R:  0.9020255863539446
F:  0.9109603789836348

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.65s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.29s/it][A
 38%|███▊      | 3/8 [00:15<00:24,  4.96s/it][A
 50%|█████     | 4/8 [00:20<00:19,  4.97s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.06s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.09s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.11s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.78s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.806598
GEO: 0.831721
=======entity level========

Epoch: 13, P: 0.922102, R: 0.899787, F: 0.910808, OOV: 0.806598, GEO: 0.831721
=======entity level========
Epoch:  26%|██▌       | 13/50 [09:22<26:37, 43.18s/it]P:  0.9221020430459959
R:  0.8997867803837953
F:  0.9108077483407976

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.96s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.48s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.28s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.23s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.10s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.66s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.805951
GEO: 0.829582
=======entity level========

Epoch: 14, P: 0.918245, R: 0.899254, F: 0.908650, OOV: 0.805951, GEO: 0.829582
=======entity level========
Epoch:  28%|██▊       | 14/50 [10:06<25:55, 43.21s/it]P:  0.9182451556716743
R:  0.8992537313432836
F:  0.9086502208337821

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.49s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.32s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.45s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.17s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.13s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.12s/it][A
 88%|████████▊ | 7/8 [00:35<00:04,  4.99s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.809508
GEO: 0.836129
=======entity level========

Epoch: 15, P: 0.921534, R: 0.901493, F: 0.911403, OOV: 0.809508, GEO: 0.836129
=======entity level========
Epoch:  30%|███       | 15/50 [10:49<25:13, 43.23s/it]P:  0.9215344376634699
R:  0.9014925373134328
F:  0.9114033196809657

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:37,  5.29s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.62s/it][A
 38%|███▊      | 3/8 [00:16<00:26,  5.36s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.27s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.19s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.11s/it][A
 88%|████████▊ | 7/8 [00:36<00:04,  4.98s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.48s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.810155
GEO: 0.819231
=======entity level========

Epoch: 16, P: 0.916847, R: 0.903945, F: 0.910350, OOV: 0.810155, GEO: 0.819231
=======entity level========
Epoch:  32%|███▏      | 16/50 [11:32<24:26, 43.13s/it]P:  0.9168468858131488
R:  0.9039445628997868
F:  0.9103500107365257

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.65s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.41s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.24s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.23s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.14s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.18s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.62s/it][A100%|██████████| 8/8 [00:39<00:00,  5.00s/it]
OOV: 0.806274
GEO: 0.826478
=======entity level========

Epoch: 17, P: 0.920253, R: 0.900533, F: 0.910286, OOV: 0.806274, GEO: 0.826478
=======entity level========
Epoch:  34%|███▍      | 17/50 [12:15<23:46, 43.23s/it]P:  0.9202527508443186
R:  0.9005330490405117
F:  0.9102861145535859

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.52s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.02s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.03s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.15s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.00s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.21s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.806274
GEO: 0.824134
=======entity level========

Epoch: 18, P: 0.921460, R: 0.901812, F: 0.911530, OOV: 0.806274, GEO: 0.824134
=======entity level========
Epoch:  36%|███▌      | 18/50 [12:58<23:00, 43.15s/it]P:  0.9214596949891067
R:  0.9018123667377399
F:  0.9115301724137932

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.86s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.19s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.31s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.34s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.20s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.57s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.809508
GEO: 0.808946
=======entity level========

Epoch: 19, P: 0.914917, R: 0.905650, F: 0.910260, OOV: 0.809508, GEO: 0.808946
=======entity level========

Early stop triggered at epoch 18

Epoch:  36%|███▌      | 18/50 [13:41<24:21, 45.66s/it]

=======best f entity level========

Epoch: 9, P: 0.920525, R: 0.896482, F: 0.908345, OOV: 0.805951, GEO: 0.844156, GEO_N: 0.833950


=======best f entity level========
P:  0.9149165320409263
R:  0.9056503198294243
F:  0.9102598446289848
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:01<01:02,  1.02s/it]  3%|▎         | 2/62 [00:01<00:59,  1.01it/s]  5%|▍         | 3/62 [00:02<00:55,  1.07it/s]  6%|▋         | 4/62 [00:03<00:56,  1.02it/s]  8%|▊         | 5/62 [00:05<00:59,  1.04s/it] 10%|▉         | 6/62 [00:06<01:00,  1.09s/it] 11%|█▏        | 7/62 [00:06<00:51,  1.06it/s] 13%|█▎        | 8/62 [00:07<00:46,  1.15it/s] 15%|█▍        | 9/62 [00:08<00:48,  1.08it/s] 16%|█▌        | 10/62 [00:09<00:47,  1.10it/s] 18%|█▊        | 11/62 [00:10<00:53,  1.05s/it] 19%|█▉        | 12/62 [00:11<00:48,  1.03it/s] 21%|██        | 13/62 [00:12<00:52,  1.06s/it] 23%|██▎       | 14/62 [00:14<00:51,  1.07s/it] 24%|██▍       | 15/62 [00:14<00:48,  1.03s/it] 26%|██▌       | 16/62 [00:15<00:40,  1.12it/s] 27%|██▋       | 17/62 [00:16<00:37,  1.20it/s] 29%|██▉       | 18/62 [00:17<00:39,  1.12it/s] 31%|███       | 19/62 [00:18<00:45,  1.07s/it] 32%|███▏      | 20/62 [00:20<00:49,  1.18s/it] 34%|███▍      | 21/62 [00:22<00:57,  1.41s/it] 35%|███▌      | 22/62 [00:23<00:51,  1.28s/it] 37%|███▋      | 23/62 [00:23<00:42,  1.09s/it] 39%|███▊      | 24/62 [00:24<00:42,  1.12s/it] 40%|████      | 25/62 [00:27<00:53,  1.45s/it] 42%|████▏     | 26/62 [00:28<00:49,  1.38s/it] 44%|████▎     | 27/62 [00:29<00:44,  1.26s/it] 45%|████▌     | 28/62 [00:30<00:41,  1.21s/it] 47%|████▋     | 29/62 [00:31<00:39,  1.20s/it] 48%|████▊     | 30/62 [00:32<00:35,  1.11s/it] 50%|█████     | 31/62 [00:33<00:33,  1.08s/it] 52%|█████▏    | 32/62 [00:34<00:28,  1.06it/s] 53%|█████▎    | 33/62 [00:35<00:30,  1.04s/it] 55%|█████▍    | 34/62 [00:36<00:30,  1.10s/it] 56%|█████▋    | 35/62 [00:37<00:28,  1.05s/it] 58%|█████▊    | 36/62 [00:38<00:24,  1.05it/s] 60%|█████▉    | 37/62 [00:38<00:20,  1.24it/s] 61%|██████▏   | 38/62 [00:39<00:20,  1.19it/s] 63%|██████▎   | 39/62 [00:40<00:21,  1.05it/s] 65%|██████▍   | 40/62 [00:41<00:20,  1.06it/s] 66%|██████▌   | 41/62 [00:42<00:19,  1.08it/s] 68%|██████▊   | 42/62 [00:43<00:18,  1.09it/s] 69%|██████▉   | 43/62 [00:44<00:18,  1.03it/s] 71%|███████   | 44/62 [00:45<00:16,  1.07it/s] 73%|███████▎  | 45/62 [00:47<00:19,  1.14s/it] 74%|███████▍  | 46/62 [00:47<00:15,  1.00it/s] 76%|███████▌  | 47/62 [00:48<00:14,  1.07it/s] 77%|███████▋  | 48/62 [00:49<00:12,  1.08it/s] 79%|███████▉  | 49/62 [00:51<00:14,  1.09s/it] 81%|████████  | 50/62 [00:51<00:12,  1.02s/it] 82%|████████▏ | 51/62 [00:52<00:11,  1.04s/it] 84%|████████▍ | 52/62 [00:54<00:10,  1.07s/it] 85%|████████▌ | 53/62 [00:55<00:11,  1.28s/it] 87%|████████▋ | 54/62 [00:56<00:09,  1.17s/it] 89%|████████▊ | 55/62 [00:57<00:07,  1.08s/it] 90%|█████████ | 56/62 [00:58<00:05,  1.01it/s] 92%|█████████▏| 57/62 [00:59<00:04,  1.06it/s] 94%|█████████▎| 58/62 [01:00<00:03,  1.10it/s] 95%|█████████▌| 59/62 [01:01<00:02,  1.10it/s] 97%|█████████▋| 60/62 [01:01<00:01,  1.18it/s] 98%|█████████▊| 61/62 [01:03<00:00,  1.00it/s]100%|██████████| 62/62 [01:03<00:00,  1.04it/s]100%|██████████| 62/62 [01:03<00:00,  1.03s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0_0.811', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.98s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.25s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.21s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.11s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.09s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.16s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.21s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.60s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.664295
GEO: 0.556845
=======entity level========

Epoch: 1, P: 0.821851, R: 0.785928, F: 0.803488, OOV: 0.664295, GEO: 0.556845
=======entity level========
Epoch:   2%|▏         | 1/50 [00:43<35:24, 43.36s/it]P:  0.821850613154961
R:  0.7859275053304904
F:  0.8034877384196186

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  5.00s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.93s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.94s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.09s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.19s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.23s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.14s/it][A
100%|██████████| 8/8 [00:38<00:00,  4.51s/it][A100%|██████████| 8/8 [00:38<00:00,  4.87s/it]
OOV: 0.787516
GEO: 0.807717
=======entity level========

Epoch: 2, P: 0.913546, R: 0.884328, F: 0.898700, OOV: 0.787516, GEO: 0.807717
=======entity level========
Epoch:   4%|▍         | 2/50 [01:26<34:35, 43.23s/it]P:  0.913546255506608
R:  0.8843283582089553
F:  0.8986998916576382

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.07s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.47s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.17s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.24s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.25s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.10s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.59s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.797219
GEO: 0.819293
=======entity level========

Epoch: 3, P: 0.918750, R: 0.893284, F: 0.905838, OOV: 0.797219, GEO: 0.819293
=======entity level========
Epoch:   6%|▌         | 3/50 [02:10<34:05, 43.51s/it]P:  0.91875
R:  0.8932835820895523
F:  0.9058378378378379

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.01s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.09s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.49s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.22s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.10s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.47s/it][A100%|██████████| 8/8 [00:39<00:00,  4.91s/it]
OOV: 0.808215
GEO: 0.811224
=======entity level========

Epoch: 4, P: 0.916441, R: 0.902665, F: 0.909501, OOV: 0.808215, GEO: 0.811224
=======entity level========
Epoch:   8%|▊         | 4/50 [02:53<33:07, 43.20s/it]P:  0.9164411732871522
R:  0.9026652452025586
F:  0.9095010473172565

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.05s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.00s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.99s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.07s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.11s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.61s/it][A100%|██████████| 8/8 [00:39<00:00,  4.90s/it]
OOV: 0.805304
GEO: 0.819169
=======entity level========

Epoch: 5, P: 0.917725, R: 0.901386, F: 0.909482, OOV: 0.805304, GEO: 0.819169
=======entity level========
Epoch:  10%|█         | 5/50 [03:35<32:15, 43.01s/it]P:  0.9177249538695322
R:  0.9013859275053305
F:  0.9094820631420428

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.86s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.09s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.07s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.30s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.25s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.26s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.26s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.804334
GEO: 0.824663
=======entity level========

Epoch: 6, P: 0.915701, R: 0.900959, F: 0.908270, OOV: 0.804334, GEO: 0.824663
=======entity level========
Epoch:  12%|█▏        | 6/50 [04:19<31:48, 43.38s/it]P:  0.9157005092642757
R:  0.9009594882729212
F:  0.9082701918426569

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.11s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.15s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.05s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.32s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.27s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.55s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.806598
GEO: 0.817425
=======entity level========

Epoch: 7, P: 0.919057, R: 0.901812, F: 0.910353, OOV: 0.806598, GEO: 0.817425
=======entity level========
Epoch:  14%|█▍        | 7/50 [05:02<30:59, 43.24s/it]P:  0.9190569317687962
R:  0.9018123667377399
F:  0.9103529918209213

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.15s/it][A
 25%|██▌       | 2/8 [00:10<00:33,  5.55s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.16s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.10s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.16s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.09s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.58s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.807891
GEO: 0.831620
=======entity level========

Epoch: 8, P: 0.920649, R: 0.901706, F: 0.911079, OOV: 0.807891, GEO: 0.831620
=======entity level========
Epoch:  16%|█▌        | 8/50 [05:46<30:22, 43.40s/it]P:  0.9206487427887232
R:  0.9017057569296375
F:  0.9110787957128238

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.05s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.94s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.16s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.11s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.27s/it][A
 75%|███████▌  | 6/8 [00:31<00:11,  5.52s/it][A
 88%|████████▊ | 7/8 [00:37<00:05,  5.40s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.74s/it][A100%|██████████| 8/8 [00:40<00:00,  5.05s/it]
OOV: 0.807245
GEO: 0.832795
=======entity level========

Epoch: 9, P: 0.919983, R: 0.899680, F: 0.909718, OOV: 0.807245, GEO: 0.832795
=======entity level========
Epoch:  18%|█▊        | 9/50 [06:31<29:55, 43.78s/it]P:  0.9199825575057233
R:  0.8996801705756929
F:  0.9097181048886973

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.84s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.96s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.28s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.19s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.11s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.24s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.28s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.811772
GEO: 0.838710
=======entity level========

Epoch: 10, P: 0.921739, R: 0.904051, F: 0.912809, OOV: 0.811772, GEO: 0.838710
=======entity level========
Epoch:  20%|██        | 10/50 [07:15<29:12, 43.81s/it]P:  0.9217391304347826
R:  0.9040511727078892
F:  0.9128094725511302

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.90s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.20s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.25s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.08s/it][A
 62%|██████▎   | 5/8 [00:25<00:14,  4.99s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.05s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.62s/it][A100%|██████████| 8/8 [00:39<00:00,  4.91s/it]
OOV: 0.810802
GEO: 0.826923
=======entity level========

Epoch: 11, P: 0.919413, R: 0.901279, F: 0.910256, OOV: 0.810802, GEO: 0.826923
=======entity level========
Epoch:  22%|██▏       | 11/50 [07:57<28:15, 43.48s/it]P:  0.9194127243066884
R:  0.9012793176972281
F:  0.9102557200538358

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.17s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.09s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.07s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.20s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.12s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.24s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.54s/it][A100%|██████████| 8/8 [00:39<00:00,  4.91s/it]
OOV: 0.804981
GEO: 0.825112
=======entity level========

Epoch: 12, P: 0.918370, R: 0.900746, F: 0.909473, OOV: 0.804981, GEO: 0.825112
=======entity level========
Epoch:  24%|██▍       | 12/50 [08:40<27:23, 43.26s/it]P:  0.9183695652173913
R:  0.9007462686567164
F:  0.9094725511302477

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.67s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.31s/it][A
 38%|███▊      | 3/8 [00:15<00:24,  4.98s/it][A
 50%|█████     | 4/8 [00:20<00:19,  4.95s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.03s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.06s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.11s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.79s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.805951
GEO: 0.832474
=======entity level========

Epoch: 13, P: 0.920327, R: 0.900213, F: 0.910159, OOV: 0.805951, GEO: 0.832474
=======entity level========
Epoch:  26%|██▌       | 13/50 [09:23<26:40, 43.26s/it]P:  0.9203269754768393
R:  0.9002132196162047
F:  0.9101589867960118

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.96s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.50s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.29s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.23s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.10s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.66s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.805951
GEO: 0.817369
=======entity level========

Epoch: 14, P: 0.914131, R: 0.900000, F: 0.907010, OOV: 0.805951, GEO: 0.817369
=======entity level========
Epoch:  28%|██▊       | 14/50 [10:07<25:57, 43.26s/it]P:  0.9141310232809962
R:  0.9
F:  0.9070104754230459

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.50s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.33s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.46s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.18s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.14s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.12s/it][A
 88%|████████▊ | 7/8 [00:35<00:04,  4.98s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.66s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.806598
GEO: 0.828829
=======entity level========

Epoch: 15, P: 0.920760, R: 0.899360, F: 0.909934, OOV: 0.806598, GEO: 0.828829
=======entity level========
Epoch:  30%|███       | 15/50 [10:50<25:15, 43.29s/it]P:  0.9207596594629993
R:  0.899360341151386
F:  0.9099342034300508

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:37,  5.32s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.65s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.41s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.30s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.21s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.12s/it][A
 88%|████████▊ | 7/8 [00:36<00:04,  4.98s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.47s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.812419
GEO: 0.816613
=======entity level========

Epoch: 16, P: 0.918416, R: 0.904904, F: 0.911610, OOV: 0.812419, GEO: 0.816613
=======entity level========
Epoch:  32%|███▏      | 16/50 [11:33<24:28, 43.20s/it]P:  0.9184159272884657
R:  0.9049040511727079
F:  0.9116099237461067

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.65s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.41s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.24s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.20s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.60s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.811125
GEO: 0.826701
=======entity level========

Epoch: 17, P: 0.919856, R: 0.901812, F: 0.910745, OOV: 0.811125, GEO: 0.826701
=======entity level========
Epoch:  34%|███▍      | 17/50 [12:16<23:46, 43.23s/it]P:  0.9198564593301436
R:  0.9018123667377399
F:  0.9107450473729544

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.54s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.02s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.05s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.15s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.00s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.15s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.19s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.808538
GEO: 0.834300
=======entity level========

Epoch: 18, P: 0.920139, R: 0.901599, F: 0.910775, OOV: 0.808538, GEO: 0.834300
=======entity level========
Epoch:  36%|███▌      | 18/50 [12:59<23:02, 43.21s/it]P:  0.9201392666739201
R:  0.9015991471215352
F:  0.9107748640353239

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.87s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.23s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.32s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.35s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.22s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.57s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.804657
GEO: 0.818706
=======entity level========

Epoch: 19, P: 0.916820, R: 0.901279, F: 0.908983, OOV: 0.804657, GEO: 0.818706
=======entity level========
Epoch:  38%|███▊      | 19/50 [13:42<22:18, 43.18s/it]P:  0.9168203014857391
R:  0.9012793176972281
F:  0.908983387989893

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.07s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.07s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.21s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.33s/it][A
 62%|██████▎   | 5/8 [00:26<00:16,  5.35s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.38s/it][A
 88%|████████▊ | 7/8 [00:37<00:05,  5.32s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.60s/it][A100%|██████████| 8/8 [00:40<00:00,  5.01s/it]
OOV: 0.809185
GEO: 0.807398
=======entity level========

Epoch: 20, P: 0.917758, R: 0.904158, F: 0.910907, OOV: 0.809185, GEO: 0.807398
=======entity level========

Early stop triggered at epoch 19

Epoch:  38%|███▊      | 19/50 [14:26<23:33, 45.60s/it]

=======best f entity level========

Epoch: 10, P: 0.921739, R: 0.904051, F: 0.912809, OOV: 0.811772, GEO: 0.838710, GEO_N: 0.829939


=======best f entity level========
P:  0.9177578184179201
R:  0.9041577825159914
F:  0.9109070404382149
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:01<01:02,  1.03s/it]  3%|▎         | 2/62 [00:01<00:59,  1.01it/s]  5%|▍         | 3/62 [00:02<00:55,  1.06it/s]  6%|▋         | 4/62 [00:03<00:56,  1.02it/s]  8%|▊         | 5/62 [00:05<00:59,  1.04s/it] 10%|▉         | 6/62 [00:06<01:01,  1.09s/it] 11%|█▏        | 7/62 [00:06<00:51,  1.06it/s] 13%|█▎        | 8/62 [00:07<00:46,  1.15it/s] 15%|█▍        | 9/62 [00:08<00:49,  1.08it/s] 16%|█▌        | 10/62 [00:09<00:47,  1.10it/s] 18%|█▊        | 11/62 [00:10<00:53,  1.05s/it] 19%|█▉        | 12/62 [00:11<00:48,  1.03it/s] 21%|██        | 13/62 [00:12<00:52,  1.06s/it] 23%|██▎       | 14/62 [00:14<00:51,  1.07s/it] 24%|██▍       | 15/62 [00:14<00:48,  1.03s/it] 26%|██▌       | 16/62 [00:15<00:41,  1.12it/s] 27%|██▋       | 17/62 [00:16<00:37,  1.20it/s] 29%|██▉       | 18/62 [00:17<00:39,  1.12it/s] 31%|███       | 19/62 [00:18<00:45,  1.07s/it] 32%|███▏      | 20/62 [00:20<00:49,  1.19s/it] 34%|███▍      | 21/62 [00:22<00:57,  1.41s/it] 35%|███▌      | 22/62 [00:23<00:51,  1.28s/it] 37%|███▋      | 23/62 [00:23<00:42,  1.09s/it] 39%|███▊      | 24/62 [00:24<00:42,  1.13s/it] 40%|████      | 25/62 [00:27<00:53,  1.45s/it] 42%|████▏     | 26/62 [00:28<00:49,  1.38s/it] 44%|████▎     | 27/62 [00:29<00:44,  1.27s/it] 45%|████▌     | 28/62 [00:30<00:41,  1.22s/it] 47%|████▋     | 29/62 [00:31<00:39,  1.20s/it] 48%|████▊     | 30/62 [00:32<00:35,  1.11s/it] 50%|█████     | 31/62 [00:33<00:33,  1.08s/it] 52%|█████▏    | 32/62 [00:34<00:28,  1.05it/s] 53%|█████▎    | 33/62 [00:35<00:30,  1.04s/it] 55%|█████▍    | 34/62 [00:36<00:30,  1.10s/it] 56%|█████▋    | 35/62 [00:37<00:28,  1.05s/it] 58%|█████▊    | 36/62 [00:38<00:24,  1.05it/s] 60%|█████▉    | 37/62 [00:38<00:20,  1.24it/s] 61%|██████▏   | 38/62 [00:39<00:20,  1.19it/s] 63%|██████▎   | 39/62 [00:41<00:21,  1.05it/s] 65%|██████▍   | 40/62 [00:41<00:20,  1.06it/s] 66%|██████▌   | 41/62 [00:42<00:19,  1.08it/s] 68%|██████▊   | 42/62 [00:43<00:18,  1.09it/s] 69%|██████▉   | 43/62 [00:44<00:18,  1.03it/s] 71%|███████   | 44/62 [00:45<00:16,  1.07it/s] 73%|███████▎  | 45/62 [00:47<00:19,  1.14s/it] 74%|███████▍  | 46/62 [00:47<00:15,  1.00it/s] 76%|███████▌  | 47/62 [00:48<00:14,  1.06it/s] 77%|███████▋  | 48/62 [00:49<00:12,  1.08it/s] 79%|███████▉  | 49/62 [00:51<00:14,  1.10s/it] 81%|████████  | 50/62 [00:51<00:12,  1.02s/it] 82%|████████▏ | 51/62 [00:53<00:11,  1.04s/it] 84%|████████▍ | 52/62 [00:54<00:10,  1.07s/it] 85%|████████▌ | 53/62 [00:55<00:11,  1.29s/it] 87%|████████▋ | 54/62 [00:56<00:09,  1.17s/it] 89%|████████▊ | 55/62 [00:57<00:07,  1.09s/it] 90%|█████████ | 56/62 [00:58<00:05,  1.01it/s] 92%|█████████▏| 57/62 [00:59<00:04,  1.06it/s] 94%|█████████▎| 58/62 [01:00<00:03,  1.10it/s] 95%|█████████▌| 59/62 [01:01<00:02,  1.10it/s] 97%|█████████▋| 60/62 [01:01<00:01,  1.18it/s] 98%|█████████▊| 61/62 [01:03<00:01,  1.00s/it]100%|██████████| 62/62 [01:04<00:00,  1.03it/s]100%|██████████| 62/62 [01:04<00:00,  1.03s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0_0.812', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.00s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.25s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.20s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.14s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.11s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.18s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.20s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.60s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.664618
GEO: 0.555362
=======entity level========

Epoch: 1, P: 0.821982, R: 0.786141, F: 0.803662, OOV: 0.664618, GEO: 0.555362
=======entity level========
Epoch:   2%|▏         | 1/50 [00:43<35:29, 43.45s/it]P:  0.8219819418125069
R:  0.7861407249466951
F:  0.8036619257806114

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.00s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.93s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.95s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.10s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.19s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.24s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.52s/it][A100%|██████████| 8/8 [00:39<00:00,  4.88s/it]
OOV: 0.787516
GEO: 0.809524
=======entity level========

Epoch: 2, P: 0.914169, R: 0.884542, F: 0.899111, OOV: 0.787516, GEO: 0.809524
=======entity level========
Epoch:   4%|▍         | 2/50 [01:26<34:41, 43.37s/it]P:  0.9141692375495813
R:  0.88454157782516
F:  0.8991114000866927

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.05s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.46s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.16s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.20s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.05s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.57s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.796248
GEO: 0.821107
=======entity level========

Epoch: 3, P: 0.918376, R: 0.892431, F: 0.905218, OOV: 0.796248, GEO: 0.821107
=======entity level========
Epoch:   6%|▌         | 3/50 [02:10<34:06, 43.53s/it]P:  0.9183763027975864
R:  0.8924307036247334
F:  0.9052176263855096

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  5.00s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.08s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.47s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.19s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.22s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.14s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.48s/it][A100%|██████████| 8/8 [00:39<00:00,  4.91s/it]
OOV: 0.809832
GEO: 0.812222
=======entity level========

Epoch: 4, P: 0.915784, R: 0.903092, F: 0.909393, OOV: 0.809832, GEO: 0.812222
=======entity level========
Epoch:   8%|▊         | 4/50 [02:53<33:08, 43.22s/it]P:  0.9157837837837838
R:  0.903091684434968
F:  0.909393451422437

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.06s/it][A
 25%|██▌       | 2/8 [00:10<00:29,  5.00s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.99s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.08s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.91s/it]
OOV: 0.807245
GEO: 0.815571
=======entity level========

Epoch: 5, P: 0.916874, R: 0.903092, F: 0.909931, OOV: 0.807245, GEO: 0.815571
=======entity level========
Epoch:  10%|█         | 5/50 [03:36<32:17, 43.06s/it]P:  0.9168741205758199
R:  0.903091684434968
F:  0.9099307159353348

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.92s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.12s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.10s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.30s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.25s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.28s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.28s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.66s/it][A100%|██████████| 8/8 [00:39<00:00,  5.00s/it]
OOV: 0.801100
GEO: 0.836246
=======entity level========

Epoch: 6, P: 0.917292, R: 0.898614, F: 0.907857, OOV: 0.801100, GEO: 0.836246
=======entity level========
Epoch:  12%|█▏        | 6/50 [04:20<31:50, 43.41s/it]P:  0.9172924148438351
R:  0.8986140724946695
F:  0.9078571813237115

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.09s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.11s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.04s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.30s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.28s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.18s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.56s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.808215
GEO: 0.820972
=======entity level========

Epoch: 7, P: 0.919036, R: 0.902772, F: 0.910831, OOV: 0.808215, GEO: 0.820972
=======entity level========
Epoch:  14%|█▍        | 7/50 [05:03<31:00, 43.27s/it]P:  0.9190362491860212
R:  0.9027718550106609
F:  0.9108314510057006

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.21s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.58s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.17s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.13s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.09s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.57s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.810155
GEO: 0.829268
=======entity level========

Epoch: 8, P: 0.921428, R: 0.902665, F: 0.911950, OOV: 0.810155, GEO: 0.829268
=======entity level========
Epoch:  16%|█▌        | 8/50 [05:46<30:14, 43.21s/it]P:  0.9214277941016432
R:  0.9026652452025586
F:  0.9119500242339382

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.09s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.95s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.15s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.09s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.49s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.39s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.73s/it][A100%|██████████| 8/8 [00:40<00:00,  5.04s/it]
OOV: 0.801746
GEO: 0.832362
=======entity level========

Epoch: 9, P: 0.918399, R: 0.895096, F: 0.906598, OOV: 0.801746, GEO: 0.832362
=======entity level========
Epoch:  18%|█▊        | 9/50 [06:29<29:38, 43.38s/it]P:  0.9183985998687377
R:  0.8950959488272922
F:  0.9065975596587842

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.79s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.94s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.27s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.18s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.11s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.22s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.27s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.808215
GEO: 0.834300
=======entity level========

Epoch: 10, P: 0.920252, R: 0.902985, F: 0.911537, OOV: 0.808215, GEO: 0.834300
=======entity level========
Epoch:  20%|██        | 10/50 [07:12<28:51, 43.28s/it]P:  0.920252064319861
R:  0.9029850746268657
F:  0.9115368058544985

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.95s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.23s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.26s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.09s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.00s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.05s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.62s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.808538
GEO: 0.825723
=======entity level========

Epoch: 11, P: 0.919787, R: 0.900959, F: 0.910276, OOV: 0.808538, GEO: 0.825723
=======entity level========
Epoch:  22%|██▏       | 11/50 [07:55<28:02, 43.13s/it]P:  0.9197866782760122
R:  0.9009594882729212
F:  0.9102757432141318

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.19s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.14s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.09s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.22s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.13s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.26s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.53s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.809832
GEO: 0.823529
=======entity level========

Epoch: 12, P: 0.920938, R: 0.904051, F: 0.912417, OOV: 0.809832, GEO: 0.823529
=======entity level========
Epoch:  24%|██▍       | 12/50 [08:38<27:15, 43.04s/it]P:  0.9209383145091226
R:  0.9040511727078892
F:  0.9124166128685174

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.67s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.31s/it][A
 38%|███▊      | 3/8 [00:15<00:24,  4.97s/it][A
 50%|█████     | 4/8 [00:20<00:19,  4.95s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.03s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.07s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.10s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.79s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.807245
GEO: 0.828829
=======entity level========

Epoch: 13, P: 0.920052, R: 0.900533, F: 0.910188, OOV: 0.807245, GEO: 0.828829
=======entity level========
Epoch:  26%|██▌       | 13/50 [09:21<26:34, 43.10s/it]P:  0.9200522818865048
R:  0.9005330490405117
F:  0.9101880286622488

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.93s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.46s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.29s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.24s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.16s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.67s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.809508
GEO: 0.807129
=======entity level========

Epoch: 14, P: 0.914514, R: 0.902132, F: 0.908281, OOV: 0.809508, GEO: 0.807129
=======entity level========
Epoch:  28%|██▊       | 14/50 [10:05<25:54, 43.19s/it]P:  0.9145142116070464
R:  0.9021321961620469
F:  0.9082810068158644

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.55s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.36s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.49s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.19s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:04,  4.99s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.804981
GEO: 0.825723
=======entity level========

Epoch: 15, P: 0.919214, R: 0.897655, F: 0.908306, OOV: 0.804981, GEO: 0.825723
=======entity level========
Epoch:  30%|███       | 15/50 [10:48<25:13, 43.25s/it]P:  0.9192139737991266
R:  0.8976545842217484
F:  0.9083063646170443

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.25s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.61s/it][A
 38%|███▊      | 3/8 [00:16<00:26,  5.37s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.28s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.20s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:04,  4.99s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.50s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.808862
GEO: 0.824584
=======entity level========

Epoch: 16, P: 0.918819, R: 0.902559, F: 0.910616, OOV: 0.808862, GEO: 0.824584
=======entity level========

Early stop triggered at epoch 15

Epoch:  30%|███       | 15/50 [11:31<26:53, 46.11s/it]

=======best f entity level========

Epoch: 6, P: 0.917292, R: 0.898614, F: 0.907857, OOV: 0.801100, GEO: 0.836246, GEO_N: 0.826397


=======best f entity level========
P:  0.9188191881918819
R:  0.9025586353944562
F:  0.9106163278476928
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:01<01:02,  1.02s/it]  3%|▎         | 2/62 [00:01<00:59,  1.01it/s]  5%|▍         | 3/62 [00:02<00:55,  1.07it/s]  6%|▋         | 4/62 [00:03<00:56,  1.02it/s]  8%|▊         | 5/62 [00:05<00:59,  1.04s/it] 10%|▉         | 6/62 [00:06<01:00,  1.09s/it] 11%|█▏        | 7/62 [00:06<00:51,  1.06it/s] 13%|█▎        | 8/62 [00:07<00:46,  1.15it/s] 15%|█▍        | 9/62 [00:08<00:48,  1.08it/s] 16%|█▌        | 10/62 [00:09<00:47,  1.10it/s] 18%|█▊        | 11/62 [00:10<00:53,  1.05s/it] 19%|█▉        | 12/62 [00:11<00:48,  1.03it/s] 21%|██        | 13/62 [00:12<00:51,  1.06s/it] 23%|██▎       | 14/62 [00:14<00:51,  1.07s/it] 24%|██▍       | 15/62 [00:14<00:48,  1.03s/it] 26%|██▌       | 16/62 [00:15<00:40,  1.12it/s] 27%|██▋       | 17/62 [00:16<00:37,  1.21it/s] 29%|██▉       | 18/62 [00:17<00:39,  1.12it/s] 31%|███       | 19/62 [00:18<00:45,  1.07s/it] 32%|███▏      | 20/62 [00:20<00:49,  1.18s/it] 34%|███▍      | 21/62 [00:22<00:57,  1.41s/it] 35%|███▌      | 22/62 [00:23<00:50,  1.27s/it] 37%|███▋      | 23/62 [00:23<00:42,  1.09s/it] 39%|███▊      | 24/62 [00:24<00:42,  1.12s/it] 40%|████      | 25/62 [00:27<00:53,  1.45s/it] 42%|████▏     | 26/62 [00:28<00:49,  1.38s/it] 44%|████▎     | 27/62 [00:29<00:44,  1.26s/it] 45%|████▌     | 28/62 [00:30<00:41,  1.21s/it] 47%|████▋     | 29/62 [00:31<00:39,  1.20s/it] 48%|████▊     | 30/62 [00:32<00:35,  1.11s/it] 50%|█████     | 31/62 [00:33<00:33,  1.08s/it] 52%|█████▏    | 32/62 [00:34<00:28,  1.06it/s] 53%|█████▎    | 33/62 [00:35<00:30,  1.04s/it] 55%|█████▍    | 34/62 [00:36<00:30,  1.10s/it] 56%|█████▋    | 35/62 [00:37<00:28,  1.04s/it] 58%|█████▊    | 36/62 [00:38<00:24,  1.05it/s] 60%|█████▉    | 37/62 [00:38<00:20,  1.24it/s] 61%|██████▏   | 38/62 [00:39<00:20,  1.20it/s] 63%|██████▎   | 39/62 [00:40<00:21,  1.05it/s] 65%|██████▍   | 40/62 [00:41<00:20,  1.07it/s] 66%|██████▌   | 41/62 [00:42<00:19,  1.08it/s] 68%|██████▊   | 42/62 [00:43<00:18,  1.09it/s] 69%|██████▉   | 43/62 [00:44<00:18,  1.03it/s] 71%|███████   | 44/62 [00:45<00:16,  1.08it/s] 73%|███████▎  | 45/62 [00:47<00:19,  1.13s/it] 74%|███████▍  | 46/62 [00:47<00:15,  1.00it/s] 76%|███████▌  | 47/62 [00:48<00:14,  1.07it/s] 77%|███████▋  | 48/62 [00:49<00:12,  1.09it/s] 79%|███████▉  | 49/62 [00:50<00:14,  1.09s/it] 81%|████████  | 50/62 [00:51<00:12,  1.02s/it] 82%|████████▏ | 51/62 [00:52<00:11,  1.04s/it] 84%|████████▍ | 52/62 [00:54<00:10,  1.07s/it] 85%|████████▌ | 53/62 [00:55<00:11,  1.28s/it] 87%|████████▋ | 54/62 [00:56<00:09,  1.17s/it] 89%|████████▊ | 55/62 [00:57<00:07,  1.08s/it] 90%|█████████ | 56/62 [00:58<00:05,  1.01it/s] 92%|█████████▏| 57/62 [00:59<00:04,  1.06it/s] 94%|█████████▎| 58/62 [01:00<00:03,  1.10it/s] 95%|█████████▌| 59/62 [01:00<00:02,  1.10it/s] 97%|█████████▋| 60/62 [01:01<00:01,  1.18it/s] 98%|█████████▊| 61/62 [01:03<00:00,  1.00it/s]100%|██████████| 62/62 [01:03<00:00,  1.04it/s]100%|██████████| 62/62 [01:03<00:00,  1.03s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0_0.813', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  5.00s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.30s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.24s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.13s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.11s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.18s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.20s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.59s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.664942
GEO: 0.551645
=======entity level========

Epoch: 1, P: 0.821246, R: 0.787100, F: 0.803811, OOV: 0.664942, GEO: 0.551645
=======entity level========
Epoch:   2%|▏         | 1/50 [00:43<35:27, 43.41s/it]P:  0.821245828698554
R:  0.7871002132196162
F:  0.8038105606967882

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.95s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.94s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.97s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.13s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.21s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.23s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.13s/it][A
100%|██████████| 8/8 [00:38<00:00,  4.51s/it][A100%|██████████| 8/8 [00:38<00:00,  4.87s/it]
OOV: 0.783312
GEO: 0.820413
=======entity level========

Epoch: 2, P: 0.913053, R: 0.882196, F: 0.897359, OOV: 0.783312, GEO: 0.820413
=======entity level========
Epoch:   4%|▍         | 2/50 [01:26<34:36, 43.27s/it]P:  0.9130530729339071
R:  0.8821961620469083
F:  0.8973594317627285

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.06s/it][A
 25%|██▌       | 2/8 [00:10<00:33,  5.54s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.19s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.24s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.22s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.22s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.08s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.59s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.790427
GEO: 0.820579
=======entity level========

Epoch: 3, P: 0.917527, R: 0.890725, F: 0.903927, OOV: 0.790427, GEO: 0.820579
=======entity level========
Epoch:   6%|▌         | 3/50 [02:10<34:08, 43.58s/it]P:  0.9175269053371403
R:  0.8907249466950959
F:  0.9039272963323596

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.08s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.11s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.48s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.19s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.14s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.50s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.806598
GEO: 0.806369
=======entity level========

Epoch: 4, P: 0.913743, R: 0.902345, F: 0.908008, OOV: 0.806598, GEO: 0.806369
=======entity level========
Epoch:   8%|▊         | 4/50 [02:53<33:12, 43.30s/it]P:  0.9137428478894527
R:  0.9023454157782516
F:  0.9080083677519712

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.10s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.01s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.98s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.06s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.13s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.91s/it]
OOV: 0.801746
GEO: 0.822850
=======entity level========

Epoch: 5, P: 0.917808, R: 0.900000, F: 0.908817, OOV: 0.801746, GEO: 0.822850
=======entity level========
Epoch:  10%|█         | 5/50 [03:36<32:32, 43.38s/it]P:  0.9178082191780822
R:  0.9
F:  0.908816880180859

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.86s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.07s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.09s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.29s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.24s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.26s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.26s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.801100
GEO: 0.843264
=======entity level========

Epoch: 6, P: 0.917067, R: 0.895949, F: 0.906385, OOV: 0.801100, GEO: 0.843264
=======entity level========
Epoch:  12%|█▏        | 6/50 [04:21<31:59, 43.62s/it]P:  0.9170667830641641
R:  0.8959488272921109
F:  0.9063848144952545

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.09s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.11s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.03s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.30s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.27s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.18s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.56s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.805951
GEO: 0.822850
=======entity level========

Epoch: 7, P: 0.918922, R: 0.901386, F: 0.910069, OOV: 0.805951, GEO: 0.822850
=======entity level========
Epoch:  14%|█▍        | 7/50 [05:03<31:06, 43.40s/it]P:  0.9189218563199653
R:  0.9013859275053305
F:  0.9100694257574942

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.17s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.58s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.19s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.13s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.07s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.57s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.807245
GEO: 0.822322
=======entity level========

Epoch: 8, P: 0.918361, R: 0.900640, F: 0.909414, OOV: 0.807245, GEO: 0.822322
=======entity level========
Epoch:  16%|█▌        | 8/50 [05:46<30:17, 43.28s/it]P:  0.9183606913794977
R:  0.9006396588486141
F:  0.9094138543516873

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.10s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.96s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.16s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.09s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.49s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.38s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.71s/it][A100%|██████████| 8/8 [00:40<00:00,  5.03s/it]
OOV: 0.807245
GEO: 0.834625
=======entity level========

Epoch: 9, P: 0.916016, R: 0.900000, F: 0.907937, OOV: 0.807245, GEO: 0.834625
=======entity level========
Epoch:  18%|█▊        | 9/50 [06:30<29:40, 43.42s/it]P:  0.916015625
R:  0.9
F:  0.9079371907937192

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.81s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.96s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.28s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.17s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.11s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.22s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.27s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.809508
GEO: 0.805856
=======entity level========

Epoch: 10, P: 0.917801, R: 0.905864, F: 0.911793, OOV: 0.809508, GEO: 0.805856
=======entity level========
Epoch:  20%|██        | 10/50 [07:13<28:52, 43.31s/it]P:  0.9178008209116439
R:  0.905863539445629
F:  0.9117931108488035

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.95s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.23s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.28s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.15s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.04s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.07s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.21s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.66s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.810155
GEO: 0.816092
=======entity level========

Epoch: 11, P: 0.917866, R: 0.904264, F: 0.911014, OOV: 0.810155, GEO: 0.816092
=======entity level========
Epoch:  22%|██▏       | 11/50 [07:56<28:06, 43.23s/it]P:  0.9178660318147387
R:  0.9042643923240938
F:  0.9110144460555287

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.23s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.14s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.11s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.22s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.13s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.24s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.14s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.52s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.806598
GEO: 0.823605
=======entity level========

Epoch: 12, P: 0.918731, R: 0.901493, F: 0.910030, OOV: 0.806598, GEO: 0.823605
=======entity level========
Epoch:  24%|██▍       | 12/50 [08:39<27:17, 43.09s/it]P:  0.9187309865275967
R:  0.9014925373134328
F:  0.9100301334481273

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.68s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.33s/it][A
 38%|███▊      | 3/8 [00:15<00:24,  4.99s/it][A
 50%|█████     | 4/8 [00:20<00:19,  4.97s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.05s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.09s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.79s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.808538
GEO: 0.833977
=======entity level========

Epoch: 13, P: 0.921150, R: 0.901706, F: 0.911324, OOV: 0.808538, GEO: 0.833977
=======entity level========
Epoch:  26%|██▌       | 13/50 [09:22<26:37, 43.17s/it]P:  0.9211500762361141
R:  0.9017057569296375
F:  0.9113242107531516

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.92s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.48s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.28s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.25s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.17s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.14s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.10s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.807245
GEO: 0.836340
=======entity level========

Epoch: 14, P: 0.920855, R: 0.900533, F: 0.910580, OOV: 0.807245, GEO: 0.836340
=======entity level========
Epoch:  28%|██▊       | 14/50 [10:06<25:55, 43.21s/it]P:  0.9208546822195574
R:  0.9005330490405117
F:  0.910580499110656

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.50s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.34s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.46s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.18s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.13s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.00s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.67s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.806921
GEO: 0.830552
=======entity level========

Epoch: 15, P: 0.919752, R: 0.900533, F: 0.910041, OOV: 0.806921, GEO: 0.830552
=======entity level========
Epoch:  30%|███       | 15/50 [10:49<25:14, 43.27s/it]P:  0.9197517421602788
R:  0.9005330490405117
F:  0.9100409394527041

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.24s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.59s/it][A
 38%|███▊      | 3/8 [00:16<00:26,  5.37s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.28s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.19s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.11s/it][A
 88%|████████▊ | 7/8 [00:35<00:04,  4.97s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.48s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.809832
GEO: 0.833441
=======entity level========

Epoch: 16, P: 0.918655, R: 0.902985, F: 0.910753, OOV: 0.809832, GEO: 0.833441
=======entity level========

Early stop triggered at epoch 15

Epoch:  30%|███       | 15/50 [11:32<26:55, 46.17s/it]

=======best f entity level========

Epoch: 6, P: 0.917067, R: 0.895949, F: 0.906385, OOV: 0.801100, GEO: 0.843264, GEO_N: 0.830049


=======best f entity level========
P:  0.9186550976138829
R:  0.9029850746268657
F:  0.910752688172043
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:01<01:02,  1.02s/it]  3%|▎         | 2/62 [00:01<00:59,  1.01it/s]  5%|▍         | 3/62 [00:02<00:55,  1.06it/s]  6%|▋         | 4/62 [00:03<00:56,  1.02it/s]  8%|▊         | 5/62 [00:05<00:59,  1.04s/it] 10%|▉         | 6/62 [00:06<01:00,  1.09s/it] 11%|█▏        | 7/62 [00:06<00:51,  1.06it/s] 13%|█▎        | 8/62 [00:07<00:46,  1.15it/s] 15%|█▍        | 9/62 [00:08<00:48,  1.08it/s] 16%|█▌        | 10/62 [00:09<00:47,  1.10it/s] 18%|█▊        | 11/62 [00:10<00:53,  1.05s/it] 19%|█▉        | 12/62 [00:11<00:48,  1.03it/s] 21%|██        | 13/62 [00:12<00:52,  1.06s/it] 23%|██▎       | 14/62 [00:14<00:51,  1.07s/it] 24%|██▍       | 15/62 [00:14<00:48,  1.03s/it] 26%|██▌       | 16/62 [00:15<00:40,  1.12it/s] 27%|██▋       | 17/62 [00:16<00:37,  1.20it/s] 29%|██▉       | 18/62 [00:17<00:39,  1.12it/s] 31%|███       | 19/62 [00:18<00:45,  1.07s/it] 32%|███▏      | 20/62 [00:20<00:49,  1.19s/it] 34%|███▍      | 21/62 [00:22<00:57,  1.41s/it] 35%|███▌      | 22/62 [00:23<00:51,  1.28s/it] 37%|███▋      | 23/62 [00:23<00:42,  1.09s/it] 39%|███▊      | 24/62 [00:24<00:42,  1.12s/it] 40%|████      | 25/62 [00:27<00:53,  1.45s/it] 42%|████▏     | 26/62 [00:28<00:49,  1.38s/it] 44%|████▎     | 27/62 [00:29<00:44,  1.26s/it] 45%|████▌     | 28/62 [00:30<00:41,  1.21s/it] 47%|████▋     | 29/62 [00:31<00:39,  1.20s/it] 48%|████▊     | 30/62 [00:32<00:35,  1.11s/it] 50%|█████     | 31/62 [00:33<00:33,  1.08s/it] 52%|█████▏    | 32/62 [00:34<00:28,  1.05it/s] 53%|█████▎    | 33/62 [00:35<00:30,  1.04s/it] 55%|█████▍    | 34/62 [00:36<00:30,  1.10s/it] 56%|█████▋    | 35/62 [00:37<00:28,  1.05s/it] 58%|█████▊    | 36/62 [00:38<00:24,  1.05it/s] 60%|█████▉    | 37/62 [00:38<00:20,  1.24it/s] 61%|██████▏   | 38/62 [00:39<00:20,  1.19it/s] 63%|██████▎   | 39/62 [00:40<00:21,  1.05it/s] 65%|██████▍   | 40/62 [00:41<00:20,  1.06it/s] 66%|██████▌   | 41/62 [00:42<00:19,  1.08it/s] 68%|██████▊   | 42/62 [00:43<00:18,  1.09it/s] 69%|██████▉   | 43/62 [00:44<00:18,  1.03it/s] 71%|███████   | 44/62 [00:45<00:16,  1.08it/s] 73%|███████▎  | 45/62 [00:47<00:19,  1.14s/it] 74%|███████▍  | 46/62 [00:47<00:15,  1.00it/s] 76%|███████▌  | 47/62 [00:48<00:14,  1.07it/s] 77%|███████▋  | 48/62 [00:49<00:12,  1.08it/s] 79%|███████▉  | 49/62 [00:51<00:14,  1.09s/it] 81%|████████  | 50/62 [00:51<00:12,  1.02s/it] 82%|████████▏ | 51/62 [00:52<00:11,  1.04s/it] 84%|████████▍ | 52/62 [00:54<00:10,  1.07s/it] 85%|████████▌ | 53/62 [00:55<00:11,  1.28s/it] 87%|████████▋ | 54/62 [00:56<00:09,  1.17s/it] 89%|████████▊ | 55/62 [00:57<00:07,  1.08s/it] 90%|█████████ | 56/62 [00:58<00:05,  1.01it/s] 92%|█████████▏| 57/62 [00:59<00:04,  1.06it/s] 94%|█████████▎| 58/62 [01:00<00:03,  1.10it/s] 95%|█████████▌| 59/62 [01:01<00:02,  1.10it/s] 97%|█████████▋| 60/62 [01:01<00:01,  1.18it/s] 98%|█████████▊| 61/62 [01:03<00:01,  1.00s/it]100%|██████████| 62/62 [01:03<00:00,  1.03it/s]100%|██████████| 62/62 [01:03<00:00,  1.03s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0_0.814', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.96s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.24s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.22s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.13s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.11s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.16s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.19s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.58s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.663972
GEO: 0.548387
=======entity level========

Epoch: 1, P: 0.820912, R: 0.786780, F: 0.803484, OOV: 0.663972, GEO: 0.548387
=======entity level========
Epoch:   2%|▏         | 1/50 [00:43<35:20, 43.28s/it]P:  0.8209121245828699
R:  0.7867803837953091
F:  0.8034839412084921

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.99s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.93s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.95s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.13s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.20s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.23s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.52s/it][A100%|██████████| 8/8 [00:39<00:00,  4.88s/it]
OOV: 0.785252
GEO: 0.825130
=======entity level========

Epoch: 2, P: 0.912924, R: 0.881876, F: 0.897131, OOV: 0.785252, GEO: 0.825130
=======entity level========
Epoch:   4%|▍         | 2/50 [01:26<34:35, 43.24s/it]P:  0.9129235183754553
R:  0.8818763326226012
F:  0.897131392006941

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.05s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.45s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.15s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.20s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.19s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.06s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.59s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.791074
GEO: 0.823907
=======entity level========

Epoch: 3, P: 0.918161, R: 0.889872, F: 0.903795, OOV: 0.791074, GEO: 0.823907
=======entity level========
Epoch:   6%|▌         | 3/50 [02:09<33:47, 43.13s/it]P:  0.9181608183918161
R:  0.8898720682302772
F:  0.9037951383249417

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.03s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.09s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.51s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.24s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.15s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.47s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.802070
GEO: 0.803810
=======entity level========

Epoch: 4, P: 0.913532, R: 0.901066, F: 0.907256, OOV: 0.802070, GEO: 0.803810
=======entity level========
Epoch:   8%|▊         | 4/50 [02:52<32:57, 42.98s/it]P:  0.9135322092520536
R:  0.9010660980810234
F:  0.9072563331902104

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.10s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.02s/it][A
 38%|███▊      | 3/8 [00:15<00:24,  4.98s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.06s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.16s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.11s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.61s/it][A100%|██████████| 8/8 [00:39<00:00,  4.90s/it]
OOV: 0.805951
GEO: 0.824134
=======entity level========

Epoch: 5, P: 0.916757, R: 0.901706, F: 0.909169, OOV: 0.805951, GEO: 0.824134
=======entity level========
Epoch:  10%|█         | 5/50 [03:34<32:09, 42.87s/it]P:  0.9167569911120745
R:  0.9017057569296375
F:  0.90916908524132

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.95s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.14s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.10s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.30s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.24s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.24s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.62s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.795602
GEO: 0.836576
=======entity level========

Epoch: 6, P: 0.915728, R: 0.893177, F: 0.904312, OOV: 0.795602, GEO: 0.836576
=======entity level========
Epoch:  12%|█▏        | 6/50 [04:18<31:42, 43.23s/it]P:  0.9157284949174773
R:  0.8931769722814499
F:  0.904312159317826

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.08s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.11s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.03s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.31s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.26s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.55s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.803687
GEO: 0.818706
=======entity level========

Epoch: 7, P: 0.917028, R: 0.902559, F: 0.909736, OOV: 0.803687, GEO: 0.818706
=======entity level========
Epoch:  14%|█▍        | 7/50 [05:01<30:54, 43.12s/it]P:  0.9170277296360485
R:  0.9025586353944562
F:  0.9097356544165055

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.17s/it][A
 25%|██▌       | 2/8 [00:10<00:33,  5.54s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.16s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.10s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.16s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.09s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.57s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.803040
GEO: 0.819169
=======entity level========

Epoch: 8, P: 0.918919, R: 0.898934, F: 0.908817, OOV: 0.803040, GEO: 0.819169
=======entity level========
Epoch:  16%|█▌        | 8/50 [05:44<30:09, 43.08s/it]P:  0.918918918918919
R:  0.8989339019189766
F:  0.9088165552920887

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.06s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.94s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.12s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.09s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:31<00:11,  5.52s/it][A
 88%|████████▊ | 7/8 [00:37<00:05,  5.40s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.74s/it][A100%|██████████| 8/8 [00:40<00:00,  5.04s/it]
OOV: 0.808215
GEO: 0.836129
=======entity level========

Epoch: 9, P: 0.917484, R: 0.897335, F: 0.907298, OOV: 0.808215, GEO: 0.836129
=======entity level========
Epoch:  18%|█▊        | 9/50 [06:28<29:35, 43.30s/it]P:  0.9174841944626118
R:  0.8973347547974414
F:  0.9072976177643636

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.85s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.95s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.30s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.12s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.25s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.28s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.807245
GEO: 0.843871
=======entity level========

Epoch: 10, P: 0.920343, R: 0.902878, F: 0.911527, OOV: 0.807245, GEO: 0.843871
=======entity level========
Epoch:  20%|██        | 10/50 [07:12<28:58, 43.47s/it]P:  0.9203434036079113
R:  0.9028784648187633
F:  0.9115272844688407

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.93s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.24s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.29s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.10s/it][A
 62%|██████▎   | 5/8 [00:25<00:14,  5.00s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.05s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.62s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.809185
GEO: 0.815806
=======entity level========

Epoch: 11, P: 0.917506, R: 0.903518, F: 0.910458, OOV: 0.809185, GEO: 0.815806
=======entity level========
Epoch:  22%|██▏       | 11/50 [07:55<28:07, 43.27s/it]P:  0.9175056836635271
R:  0.9035181236673774
F:  0.910458183380781

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.22s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.12s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.09s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.20s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.13s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.25s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.53s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.805627
GEO: 0.831085
=======entity level========

Epoch: 12, P: 0.919045, R: 0.902878, F: 0.910890, OOV: 0.805627, GEO: 0.831085
=======entity level========
Epoch:  24%|██▍       | 12/50 [08:38<27:20, 43.18s/it]P:  0.9190450352685838
R:  0.9028784648187633
F:  0.9108900242000538

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.65s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.30s/it][A
 38%|███▊      | 3/8 [00:15<00:24,  4.97s/it][A
 50%|█████     | 4/8 [00:20<00:19,  4.96s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.03s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.08s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.10s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.78s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.807245
GEO: 0.828516
=======entity level========

Epoch: 13, P: 0.918425, R: 0.900213, F: 0.909228, OOV: 0.807245, GEO: 0.828516
=======entity level========
Epoch:  26%|██▌       | 13/50 [09:21<26:38, 43.19s/it]P:  0.9184250598216228
R:  0.9002132196162047
F:  0.9092279530526542

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.96s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.47s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.28s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.24s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.19s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.14s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.68s/it][A100%|██████████| 8/8 [00:40<00:00,  5.00s/it]
OOV: 0.811449
GEO: 0.819693
=======entity level========

Epoch: 14, P: 0.917488, R: 0.903305, F: 0.910341, OOV: 0.811449, GEO: 0.819693
=======entity level========
Epoch:  28%|██▊       | 14/50 [10:04<25:58, 43.28s/it]P:  0.9174878180833784
R:  0.9033049040511727
F:  0.91034112275047

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.49s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.37s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.49s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.19s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.15s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.00s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  5.00s/it]
OOV: 0.811125
GEO: 0.837838
=======entity level========

Epoch: 15, P: 0.919604, R: 0.901173, F: 0.910295, OOV: 0.811125, GEO: 0.837838
=======entity level========
Epoch:  30%|███       | 15/50 [10:48<25:16, 43.32s/it]P:  0.9196040034812881
R:  0.9011727078891258
F:  0.9102950678440663

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.23s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.65s/it][A
 38%|███▊      | 3/8 [00:16<00:26,  5.38s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.28s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.12s/it][A
 88%|████████▊ | 7/8 [00:36<00:04,  4.96s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.48s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.809185
GEO: 0.828296
=======entity level========

Epoch: 16, P: 0.917687, R: 0.903305, F: 0.910439, OOV: 0.809185, GEO: 0.828296
=======entity level========
Epoch:  32%|███▏      | 16/50 [11:31<24:28, 43.20s/it]P:  0.9176865590815553
R:  0.9033049040511727
F:  0.9104389405254393

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.64s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.39s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.20s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.19s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.16s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.11s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.59s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.808862
GEO: 0.826923
=======entity level========

Epoch: 17, P: 0.920526, R: 0.902665, F: 0.911508, OOV: 0.808862, GEO: 0.826923
=======entity level========
Epoch:  34%|███▍      | 17/50 [12:14<23:45, 43.20s/it]P:  0.9205262013481191
R:  0.9026652452025586
F:  0.9115082355474217

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.56s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.03s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.03s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.15s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.01s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.17s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.21s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.806598
GEO: 0.827985
=======entity level========

Epoch: 18, P: 0.919630, R: 0.901493, F: 0.910471, OOV: 0.806598, GEO: 0.827985
=======entity level========
Epoch:  36%|███▌      | 18/50 [12:57<23:00, 43.13s/it]P:  0.9196302338227298
R:  0.9014925373134328
F:  0.910471063257066

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.85s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.18s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.27s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.32s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.20s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.17s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.14s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.57s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.807568
GEO: 0.818414
=======entity level========

Epoch: 19, P: 0.918204, R: 0.902345, F: 0.910205, OOV: 0.807568, GEO: 0.818414
=======entity level========
Epoch:  38%|███▊      | 19/50 [13:40<22:15, 43.08s/it]P:  0.9182035148622261
R:  0.9023454157782516
F:  0.9102053984299386

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.00s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.02s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.17s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.29s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.31s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.35s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.31s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.58s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.810155
GEO: 0.829487
=======entity level========

Epoch: 20, P: 0.917632, R: 0.903838, F: 0.910683, OOV: 0.810155, GEO: 0.829487
=======entity level========

Early stop triggered at epoch 19

Epoch:  38%|███▊      | 19/50 [14:23<23:29, 45.46s/it]

=======best f entity level========

Epoch: 10, P: 0.920343, R: 0.902878, F: 0.911527, OOV: 0.807245, GEO: 0.843871, GEO_N: 0.827569


=======best f entity level========
P:  0.9176317783309882
R:  0.9038379530916845
F:  0.9106826360169719
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:01<01:02,  1.02s/it]  3%|▎         | 2/62 [00:01<00:59,  1.01it/s]  5%|▍         | 3/62 [00:02<00:55,  1.06it/s]  6%|▋         | 4/62 [00:03<00:56,  1.02it/s]  8%|▊         | 5/62 [00:05<00:59,  1.04s/it] 10%|▉         | 6/62 [00:06<01:00,  1.09s/it] 11%|█▏        | 7/62 [00:06<00:51,  1.06it/s] 13%|█▎        | 8/62 [00:07<00:46,  1.15it/s] 15%|█▍        | 9/62 [00:08<00:48,  1.08it/s] 16%|█▌        | 10/62 [00:09<00:47,  1.10it/s] 18%|█▊        | 11/62 [00:10<00:53,  1.05s/it] 19%|█▉        | 12/62 [00:11<00:48,  1.03it/s] 21%|██        | 13/62 [00:12<00:52,  1.06s/it] 23%|██▎       | 14/62 [00:14<00:51,  1.07s/it] 24%|██▍       | 15/62 [00:14<00:48,  1.03s/it] 26%|██▌       | 16/62 [00:15<00:40,  1.12it/s] 27%|██▋       | 17/62 [00:16<00:37,  1.20it/s] 29%|██▉       | 18/62 [00:17<00:39,  1.12it/s] 31%|███       | 19/62 [00:18<00:45,  1.07s/it] 32%|███▏      | 20/62 [00:20<00:49,  1.19s/it] 34%|███▍      | 21/62 [00:22<00:57,  1.41s/it] 35%|███▌      | 22/62 [00:23<00:51,  1.28s/it] 37%|███▋      | 23/62 [00:23<00:42,  1.09s/it] 39%|███▊      | 24/62 [00:24<00:42,  1.12s/it] 40%|████      | 25/62 [00:27<00:53,  1.45s/it] 42%|████▏     | 26/62 [00:28<00:49,  1.38s/it] 44%|████▎     | 27/62 [00:29<00:44,  1.26s/it] 45%|████▌     | 28/62 [00:30<00:41,  1.21s/it] 47%|████▋     | 29/62 [00:31<00:39,  1.20s/it] 48%|████▊     | 30/62 [00:32<00:35,  1.11s/it] 50%|█████     | 31/62 [00:33<00:33,  1.08s/it] 52%|█████▏    | 32/62 [00:34<00:28,  1.05it/s] 53%|█████▎    | 33/62 [00:35<00:30,  1.04s/it] 55%|█████▍    | 34/62 [00:36<00:30,  1.10s/it] 56%|█████▋    | 35/62 [00:37<00:28,  1.05s/it] 58%|█████▊    | 36/62 [00:38<00:24,  1.05it/s] 60%|█████▉    | 37/62 [00:38<00:20,  1.24it/s] 61%|██████▏   | 38/62 [00:39<00:20,  1.19it/s] 63%|██████▎   | 39/62 [00:40<00:21,  1.05it/s] 65%|██████▍   | 40/62 [00:41<00:20,  1.06it/s] 66%|██████▌   | 41/62 [00:42<00:19,  1.08it/s] 68%|██████▊   | 42/62 [00:43<00:18,  1.09it/s] 69%|██████▉   | 43/62 [00:44<00:18,  1.03it/s] 71%|███████   | 44/62 [00:45<00:16,  1.08it/s] 73%|███████▎  | 45/62 [00:47<00:19,  1.13s/it] 74%|███████▍  | 46/62 [00:47<00:15,  1.00it/s] 76%|███████▌  | 47/62 [00:48<00:14,  1.07it/s] 77%|███████▋  | 48/62 [00:49<00:12,  1.09it/s] 79%|███████▉  | 49/62 [00:51<00:14,  1.09s/it] 81%|████████  | 50/62 [00:51<00:12,  1.02s/it] 82%|████████▏ | 51/62 [00:52<00:11,  1.04s/it] 84%|████████▍ | 52/62 [00:54<00:10,  1.07s/it] 85%|████████▌ | 53/62 [00:55<00:11,  1.28s/it] 87%|████████▋ | 54/62 [00:56<00:09,  1.17s/it] 89%|████████▊ | 55/62 [00:57<00:07,  1.08s/it] 90%|█████████ | 56/62 [00:58<00:05,  1.01it/s] 92%|█████████▏| 57/62 [00:59<00:04,  1.06it/s] 94%|█████████▎| 58/62 [01:00<00:03,  1.10it/s] 95%|█████████▌| 59/62 [01:01<00:02,  1.10it/s] 97%|█████████▋| 60/62 [01:01<00:01,  1.18it/s] 98%|█████████▊| 61/62 [01:03<00:00,  1.00it/s]100%|██████████| 62/62 [01:03<00:00,  1.04it/s]100%|██████████| 62/62 [01:03<00:00,  1.03s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0_0.815', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.98s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.26s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.20s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.12s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.10s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.18s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.21s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.60s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.663972
GEO: 0.554078
=======entity level========

Epoch: 1, P: 0.821663, R: 0.786887, F: 0.803899, OOV: 0.663972, GEO: 0.554078
=======entity level========
Epoch:   2%|▏         | 1/50 [00:43<35:26, 43.40s/it]P:  0.8216631414894802
R:  0.7868869936034115
F:  0.8038991450198769

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.97s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.96s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.97s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.13s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.20s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.25s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.53s/it][A100%|██████████| 8/8 [00:39<00:00,  4.89s/it]
OOV: 0.785252
GEO: 0.819121
=======entity level========

Epoch: 2, P: 0.913466, R: 0.882303, F: 0.897614, OOV: 0.785252, GEO: 0.819121
=======entity level========
Epoch:   4%|▍         | 2/50 [01:26<34:41, 43.36s/it]P:  0.9134657836644592
R:  0.8823027718550107
F:  0.8976138828633407

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.07s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.46s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.17s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.23s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.20s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.05s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.57s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.791397
GEO: 0.831504
=======entity level========

Epoch: 3, P: 0.918089, R: 0.889019, F: 0.903320, OOV: 0.791397, GEO: 0.831504
=======entity level========
Epoch:   6%|▌         | 3/50 [02:10<34:07, 43.56s/it]P:  0.9180887372013652
R:  0.8890191897654585
F:  0.9033201538211559

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.02s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.09s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.51s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.22s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.25s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.14s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.10s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.47s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.801100
GEO: 0.805856
=======entity level========

Epoch: 4, P: 0.914484, R: 0.900640, F: 0.907509, OOV: 0.801100, GEO: 0.805856
=======entity level========
Epoch:   8%|▊         | 4/50 [02:53<33:09, 43.25s/it]P:  0.9144836544706646
R:  0.9006396588486141
F:  0.9075088623912342

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.10s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.02s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.01s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.07s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.61s/it][A100%|██████████| 8/8 [00:39<00:00,  4.91s/it]
OOV: 0.804334
GEO: 0.828608
=======entity level========

Epoch: 5, P: 0.918669, R: 0.900746, F: 0.909619, OOV: 0.804334, GEO: 0.828608
=======entity level========
Epoch:  10%|█         | 5/50 [03:36<32:18, 43.07s/it]P:  0.9186691312384473
R:  0.9007462686567164
F:  0.909619421865748

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.86s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.07s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.05s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.30s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.26s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.29s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.29s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.799159
GEO: 0.840260
=======entity level========

Epoch: 6, P: 0.915149, R: 0.894563, F: 0.904739, OOV: 0.799159, GEO: 0.840260
=======entity level========
Epoch:  12%|█▏        | 6/50 [04:20<31:50, 43.43s/it]P:  0.9151488711964227
R:  0.8945628997867804
F:  0.9047387999353065

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.05s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.07s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.01s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.28s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.25s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.55s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.807245
GEO: 0.832154
=======entity level========

Epoch: 7, P: 0.918294, R: 0.902239, F: 0.910196, OOV: 0.807245, GEO: 0.832154
=======entity level========
Epoch:  14%|█▍        | 7/50 [05:03<30:59, 43.23s/it]P:  0.9182942708333334
R:  0.9022388059701493
F:  0.9101957410195741

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.13s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.57s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.17s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.12s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.19s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.09s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.58s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.806274
GEO: 0.824281
=======entity level========

Epoch: 8, P: 0.918995, R: 0.901066, F: 0.909942, OOV: 0.806274, GEO: 0.824281
=======entity level========
Epoch:  16%|█▌        | 8/50 [05:46<30:13, 43.19s/it]P:  0.9189953245623573
R:  0.9010660980810234
F:  0.9099424018948162

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.05s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.94s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.17s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.09s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.27s/it][A
 75%|███████▌  | 6/8 [00:31<00:11,  5.52s/it][A
 88%|████████▊ | 7/8 [00:37<00:05,  5.41s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.75s/it][A100%|██████████| 8/8 [00:40<00:00,  5.05s/it]
OOV: 0.808862
GEO: 0.823907
=======entity level========

Epoch: 9, P: 0.916387, R: 0.902026, F: 0.909150, OOV: 0.808862, GEO: 0.823907
=======entity level========
Epoch:  18%|█▊        | 9/50 [06:29<29:39, 43.40s/it]P:  0.9163868731723167
R:  0.9020255863539446
F:  0.90914951915328

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.78s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.94s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.27s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.16s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.09s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.26s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.807568
GEO: 0.853801
=======entity level========

Epoch: 10, P: 0.921064, R: 0.900640, F: 0.910737, OOV: 0.807568, GEO: 0.853801
=======entity level========
Epoch:  20%|██        | 10/50 [07:13<28:59, 43.49s/it]P:  0.9210641081552551
R:  0.9006396588486141
F:  0.9107373868046571

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.95s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.25s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.32s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.12s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.01s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.04s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.61s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.811125
GEO: 0.816847
=======entity level========

Epoch: 11, P: 0.917488, R: 0.903305, F: 0.910341, OOV: 0.811125, GEO: 0.816847
=======entity level========
Epoch:  22%|██▏       | 11/50 [07:56<28:08, 43.28s/it]P:  0.9174878180833784
R:  0.9033049040511727
F:  0.91034112275047

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.18s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.13s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.09s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.20s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.12s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.25s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.52s/it][A100%|██████████| 8/8 [00:39<00:00,  4.91s/it]
OOV: 0.807891
GEO: 0.814295
=======entity level========

Epoch: 12, P: 0.915902, R: 0.904478, F: 0.910154, OOV: 0.807891, GEO: 0.814295
=======entity level========
Epoch:  24%|██▍       | 12/50 [08:39<27:18, 43.12s/it]P:  0.9159019756018568
R:  0.9044776119402985
F:  0.9101539451804966

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.65s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.30s/it][A
 38%|███▊      | 3/8 [00:15<00:24,  4.96s/it][A
 50%|█████     | 4/8 [00:20<00:19,  4.94s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.01s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.07s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.10s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.81s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.807891
GEO: 0.847150
=======entity level========

Epoch: 13, P: 0.922649, R: 0.901599, F: 0.912003, OOV: 0.807891, GEO: 0.847150
=======entity level========
Epoch:  26%|██▌       | 13/50 [09:22<26:37, 43.17s/it]P:  0.9226489199214488
R:  0.9015991471215352
F:  0.9120025881591719

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.92s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.49s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.30s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.28s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.19s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.16s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.10s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.802070
GEO: 0.846952
=======entity level========

Epoch: 14, P: 0.920678, R: 0.897122, F: 0.908747, OOV: 0.802070, GEO: 0.846952
=======entity level========
Epoch:  28%|██▊       | 14/50 [10:05<25:56, 43.23s/it]P:  0.9206783369803063
R:  0.8971215351812367
F:  0.9087473002159828

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.54s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.34s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.46s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.20s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.15s/it][A
 88%|████████▊ | 7/8 [00:36<00:04,  5.00s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.808862
GEO: 0.831938
=======entity level========

Epoch: 15, P: 0.917903, R: 0.903518, F: 0.910654, OOV: 0.808862, GEO: 0.831938
=======entity level========
Epoch:  30%|███       | 15/50 [10:49<25:15, 43.30s/it]P:  0.9179031733997617
R:  0.9035181236673774
F:  0.9106538440874657

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.22s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.60s/it][A
 38%|███▊      | 3/8 [00:16<00:26,  5.36s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.28s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.20s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:04,  4.98s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.47s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.807568
GEO: 0.830868
=======entity level========

Epoch: 16, P: 0.918957, R: 0.901812, F: 0.910304, OOV: 0.807568, GEO: 0.830868
=======entity level========
Epoch:  32%|███▏      | 16/50 [11:32<24:28, 43.18s/it]P:  0.9189570885388376
R:  0.9018123667377399
F:  0.9103040086090933

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.63s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.38s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.22s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.19s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.61s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.803687
GEO: 0.846602
=======entity level========

Epoch: 17, P: 0.921856, R: 0.897974, F: 0.909759, OOV: 0.803687, GEO: 0.846602
=======entity level========
Epoch:  34%|███▍      | 17/50 [12:15<23:46, 43.22s/it]P:  0.9218561891211557
R:  0.8979744136460555
F:  0.9097586002052168

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.58s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.05s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.03s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.14s/it][A
 62%|██████▎   | 5/8 [00:25<00:14,  5.00s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.16s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.20s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.805951
GEO: 0.833441
=======entity level========

Epoch: 18, P: 0.919652, R: 0.900533, F: 0.909992, OOV: 0.805951, GEO: 0.833441
=======entity level========
Epoch:  36%|███▌      | 18/50 [12:58<23:00, 43.14s/it]P:  0.9196516058791507
R:  0.9005330490405117
F:  0.9099919202800969

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.84s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.20s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.30s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.33s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.19s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.17s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.14s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.55s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.806598
GEO: 0.828516
=======entity level========

Epoch: 19, P: 0.920775, R: 0.902026, F: 0.911304, OOV: 0.806598, GEO: 0.828516
=======entity level========
Epoch:  38%|███▊      | 19/50 [13:41<22:15, 43.09s/it]P:  0.9207748394819893
R:  0.9020255863539446
F:  0.911303785879692

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.02s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.02s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.19s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.32s/it][A
 62%|██████▎   | 5/8 [00:26<00:16,  5.34s/it][A
 75%|███████▌  | 6/8 [00:32<00:10,  5.45s/it][A
 88%|████████▊ | 7/8 [00:37<00:05,  5.38s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.64s/it][A100%|██████████| 8/8 [00:40<00:00,  5.03s/it]
OOV: 0.804334
GEO: 0.829487
=======entity level========

Epoch: 20, P: 0.919891, R: 0.902239, F: 0.910980, OOV: 0.804334, GEO: 0.829487
=======entity level========

Early stop triggered at epoch 19

Epoch:  38%|███▊      | 19/50 [14:25<23:31, 45.54s/it]

=======best f entity level========

Epoch: 10, P: 0.921064, R: 0.900640, F: 0.910737, OOV: 0.807568, GEO: 0.853801, GEO_N: 0.832963


=======best f entity level========
P:  0.9198913043478261
R:  0.9022388059701493
F:  0.9109795479009689
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:01<01:02,  1.02s/it]  3%|▎         | 2/62 [00:01<00:59,  1.01it/s]  5%|▍         | 3/62 [00:02<00:55,  1.07it/s]  6%|▋         | 4/62 [00:03<00:56,  1.02it/s]  8%|▊         | 5/62 [00:05<00:59,  1.04s/it] 10%|▉         | 6/62 [00:06<01:00,  1.09s/it] 11%|█▏        | 7/62 [00:06<00:51,  1.06it/s] 13%|█▎        | 8/62 [00:07<00:46,  1.15it/s] 15%|█▍        | 9/62 [00:08<00:48,  1.08it/s] 16%|█▌        | 10/62 [00:09<00:47,  1.10it/s] 18%|█▊        | 11/62 [00:10<00:53,  1.05s/it] 19%|█▉        | 12/62 [00:11<00:48,  1.03it/s] 21%|██        | 13/62 [00:12<00:51,  1.06s/it] 23%|██▎       | 14/62 [00:14<00:51,  1.07s/it] 24%|██▍       | 15/62 [00:14<00:48,  1.03s/it] 26%|██▌       | 16/62 [00:15<00:40,  1.13it/s] 27%|██▋       | 17/62 [00:16<00:37,  1.21it/s] 29%|██▉       | 18/62 [00:17<00:39,  1.12it/s] 31%|███       | 19/62 [00:18<00:45,  1.07s/it] 32%|███▏      | 20/62 [00:20<00:49,  1.18s/it] 34%|███▍      | 21/62 [00:22<00:57,  1.41s/it] 35%|███▌      | 22/62 [00:23<00:50,  1.27s/it] 37%|███▋      | 23/62 [00:23<00:42,  1.09s/it] 39%|███▊      | 24/62 [00:24<00:42,  1.12s/it] 40%|████      | 25/62 [00:27<00:53,  1.45s/it] 42%|████▏     | 26/62 [00:28<00:49,  1.38s/it] 44%|████▎     | 27/62 [00:29<00:44,  1.26s/it] 45%|████▌     | 28/62 [00:30<00:41,  1.21s/it] 47%|████▋     | 29/62 [00:31<00:39,  1.20s/it] 48%|████▊     | 30/62 [00:32<00:35,  1.11s/it] 50%|█████     | 31/62 [00:33<00:33,  1.08s/it] 52%|█████▏    | 32/62 [00:34<00:28,  1.06it/s] 53%|█████▎    | 33/62 [00:35<00:30,  1.04s/it] 55%|█████▍    | 34/62 [00:36<00:30,  1.10s/it] 56%|█████▋    | 35/62 [00:37<00:28,  1.04s/it] 58%|█████▊    | 36/62 [00:38<00:24,  1.05it/s] 60%|█████▉    | 37/62 [00:38<00:20,  1.24it/s] 61%|██████▏   | 38/62 [00:39<00:20,  1.20it/s] 63%|██████▎   | 39/62 [00:40<00:21,  1.05it/s] 65%|██████▍   | 40/62 [00:41<00:20,  1.06it/s] 66%|██████▌   | 41/62 [00:42<00:19,  1.08it/s] 68%|██████▊   | 42/62 [00:43<00:18,  1.09it/s] 69%|██████▉   | 43/62 [00:44<00:18,  1.03it/s] 71%|███████   | 44/62 [00:45<00:16,  1.07it/s] 73%|███████▎  | 45/62 [00:47<00:19,  1.14s/it] 74%|███████▍  | 46/62 [00:47<00:15,  1.00it/s] 76%|███████▌  | 47/62 [00:48<00:14,  1.07it/s] 77%|███████▋  | 48/62 [00:49<00:12,  1.08it/s] 79%|███████▉  | 49/62 [00:50<00:14,  1.10s/it] 81%|████████  | 50/62 [00:51<00:12,  1.04s/it] 82%|████████▏ | 51/62 [00:52<00:11,  1.06s/it] 84%|████████▍ | 52/62 [00:54<00:10,  1.08s/it] 85%|████████▌ | 53/62 [00:55<00:11,  1.29s/it] 87%|████████▋ | 54/62 [00:56<00:09,  1.17s/it] 89%|████████▊ | 55/62 [00:57<00:07,  1.09s/it] 90%|█████████ | 56/62 [00:58<00:05,  1.01it/s] 92%|█████████▏| 57/62 [00:59<00:04,  1.06it/s] 94%|█████████▎| 58/62 [01:00<00:03,  1.10it/s] 95%|█████████▌| 59/62 [01:01<00:02,  1.10it/s] 97%|█████████▋| 60/62 [01:01<00:01,  1.18it/s] 98%|█████████▊| 61/62 [01:03<00:00,  1.00it/s]100%|██████████| 62/62 [01:03<00:00,  1.04it/s]100%|██████████| 62/62 [01:03<00:00,  1.03s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0_0.816', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.97s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.29s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.24s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.15s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.11s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.18s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.21s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.59s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.664618
GEO: 0.555556
=======entity level========

Epoch: 1, P: 0.821898, R: 0.786674, F: 0.803900, OOV: 0.664618, GEO: 0.555556
=======entity level========
Epoch:   2%|▏         | 1/50 [00:43<35:27, 43.43s/it]P:  0.8218979728224549
R:  0.7866737739872068
F:  0.803900206994226

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.97s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.94s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.95s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.09s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.17s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:38<00:00,  4.50s/it][A100%|██████████| 8/8 [00:38<00:00,  4.86s/it]
OOV: 0.786546
GEO: 0.819121
=======entity level========

Epoch: 2, P: 0.914090, R: 0.882516, F: 0.898026, OOV: 0.786546, GEO: 0.819121
=======entity level========
Epoch:   4%|▍         | 2/50 [01:26<34:32, 43.17s/it]P:  0.9140901060070671
R:  0.8825159914712154
F:  0.8980256020828813

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.08s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.49s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.19s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.22s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.24s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.22s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.10s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.61s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.793338
GEO: 0.838083
=======entity level========

Epoch: 3, P: 0.918684, R: 0.890085, F: 0.904159, OOV: 0.793338, GEO: 0.838083
=======entity level========
Epoch:   6%|▌         | 3/50 [02:10<34:06, 43.55s/it]P:  0.9186839788732394
R:  0.8900852878464819
F:  0.9041585445094217

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.01s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.07s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.46s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.19s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.22s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.14s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.11s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.47s/it][A100%|██████████| 8/8 [00:39<00:00,  4.91s/it]
OOV: 0.805951
GEO: 0.807888
=======entity level========

Epoch: 4, P: 0.914428, R: 0.903412, F: 0.908886, OOV: 0.805951, GEO: 0.807888
=======entity level========
Epoch:   8%|▊         | 4/50 [02:53<33:07, 43.20s/it]P:  0.914427538577749
R:  0.9034115138592751
F:  0.9088861479058293

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.07s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.03s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.01s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.07s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.14s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.13s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.62s/it][A100%|██████████| 8/8 [00:39<00:00,  4.91s/it]
OOV: 0.804334
GEO: 0.816379
=======entity level========

Epoch: 5, P: 0.917218, R: 0.901279, F: 0.909179, OOV: 0.804334, GEO: 0.816379
=======entity level========
Epoch:  10%|█         | 5/50 [03:35<32:16, 43.03s/it]P:  0.9172181837908213
R:  0.9012793176972281
F:  0.909178899822552

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.90s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.11s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.06s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.29s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.25s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.25s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.804657
GEO: 0.838083
=======entity level========

Epoch: 6, P: 0.919930, R: 0.896588, F: 0.908109, OOV: 0.804657, GEO: 0.838083
=======entity level========
Epoch:  12%|█▏        | 6/50 [04:19<31:36, 43.10s/it]P:  0.9199299934368848
R:  0.896588486140725
F:  0.9081092754562142

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.04s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.10s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.01s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.30s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.26s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.18s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.56s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.804010
GEO: 0.836669
=======entity level========

Epoch: 7, P: 0.919372, R: 0.899574, F: 0.909365, OOV: 0.804010, GEO: 0.836669
=======entity level========
Epoch:  14%|█▍        | 7/50 [05:01<30:50, 43.03s/it]P:  0.9193724122902593
R:  0.8995735607675907
F:  0.9093652333225563

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.22s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.57s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.16s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.11s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.07s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.56s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.799806
GEO: 0.824134
=======entity level========

Epoch: 8, P: 0.919506, R: 0.897548, F: 0.908394, OOV: 0.799806, GEO: 0.824134
=======entity level========
Epoch:  16%|█▌        | 8/50 [05:44<30:07, 43.03s/it]P:  0.9195063346439494
R:  0.8975479744136461
F:  0.9083944756150195

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.03s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.93s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.14s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.07s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.22s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.50s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.38s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.71s/it][A100%|██████████| 8/8 [00:40<00:00,  5.02s/it]
OOV: 0.804981
GEO: 0.818240
=======entity level========

Epoch: 9, P: 0.916052, R: 0.900426, F: 0.908172, OOV: 0.804981, GEO: 0.818240
=======entity level========
Epoch:  18%|█▊        | 9/50 [06:28<29:32, 43.23s/it]P:  0.9160520607375271
R:  0.9004264392324094
F:  0.9081720430107527

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.79s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.95s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.27s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.17s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.10s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.26s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.809508
GEO: 0.838169
=======entity level========

Epoch: 10, P: 0.920313, R: 0.903731, F: 0.911947, OOV: 0.809508, GEO: 0.838169
=======entity level========
Epoch:  20%|██        | 10/50 [07:12<28:54, 43.37s/it]P:  0.920312669634133
R:  0.9037313432835821
F:  0.911946640847722

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.98s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.25s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.29s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.11s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.01s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.06s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.19s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.804981
GEO: 0.834514
=======entity level========

Epoch: 11, P: 0.921268, R: 0.898188, F: 0.909582, OOV: 0.804981, GEO: 0.834514
=======entity level========
Epoch:  22%|██▏       | 11/50 [07:55<28:06, 43.25s/it]P:  0.9212684527063969
R:  0.8981876332622601
F:  0.9095816464237517

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.21s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.16s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.12s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.24s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.28s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.18s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.56s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.808215
GEO: 0.824359
=======entity level========

Epoch: 12, P: 0.918336, R: 0.903945, F: 0.911084, OOV: 0.808215, GEO: 0.824359
=======entity level========
Epoch:  24%|██▍       | 12/50 [08:38<27:20, 43.17s/it]P:  0.9183364020361746
R:  0.9039445628997868
F:  0.9110836512115188

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.67s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.33s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.00s/it][A
 50%|█████     | 4/8 [00:20<00:19,  4.98s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.07s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.10s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.79s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.803364
GEO: 0.832258
=======entity level========

Epoch: 13, P: 0.920306, R: 0.898721, F: 0.909385, OOV: 0.803364, GEO: 0.832258
=======entity level========
Epoch:  26%|██▌       | 13/50 [09:21<26:39, 43.23s/it]P:  0.9203056768558951
R:  0.8987206823027718
F:  0.9093851132686085

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.95s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.48s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.31s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.24s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.17s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.15s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.10s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.804334
GEO: 0.831938
=======entity level========

Epoch: 14, P: 0.919318, R: 0.896482, F: 0.907756, OOV: 0.804334, GEO: 0.831938
=======entity level========
Epoch:  28%|██▊       | 14/50 [10:04<25:57, 43.26s/it]P:  0.9193178091177435
R:  0.8964818763326226
F:  0.9077562476385815

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.66s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.40s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.47s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.19s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.14s/it][A
 88%|████████▊ | 7/8 [00:36<00:04,  4.99s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.65s/it][A100%|██████████| 8/8 [00:40<00:00,  5.00s/it]
OOV: 0.805304
GEO: 0.828296
=======entity level========

Epoch: 15, P: 0.917636, R: 0.900320, F: 0.908895, OOV: 0.805304, GEO: 0.828296
=======entity level========
Epoch:  30%|███       | 15/50 [10:48<25:16, 43.32s/it]P:  0.9176355536238183
R:  0.900319829424307
F:  0.9088952268202121

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.25s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.62s/it][A
 38%|███▊      | 3/8 [00:16<00:26,  5.37s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.28s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.20s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:04,  4.99s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.48s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.806921
GEO: 0.835264
=======entity level========

Epoch: 16, P: 0.918660, R: 0.900640, F: 0.909561, OOV: 0.806921, GEO: 0.835264
=======entity level========
Epoch:  32%|███▏      | 16/50 [11:31<24:29, 43.21s/it]P:  0.9186602870813397
R:  0.9006396588486141
F:  0.9095607235142118

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.64s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.39s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.25s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.23s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.21s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.15s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.20s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.63s/it][A100%|██████████| 8/8 [00:40<00:00,  5.01s/it]
OOV: 0.803040
GEO: 0.840336
=======entity level========

Epoch: 17, P: 0.920157, R: 0.896908, F: 0.908384, OOV: 0.803040, GEO: 0.840336
=======entity level========
Epoch:  34%|███▍      | 17/50 [12:15<23:56, 43.52s/it]P:  0.9201574975391009
R:  0.896908315565032
F:  0.9083841710306106

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.55s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.02s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.03s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.17s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.02s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.17s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.20s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.804010
GEO: 0.831403
=======entity level========

Epoch: 18, P: 0.919451, R: 0.900533, F: 0.909894, OOV: 0.804010, GEO: 0.831403
=======entity level========
Epoch:  36%|███▌      | 18/50 [12:58<23:07, 43.35s/it]P:  0.9194513987155764
R:  0.9005330490405117
F:  0.9098938977756234

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.84s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.20s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.31s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.36s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.22s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.20s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.60s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.804334
GEO: 0.832690
=======entity level========

Epoch: 19, P: 0.919364, R: 0.899467, F: 0.909306, OOV: 0.804334, GEO: 0.832690
=======entity level========
Epoch:  38%|███▊      | 19/50 [13:41<22:22, 43.32s/it]P:  0.919363626457448
R:  0.8994669509594883
F:  0.9093064611736812

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  5.00s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.02s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.18s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.30s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.33s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.35s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.29s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.58s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.804981
GEO: 0.834727
=======entity level========

Epoch: 20, P: 0.920567, R: 0.899467, F: 0.909895, OOV: 0.804981, GEO: 0.834727
=======entity level========
Epoch:  40%|████      | 20/50 [14:25<21:39, 43.33s/it]P:  0.9205673758865248
R:  0.8994669509594883
F:  0.9098948503639795

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.76s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.91s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.94s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.09s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.17s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.17s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.30s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.70s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.804010
GEO: 0.839793
=======entity level========

Epoch: 21, P: 0.920476, R: 0.899574, F: 0.909905, OOV: 0.804010, GEO: 0.839793
=======entity level========
Epoch:  42%|████▏     | 21/50 [15:08<20:53, 43.22s/it]P:  0.9204756190683975
R:  0.8995735607675907
F:  0.909904566776298

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.15s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.10s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.12s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.23s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.805304
GEO: 0.823831
=======entity level========

Epoch: 22, P: 0.918420, R: 0.902559, F: 0.910420, OOV: 0.805304, GEO: 0.823831
=======entity level========
Epoch:  44%|████▍     | 22/50 [15:51<20:10, 43.24s/it]P:  0.9184204816663051
R:  0.9025586353944562
F:  0.9104204753199269

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.89s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.92s/it][A
 38%|███▊      | 3/8 [00:14<00:25,  5.03s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.20s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.02s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.12s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.14s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.90s/it]
OOV: 0.808862
GEO: 0.833654
=======entity level========

Epoch: 23, P: 0.919007, R: 0.903625, F: 0.911251, OOV: 0.808862, GEO: 0.833654
=======entity level========
Epoch:  46%|████▌     | 23/50 [16:34<19:23, 43.09s/it]P:  0.919006830749214
R:  0.9036247334754798
F:  0.9112508735150245

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:37,  5.38s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.10s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.15s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.08s/it][A
 62%|██████▎   | 5/8 [00:25<00:14,  4.93s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.14s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.22s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.71s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.804010
GEO: 0.835705
=======entity level========

Epoch: 24, P: 0.920642, R: 0.899147, F: 0.909768, OOV: 0.804010, GEO: 0.835705
=======entity level========
Epoch:  48%|████▊     | 24/50 [17:17<18:40, 43.10s/it]P:  0.9206418513262744
R:  0.8991471215351813
F:  0.9097675422037645

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.09s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.92s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.99s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.07s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.30s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.804981
GEO: 0.839043
=======entity level========

Epoch: 25, P: 0.920140, R: 0.899147, F: 0.909522, OOV: 0.804981, GEO: 0.839043
=======entity level========
Epoch:  50%|█████     | 25/50 [18:00<17:55, 43.04s/it]P:  0.9201396465197469
R:  0.8991471215351813
F:  0.909522268952874

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.96s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.17s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.20s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.11s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.14s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.58s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.804981
GEO: 0.836129
=======entity level========

Epoch: 26, P: 0.921357, R: 0.900533, F: 0.910826, OOV: 0.804981, GEO: 0.836129
=======entity level========
Epoch:  52%|█████▏    | 26/50 [18:43<17:11, 42.98s/it]P:  0.9213568935427574
R:  0.9005330490405117
F:  0.9108259650636187

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.97s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.08s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.94s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.10s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.05s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.25s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.23s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.60s/it][A100%|██████████| 8/8 [00:39<00:00,  4.91s/it]
OOV: 0.807245
GEO: 0.829049
=======entity level========

Epoch: 27, P: 0.919883, R: 0.902132, F: 0.910921, OOV: 0.807245, GEO: 0.829049
=======entity level========

Early stop triggered at epoch 26

Epoch:  52%|█████▏    | 26/50 [19:25<17:56, 44.84s/it]

=======best f entity level========

Epoch: 17, P: 0.920157, R: 0.896908, F: 0.908384, OOV: 0.803040, GEO: 0.840336, GEO_N: 0.828129


=======best f entity level========
P:  0.9198825959343407
R:  0.9021321961620469
F:  0.9109209322353194
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:01<01:02,  1.03s/it]  3%|▎         | 2/62 [00:01<00:59,  1.01it/s]  5%|▍         | 3/62 [00:02<00:55,  1.06it/s]  6%|▋         | 4/62 [00:03<00:56,  1.02it/s]  8%|▊         | 5/62 [00:05<00:59,  1.04s/it] 10%|▉         | 6/62 [00:06<01:00,  1.09s/it] 11%|█▏        | 7/62 [00:06<00:51,  1.06it/s] 13%|█▎        | 8/62 [00:07<00:46,  1.15it/s] 15%|█▍        | 9/62 [00:08<00:48,  1.08it/s] 16%|█▌        | 10/62 [00:09<00:47,  1.10it/s] 18%|█▊        | 11/62 [00:10<00:53,  1.05s/it] 19%|█▉        | 12/62 [00:11<00:48,  1.03it/s] 21%|██        | 13/62 [00:12<00:52,  1.06s/it] 23%|██▎       | 14/62 [00:14<00:51,  1.07s/it] 24%|██▍       | 15/62 [00:14<00:48,  1.03s/it] 26%|██▌       | 16/62 [00:15<00:41,  1.12it/s] 27%|██▋       | 17/62 [00:16<00:37,  1.20it/s] 29%|██▉       | 18/62 [00:17<00:39,  1.12it/s] 31%|███       | 19/62 [00:18<00:46,  1.07s/it] 32%|███▏      | 20/62 [00:20<00:49,  1.19s/it] 34%|███▍      | 21/62 [00:22<00:57,  1.41s/it] 35%|███▌      | 22/62 [00:23<00:51,  1.28s/it] 37%|███▋      | 23/62 [00:23<00:42,  1.09s/it] 39%|███▊      | 24/62 [00:24<00:42,  1.12s/it] 40%|████      | 25/62 [00:27<00:53,  1.45s/it] 42%|████▏     | 26/62 [00:28<00:49,  1.38s/it] 44%|████▎     | 27/62 [00:29<00:44,  1.26s/it] 45%|████▌     | 28/62 [00:30<00:41,  1.21s/it] 47%|████▋     | 29/62 [00:31<00:39,  1.20s/it] 48%|████▊     | 30/62 [00:32<00:35,  1.11s/it] 50%|█████     | 31/62 [00:33<00:33,  1.08s/it] 52%|█████▏    | 32/62 [00:34<00:28,  1.06it/s] 53%|█████▎    | 33/62 [00:35<00:30,  1.04s/it] 55%|█████▍    | 34/62 [00:36<00:30,  1.10s/it] 56%|█████▋    | 35/62 [00:37<00:28,  1.05s/it] 58%|█████▊    | 36/62 [00:38<00:24,  1.05it/s] 60%|█████▉    | 37/62 [00:38<00:20,  1.24it/s] 61%|██████▏   | 38/62 [00:39<00:20,  1.19it/s] 63%|██████▎   | 39/62 [00:40<00:22,  1.04it/s] 65%|██████▍   | 40/62 [00:41<00:20,  1.06it/s] 66%|██████▌   | 41/62 [00:42<00:19,  1.08it/s] 68%|██████▊   | 42/62 [00:43<00:18,  1.09it/s] 69%|██████▉   | 43/62 [00:44<00:18,  1.03it/s] 71%|███████   | 44/62 [00:45<00:16,  1.07it/s] 73%|███████▎  | 45/62 [00:47<00:19,  1.14s/it] 74%|███████▍  | 46/62 [00:47<00:15,  1.00it/s] 76%|███████▌  | 47/62 [00:48<00:14,  1.07it/s] 77%|███████▋  | 48/62 [00:49<00:12,  1.08it/s] 79%|███████▉  | 49/62 [00:51<00:14,  1.10s/it] 81%|████████  | 50/62 [00:51<00:12,  1.02s/it] 82%|████████▏ | 51/62 [00:53<00:11,  1.04s/it] 84%|████████▍ | 52/62 [00:54<00:10,  1.07s/it] 85%|████████▌ | 53/62 [00:55<00:11,  1.28s/it] 87%|████████▋ | 54/62 [00:56<00:09,  1.17s/it] 89%|████████▊ | 55/62 [00:57<00:07,  1.09s/it] 90%|█████████ | 56/62 [00:58<00:05,  1.01it/s] 92%|█████████▏| 57/62 [00:59<00:04,  1.06it/s] 94%|█████████▎| 58/62 [01:00<00:03,  1.10it/s] 95%|█████████▌| 59/62 [01:01<00:02,  1.10it/s] 97%|█████████▋| 60/62 [01:01<00:01,  1.18it/s] 98%|█████████▊| 61/62 [01:03<00:00,  1.00it/s]100%|██████████| 62/62 [01:04<00:00,  1.03it/s]100%|██████████| 62/62 [01:04<00:00,  1.03s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0_0.817', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.95s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.22s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.22s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.12s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.11s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.16s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.20s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.59s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.664942
GEO: 0.557035
=======entity level========

Epoch: 1, P: 0.822069, R: 0.787100, F: 0.804205, OOV: 0.664942, GEO: 0.557035
=======entity level========
Epoch:   2%|▏         | 1/50 [00:43<35:28, 43.43s/it]P:  0.82206881193631
R:  0.7871002132196162
F:  0.8042045640215674

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.93s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.89s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.93s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.09s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.13s/it][A
100%|██████████| 8/8 [00:38<00:00,  4.50s/it][A100%|██████████| 8/8 [00:38<00:00,  4.85s/it]
OOV: 0.785576
GEO: 0.820413
=======entity level========

Epoch: 2, P: 0.913548, R: 0.882090, F: 0.897543, OOV: 0.785576, GEO: 0.820413
=======entity level========
Epoch:   4%|▍         | 2/50 [01:26<34:32, 43.19s/it]P:  0.913547532295462
R:  0.8820895522388059
F:  0.897542984216521

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.05s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.46s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.14s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.22s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.21s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.07s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.58s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.791074
GEO: 0.836246
=======entity level========

Epoch: 3, P: 0.917695, R: 0.887953, F: 0.902579, OOV: 0.791074, GEO: 0.836246
=======entity level========
Epoch:   6%|▌         | 3/50 [02:10<34:02, 43.47s/it]P:  0.9176950198325253
R:  0.8879530916844349
F:  0.902579107065453

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.01s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.08s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.45s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.20s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.26s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.17s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.13s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.50s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.805627
GEO: 0.803810
=======entity level========

Epoch: 4, P: 0.913090, R: 0.902772, F: 0.907902, OOV: 0.805627, GEO: 0.803810
=======entity level========
Epoch:   8%|▊         | 4/50 [02:53<33:08, 43.22s/it]P:  0.9130903601466466
R:  0.9027718550106609
F:  0.9079017905006969

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.03s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.98s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.97s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.06s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.16s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.13s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.91s/it]
OOV: 0.803364
GEO: 0.816379
=======entity level========

Epoch: 5, P: 0.916558, R: 0.900533, F: 0.908475, OOV: 0.803364, GEO: 0.816379
=======entity level========
Epoch:  10%|█         | 5/50 [03:35<32:17, 43.05s/it]P:  0.9165581597222222
R:  0.9005330490405117
F:  0.9084749408474941

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.87s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.11s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.07s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.31s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.26s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.29s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.28s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.800453
GEO: 0.833657
=======entity level========

Epoch: 6, P: 0.918233, R: 0.895522, F: 0.906736, OOV: 0.800453, GEO: 0.833657
=======entity level========
Epoch:  12%|█▏        | 6/50 [04:19<31:40, 43.18s/it]P:  0.9182334936598163
R:  0.8955223880597015
F:  0.9067357512953368

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.12s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.10s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.03s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.31s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.26s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.55s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.803364
GEO: 0.834625
=======entity level========

Epoch: 7, P: 0.918103, R: 0.897548, F: 0.907709, OOV: 0.803364, GEO: 0.834625
=======entity level========
Epoch:  14%|█▍        | 7/50 [05:02<30:53, 43.10s/it]P:  0.9181025081788441
R:  0.8975479744136461
F:  0.9077088948787062

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.17s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.57s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.17s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.12s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.08s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.57s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.804010
GEO: 0.819169
=======entity level========

Epoch: 8, P: 0.918054, R: 0.899360, F: 0.908611, OOV: 0.804010, GEO: 0.819169
=======entity level========
Epoch:  16%|█▌        | 8/50 [05:45<30:09, 43.08s/it]P:  0.9180541952334312
R:  0.899360341151386
F:  0.9086111260703322

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.07s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.93s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.13s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.07s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.21s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.48s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.37s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.71s/it][A100%|██████████| 8/8 [00:40<00:00,  5.02s/it]
OOV: 0.802717
GEO: 0.819231
=======entity level========

Epoch: 9, P: 0.916151, R: 0.899254, F: 0.907624, OOV: 0.802717, GEO: 0.819231
=======entity level========
Epoch:  18%|█▊        | 9/50 [06:28<29:33, 43.25s/it]P:  0.9161507548604323
R:  0.8992537313432836
F:  0.9076236078979931

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.84s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.95s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.27s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.17s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.10s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.26s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.804657
GEO: 0.851395
=======entity level========

Epoch: 10, P: 0.919629, R: 0.899041, F: 0.909218, OOV: 0.804657, GEO: 0.851395
=======entity level========
Epoch:  20%|██        | 10/50 [07:12<28:55, 43.38s/it]P:  0.919629225736096
R:  0.8990405117270789
F:  0.9092183288409703

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.94s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.21s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.28s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.10s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.00s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.04s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.18s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.806274
GEO: 0.822023
=======entity level========

Epoch: 11, P: 0.919935, R: 0.900320, F: 0.910022, OOV: 0.806274, GEO: 0.822023
=======entity level========
Epoch:  22%|██▏       | 11/50 [07:55<28:06, 43.24s/it]P:  0.9199346405228758
R:  0.900319829424307
F:  0.9100215517241378

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.23s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.12s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.09s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.23s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.13s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.23s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.52s/it][A100%|██████████| 8/8 [00:39<00:00,  4.91s/it]
OOV: 0.804657
GEO: 0.810433
=======entity level========

Epoch: 12, P: 0.918049, R: 0.902878, F: 0.910400, OOV: 0.804657, GEO: 0.810433
=======entity level========
Epoch:  24%|██▍       | 12/50 [08:38<27:17, 43.09s/it]P:  0.9180487804878049
R:  0.9028784648187633
F:  0.9104004299919377

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.61s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.27s/it][A
 38%|███▊      | 3/8 [00:15<00:24,  4.96s/it][A
 50%|█████     | 4/8 [00:20<00:19,  4.93s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.03s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.07s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.11s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.78s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.804010
GEO: 0.835052
=======entity level========

Epoch: 13, P: 0.919830, R: 0.899041, F: 0.909316, OOV: 0.804010, GEO: 0.835052
=======entity level========
Epoch:  26%|██▌       | 13/50 [09:21<26:35, 43.12s/it]P:  0.9198298429319371
R:  0.8990405117270789
F:  0.9093163683416002

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.91s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.47s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.28s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.23s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.16s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.16s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.10s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.801100
GEO: 0.824888
=======entity level========

Epoch: 14, P: 0.917594, R: 0.896269, F: 0.906806, OOV: 0.801100, GEO: 0.824888
=======entity level========
Epoch:  28%|██▊       | 14/50 [10:04<25:54, 43.18s/it]P:  0.917594411700502
R:  0.8962686567164179
F:  0.9068061697767231

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.51s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.35s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.45s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.18s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:35<00:04,  4.98s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.66s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.808862
GEO: 0.830334
=======entity level========

Epoch: 15, P: 0.916351, R: 0.902772, F: 0.909511, OOV: 0.808862, GEO: 0.830334
=======entity level========
Epoch:  30%|███       | 15/50 [10:48<25:13, 43.24s/it]P:  0.9163510442592793
R:  0.9027718550106609
F:  0.9095107674131357

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.26s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.59s/it][A
 38%|███▊      | 3/8 [00:16<00:26,  5.35s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.28s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.19s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.11s/it][A
 88%|████████▊ | 7/8 [00:35<00:04,  4.97s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.48s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.808862
GEO: 0.831403
=======entity level========

Epoch: 16, P: 0.917336, R: 0.901493, F: 0.909345, OOV: 0.808862, GEO: 0.831403
=======entity level========
Epoch:  32%|███▏      | 16/50 [11:30<24:26, 43.13s/it]P:  0.9173356476459101
R:  0.9014925373134328
F:  0.909345090869986

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.63s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.40s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.22s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.20s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.16s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.11s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.60s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.806921
GEO: 0.833226
=======entity level========

Epoch: 17, P: 0.919090, R: 0.899787, F: 0.909336, OOV: 0.806921, GEO: 0.833226
=======entity level========
Epoch:  34%|███▍      | 17/50 [12:14<23:44, 43.17s/it]P:  0.919089622127845
R:  0.8997867803837953
F:  0.9093357754673275

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.57s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.03s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.04s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.16s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.03s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.23s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.66s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.809185
GEO: 0.837629
=======entity level========

Epoch: 18, P: 0.921285, R: 0.902132, F: 0.911608, OOV: 0.809185, GEO: 0.837629
=======entity level========
Epoch:  36%|███▌      | 18/50 [12:57<23:01, 43.16s/it]P:  0.9212847033206315
R:  0.9021321961620469
F:  0.9116078642607056

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.81s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.22s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.30s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.35s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.22s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.56s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.805951
GEO: 0.837090
=======entity level========

Epoch: 19, P: 0.920611, R: 0.900000, F: 0.910189, OOV: 0.805951, GEO: 0.837090
=======entity level========
Epoch:  38%|███▊      | 19/50 [13:40<22:17, 43.14s/it]P:  0.9206106870229007
R:  0.9
F:  0.9101886792452831

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.02s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.02s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.19s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.31s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.32s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.35s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.29s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.57s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.808215
GEO: 0.823003
=======entity level========

Epoch: 20, P: 0.920984, R: 0.902132, F: 0.911461, OOV: 0.808215, GEO: 0.823003
=======entity level========

Early stop triggered at epoch 19

Epoch:  38%|███▊      | 19/50 [14:23<23:29, 45.46s/it]

=======best f entity level========

Epoch: 10, P: 0.919629, R: 0.899041, F: 0.909218, OOV: 0.804657, GEO: 0.851395, GEO_N: 0.832552


=======best f entity level========
P:  0.9209838920330866
R:  0.9021321961620469
F:  0.9114605773373544
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:01<01:02,  1.02s/it]  3%|▎         | 2/62 [00:01<00:59,  1.01it/s]  5%|▍         | 3/62 [00:02<00:55,  1.07it/s]  6%|▋         | 4/62 [00:03<00:56,  1.02it/s]  8%|▊         | 5/62 [00:05<00:59,  1.04s/it] 10%|▉         | 6/62 [00:06<01:00,  1.09s/it] 11%|█▏        | 7/62 [00:06<00:51,  1.06it/s] 13%|█▎        | 8/62 [00:07<00:46,  1.15it/s] 15%|█▍        | 9/62 [00:08<00:48,  1.08it/s] 16%|█▌        | 10/62 [00:09<00:47,  1.10it/s] 18%|█▊        | 11/62 [00:10<00:53,  1.05s/it] 19%|█▉        | 12/62 [00:11<00:48,  1.03it/s] 21%|██        | 13/62 [00:12<00:52,  1.06s/it] 23%|██▎       | 14/62 [00:14<00:51,  1.07s/it] 24%|██▍       | 15/62 [00:14<00:48,  1.03s/it] 26%|██▌       | 16/62 [00:15<00:40,  1.12it/s] 27%|██▋       | 17/62 [00:16<00:37,  1.20it/s] 29%|██▉       | 18/62 [00:17<00:39,  1.12it/s] 31%|███       | 19/62 [00:18<00:45,  1.07s/it] 32%|███▏      | 20/62 [00:20<00:49,  1.18s/it] 34%|███▍      | 21/62 [00:22<00:57,  1.41s/it] 35%|███▌      | 22/62 [00:23<00:51,  1.28s/it] 37%|███▋      | 23/62 [00:23<00:42,  1.09s/it] 39%|███▊      | 24/62 [00:24<00:42,  1.12s/it] 40%|████      | 25/62 [00:27<00:53,  1.45s/it] 42%|████▏     | 26/62 [00:28<00:49,  1.38s/it] 44%|████▎     | 27/62 [00:29<00:44,  1.26s/it] 45%|████▌     | 28/62 [00:30<00:41,  1.21s/it] 47%|████▋     | 29/62 [00:31<00:39,  1.20s/it] 48%|████▊     | 30/62 [00:32<00:35,  1.11s/it] 50%|█████     | 31/62 [00:33<00:33,  1.08s/it] 52%|█████▏    | 32/62 [00:34<00:28,  1.06it/s] 53%|█████▎    | 33/62 [00:35<00:30,  1.04s/it] 55%|█████▍    | 34/62 [00:36<00:30,  1.10s/it] 56%|█████▋    | 35/62 [00:37<00:28,  1.05s/it] 58%|█████▊    | 36/62 [00:38<00:24,  1.05it/s] 60%|█████▉    | 37/62 [00:38<00:20,  1.24it/s] 61%|██████▏   | 38/62 [00:39<00:20,  1.19it/s] 63%|██████▎   | 39/62 [00:40<00:21,  1.05it/s] 65%|██████▍   | 40/62 [00:41<00:20,  1.06it/s] 66%|██████▌   | 41/62 [00:42<00:19,  1.08it/s] 68%|██████▊   | 42/62 [00:43<00:18,  1.09it/s] 69%|██████▉   | 43/62 [00:44<00:18,  1.03it/s] 71%|███████   | 44/62 [00:45<00:16,  1.08it/s] 73%|███████▎  | 45/62 [00:47<00:19,  1.14s/it] 74%|███████▍  | 46/62 [00:47<00:15,  1.00it/s] 76%|███████▌  | 47/62 [00:48<00:14,  1.07it/s] 77%|███████▋  | 48/62 [00:49<00:12,  1.08it/s] 79%|███████▉  | 49/62 [00:51<00:14,  1.09s/it] 81%|████████  | 50/62 [00:51<00:12,  1.02s/it] 82%|████████▏ | 51/62 [00:52<00:11,  1.04s/it] 84%|████████▍ | 52/62 [00:54<00:10,  1.07s/it] 85%|████████▌ | 53/62 [00:55<00:11,  1.28s/it] 87%|████████▋ | 54/62 [00:56<00:09,  1.17s/it] 89%|████████▊ | 55/62 [00:57<00:07,  1.08s/it] 90%|█████████ | 56/62 [00:58<00:05,  1.01it/s] 92%|█████████▏| 57/62 [00:59<00:04,  1.06it/s] 94%|█████████▎| 58/62 [01:00<00:03,  1.10it/s] 95%|█████████▌| 59/62 [01:01<00:02,  1.10it/s] 97%|█████████▋| 60/62 [01:01<00:01,  1.18it/s] 98%|█████████▊| 61/62 [01:03<00:01,  1.00s/it]100%|██████████| 62/62 [01:03<00:00,  1.04it/s]100%|██████████| 62/62 [01:03<00:00,  1.03s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0_0.818', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.97s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.23s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.20s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.12s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.09s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.17s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.21s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.60s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.664295
GEO: 0.557681
=======entity level========

Epoch: 1, P: 0.822081, R: 0.786674, F: 0.803988, OOV: 0.664295, GEO: 0.557681
=======entity level========
Epoch:   2%|▏         | 1/50 [00:43<35:24, 43.36s/it]P:  0.8220811051693404
R:  0.7866737739872068
F:  0.8039877969056439

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.98s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.94s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.96s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.10s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.23s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.52s/it][A100%|██████████| 8/8 [00:39<00:00,  4.88s/it]
OOV: 0.785252
GEO: 0.821705
=======entity level========

Epoch: 2, P: 0.913576, R: 0.882409, F: 0.897722, OOV: 0.785252, GEO: 0.821705
=======entity level========
Epoch:   4%|▍         | 2/50 [01:26<34:35, 43.25s/it]P:  0.9135761589403973
R:  0.882409381663113
F:  0.8977223427331887

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.10s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.47s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.15s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.23s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.22s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.22s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.07s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.58s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.793984
GEO: 0.839922
=======entity level========

Epoch: 3, P: 0.918996, R: 0.890192, F: 0.904365, OOV: 0.793984, GEO: 0.839922
=======entity level========
Epoch:   6%|▌         | 3/50 [02:10<34:04, 43.51s/it]P:  0.9189962579793088
R:  0.8901918976545842
F:  0.9043647785118596

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.00s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.09s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.50s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.22s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.24s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.15s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.49s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.803364
GEO: 0.799492
=======entity level========

Epoch: 4, P: 0.913034, R: 0.902132, F: 0.907550, OOV: 0.803364, GEO: 0.799492
=======entity level========
Epoch:   8%|▊         | 4/50 [02:53<33:11, 43.29s/it]P:  0.913034095813552
R:  0.9021321961620469
F:  0.9075504075504075

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.06s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.00s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.98s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.06s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.18s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.61s/it][A100%|██████████| 8/8 [00:39<00:00,  4.90s/it]
OOV: 0.804334
GEO: 0.824134
=======entity level========

Epoch: 5, P: 0.918352, R: 0.900533, F: 0.909355, OOV: 0.804334, GEO: 0.824134
=======entity level========
Epoch:  10%|█         | 5/50 [03:36<32:19, 43.10s/it]P:  0.9183518156120896
R:  0.9005330490405117
F:  0.9093551512541717

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.89s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.12s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.09s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.30s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.26s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.27s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.27s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.802717
GEO: 0.825274
=======entity level========

Epoch: 6, P: 0.915308, R: 0.897548, F: 0.906341, OOV: 0.802717, GEO: 0.825274
=======entity level========
Epoch:  12%|█▏        | 6/50 [04:19<31:39, 43.18s/it]P:  0.9153076755816482
R:  0.8975479744136461
F:  0.9063408332436214

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.11s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.13s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.08s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.33s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.27s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.22s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.21s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.57s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.805627
GEO: 0.840467
=======entity level========

Epoch: 7, P: 0.919550, R: 0.898081, F: 0.908689, OOV: 0.805627, GEO: 0.840467
=======entity level========
Epoch:  14%|█▍        | 7/50 [05:03<31:03, 43.34s/it]P:  0.9195502674380526
R:  0.8980810234541577
F:  0.9086888517339949

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.18s/it][A
 25%|██▌       | 2/8 [00:10<00:33,  5.55s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.15s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.11s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.07s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.58s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.806598
GEO: 0.822251
=======entity level========

Epoch: 8, P: 0.919078, R: 0.900853, F: 0.909874, OOV: 0.806598, GEO: 0.822251
=======entity level========
Epoch:  16%|█▌        | 8/50 [05:46<30:16, 43.24s/it]P:  0.9190776593430499
R:  0.9008528784648188
F:  0.9098740174437385

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.10s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.94s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.14s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.07s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.24s/it][A
 75%|███████▌  | 6/8 [00:31<00:11,  5.52s/it][A
 88%|████████▊ | 7/8 [00:37<00:05,  5.40s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.72s/it][A100%|██████████| 8/8 [00:40<00:00,  5.04s/it]
OOV: 0.806598
GEO: 0.830968
=======entity level========

Epoch: 9, P: 0.917510, R: 0.898827, F: 0.908073, OOV: 0.806598, GEO: 0.830968
=======entity level========
Epoch:  18%|█▊        | 9/50 [06:29<29:39, 43.40s/it]P:  0.9175100663837197
R:  0.8988272921108742
F:  0.9080725941084604

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.82s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.95s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.30s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.20s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.12s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.22s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.27s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.806921
GEO: 0.852140
=======entity level========

Epoch: 10, P: 0.920637, R: 0.900320, F: 0.910365, OOV: 0.806921, GEO: 0.852140
=======entity level========
Epoch:  20%|██        | 10/50 [07:13<29:01, 43.55s/it]P:  0.9206366510410989
R:  0.900319829424307
F:  0.9103649005551663

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.93s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.25s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.31s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.11s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.00s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.07s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.20s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.809185
GEO: 0.804320
=======entity level========

Epoch: 11, P: 0.916838, R: 0.902665, F: 0.909696, OOV: 0.809185, GEO: 0.804320
=======entity level========
Epoch:  22%|██▏       | 11/50 [07:56<28:11, 43.38s/it]P:  0.9168381158635626
R:  0.9026652452025586
F:  0.909696481332259

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.19s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.11s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.09s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.20s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.13s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.26s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.53s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.808215
GEO: 0.826701
=======entity level========

Epoch: 12, P: 0.919441, R: 0.904051, F: 0.911681, OOV: 0.808215, GEO: 0.826701
=======entity level========
Epoch:  24%|██▍       | 12/50 [08:39<27:21, 43.20s/it]P:  0.9194405291120026
R:  0.9040511727078892
F:  0.9116809116809117

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.67s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.31s/it][A
 38%|███▊      | 3/8 [00:15<00:24,  4.96s/it][A
 50%|█████     | 4/8 [00:20<00:19,  4.96s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.04s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.09s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.11s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.78s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.804657
GEO: 0.839458
=======entity level========

Epoch: 13, P: 0.919573, R: 0.899574, F: 0.909463, OOV: 0.804657, GEO: 0.839458
=======entity level========
Epoch:  26%|██▌       | 13/50 [09:22<26:39, 43.22s/it]P:  0.9195727986050567
R:  0.8995735607675907
F:  0.9094632463893081

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.93s/it][A
 25%|██▌       | 2/8 [00:10<00:33,  5.51s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.32s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.27s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.17s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.16s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.68s/it][A100%|██████████| 8/8 [00:40<00:00,  5.00s/it]
OOV: 0.804010
GEO: 0.835052
=======entity level========

Epoch: 14, P: 0.918394, R: 0.897441, F: 0.907797, OOV: 0.804010, GEO: 0.835052
=======entity level========
Epoch:  28%|██▊       | 14/50 [10:06<25:58, 43.30s/it]P:  0.9183940650229108
R:  0.8974413646055437
F:  0.9077968295050146

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.51s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.33s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.46s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.19s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.17s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.16s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.02s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.67s/it][A100%|██████████| 8/8 [00:40<00:00,  5.00s/it]
OOV: 0.807891
GEO: 0.832690
=======entity level========

Epoch: 15, P: 0.915227, R: 0.903518, F: 0.909335, OOV: 0.807891, GEO: 0.832690
=======entity level========
Epoch:  30%|███       | 15/50 [10:49<25:17, 43.37s/it]P:  0.9152267818574514
R:  0.9035181236673774
F:  0.9093347639484979

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.26s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.61s/it][A
 38%|███▊      | 3/8 [00:16<00:26,  5.38s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.29s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.22s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.15s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.00s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.50s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.806598
GEO: 0.845655
=======entity level========

Epoch: 16, P: 0.921093, R: 0.898507, F: 0.909660, OOV: 0.806598, GEO: 0.845655
=======entity level========
Epoch:  32%|███▏      | 16/50 [11:32<24:31, 43.27s/it]P:  0.9210928961748633
R:  0.8985074626865671
F:  0.9096600107933082

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.66s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.44s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.25s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.13s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.19s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.63s/it][A100%|██████████| 8/8 [00:40<00:00,  5.00s/it]
OOV: 0.807891
GEO: 0.834514
=======entity level========

Epoch: 17, P: 0.918834, R: 0.900320, F: 0.909483, OOV: 0.807891, GEO: 0.834514
=======entity level========
Epoch:  34%|███▍      | 17/50 [12:16<23:49, 43.33s/it]P:  0.9188336416059188
R:  0.900319829424307
F:  0.9094825265198426

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.54s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.05s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.06s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.17s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.02s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.23s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.66s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.808215
GEO: 0.826171
=======entity level========

Epoch: 18, P: 0.918901, R: 0.902345, F: 0.910548, OOV: 0.808215, GEO: 0.826171
=======entity level========
Epoch:  36%|███▌      | 18/50 [12:59<23:04, 43.28s/it]P:  0.9189013136467268
R:  0.9023454157782516
F:  0.9105481146791459

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.84s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.22s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.33s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.38s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.27s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.25s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.19s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.60s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.807891
GEO: 0.826255
=======entity level========

Epoch: 19, P: 0.918887, R: 0.900959, F: 0.909835, OOV: 0.807891, GEO: 0.826255
=======entity level========
Epoch:  38%|███▊      | 19/50 [13:42<22:22, 43.31s/it]P:  0.9188865934543873
R:  0.9009594882729212
F:  0.9098347418851267

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.05s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.04s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.23s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.35s/it][A
 62%|██████▎   | 5/8 [00:26<00:16,  5.35s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.38s/it][A
 88%|████████▊ | 7/8 [00:37<00:05,  5.32s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.59s/it][A100%|██████████| 8/8 [00:40<00:00,  5.01s/it]
OOV: 0.808538
GEO: 0.824359
=======entity level========

Epoch: 20, P: 0.917289, R: 0.903305, F: 0.910243, OOV: 0.808538, GEO: 0.824359
=======entity level========

Early stop triggered at epoch 19

Epoch:  38%|███▊      | 19/50 [14:26<23:33, 45.60s/it]

=======best f entity level========

Epoch: 10, P: 0.920637, R: 0.900320, F: 0.910365, OOV: 0.806921, GEO: 0.852140, GEO_N: 0.834770


=======best f entity level========
P:  0.9172891631482083
R:  0.9033049040511727
F:  0.9102433259923726
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:01<01:02,  1.03s/it]  3%|▎         | 2/62 [00:01<00:59,  1.01it/s]  5%|▍         | 3/62 [00:02<00:55,  1.07it/s]  6%|▋         | 4/62 [00:03<00:56,  1.02it/s]  8%|▊         | 5/62 [00:05<00:59,  1.04s/it] 10%|▉         | 6/62 [00:06<01:00,  1.09s/it] 11%|█▏        | 7/62 [00:06<00:52,  1.06it/s] 13%|█▎        | 8/62 [00:07<00:47,  1.15it/s] 15%|█▍        | 9/62 [00:08<00:49,  1.08it/s] 16%|█▌        | 10/62 [00:09<00:47,  1.10it/s] 18%|█▊        | 11/62 [00:10<00:53,  1.05s/it] 19%|█▉        | 12/62 [00:11<00:48,  1.03it/s] 21%|██        | 13/62 [00:12<00:52,  1.06s/it] 23%|██▎       | 14/62 [00:14<00:51,  1.07s/it] 24%|██▍       | 15/62 [00:14<00:48,  1.03s/it] 26%|██▌       | 16/62 [00:15<00:40,  1.12it/s] 27%|██▋       | 17/62 [00:16<00:37,  1.20it/s] 29%|██▉       | 18/62 [00:17<00:39,  1.12it/s] 31%|███       | 19/62 [00:18<00:45,  1.07s/it] 32%|███▏      | 20/62 [00:20<00:49,  1.18s/it] 34%|███▍      | 21/62 [00:22<00:57,  1.41s/it] 35%|███▌      | 22/62 [00:23<00:51,  1.28s/it] 37%|███▋      | 23/62 [00:23<00:42,  1.09s/it] 39%|███▊      | 24/62 [00:24<00:42,  1.12s/it] 40%|████      | 25/62 [00:27<00:53,  1.45s/it] 42%|████▏     | 26/62 [00:28<00:49,  1.38s/it] 44%|████▎     | 27/62 [00:29<00:44,  1.26s/it] 45%|████▌     | 28/62 [00:30<00:41,  1.21s/it] 47%|████▋     | 29/62 [00:31<00:39,  1.20s/it] 48%|████▊     | 30/62 [00:32<00:35,  1.11s/it] 50%|█████     | 31/62 [00:33<00:33,  1.08s/it] 52%|█████▏    | 32/62 [00:34<00:28,  1.05it/s] 53%|█████▎    | 33/62 [00:35<00:30,  1.04s/it] 55%|█████▍    | 34/62 [00:36<00:30,  1.10s/it] 56%|█████▋    | 35/62 [00:37<00:28,  1.05s/it] 58%|█████▊    | 36/62 [00:38<00:24,  1.05it/s] 60%|█████▉    | 37/62 [00:38<00:20,  1.24it/s] 61%|██████▏   | 38/62 [00:39<00:20,  1.19it/s] 63%|██████▎   | 39/62 [00:40<00:21,  1.05it/s] 65%|██████▍   | 40/62 [00:41<00:20,  1.06it/s] 66%|██████▌   | 41/62 [00:42<00:19,  1.08it/s] 68%|██████▊   | 42/62 [00:43<00:18,  1.09it/s] 69%|██████▉   | 43/62 [00:44<00:18,  1.03it/s] 71%|███████   | 44/62 [00:45<00:16,  1.08it/s] 73%|███████▎  | 45/62 [00:47<00:19,  1.14s/it] 74%|███████▍  | 46/62 [00:47<00:15,  1.00it/s] 76%|███████▌  | 47/62 [00:48<00:14,  1.07it/s] 77%|███████▋  | 48/62 [00:49<00:12,  1.08it/s] 79%|███████▉  | 49/62 [00:51<00:14,  1.10s/it] 81%|████████  | 50/62 [00:51<00:12,  1.02s/it] 82%|████████▏ | 51/62 [00:53<00:11,  1.04s/it] 84%|████████▍ | 52/62 [00:54<00:10,  1.07s/it] 85%|████████▌ | 53/62 [00:55<00:11,  1.28s/it] 87%|████████▋ | 54/62 [00:56<00:09,  1.17s/it] 89%|████████▊ | 55/62 [00:57<00:07,  1.09s/it] 90%|█████████ | 56/62 [00:58<00:05,  1.01it/s] 92%|█████████▏| 57/62 [00:59<00:04,  1.06it/s] 94%|█████████▎| 58/62 [01:00<00:03,  1.10it/s] 95%|█████████▌| 59/62 [01:01<00:02,  1.10it/s] 97%|█████████▋| 60/62 [01:01<00:01,  1.17it/s] 98%|█████████▊| 61/62 [01:03<00:01,  1.00s/it]100%|██████████| 62/62 [01:04<00:00,  1.03it/s]100%|██████████| 62/62 [01:04<00:00,  1.03s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0_0.819', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.91s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.25s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.22s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.13s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.11s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.17s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.20s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.60s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.664295
GEO: 0.557681
=======entity level========

Epoch: 1, P: 0.821878, R: 0.786567, F: 0.803835, OOV: 0.664295, GEO: 0.557681
=======entity level========
Epoch:   2%|▏         | 1/50 [00:43<35:26, 43.39s/it]P:  0.8218781330065723
R:  0.7865671641791044
F:  0.8038350492999946

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.97s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.91s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.94s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.09s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.23s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.14s/it][A
100%|██████████| 8/8 [00:38<00:00,  4.51s/it][A100%|██████████| 8/8 [00:38<00:00,  4.87s/it]
OOV: 0.782988
GEO: 0.816248
=======entity level========

Epoch: 2, P: 0.912684, R: 0.881450, F: 0.896795, OOV: 0.782988, GEO: 0.816248
=======entity level========
Epoch:   4%|▍         | 2/50 [01:26<34:35, 43.24s/it]P:  0.9126835191522243
R:  0.8814498933901919
F:  0.8967948370302078

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.11s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.50s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.17s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.22s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.21s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.21s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.08s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.59s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.793338
GEO: 0.832362
=======entity level========

Epoch: 3, P: 0.918105, R: 0.890405, F: 0.904043, OOV: 0.793338, GEO: 0.832362
=======entity level========
Epoch:   6%|▌         | 3/50 [02:10<34:05, 43.53s/it]P:  0.918104869737276
R:  0.8904051172707889
F:  0.9040428641013151

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.06s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.11s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.49s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.26s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.28s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.18s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.14s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.50s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.802717
GEO: 0.795699
=======entity level========

Epoch: 4, P: 0.912266, R: 0.902345, F: 0.907278, OOV: 0.802717, GEO: 0.795699
=======entity level========
Epoch:   8%|▊         | 4/50 [02:53<33:12, 43.32s/it]P:  0.912265574477258
R:  0.9023454157782516
F:  0.9072783792475076

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.04s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.98s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.96s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.05s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.14s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.18s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.12s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.61s/it][A100%|██████████| 8/8 [00:39<00:00,  4.90s/it]
OOV: 0.804657
GEO: 0.823907
=======entity level========

Epoch: 5, P: 0.919908, R: 0.900000, F: 0.909845, OOV: 0.804657, GEO: 0.823907
=======entity level========
Epoch:  10%|█         | 5/50 [03:36<32:18, 43.07s/it]P:  0.919908466819222
R:  0.9
F:  0.9098453413806111

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.87s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.06s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.05s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.29s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.24s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.27s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.27s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.65s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.802393
GEO: 0.832041
=======entity level========

Epoch: 6, P: 0.916395, R: 0.897441, F: 0.906819, OOV: 0.802393, GEO: 0.832041
=======entity level========
Epoch:  12%|█▏        | 6/50 [04:19<31:38, 43.14s/it]P:  0.9163945133899413
R:  0.8974413646055437
F:  0.9068189162986104

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.12s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.13s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.04s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.31s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.25s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.18s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.18s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.55s/it][A100%|██████████| 8/8 [00:39<00:00,  4.93s/it]
OOV: 0.804334
GEO: 0.838292
=======entity level========

Epoch: 7, P: 0.920197, R: 0.898614, F: 0.909277, OOV: 0.804334, GEO: 0.838292
=======entity level========
Epoch:  14%|█▍        | 7/50 [05:02<31:02, 43.31s/it]P:  0.9201965065502183
R:  0.8986140724946695
F:  0.909277238403452

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.16s/it][A
 25%|██▌       | 2/8 [00:10<00:33,  5.56s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.15s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.10s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.16s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.18s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.08s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.58s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.799159
GEO: 0.821497
=======entity level========

Epoch: 8, P: 0.916567, R: 0.897122, F: 0.906740, OOV: 0.799159, GEO: 0.821497
=======entity level========
Epoch:  16%|█▌        | 8/50 [05:45<30:15, 43.22s/it]P:  0.9165668227861888
R:  0.8971215351812367
F:  0.9067399385808955

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.03s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.91s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.11s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.05s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.20s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.47s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.37s/it][A
100%|██████████| 8/8 [00:40<00:00,  4.71s/it][A100%|██████████| 8/8 [00:40<00:00,  5.01s/it]
OOV: 0.805951
GEO: 0.817191
=======entity level========

Epoch: 9, P: 0.915539, R: 0.901386, F: 0.908407, OOV: 0.805951, GEO: 0.817191
=======entity level========
Epoch:  18%|█▊        | 9/50 [06:29<29:36, 43.32s/it]P:  0.9155387114239307
R:  0.9013859275053305
F:  0.9084071984958367

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.81s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.97s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.30s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.18s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.11s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.23s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.29s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.64s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.807568
GEO: 0.844358
=======entity level========

Epoch: 10, P: 0.920723, R: 0.901386, F: 0.910952, OOV: 0.807568, GEO: 0.844358
=======entity level========
Epoch:  20%|██        | 10/50 [07:13<28:59, 43.49s/it]P:  0.9207230752477404
R:  0.9013859275053305
F:  0.910951893551689

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.93s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.20s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.26s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.09s/it][A
 62%|██████▎   | 5/8 [00:25<00:14,  4.99s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.05s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.810479
GEO: 0.827985
=======entity level========

Epoch: 11, P: 0.923278, R: 0.901919, F: 0.912474, OOV: 0.810479, GEO: 0.827985
=======entity level========
Epoch:  22%|██▏       | 11/50 [07:56<28:07, 43.27s/it]P:  0.9232784022699989
R:  0.9019189765458422
F:  0.9124737097557029

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.23s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.13s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.10s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.22s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.14s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.26s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.53s/it][A100%|██████████| 8/8 [00:39<00:00,  4.92s/it]
OOV: 0.808862
GEO: 0.827985
=======entity level========

Epoch: 12, P: 0.919367, R: 0.904371, F: 0.911807, OOV: 0.808862, GEO: 0.827985
=======entity level========
Epoch:  24%|██▍       | 12/50 [08:39<27:19, 43.14s/it]P:  0.919367074888913
R:  0.9043710021321961
F:  0.9118073843177298

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.65s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.29s/it][A
 38%|███▊      | 3/8 [00:15<00:24,  4.98s/it][A
 50%|█████     | 4/8 [00:20<00:19,  4.95s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.03s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.07s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.10s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.79s/it][A100%|██████████| 8/8 [00:39<00:00,  4.98s/it]
OOV: 0.808538
GEO: 0.841969
=======entity level========

Epoch: 13, P: 0.921213, R: 0.900000, F: 0.910483, OOV: 0.808538, GEO: 0.841969
=======entity level========
Epoch:  26%|██▌       | 13/50 [09:22<26:37, 43.19s/it]P:  0.9212134439109559
R:  0.9
F:  0.9104831751509923

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.99s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.48s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.28s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.24s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.16s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.11s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.66s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.809508
GEO: 0.840129
=======entity level========

Epoch: 14, P: 0.920314, R: 0.898827, F: 0.909444, OOV: 0.809508, GEO: 0.840129
=======entity level========
Epoch:  28%|██▊       | 14/50 [10:05<25:56, 43.24s/it]P:  0.9203143761598079
R:  0.8988272921108742
F:  0.9094439350628338

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.55s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.36s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.46s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.18s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.15s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.14s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.01s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.66s/it][A100%|██████████| 8/8 [00:39<00:00,  5.00s/it]
OOV: 0.809185
GEO: 0.840336
=======entity level========

Epoch: 15, P: 0.918866, R: 0.901919, F: 0.910314, OOV: 0.809185, GEO: 0.840336
=======entity level========
Epoch:  30%|███       | 15/50 [10:49<25:15, 43.30s/it]P:  0.9188660801564027
R:  0.9019189765458422
F:  0.9103136600850055

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:36,  5.23s/it][A
 25%|██▌       | 2/8 [00:11<00:33,  5.63s/it][A
 38%|███▊      | 3/8 [00:16<00:26,  5.38s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.27s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.20s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.11s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.01s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.51s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.811125
GEO: 0.833977
=======entity level========

Epoch: 16, P: 0.920039, R: 0.904051, F: 0.911975, OOV: 0.811125, GEO: 0.833977
=======entity level========
Epoch:  32%|███▏      | 16/50 [11:32<24:29, 43.23s/it]P:  0.9200390582619073
R:  0.9040511727078892
F:  0.9119750497392052

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:39,  5.64s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.41s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.22s/it][A
 50%|█████     | 4/8 [00:21<00:20,  5.21s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.18s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.12s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.17s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.61s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.804981
GEO: 0.842718
=======entity level========

Epoch: 17, P: 0.920214, R: 0.898827, F: 0.909395, OOV: 0.804981, GEO: 0.842718
=======entity level========
Epoch:  34%|███▍      | 17/50 [12:15<23:48, 43.27s/it]P:  0.920213927090155
R:  0.8988272921108742
F:  0.9093948872829253

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:38,  5.56s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.03s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.03s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.15s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.01s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.17s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.20s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.63s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.809508
GEO: 0.836340
=======entity level========

Epoch: 18, P: 0.921202, R: 0.902345, F: 0.911676, OOV: 0.809508, GEO: 0.836340
=======entity level========
Epoch:  36%|███▌      | 18/50 [12:58<23:01, 43.18s/it]P:  0.9212015672616456
R:  0.9023454157782516
F:  0.9116760017233951

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:33,  4.83s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.24s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.35s/it][A
 50%|█████     | 4/8 [00:21<00:21,  5.37s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.23s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.58s/it][A100%|██████████| 8/8 [00:39<00:00,  4.97s/it]
OOV: 0.809185
GEO: 0.833763
=======entity level========

Epoch: 19, P: 0.919500, R: 0.902345, F: 0.910842, OOV: 0.809185, GEO: 0.833763
=======entity level========
Epoch:  38%|███▊      | 19/50 [13:41<22:19, 43.20s/it]P:  0.9195002715915264
R:  0.9023454157782516
F:  0.9108420769437718

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.03s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.03s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.19s/it][A
 50%|█████     | 4/8 [00:20<00:21,  5.31s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.31s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.34s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.30s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.58s/it][A100%|██████████| 8/8 [00:39<00:00,  4.99s/it]
OOV: 0.807245
GEO: 0.830552
=======entity level========

Epoch: 20, P: 0.921308, R: 0.901173, F: 0.911129, OOV: 0.807245, GEO: 0.830552
=======entity level========

Early stop triggered at epoch 19

Epoch:  38%|███▊      | 19/50 [14:25<23:31, 45.53s/it]

=======best f entity level========

Epoch: 10, P: 0.920723, R: 0.901386, F: 0.910952, OOV: 0.807568, GEO: 0.844358, GEO_N: 0.830254


=======best f entity level========
P:  0.9213079019073569
R:  0.9011727078891258
F:  0.9111290757208299
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:01<01:02,  1.02s/it]  3%|▎         | 2/62 [00:01<00:59,  1.01it/s]  5%|▍         | 3/62 [00:02<00:55,  1.07it/s]  6%|▋         | 4/62 [00:03<00:56,  1.02it/s]  8%|▊         | 5/62 [00:05<00:59,  1.04s/it] 10%|▉         | 6/62 [00:06<01:00,  1.09s/it] 11%|█▏        | 7/62 [00:06<00:51,  1.06it/s] 13%|█▎        | 8/62 [00:07<00:46,  1.15it/s] 15%|█▍        | 9/62 [00:08<00:48,  1.08it/s] 16%|█▌        | 10/62 [00:09<00:47,  1.10it/s] 18%|█▊        | 11/62 [00:10<00:53,  1.05s/it] 19%|█▉        | 12/62 [00:11<00:48,  1.03it/s] 21%|██        | 13/62 [00:12<00:51,  1.06s/it] 23%|██▎       | 14/62 [00:14<00:51,  1.07s/it] 24%|██▍       | 15/62 [00:14<00:48,  1.03s/it] 26%|██▌       | 16/62 [00:15<00:40,  1.12it/s] 27%|██▋       | 17/62 [00:16<00:37,  1.21it/s] 29%|██▉       | 18/62 [00:17<00:39,  1.12it/s] 31%|███       | 19/62 [00:18<00:45,  1.07s/it] 32%|███▏      | 20/62 [00:20<00:49,  1.18s/it] 34%|███▍      | 21/62 [00:22<00:57,  1.41s/it] 35%|███▌      | 22/62 [00:23<00:50,  1.27s/it] 37%|███▋      | 23/62 [00:23<00:42,  1.09s/it] 39%|███▊      | 24/62 [00:24<00:42,  1.12s/it] 40%|████      | 25/62 [00:27<00:53,  1.45s/it] 42%|████▏     | 26/62 [00:28<00:49,  1.38s/it] 44%|████▎     | 27/62 [00:29<00:44,  1.26s/it] 45%|████▌     | 28/62 [00:30<00:41,  1.21s/it] 47%|████▋     | 29/62 [00:31<00:39,  1.20s/it] 48%|████▊     | 30/62 [00:32<00:35,  1.11s/it] 50%|█████     | 31/62 [00:33<00:33,  1.08s/it] 52%|█████▏    | 32/62 [00:34<00:28,  1.06it/s] 53%|█████▎    | 33/62 [00:35<00:30,  1.04s/it] 55%|█████▍    | 34/62 [00:36<00:30,  1.10s/it] 56%|█████▋    | 35/62 [00:37<00:28,  1.05s/it] 58%|█████▊    | 36/62 [00:38<00:24,  1.05it/s] 60%|█████▉    | 37/62 [00:38<00:20,  1.24it/s] 61%|██████▏   | 38/62 [00:39<00:20,  1.19it/s] 63%|██████▎   | 39/62 [00:40<00:21,  1.05it/s] 65%|██████▍   | 40/62 [00:41<00:20,  1.07it/s] 66%|██████▌   | 41/62 [00:42<00:19,  1.08it/s] 68%|██████▊   | 42/62 [00:43<00:18,  1.09it/s] 69%|██████▉   | 43/62 [00:44<00:18,  1.03it/s] 71%|███████   | 44/62 [00:45<00:16,  1.08it/s] 73%|███████▎  | 45/62 [00:47<00:19,  1.14s/it] 74%|███████▍  | 46/62 [00:47<00:15,  1.00it/s] 76%|███████▌  | 47/62 [00:48<00:14,  1.07it/s] 77%|███████▋  | 48/62 [00:49<00:12,  1.08it/s] 79%|███████▉  | 49/62 [00:50<00:14,  1.09s/it] 81%|████████  | 50/62 [00:51<00:12,  1.02s/it] 82%|████████▏ | 51/62 [00:52<00:11,  1.04s/it] 84%|████████▍ | 52/62 [00:54<00:10,  1.07s/it] 85%|████████▌ | 53/62 [00:55<00:11,  1.28s/it] 87%|████████▋ | 54/62 [00:56<00:09,  1.17s/it] 89%|████████▊ | 55/62 [00:57<00:07,  1.08s/it] 90%|█████████ | 56/62 [00:58<00:05,  1.01it/s] 92%|█████████▏| 57/62 [00:59<00:04,  1.06it/s] 94%|█████████▎| 58/62 [01:00<00:03,  1.10it/s] 95%|█████████▌| 59/62 [01:01<00:02,  1.08it/s] 97%|█████████▋| 60/62 [01:01<00:01,  1.15it/s] 98%|█████████▊| 61/62 [01:03<00:01,  1.02s/it]100%|██████████| 62/62 [01:03<00:00,  1.02it/s]100%|██████████| 62/62 [01:03<00:00,  1.03s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/opt/Projects/Models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0_0.820', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 1, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.00s/it][A
 25%|██▌       | 2/8 [00:10<00:31,  5.32s/it][A
 38%|███▊      | 3/8 [00:15<00:26,  5.27s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.18s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.14s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.19s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.22s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.60s/it][A100%|██████████| 8/8 [00:39<00:00,  4.96s/it]
OOV: 0.663972
GEO: 0.555556
=======entity level========

Epoch: 1, P: 0.821532, R: 0.786674, F: 0.803725, OOV: 0.663972, GEO: 0.555556
=======entity level========
Epoch:   2%|▏         | 1/50 [00:43<35:35, 43.58s/it]P:  0.8215319527944779
R:  0.7866737739872068
F:  0.8037250844134626

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:04<00:34,  4.99s/it][A
 25%|██▌       | 2/8 [00:09<00:29,  4.93s/it][A
 38%|███▊      | 3/8 [00:14<00:24,  4.96s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.11s/it][A
 62%|██████▎   | 5/8 [00:25<00:15,  5.19s/it][A
 75%|███████▌  | 6/8 [00:30<00:10,  5.24s/it][A
 88%|████████▊ | 7/8 [00:35<00:05,  5.16s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.53s/it][A100%|██████████| 8/8 [00:39<00:00,  4.88s/it]
OOV: 0.784929
GEO: 0.821705
=======entity level========

Epoch: 2, P: 0.913245, R: 0.882090, F: 0.897397, OOV: 0.784929, GEO: 0.821705
=======entity level========
Epoch:   4%|▍         | 2/50 [01:26<34:41, 43.36s/it]P:  0.9132450331125828
R:  0.8820895522388059
F:  0.8973969631236441

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.10s/it][A
 25%|██▌       | 2/8 [00:10<00:32,  5.46s/it][A
 38%|███▊      | 3/8 [00:15<00:25,  5.16s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.23s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.21s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.20s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.06s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.57s/it][A100%|██████████| 8/8 [00:39<00:00,  4.95s/it]
OOV: 0.794631
GEO: 0.841218
=======entity level========

Epoch: 3, P: 0.919252, R: 0.890832, F: 0.904819, OOV: 0.794631, GEO: 0.841218
=======entity level========
Epoch:   6%|▌         | 3/50 [02:10<34:05, 43.53s/it]P:  0.9192519251925193
R:  0.8908315565031983
F:  0.9048186247969681

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.03s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.16s/it][A
 38%|███▊      | 3/8 [00:16<00:27,  5.52s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.22s/it][A
 62%|██████▎   | 5/8 [00:26<00:15,  5.25s/it][A
 75%|███████▌  | 6/8 [00:31<00:10,  5.15s/it][A
 88%|████████▊ | 7/8 [00:36<00:05,  5.15s/it][A
100%|██████████| 8/8 [00:39<00:00,  4.50s/it][A100%|██████████| 8/8 [00:39<00:00,  4.94s/it]
OOV: 0.802070
GEO: 0.802540
=======entity level========

Epoch: 4, P: 0.912063, R: 0.901173, F: 0.906585, OOV: 0.802070, GEO: 0.802540
=======entity level========
Epoch:   8%|▊         | 4/50 [02:53<33:11, 43.30s/it]P:  0.9120630125161847
R:  0.9011727078891258
F:  0.9065851565851566

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:05<00:35,  5.07s/it][A
 25%|██▌       | 2/8 [00:10<00:30,  5.00s/it][A
 38%|███▊      | 3/8 [00:15<00:24,  5.00s/it][A
 50%|█████     | 4/8 [00:20<00:20,  5.10s/it][ATerminated
