{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': None, 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/home/testcross/projects/models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.5, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'bert_wm_av_3_score_0.7_0.8', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 4056
# of trainable parameters: 105396480
***** Running training *****
  Num examples = 120
  Batch size = 16
  Num steps = 350
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

 12%|█▎        | 1/8 [00:03<00:26,  3.73s/it][A
 25%|██▌       | 2/8 [00:04<00:11,  1.90s/it][A
 38%|███▊      | 3/8 [00:04<00:06,  1.28s/it][A
 50%|█████     | 4/8 [00:05<00:03,  1.04it/s][A
 62%|██████▎   | 5/8 [00:05<00:02,  1.26it/s][A
 75%|███████▌  | 6/8 [00:06<00:01,  1.37it/s][A
 88%|████████▊ | 7/8 [00:07<00:00,  1.49it/s][A
100%|██████████| 8/8 [00:07<00:00,  1.69it/s][A100%|██████████| 8/8 [00:07<00:00,  1.07it/s]
OOV: 0.008409
GEO: 0.000000
=======entity level========

Epoch: 1, P: 0.252908, R: 0.136780, F: 0.177541, OOV: 0.008409, GEO: 0.000000
=======entity level========
/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/seqeval/metrics/sequence_labeling.py:171: UserWarning: [SEP] seems not to be NE tag.
  warnings.warn('{} seems not to be NE tag.'.format(chunk))
/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/seqeval/metrics/sequence_labeling.py:171: UserWarning: [CLS] seems not to be NE tag.
  warnings.warn('{} seems not to be NE tag.'.format(chunk))
/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Epoch:   2%|▏         | 1/50 [00:19<15:36, 19.11s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.42it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.54it/s][A
 38%|███▊      | 3/8 [00:01<00:03,  1.63it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.74it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.77it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.81it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  1.90it/s][A
100%|██████████| 8/8 [00:04<00:00,  2.06it/s][A100%|██████████| 8/8 [00:04<00:00,  1.84it/s]
OOV: 0.149418
GEO: 0.034286
=======entity level========

Epoch: 2, P: 0.528979, R: 0.444670, F: 0.483174, OOV: 0.149418, GEO: 0.034286
=======entity level========
Epoch:   4%|▍         | 2/50 [00:35<14:08, 17.68s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.59it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.78it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.82it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.81it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.81it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.81it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  1.75it/s][A
100%|██████████| 8/8 [00:04<00:00,  1.97it/s][A100%|██████████| 8/8 [00:04<00:00,  1.85it/s]
OOV: 0.605757
GEO: 0.476550
=======entity level========

Epoch: 3, P: 0.811308, R: 0.757249, F: 0.783347, OOV: 0.605757, GEO: 0.476550
=======entity level========
Epoch:   6%|▌         | 3/50 [00:52<13:22, 17.07s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:05,  1.39it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.66it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.81it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.82it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.76it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.79it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  1.78it/s][A
100%|██████████| 8/8 [00:04<00:00,  1.98it/s][A100%|██████████| 8/8 [00:04<00:00,  1.83it/s]
OOV: 0.711514
GEO: 0.558773
=======entity level========

Epoch: 4, P: 0.868046, R: 0.850000, F: 0.858928, OOV: 0.711514, GEO: 0.558773
=======entity level========
Epoch:   8%|▊         | 4/50 [01:08<12:51, 16.78s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.59it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.76it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.77it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.72it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.67it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.68it/s][A
 88%|████████▊ | 7/8 [00:04<00:00,  1.71it/s][A
100%|██████████| 8/8 [00:04<00:00,  1.89it/s][A100%|██████████| 8/8 [00:04<00:00,  1.77it/s]
OOV: 0.771345
GEO: 0.759013
=======entity level========

Epoch: 5, P: 0.894548, R: 0.876333, F: 0.885347, OOV: 0.771345, GEO: 0.759013
=======entity level========
Epoch:  10%|█         | 5/50 [01:25<12:33, 16.75s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.54it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.73it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.82it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.85it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.76it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.80it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  1.74it/s][A
100%|██████████| 8/8 [00:04<00:00,  1.99it/s][A100%|██████████| 8/8 [00:04<00:00,  1.85it/s]
OOV: 0.792367
GEO: 0.731768
=======entity level========

Epoch: 6, P: 0.903596, R: 0.889339, F: 0.896411, OOV: 0.792367, GEO: 0.731768
=======entity level========
Epoch:  12%|█▏        | 6/50 [01:41<12:09, 16.59s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.41it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.54it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.78it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.76it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.82it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.84it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  1.81it/s][A
100%|██████████| 8/8 [00:04<00:00,  1.98it/s][A100%|██████████| 8/8 [00:04<00:00,  1.83it/s]
OOV: 0.783635
GEO: 0.804862
=======entity level========

Epoch: 7, P: 0.914170, R: 0.887953, F: 0.900871, OOV: 0.783635, GEO: 0.804862
=======entity level========
Epoch:  14%|█▍        | 7/50 [01:57<11:49, 16.50s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.73it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.85it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.75it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.71it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.73it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.75it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  1.82it/s][A
100%|██████████| 8/8 [00:04<00:00,  2.01it/s][A100%|██████████| 8/8 [00:04<00:00,  1.85it/s]
OOV: 0.792691
GEO: 0.788071
=======entity level========

Epoch: 8, P: 0.910591, R: 0.888166, F: 0.899239, OOV: 0.792691, GEO: 0.788071
=======entity level========
Epoch:  16%|█▌        | 8/50 [02:11<11:00, 15.73s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.52it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.61it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.68it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.75it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.80it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.80it/s][A
 88%|████████▊ | 7/8 [00:04<00:00,  1.75it/s][A
100%|██████████| 8/8 [00:04<00:00,  1.98it/s][A100%|██████████| 8/8 [00:04<00:00,  1.82it/s]
OOV: 0.783959
GEO: 0.693902
=======entity level========

Epoch: 9, P: 0.887342, R: 0.896802, F: 0.892047, OOV: 0.783959, GEO: 0.693902
=======entity level========
Epoch:  18%|█▊        | 9/50 [02:25<10:23, 15.21s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.55it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.73it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.77it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.71it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.68it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.74it/s][A
 88%|████████▊ | 7/8 [00:04<00:00,  1.79it/s][A
100%|██████████| 8/8 [00:04<00:00,  1.93it/s][A100%|██████████| 8/8 [00:04<00:00,  1.80it/s]
OOV: 0.788486
GEO: 0.821935
=======entity level========

Epoch: 10, P: 0.919996, R: 0.886354, F: 0.902861, OOV: 0.788486, GEO: 0.821935
=======entity level========
Epoch:  20%|██        | 10/50 [02:42<10:20, 15.52s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.43it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.66it/s][A
 38%|███▊      | 3/8 [00:01<00:03,  1.63it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.74it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.76it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.77it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  1.84it/s][A
100%|██████████| 8/8 [00:04<00:00,  2.03it/s][A100%|██████████| 8/8 [00:04<00:00,  1.83it/s]
OOV: 0.792044
GEO: 0.781290
=======entity level========

Epoch: 11, P: 0.910111, R: 0.899147, F: 0.904596, OOV: 0.792044, GEO: 0.781290
=======entity level========
Epoch:  22%|██▏       | 11/50 [02:58<10:15, 15.78s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.49it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.78it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.81it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.81it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.89it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.89it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  1.89it/s][A
100%|██████████| 8/8 [00:04<00:00,  2.02it/s][A100%|██████████| 8/8 [00:04<00:00,  1.90it/s]
OOV: 0.794631
GEO: 0.777989
=======entity level========

Epoch: 12, P: 0.914799, R: 0.896269, F: 0.905439, OOV: 0.794631, GEO: 0.777989
=======entity level========
Epoch:  24%|██▍       | 12/50 [03:14<10:04, 15.90s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.51it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.56it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.76it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.79it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.87it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.80it/s][A
 88%|████████▊ | 7/8 [00:04<00:00,  1.75it/s][A
100%|██████████| 8/8 [00:04<00:00,  1.97it/s][A100%|██████████| 8/8 [00:04<00:00,  1.83it/s]
OOV: 0.799159
GEO: 0.804348
=======entity level========

Epoch: 13, P: 0.921379, R: 0.894563, F: 0.907773, OOV: 0.799159, GEO: 0.804348
=======entity level========
Epoch:  26%|██▌       | 13/50 [03:31<09:54, 16.06s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.43it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.67it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.76it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.79it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.80it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.74it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  1.79it/s][A
100%|██████████| 8/8 [00:04<00:00,  2.02it/s][A100%|██████████| 8/8 [00:04<00:00,  1.84it/s]
OOV: 0.796572
GEO: 0.795411
=======entity level========

Epoch: 14, P: 0.919498, R: 0.897441, F: 0.908336, OOV: 0.796572, GEO: 0.795411
=======entity level========
Epoch:  28%|██▊       | 14/50 [03:47<09:42, 16.17s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.62it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.76it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.72it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.69it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.80it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.82it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  1.76it/s][A
100%|██████████| 8/8 [00:04<00:00,  1.96it/s][A100%|██████████| 8/8 [00:04<00:00,  1.83it/s]
OOV: 0.800453
GEO: 0.775536
=======entity level========

Epoch: 15, P: 0.920690, R: 0.898507, F: 0.909464, OOV: 0.800453, GEO: 0.775536
=======entity level========
Epoch:  30%|███       | 15/50 [04:03<09:23, 16.10s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.47it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.63it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.75it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.80it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.83it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.91it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  1.81it/s][A
100%|██████████| 8/8 [00:04<00:00,  2.01it/s][A100%|██████████| 8/8 [00:04<00:00,  1.86it/s]
OOV: 0.800129
GEO: 0.761606
=======entity level========

Epoch: 16, P: 0.918895, R: 0.897441, F: 0.908042, OOV: 0.800129, GEO: 0.761606
=======entity level========
Epoch:  32%|███▏      | 16/50 [04:17<08:46, 15.50s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.47it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.61it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.69it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.79it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.73it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.78it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  1.82it/s][A
100%|██████████| 8/8 [00:04<00:00,  2.00it/s][A100%|██████████| 8/8 [00:04<00:00,  1.83it/s]
OOV: 0.804657
GEO: 0.813581
=======entity level========

Epoch: 17, P: 0.924712, R: 0.899574, F: 0.911970, OOV: 0.804657, GEO: 0.813581
=======entity level========
Epoch:  34%|███▍      | 17/50 [04:33<08:40, 15.76s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.43it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.68it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.78it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.81it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.83it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.81it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  1.82it/s][A
100%|██████████| 8/8 [00:04<00:00,  1.99it/s][A100%|██████████| 8/8 [00:04<00:00,  1.85it/s]
OOV: 0.800453
GEO: 0.809737
=======entity level========

Epoch: 18, P: 0.919652, R: 0.900533, F: 0.909992, OOV: 0.800453, GEO: 0.809737
=======entity level========
Epoch:  36%|███▌      | 18/50 [04:47<08:08, 15.25s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.43it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.62it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.70it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.66it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.76it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.83it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  1.86it/s][A
100%|██████████| 8/8 [00:04<00:00,  2.07it/s][A100%|██████████| 8/8 [00:04<00:00,  1.85it/s]
OOV: 0.805951
GEO: 0.782059
=======entity level========

Epoch: 19, P: 0.920048, R: 0.899254, F: 0.909532, OOV: 0.805951, GEO: 0.782059
=======entity level========
Epoch:  38%|███▊      | 19/50 [05:02<07:42, 14.92s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.41it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.64it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.75it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.81it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.81it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.81it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  1.79it/s][A
100%|██████████| 8/8 [00:04<00:00,  1.95it/s][A100%|██████████| 8/8 [00:04<00:00,  1.82it/s]
OOV: 0.801423
GEO: 0.778761
=======entity level========

Epoch: 20, P: 0.913970, R: 0.900426, F: 0.907148, OOV: 0.801423, GEO: 0.778761
=======entity level========
Epoch:  40%|████      | 20/50 [05:16<07:20, 14.67s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.63it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.77it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.68it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.73it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.85it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.86it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  1.84it/s][A
100%|██████████| 8/8 [00:04<00:00,  2.04it/s][A100%|██████████| 8/8 [00:04<00:00,  1.87it/s]
OOV: 0.799806
GEO: 0.826200
=======entity level========

Epoch: 21, P: 0.916576, R: 0.897228, F: 0.906799, OOV: 0.799806, GEO: 0.826200
=======entity level========
Epoch:  42%|████▏     | 21/50 [05:30<06:59, 14.45s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.69it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.67it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.73it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.68it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.70it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.80it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  1.86it/s][A
100%|██████████| 8/8 [00:04<00:00,  2.05it/s][A100%|██████████| 8/8 [00:04<00:00,  1.85it/s]
OOV: 0.800129
GEO: 0.831927
=======entity level========

Epoch: 22, P: 0.917157, R: 0.897015, F: 0.906974, OOV: 0.800129, GEO: 0.831927
=======entity level========
Epoch:  44%|████▍     | 22/50 [05:44<06:41, 14.32s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.53it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.67it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.74it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.73it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.76it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.70it/s][A
 88%|████████▊ | 7/8 [00:04<00:00,  1.75it/s][A
100%|██████████| 8/8 [00:04<00:00,  1.98it/s][A100%|██████████| 8/8 [00:04<00:00,  1.81it/s]
OOV: 0.798189
GEO: 0.804612
=======entity level========

Epoch: 23, P: 0.916594, R: 0.899787, F: 0.908113, OOV: 0.798189, GEO: 0.804612
=======entity level========
Epoch:  46%|████▌     | 23/50 [05:58<06:25, 14.26s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  1.79it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.77it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.77it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.71it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.75it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.79it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  1.82it/s][A
100%|██████████| 8/8 [00:04<00:00,  2.01it/s][A100%|██████████| 8/8 [00:04<00:00,  1.86it/s]
OOV: 0.793014
GEO: 0.758750
=======entity level========

Epoch: 24, P: 0.912006, R: 0.900533, F: 0.906233, OOV: 0.793014, GEO: 0.758750
=======entity level========
Epoch:  48%|████▊     | 24/50 [06:12<06:08, 14.17s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.53it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.76it/s][A
 38%|███▊      | 3/8 [00:01<00:03,  1.64it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.68it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.79it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.82it/s][A
 88%|████████▊ | 7/8 [00:04<00:00,  1.75it/s][A
100%|██████████| 8/8 [00:04<00:00,  1.99it/s][A100%|██████████| 8/8 [00:04<00:00,  1.82it/s]
OOV: 0.800776
GEO: 0.780303
=======entity level========

Epoch: 25, P: 0.916035, R: 0.901386, F: 0.908651, OOV: 0.800776, GEO: 0.780303
=======entity level========
Epoch:  50%|█████     | 25/50 [06:26<05:54, 14.16s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:03,  1.84it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.78it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.77it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.72it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.70it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.79it/s][A
 88%|████████▊ | 7/8 [00:03<00:00,  1.82it/s][A
100%|██████████| 8/8 [00:04<00:00,  2.04it/s][A100%|██████████| 8/8 [00:04<00:00,  1.86it/s]
OOV: 0.803687
GEO: 0.794155
=======entity level========

Epoch: 26, P: 0.918454, R: 0.899360, F: 0.908807, OOV: 0.803687, GEO: 0.794155
=======entity level========
Epoch:  52%|█████▏    | 26/50 [06:40<05:38, 14.10s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:00<00:04,  1.51it/s][A
 25%|██▌       | 2/8 [00:01<00:03,  1.62it/s][A
 38%|███▊      | 3/8 [00:01<00:02,  1.69it/s][A
 50%|█████     | 4/8 [00:02<00:02,  1.76it/s][A
 62%|██████▎   | 5/8 [00:02<00:01,  1.71it/s][A
 75%|███████▌  | 6/8 [00:03<00:01,  1.81it/s][A
 88%|████████▊ | 7/8 [00:04<00:00,  1.77it/s][A
100%|██████████| 8/8 [00:04<00:00,  1.97it/s][A100%|██████████| 8/8 [00:04<00:00,  1.81it/s]
OOV: 0.803040
GEO: 0.801278
=======entity level========

Epoch: 27, P: 0.918076, R: 0.897228, F: 0.907532, OOV: 0.803040, GEO: 0.801278
=======entity level========

Early stop triggered at epoch 26

Epoch:  52%|█████▏    | 26/50 [06:54<06:22, 15.94s/it]

=======best f entity level========

Epoch: 17, P: 0.924712, R: 0.899574, F: 0.911970, OOV: 0.804657, GEO: 0.813581, GEO_N: 0.825810


=======best f entity level========
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
./models/bert_wm_av_3_score_0.7_0.8_2024-12-24-12-31-36/model.pt
  0%|          | 0/62 [00:00<?, ?it/s]/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|▏         | 1/62 [00:04<04:48,  4.73s/it]  3%|▎         | 2/62 [00:06<02:53,  2.88s/it]  5%|▍         | 3/62 [00:07<02:11,  2.23s/it]  6%|▋         | 4/62 [00:09<01:56,  2.01s/it]  8%|▊         | 5/62 [00:11<01:48,  1.90s/it] 10%|▉         | 6/62 [00:13<01:45,  1.88s/it] 11%|█▏        | 7/62 [00:14<01:31,  1.66s/it] 13%|█▎        | 8/62 [00:15<01:23,  1.54s/it] 15%|█▍        | 9/62 [00:17<01:23,  1.58s/it] 16%|█▌        | 10/62 [00:18<01:19,  1.53s/it] 18%|█▊        | 11/62 [00:20<01:24,  1.66s/it] 19%|█▉        | 12/62 [00:21<01:18,  1.56s/it] 21%|██        | 13/62 [00:23<01:22,  1.68s/it] 23%|██▎       | 14/62 [00:25<01:21,  1.69s/it] 24%|██▍       | 15/62 [00:27<01:17,  1.64s/it] 26%|██▌       | 16/62 [00:28<01:07,  1.47s/it] 27%|██▋       | 17/62 [00:29<01:01,  1.38s/it] 29%|██▉       | 18/62 [00:30<01:02,  1.42s/it] 31%|███       | 19/62 [00:32<01:09,  1.61s/it] 32%|███▏      | 20/62 [00:34<01:12,  1.73s/it] 34%|███▍      | 21/62 [00:37<01:19,  1.95s/it] 35%|███▌      | 22/62 [00:38<01:12,  1.81s/it] 37%|███▋      | 23/62 [00:39<01:02,  1.60s/it] 39%|███▊      | 24/62 [00:41<01:02,  1.64s/it] 40%|████      | 25/62 [00:44<01:14,  2.01s/it] 42%|████▏     | 26/62 [00:46<01:08,  1.91s/it] 44%|████▎     | 27/62 [00:47<01:01,  1.77s/it] 45%|████▌     | 28/62 [00:49<00:58,  1.72s/it] 47%|████▋     | 29/62 [00:50<00:56,  1.71s/it] 48%|████▊     | 30/62 [00:52<00:51,  1.62s/it] 50%|█████     | 31/62 [00:53<00:49,  1.60s/it] 52%|█████▏    | 32/62 [00:55<00:43,  1.46s/it] 53%|█████▎    | 33/62 [00:56<00:44,  1.53s/it] 55%|█████▍    | 34/62 [00:58<00:44,  1.60s/it] 56%|█████▋    | 35/62 [00:59<00:42,  1.56s/it] 58%|█████▊    | 36/62 [01:01<00:37,  1.45s/it] 60%|█████▉    | 37/62 [01:02<00:32,  1.31s/it] 61%|██████▏   | 38/62 [01:03<00:31,  1.32s/it] 63%|██████▎   | 39/62 [01:05<00:33,  1.44s/it] 65%|██████▍   | 40/62 [01:06<00:31,  1.43s/it] 66%|██████▌   | 41/62 [01:07<00:29,  1.40s/it] 68%|██████▊   | 42/62 [01:09<00:27,  1.39s/it] 69%|██████▉   | 43/62 [01:11<00:28,  1.49s/it] 71%|███████   | 44/62 [01:12<00:25,  1.42s/it] 73%|███████▎  | 45/62 [01:14<00:28,  1.65s/it] 74%|███████▍  | 46/62 [01:15<00:23,  1.50s/it] 76%|███████▌  | 47/62 [01:16<00:21,  1.45s/it] 77%|███████▋  | 48/62 [01:18<00:20,  1.43s/it] 79%|███████▉  | 49/62 [01:20<00:20,  1.60s/it] 81%|████████  | 50/62 [01:21<00:18,  1.54s/it] 82%|████████▏ | 51/62 [01:23<00:17,  1.57s/it] 84%|████████▍ | 52/62 [01:24<00:15,  1.58s/it] 85%|████████▌ | 53/62 [01:27<00:16,  1.82s/it] 87%|████████▋ | 54/62 [01:28<00:13,  1.65s/it] 89%|████████▊ | 55/62 [01:30<00:11,  1.58s/it] 90%|█████████ | 56/62 [01:31<00:08,  1.50s/it] 92%|█████████▏| 57/62 [01:32<00:07,  1.45s/it] 94%|█████████▎| 58/62 [01:34<00:05,  1.41s/it] 95%|█████████▌| 59/62 [01:35<00:04,  1.42s/it] 97%|█████████▋| 60/62 [01:36<00:02,  1.35s/it] 98%|█████████▊| 61/62 [01:38<00:01,  1.53s/it]100%|██████████| 62/62 [01:40<00:00,  1.50s/it]100%|██████████| 62/62 [01:40<00:00,  1.61s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/home/testcross/projects/models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0.7_0.81', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

 12%|█▎        | 1/8 [00:09<01:09,  9.87s/it][A
 25%|██▌       | 2/8 [00:16<00:49,  8.23s/it][A
 38%|███▊      | 3/8 [00:23<00:38,  7.61s/it][A
 50%|█████     | 4/8 [00:30<00:29,  7.26s/it][A
 62%|██████▎   | 5/8 [00:37<00:21,  7.04s/it][A
 75%|███████▌  | 6/8 [00:44<00:13,  6.97s/it][A
 88%|████████▊ | 7/8 [00:50<00:06,  6.89s/it][A
100%|██████████| 8/8 [00:55<00:00,  6.12s/it][A100%|██████████| 8/8 [00:55<00:00,  6.90s/it]
OOV: 0.666235
GEO: 0.547961
=======entity level========

Epoch: 1, P: 0.824980, R: 0.787953, F: 0.806042, OOV: 0.666235, GEO: 0.547961
=======entity level========
Epoch:   2%|▏         | 1/50 [01:07<55:12, 67.60s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.54s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.61s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.65s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.79s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.92s/it][A
 75%|███████▌  | 6/8 [00:41<00:14,  7.04s/it][A
 88%|████████▊ | 7/8 [00:48<00:07,  7.02s/it][A
100%|██████████| 8/8 [00:53<00:00,  6.28s/it][A100%|██████████| 8/8 [00:53<00:00,  6.63s/it]
OOV: 0.792367
GEO: 0.841146
=======entity level========

Epoch: 2, P: 0.918641, R: 0.884755, F: 0.901379, OOV: 0.792367, GEO: 0.841146
=======entity level========
Epoch:   4%|▍         | 2/50 [02:14<53:40, 67.09s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.76s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.08s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.76s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.79s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.75s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.73s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.61s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.01s/it][A100%|██████████| 8/8 [00:51<00:00,  6.47s/it]
OOV: 0.806598
GEO: 0.821337
=======entity level========

Epoch: 3, P: 0.920685, R: 0.899680, F: 0.910061, OOV: 0.806598, GEO: 0.821337
=======entity level========
Epoch:   6%|▌         | 3/50 [03:16<50:55, 65.01s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.67s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.65s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.97s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.75s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.76s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.64s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.91s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.795602
GEO: 0.848010
=======entity level========

Epoch: 4, P: 0.928961, R: 0.890832, F: 0.909497, OOV: 0.795602, GEO: 0.848010
=======entity level========
Epoch:   8%|▊         | 4/50 [04:21<49:42, 64.85s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.65s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.56s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.56s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.61s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.67s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.04s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.808215
GEO: 0.814341
=======entity level========

Epoch: 5, P: 0.928123, R: 0.897548, F: 0.912579, OOV: 0.808215, GEO: 0.814341
=======entity level========
Epoch:  10%|█         | 5/50 [05:23<47:57, 63.95s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.72s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.84s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.81s/it][A
 50%|█████     | 4/8 [00:27<00:27,  7.00s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.93s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.89s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.86s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.10s/it][A100%|██████████| 8/8 [00:52<00:00,  6.57s/it]
OOV: 0.807568
GEO: 0.837419
=======entity level========

Epoch: 6, P: 0.927442, R: 0.900746, F: 0.913899, OOV: 0.807568, GEO: 0.837419
=======entity level========
Epoch:  12%|█▏        | 6/50 [06:27<46:47, 63.80s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.71s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.67s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.57s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.80s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.80s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.72s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.70s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.96s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.811125
GEO: 0.817481
=======entity level========

Epoch: 7, P: 0.926701, R: 0.901706, F: 0.914033, OOV: 0.811125, GEO: 0.817481
=======entity level========
Epoch:  14%|█▍        | 7/50 [07:29<45:21, 63.28s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.75s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.03s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.70s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.65s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.75s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.70s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.07s/it][A100%|██████████| 8/8 [00:51<00:00,  6.47s/it]
OOV: 0.812419
GEO: 0.839170
=======entity level========

Epoch: 8, P: 0.927034, R: 0.904797, F: 0.915781, OOV: 0.812419, GEO: 0.839170
=======entity level========
Epoch:  16%|█▌        | 8/50 [08:32<44:10, 63.11s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.84s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.63s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.72s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.67s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.97s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.93s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.18s/it][A100%|██████████| 8/8 [00:52<00:00,  6.56s/it]
OOV: 0.818887
GEO: 0.811982
=======entity level========

Epoch: 9, P: 0.922012, R: 0.908742, F: 0.915329, OOV: 0.818887, GEO: 0.811982
=======entity level========
Epoch:  18%|█▊        | 9/50 [09:35<43:12, 63.23s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.46s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.51s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.78s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.69s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.62s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.72s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.77s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.02s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.813066
GEO: 0.824888
=======entity level========

Epoch: 10, P: 0.927348, R: 0.906290, F: 0.916698, OOV: 0.813066, GEO: 0.824888
=======entity level========
Epoch:  20%|██        | 10/50 [10:37<41:55, 62.88s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.54s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.78s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.80s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.63s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.54s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.56s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.00s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.812419
GEO: 0.830116
=======entity level========

Epoch: 11, P: 0.928125, R: 0.903092, F: 0.915437, OOV: 0.812419, GEO: 0.830116
=======entity level========
Epoch:  22%|██▏       | 11/50 [11:39<40:40, 62.58s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.77s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.65s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.61s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.73s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.74s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.94s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.814683
GEO: 0.839793
=======entity level========

Epoch: 12, P: 0.928259, R: 0.904904, F: 0.916433, OOV: 0.814683, GEO: 0.839793
=======entity level========
Epoch:  24%|██▍       | 12/50 [12:41<39:30, 62.38s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.14s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.87s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.63s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.64s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.71s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.74s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.80s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.28s/it][A100%|██████████| 8/8 [00:52<00:00,  6.57s/it]
OOV: 0.814683
GEO: 0.851395
=======entity level========

Epoch: 13, P: 0.929136, R: 0.902985, F: 0.915874, OOV: 0.814683, GEO: 0.851395
=======entity level========
Epoch:  26%|██▌       | 13/50 [13:47<39:05, 63.39s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.64s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.01s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.80s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.75s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.67s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.62s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.45s/it]
OOV: 0.813389
GEO: 0.835590
=======entity level========

Epoch: 14, P: 0.926744, R: 0.903625, F: 0.915038, OOV: 0.813389, GEO: 0.835590
=======entity level========
Epoch:  28%|██▊       | 14/50 [14:49<37:52, 63.12s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.24s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.02s/it][A
 38%|███▊      | 3/8 [00:21<00:35,  7.11s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.82s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.62s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.14s/it][A100%|██████████| 8/8 [00:52<00:00,  6.57s/it]
OOV: 0.813066
GEO: 0.828829
=======entity level========

Epoch: 15, P: 0.926517, R: 0.903305, F: 0.914764, OOV: 0.813066, GEO: 0.828829
=======entity level========
Epoch:  30%|███       | 15/50 [15:53<36:54, 63.26s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.97s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.15s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.90s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.82s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.72s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.65s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.52s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.89s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.812096
GEO: 0.852865
=======entity level========

Epoch: 16, P: 0.930222, R: 0.901066, F: 0.915412, OOV: 0.812096, GEO: 0.852865
=======entity level========
Epoch:  32%|███▏      | 16/50 [16:58<36:05, 63.69s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.22s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.02s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.83s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.87s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.78s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.72s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.03s/it][A100%|██████████| 8/8 [00:52<00:00,  6.51s/it]
OOV: 0.812096
GEO: 0.845855
=======entity level========

Epoch: 17, P: 0.928125, R: 0.901706, F: 0.914724, OOV: 0.812096, GEO: 0.845855
=======entity level========
Epoch:  34%|███▍      | 17/50 [18:01<34:54, 63.47s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.06s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.57s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.59s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.78s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.67s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.82s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.86s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.16s/it][A100%|██████████| 8/8 [00:52<00:00,  6.52s/it]
OOV: 0.807245
GEO: 0.821566
=======entity level========

Epoch: 18, P: 0.927686, R: 0.901279, F: 0.914292, OOV: 0.807245, GEO: 0.821566
=======entity level========
Epoch:  36%|███▌      | 18/50 [19:04<33:47, 63.37s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.66s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.97s/it][A
 38%|███▊      | 3/8 [00:20<00:35,  7.02s/it][A
 50%|█████     | 4/8 [00:27<00:28,  7.04s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.91s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.82s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.75s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.02s/it][A100%|██████████| 8/8 [00:52<00:00,  6.55s/it]
OOV: 0.811772
GEO: 0.845655
=======entity level========

Epoch: 19, P: 0.929598, R: 0.903731, F: 0.916482, OOV: 0.811772, GEO: 0.845655
=======entity level========
Epoch:  38%|███▊      | 19/50 [20:07<32:42, 63.32s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.62s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.59s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.72s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.80s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.81s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.84s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.78s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.96s/it][A100%|██████████| 8/8 [00:51<00:00,  6.45s/it]
OOV: 0.810802
GEO: 0.856400
=======entity level========

Epoch: 20, P: 0.929396, R: 0.900959, F: 0.914957, OOV: 0.810802, GEO: 0.856400
=======entity level========
Epoch:  40%|████      | 20/50 [21:12<31:53, 63.77s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.47s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.51s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.52s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.67s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.72s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.80s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.11s/it][A100%|██████████| 8/8 [00:51<00:00,  6.44s/it]
OOV: 0.810802
GEO: 0.839586
=======entity level========

Epoch: 21, P: 0.927241, R: 0.902132, F: 0.914514, OOV: 0.810802, GEO: 0.839586
=======entity level========
Epoch:  42%|████▏     | 21/50 [22:14<30:37, 63.35s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.68s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.62s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.63s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.75s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.75s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.66s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.06s/it][A100%|██████████| 8/8 [00:51<00:00,  6.44s/it]
OOV: 0.806598
GEO: 0.849707
=======entity level========

Epoch: 22, P: 0.930353, R: 0.898614, F: 0.914208, OOV: 0.806598, GEO: 0.849707
=======entity level========
Epoch:  44%|████▍     | 22/50 [23:17<29:26, 63.07s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.63s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.65s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.75s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.89s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.67s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.73s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.70s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.07s/it][A100%|██████████| 8/8 [00:51<00:00,  6.47s/it]
OOV: 0.812743
GEO: 0.837209
=======entity level========

Epoch: 23, P: 0.927977, R: 0.903838, F: 0.915749, OOV: 0.812743, GEO: 0.837209
=======entity level========
Epoch:  46%|████▌     | 23/50 [24:19<28:18, 62.92s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.00s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.70s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.78s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.75s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.64s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.84s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.90s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.24s/it][A100%|██████████| 8/8 [00:52<00:00,  6.58s/it]
OOV: 0.809185
GEO: 0.861821
=======entity level========

Epoch: 24, P: 0.930092, R: 0.899254, F: 0.914413, OOV: 0.809185, GEO: 0.861821
=======entity level========
Epoch:  48%|████▊     | 24/50 [25:25<27:40, 63.86s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.70s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.50s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.55s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.62s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.71s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.79s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.02s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.812096
GEO: 0.849741
=======entity level========

Epoch: 25, P: 0.929765, R: 0.901812, F: 0.915575, OOV: 0.812096, GEO: 0.849741
=======entity level========
Epoch:  50%|█████     | 25/50 [26:27<26:23, 63.36s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.63s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.73s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.77s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.82s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.83s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.84s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.13s/it][A100%|██████████| 8/8 [00:52<00:00,  6.53s/it]
OOV: 0.811772
GEO: 0.833763
=======entity level========

Epoch: 26, P: 0.926602, R: 0.903092, F: 0.914696, OOV: 0.811772, GEO: 0.833763
=======entity level========
Epoch:  52%|█████▏    | 26/50 [27:31<25:19, 63.31s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.82s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.87s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.61s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.68s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.61s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.78s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.76s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.01s/it][A100%|██████████| 8/8 [00:51<00:00,  6.44s/it]
OOV: 0.807568
GEO: 0.846554
=======entity level========

Epoch: 27, P: 0.930163, R: 0.898827, F: 0.914227, OOV: 0.807568, GEO: 0.846554
=======entity level========
Epoch:  54%|█████▍    | 27/50 [28:33<24:10, 63.05s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.83s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.70s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.64s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.56s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.62s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.73s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.98s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.812096
GEO: 0.834197
=======entity level========

Epoch: 28, P: 0.928367, R: 0.900853, F: 0.914403, OOV: 0.812096, GEO: 0.834197
=======entity level========
Epoch:  56%|█████▌    | 28/50 [29:35<23:01, 62.77s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.91s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.67s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.68s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.83s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.68s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.72s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.01s/it][A100%|██████████| 8/8 [00:51<00:00,  6.44s/it]
OOV: 0.807245
GEO: 0.836999
=======entity level========

Epoch: 29, P: 0.928626, R: 0.900213, F: 0.914199, OOV: 0.807245, GEO: 0.836999
=======entity level========
Epoch:  58%|█████▊    | 29/50 [30:38<21:55, 62.66s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:51,  7.35s/it][A
 25%|██▌       | 2/8 [00:14<00:43,  7.23s/it][A
 38%|███▊      | 3/8 [00:21<00:34,  6.92s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.78s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.75s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.71s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.12s/it][A100%|██████████| 8/8 [00:52<00:00,  6.57s/it]
OOV: 0.813066
GEO: 0.847854
=======entity level========

Epoch: 30, P: 0.929074, R: 0.900746, F: 0.914691, OOV: 0.813066, GEO: 0.847854
=======entity level========
Epoch:  60%|██████    | 30/50 [31:41<20:58, 62.90s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.09s/it][A
 25%|██▌       | 2/8 [00:14<00:43,  7.19s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.85s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.78s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.63s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.63s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.57s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.85s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.813389
GEO: 0.838501
=======entity level========

Epoch: 31, P: 0.928995, R: 0.902452, F: 0.915531, OOV: 0.813389, GEO: 0.838501
=======entity level========
Epoch:  62%|██████▏   | 31/50 [32:43<19:50, 62.65s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.05s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.77s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.79s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.59s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.61s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.75s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.67s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.88s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.816624
GEO: 0.820972
=======entity level========

Epoch: 32, P: 0.928931, R: 0.905757, F: 0.917197, OOV: 0.816624, GEO: 0.820972
=======entity level========
Epoch:  64%|██████▍   | 32/50 [33:45<18:43, 62.43s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.78s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.82s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.84s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.61s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.63s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.52s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.73s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.91s/it][A100%|██████████| 8/8 [00:51<00:00,  6.38s/it]
OOV: 0.810479
GEO: 0.852673
=======entity level========

Epoch: 33, P: 0.931453, R: 0.901066, F: 0.916007, OOV: 0.810479, GEO: 0.852673
=======entity level========
Epoch:  66%|██████▌   | 33/50 [34:47<17:38, 62.26s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.75s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.60s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.75s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.91s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.79s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.74s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.90s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.814683
GEO: 0.837419
=======entity level========

Epoch: 34, P: 0.928196, R: 0.904051, F: 0.915965, OOV: 0.814683, GEO: 0.837419
=======entity level========

Early stop triggered at epoch 33

Epoch:  66%|██████▌   | 33/50 [35:49<18:27, 65.14s/it]

=======best f entity level========

Epoch: 24, P: 0.930092, R: 0.899254, F: 0.914413, OOV: 0.809185, GEO: 0.861821, GEO_N: 0.845427


=======best f entity level========
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
./models/self_bert_wm_av_3_score_0.7_0.81_2024-12-24-12-40-44/model.pt
  0%|          | 0/62 [00:00<?, ?it/s]/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|▏         | 1/62 [00:04<04:55,  4.84s/it]  3%|▎         | 2/62 [00:06<02:56,  2.94s/it]  5%|▍         | 3/62 [00:07<02:13,  2.27s/it]  6%|▋         | 4/62 [00:09<01:58,  2.04s/it]  8%|▊         | 5/62 [00:11<01:51,  1.96s/it] 10%|▉         | 6/62 [00:13<01:47,  1.92s/it] 11%|█▏        | 7/62 [00:14<01:32,  1.68s/it] 13%|█▎        | 8/62 [00:15<01:24,  1.56s/it] 15%|█▍        | 9/62 [00:17<01:25,  1.62s/it] 16%|█▌        | 10/62 [00:19<01:22,  1.59s/it] 18%|█▊        | 11/62 [00:21<01:28,  1.74s/it] 19%|█▉        | 12/62 [00:22<01:20,  1.62s/it] 21%|██        | 13/62 [00:24<01:25,  1.74s/it] 23%|██▎       | 14/62 [00:26<01:24,  1.76s/it] 24%|██▍       | 15/62 [00:27<01:19,  1.70s/it] 26%|██▌       | 16/62 [00:28<01:09,  1.52s/it] 27%|██▋       | 17/62 [00:30<01:04,  1.44s/it] 29%|██▉       | 18/62 [00:31<01:07,  1.54s/it] 31%|███       | 19/62 [00:34<01:15,  1.75s/it] 32%|███▏      | 20/62 [00:36<01:19,  1.88s/it] 34%|███▍      | 21/62 [00:39<01:27,  2.14s/it] 35%|███▌      | 22/62 [00:40<01:19,  1.98s/it] 37%|███▋      | 23/62 [00:41<01:08,  1.75s/it] 39%|███▊      | 24/62 [00:43<01:08,  1.80s/it] 40%|████      | 25/62 [00:46<01:20,  2.18s/it] 42%|████▏     | 26/62 [00:48<01:16,  2.12s/it] 44%|████▎     | 27/62 [00:50<01:09,  1.98s/it] 45%|████▌     | 28/62 [00:52<01:05,  1.92s/it] 47%|████▋     | 29/62 [00:54<01:02,  1.91s/it] 48%|████▊     | 30/62 [00:55<00:57,  1.79s/it] 50%|█████     | 31/62 [00:57<00:54,  1.76s/it] 52%|█████▏    | 32/62 [00:58<00:47,  1.60s/it] 53%|█████▎    | 33/62 [01:00<00:49,  1.71s/it] 55%|█████▍    | 34/62 [01:02<00:50,  1.80s/it] 56%|█████▋    | 35/62 [01:04<00:46,  1.73s/it] 58%|█████▊    | 36/62 [01:05<00:41,  1.61s/it] 60%|█████▉    | 37/62 [01:06<00:35,  1.43s/it] 61%|██████▏   | 38/62 [01:08<00:35,  1.46s/it] 63%|██████▎   | 39/62 [01:10<00:36,  1.61s/it] 65%|██████▍   | 40/62 [01:11<00:35,  1.61s/it] 66%|██████▌   | 41/62 [01:13<00:33,  1.60s/it] 68%|██████▊   | 42/62 [01:14<00:32,  1.60s/it] 69%|██████▉   | 43/62 [01:16<00:32,  1.70s/it] 71%|███████   | 44/62 [01:18<00:29,  1.65s/it] 73%|███████▎  | 45/62 [01:20<00:32,  1.94s/it] 74%|███████▍  | 46/62 [01:22<00:28,  1.75s/it] 76%|███████▌  | 47/62 [01:23<00:25,  1.68s/it] 77%|███████▋  | 48/62 [01:25<00:23,  1.66s/it] 79%|███████▉  | 49/62 [01:27<00:24,  1.89s/it] 81%|████████  | 50/62 [01:29<00:21,  1.79s/it] 82%|████████▏ | 51/62 [01:31<00:19,  1.81s/it] 84%|████████▍ | 52/62 [01:33<00:18,  1.84s/it] 85%|████████▌ | 53/62 [01:35<00:19,  2.12s/it] 87%|████████▋ | 54/62 [01:37<00:15,  1.97s/it] 89%|████████▊ | 55/62 [01:39<00:12,  1.86s/it] 90%|█████████ | 56/62 [01:40<00:10,  1.73s/it] 92%|█████████▏| 57/62 [01:42<00:08,  1.66s/it] 94%|█████████▎| 58/62 [01:43<00:06,  1.62s/it] 95%|█████████▌| 59/62 [01:45<00:04,  1.62s/it] 97%|█████████▋| 60/62 [01:46<00:03,  1.55s/it] 98%|█████████▊| 61/62 [01:48<00:01,  1.74s/it]100%|██████████| 62/62 [01:50<00:00,  1.69s/it]100%|██████████| 62/62 [01:50<00:00,  1.78s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/home/testcross/projects/models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0.7_0.82', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

 12%|█▎        | 1/8 [00:09<01:07,  9.59s/it][A
 25%|██▌       | 2/8 [00:16<00:47,  7.99s/it][A
 38%|███▊      | 3/8 [00:23<00:36,  7.40s/it][A
 50%|█████     | 4/8 [00:29<00:28,  7.06s/it][A
 62%|██████▎   | 5/8 [00:36<00:20,  6.90s/it][A
 75%|███████▌  | 6/8 [00:43<00:13,  6.91s/it][A
 88%|████████▊ | 7/8 [00:50<00:06,  6.87s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.13s/it][A100%|██████████| 8/8 [00:54<00:00,  6.82s/it]
OOV: 0.666882
GEO: 0.556582
=======entity level========

Epoch: 1, P: 0.825985, R: 0.786887, F: 0.805962, OOV: 0.666882, GEO: 0.556582
=======entity level========
Epoch:   2%|▏         | 1/50 [01:07<54:46, 67.07s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.59s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.56s/it][A
 38%|███▊      | 3/8 [00:18<00:31,  6.22s/it][A
 50%|█████     | 4/8 [00:24<00:24,  6.04s/it][A
 62%|██████▎   | 5/8 [00:31<00:18,  6.30s/it][A
 75%|███████▌  | 6/8 [00:38<00:12,  6.49s/it][A
 88%|████████▊ | 7/8 [00:44<00:06,  6.51s/it][A
100%|██████████| 8/8 [00:49<00:00,  5.82s/it][A100%|██████████| 8/8 [00:49<00:00,  6.15s/it]
OOV: 0.782988
GEO: 0.848366
=======entity level========

Epoch: 2, P: 0.918115, R: 0.878571, F: 0.897908, OOV: 0.782988, GEO: 0.848366
=======entity level========
Epoch:   4%|▍         | 2/50 [02:09<51:22, 64.22s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.77s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.02s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.73s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.79s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.77s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.71s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.14s/it][A100%|██████████| 8/8 [00:52<00:00,  6.53s/it]
OOV: 0.808215
GEO: 0.815099
=======entity level========

Epoch: 3, P: 0.917869, R: 0.901919, F: 0.909824, OOV: 0.808215, GEO: 0.815099
=======entity level========
Epoch:   6%|▌         | 3/50 [03:12<49:58, 63.79s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.88s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.87s/it][A
 38%|███▊      | 3/8 [00:21<00:36,  7.20s/it][A
 50%|█████     | 4/8 [00:28<00:27,  6.99s/it][A
 62%|██████▎   | 5/8 [00:35<00:20,  6.99s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.85s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.78s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.03s/it][A100%|██████████| 8/8 [00:52<00:00,  6.58s/it]
OOV: 0.793984
GEO: 0.860892
=======entity level========

Epoch: 4, P: 0.928333, R: 0.887953, F: 0.907694, OOV: 0.793984, GEO: 0.860892
=======entity level========
Epoch:   8%|▊         | 4/50 [04:18<49:34, 64.65s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.70s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.59s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.59s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.64s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.70s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.74s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.05s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.808215
GEO: 0.859752
=======entity level========

Epoch: 5, P: 0.929272, R: 0.899254, F: 0.914016, OOV: 0.808215, GEO: 0.859752
=======entity level========
Epoch:  10%|█         | 5/50 [05:20<47:52, 63.82s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.57s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.67s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.63s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.91s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.84s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.84s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.83s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.08s/it][A100%|██████████| 8/8 [00:52<00:00,  6.51s/it]
OOV: 0.809185
GEO: 0.853056
=======entity level========

Epoch: 6, P: 0.929255, R: 0.900426, F: 0.914614, OOV: 0.809185, GEO: 0.853056
=======entity level========
Epoch:  12%|█▏        | 6/50 [06:23<46:37, 63.57s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.83s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.81s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.74s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.97s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.95s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.87s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.88s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.13s/it][A100%|██████████| 8/8 [00:52<00:00,  6.58s/it]
OOV: 0.810479
GEO: 0.833977
=======entity level========

Epoch: 7, P: 0.926896, R: 0.901599, F: 0.914073, OOV: 0.810479, GEO: 0.833977
=======entity level========
Epoch:  14%|█▍        | 7/50 [07:27<45:34, 63.58s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.79s/it][A
 25%|██▌       | 2/8 [00:14<00:43,  7.18s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.81s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.70s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.74s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.81s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.72s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.08s/it][A100%|██████████| 8/8 [00:52<00:00,  6.52s/it]
OOV: 0.808862
GEO: 0.854912
=======entity level========

Epoch: 8, P: 0.928540, R: 0.897655, F: 0.912836, OOV: 0.808862, GEO: 0.854912
=======entity level========
Epoch:  16%|█▌        | 8/50 [08:30<44:23, 63.42s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.81s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.68s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.83s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.82s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.92s/it][A
 75%|███████▌  | 6/8 [00:41<00:14,  7.12s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.98s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.17s/it][A100%|██████████| 8/8 [00:52<00:00,  6.62s/it]
OOV: 0.810802
GEO: 0.849903
=======entity level========

Epoch: 9, P: 0.927065, R: 0.899787, F: 0.913222, OOV: 0.810802, GEO: 0.849903
=======entity level========
Epoch:  18%|█▊        | 9/50 [09:34<43:24, 63.53s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.48s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.56s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.80s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.70s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.64s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.73s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.77s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.808862
GEO: 0.859935
=======entity level========

Epoch: 10, P: 0.927223, R: 0.900533, F: 0.913683, OOV: 0.808862, GEO: 0.859935
=======entity level========
Epoch:  20%|██        | 10/50 [10:37<42:11, 63.28s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.76s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.97s/it][A
 38%|███▊      | 3/8 [00:20<00:35,  7.01s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.84s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.76s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.80s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.90s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.22s/it][A100%|██████████| 8/8 [00:52<00:00,  6.61s/it]
OOV: 0.813389
GEO: 0.841629
=======entity level========

Epoch: 11, P: 0.926047, R: 0.902452, F: 0.914098, OOV: 0.813389, GEO: 0.841629
=======entity level========
Epoch:  22%|██▏       | 11/50 [11:41<41:15, 63.48s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.03s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.89s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.78s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.81s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.74s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.86s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.79s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.03s/it][A100%|██████████| 8/8 [00:52<00:00,  6.51s/it]
OOV: 0.800776
GEO: 0.879048
=======entity level========

Epoch: 12, P: 0.928049, R: 0.892431, F: 0.909891, OOV: 0.800776, GEO: 0.879048
=======entity level========
Epoch:  24%|██▍       | 12/50 [12:46<40:33, 64.05s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:51,  7.33s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.04s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.72s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.66s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.18s/it][A100%|██████████| 8/8 [00:52<00:00,  6.53s/it]
OOV: 0.812096
GEO: 0.855844
=======entity level========

Epoch: 13, P: 0.928650, R: 0.901919, F: 0.915089, OOV: 0.812096, GEO: 0.855844
=======entity level========
Epoch:  26%|██▌       | 13/50 [13:49<39:19, 63.78s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.58s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.97s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.82s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.77s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.70s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.68s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.63s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.05s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.811125
GEO: 0.859935
=======entity level========

Epoch: 14, P: 0.929051, R: 0.899041, F: 0.913800, OOV: 0.811125, GEO: 0.859935
=======entity level========
Epoch:  28%|██▊       | 14/50 [14:52<38:03, 63.43s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.07s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.86s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.93s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.69s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.67s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.65s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.52s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.04s/it][A100%|██████████| 8/8 [00:51<00:00,  6.45s/it]
OOV: 0.815330
GEO: 0.867580
=======entity level========

Epoch: 15, P: 0.928164, R: 0.902239, F: 0.915018, OOV: 0.815330, GEO: 0.867580
=======entity level========
Epoch:  30%|███       | 15/50 [15:54<36:50, 63.17s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.80s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.06s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.86s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.78s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.72s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.65s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.52s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.89s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.812743
GEO: 0.856771
=======entity level========

Epoch: 16, P: 0.928367, R: 0.900853, F: 0.914403, OOV: 0.812743, GEO: 0.856771
=======entity level========
Epoch:  32%|███▏      | 16/50 [16:56<35:36, 62.84s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:51,  7.32s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.06s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.88s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.82s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.74s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.01s/it][A100%|██████████| 8/8 [00:51<00:00,  6.50s/it]
OOV: 0.805951
GEO: 0.868369
=======entity level========

Epoch: 17, P: 0.930878, R: 0.897335, F: 0.913799, OOV: 0.805951, GEO: 0.868369
=======entity level========
Epoch:  34%|███▍      | 17/50 [17:59<34:34, 62.86s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.08s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.58s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.56s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.69s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.56s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.72s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.811772
GEO: 0.854545
=======entity level========

Epoch: 18, P: 0.930586, R: 0.900426, F: 0.915258, OOV: 0.811772, GEO: 0.854545
=======entity level========
Epoch:  36%|███▌      | 18/50 [19:02<33:26, 62.71s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.53s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.75s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.82s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.85s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.73s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.71s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.04s/it][A100%|██████████| 8/8 [00:51<00:00,  6.47s/it]
OOV: 0.809185
GEO: 0.864971
=======entity level========

Epoch: 19, P: 0.928053, R: 0.899360, F: 0.913481, OOV: 0.809185, GEO: 0.864971
=======entity level========
Epoch:  38%|███▊      | 19/50 [20:04<32:23, 62.69s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.87s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.85s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.86s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.94s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.95s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.99s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.93s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.07s/it][A100%|██████████| 8/8 [00:52<00:00,  6.59s/it]
OOV: 0.805304
GEO: 0.864230
=======entity level========

Epoch: 20, P: 0.931038, R: 0.896695, F: 0.913544, OOV: 0.805304, GEO: 0.864230
=======entity level========
Epoch:  40%|████      | 20/50 [21:08<31:29, 62.99s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.47s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.63s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.65s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.73s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.76s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.73s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.82s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.11s/it][A100%|██████████| 8/8 [00:51<00:00,  6.47s/it]
OOV: 0.814360
GEO: 0.846998
=======entity level========

Epoch: 21, P: 0.927860, R: 0.903625, F: 0.915582, OOV: 0.814360, GEO: 0.846998
=======entity level========
Epoch:  42%|████▏     | 21/50 [22:11<30:23, 62.88s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.89s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.82s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.83s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.89s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.82s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.73s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.07s/it][A100%|██████████| 8/8 [00:52<00:00,  6.51s/it]
OOV: 0.815006
GEO: 0.871158
=======entity level========

Epoch: 22, P: 0.928133, R: 0.901812, F: 0.914783, OOV: 0.815006, GEO: 0.871158
=======entity level========

Early stop triggered at epoch 21

Epoch:  42%|████▏     | 21/50 [23:14<32:05, 66.38s/it]

=======best f entity level========

Epoch: 12, P: 0.928049, R: 0.892431, F: 0.909891, OOV: 0.800776, GEO: 0.879048, GEO_N: 0.855069


=======best f entity level========
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
./models/self_bert_wm_av_3_score_0.7_0.82_2024-12-24-13-19-01/model.pt
  0%|          | 0/62 [00:00<?, ?it/s]/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|▏         | 1/62 [00:04<04:56,  4.85s/it]  3%|▎         | 2/62 [00:06<02:57,  2.96s/it]  5%|▍         | 3/62 [00:07<02:14,  2.28s/it]  6%|▋         | 4/62 [00:09<01:58,  2.05s/it]  8%|▊         | 5/62 [00:11<01:51,  1.96s/it] 10%|▉         | 6/62 [00:13<01:47,  1.92s/it] 11%|█▏        | 7/62 [00:14<01:33,  1.69s/it] 13%|█▎        | 8/62 [00:15<01:24,  1.57s/it] 15%|█▍        | 9/62 [00:17<01:26,  1.63s/it] 16%|█▌        | 10/62 [00:19<01:22,  1.60s/it] 18%|█▊        | 11/62 [00:21<01:29,  1.75s/it] 19%|█▉        | 12/62 [00:22<01:21,  1.63s/it] 21%|██        | 13/62 [00:24<01:25,  1.75s/it] 23%|██▎       | 14/62 [00:26<01:24,  1.77s/it] 24%|██▍       | 15/62 [00:27<01:20,  1.71s/it] 26%|██▌       | 16/62 [00:29<01:09,  1.52s/it] 27%|██▋       | 17/62 [00:30<01:04,  1.44s/it] 29%|██▉       | 18/62 [00:32<01:07,  1.54s/it] 31%|███       | 19/62 [00:34<01:16,  1.78s/it] 32%|███▏      | 20/62 [00:36<01:20,  1.92s/it] 34%|███▍      | 21/62 [00:39<01:28,  2.16s/it] 35%|███▌      | 22/62 [00:41<01:20,  2.00s/it] 37%|███▋      | 23/62 [00:42<01:08,  1.77s/it] 39%|███▊      | 24/62 [00:44<01:09,  1.82s/it] 40%|████      | 25/62 [00:47<01:21,  2.19s/it] 42%|████▏     | 26/62 [00:49<01:16,  2.14s/it] 44%|████▎     | 27/62 [00:50<01:09,  1.99s/it] 45%|████▌     | 28/62 [00:52<01:05,  1.93s/it] 47%|████▋     | 29/62 [00:54<01:03,  1.92s/it] 48%|████▊     | 30/62 [00:56<00:57,  1.80s/it] 50%|█████     | 31/62 [00:57<00:54,  1.77s/it] 52%|█████▏    | 32/62 [00:59<00:48,  1.60s/it] 53%|█████▎    | 33/62 [01:01<00:49,  1.72s/it] 55%|█████▍    | 34/62 [01:02<00:50,  1.80s/it] 56%|█████▋    | 35/62 [01:04<00:46,  1.73s/it] 58%|█████▊    | 36/62 [01:05<00:41,  1.61s/it] 60%|█████▉    | 37/62 [01:06<00:35,  1.43s/it] 61%|██████▏   | 38/62 [01:08<00:35,  1.47s/it] 63%|██████▎   | 39/62 [01:10<00:36,  1.61s/it] 65%|██████▍   | 40/62 [01:11<00:34,  1.58s/it] 66%|██████▌   | 41/62 [01:13<00:32,  1.56s/it] 68%|██████▊   | 42/62 [01:14<00:30,  1.54s/it] 69%|██████▉   | 43/62 [01:16<00:30,  1.63s/it] 71%|███████   | 44/62 [01:18<00:28,  1.59s/it] 73%|███████▎  | 45/62 [01:20<00:31,  1.85s/it] 74%|███████▍  | 46/62 [01:21<00:26,  1.67s/it] 76%|███████▌  | 47/62 [01:23<00:24,  1.61s/it] 77%|███████▋  | 48/62 [01:24<00:22,  1.58s/it] 79%|███████▉  | 49/62 [01:27<00:23,  1.79s/it] 81%|████████  | 50/62 [01:28<00:20,  1.70s/it] 82%|████████▏ | 51/62 [01:30<00:18,  1.72s/it] 84%|████████▍ | 52/62 [01:32<00:17,  1.75s/it] 85%|████████▌ | 53/62 [01:34<00:18,  2.01s/it] 87%|████████▋ | 54/62 [01:36<00:14,  1.87s/it] 89%|████████▊ | 55/62 [01:37<00:12,  1.76s/it] 90%|█████████ | 56/62 [01:39<00:09,  1.64s/it] 92%|█████████▏| 57/62 [01:40<00:07,  1.58s/it] 94%|█████████▎| 58/62 [01:42<00:06,  1.54s/it] 95%|█████████▌| 59/62 [01:43<00:04,  1.54s/it] 97%|█████████▋| 60/62 [01:45<00:02,  1.47s/it] 98%|█████████▊| 61/62 [01:47<00:01,  1.65s/it]100%|██████████| 62/62 [01:48<00:00,  1.61s/it]100%|██████████| 62/62 [01:48<00:00,  1.75s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/home/testcross/projects/models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0.7_0.83', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

 12%|█▎        | 1/8 [00:09<01:06,  9.52s/it][A
 25%|██▌       | 2/8 [00:16<00:47,  7.93s/it][A
 38%|███▊      | 3/8 [00:22<00:36,  7.32s/it][A
 50%|█████     | 4/8 [00:29<00:27,  6.96s/it][A
 62%|██████▎   | 5/8 [00:35<00:20,  6.78s/it][A
 75%|███████▌  | 6/8 [00:42<00:13,  6.79s/it][A
 88%|████████▊ | 7/8 [00:49<00:06,  6.75s/it][A
100%|██████████| 8/8 [00:53<00:00,  6.01s/it][A100%|██████████| 8/8 [00:53<00:00,  6.71s/it]
OOV: 0.667206
GEO: 0.561159
=======entity level========

Epoch: 1, P: 0.825521, R: 0.784861, F: 0.804678, OOV: 0.667206, GEO: 0.561159
=======entity level========
Epoch:   2%|▏         | 1/50 [01:06<53:56, 66.06s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.51s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.47s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.44s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.56s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.62s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.59s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.85s/it][A100%|██████████| 8/8 [00:50<00:00,  6.29s/it]
OOV: 0.777490
GEO: 0.860526
=======entity level========

Epoch: 2, P: 0.918278, R: 0.875693, F: 0.896480, OOV: 0.777490, GEO: 0.860526
=======entity level========
Epoch:   4%|▍         | 2/50 [02:09<51:41, 64.61s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.67s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.92s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.63s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.68s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.64s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.52s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.93s/it][A100%|██████████| 8/8 [00:50<00:00,  6.37s/it]
OOV: 0.805627
GEO: 0.854723
=======entity level========

Epoch: 3, P: 0.922866, R: 0.896695, F: 0.909592, OOV: 0.805627, GEO: 0.854723
=======entity level========
Epoch:   6%|▌         | 3/50 [03:11<49:34, 63.29s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.54s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.55s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.88s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.67s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.59s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.57s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.85s/it][A100%|██████████| 8/8 [00:50<00:00,  6.33s/it]
OOV: 0.786223
GEO: 0.862797
=======entity level========

Epoch: 4, P: 0.929083, R: 0.885501, F: 0.906769, OOV: 0.786223, GEO: 0.862797
=======entity level========
Epoch:   8%|▊         | 4/50 [04:14<48:35, 63.39s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.66s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.57s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.53s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.56s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.60s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.63s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.59s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.96s/it][A100%|██████████| 8/8 [00:50<00:00,  6.34s/it]
OOV: 0.807891
GEO: 0.847150
=======entity level========

Epoch: 5, P: 0.926040, R: 0.899680, F: 0.912670, OOV: 0.807891, GEO: 0.847150
=======entity level========
Epoch:  10%|█         | 5/50 [05:16<47:01, 62.70s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.51s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.60s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.55s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.73s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.73s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.78s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.08s/it][A100%|██████████| 8/8 [00:51<00:00,  6.44s/it]
OOV: 0.809832
GEO: 0.858447
=======entity level========

Epoch: 6, P: 0.927543, R: 0.899360, F: 0.913234, OOV: 0.809832, GEO: 0.858447
=======entity level========
Epoch:  12%|█▏        | 6/50 [06:18<45:55, 62.62s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.65s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.59s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.56s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.77s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.73s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.65s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.62s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.91s/it][A100%|██████████| 8/8 [00:50<00:00,  6.36s/it]
OOV: 0.811125
GEO: 0.867974
=======entity level========

Epoch: 7, P: 0.928973, R: 0.899360, F: 0.913927, OOV: 0.811125, GEO: 0.867974
=======entity level========
Epoch:  14%|█▍        | 7/50 [07:22<45:13, 63.10s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.71s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.01s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.73s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.65s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.73s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.77s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.05s/it][A100%|██████████| 8/8 [00:51<00:00,  6.47s/it]
OOV: 0.811449
GEO: 0.854167
=======entity level========

Epoch: 8, P: 0.927165, R: 0.898401, F: 0.912556, OOV: 0.811449, GEO: 0.854167
=======entity level========
Epoch:  16%|█▌        | 8/50 [08:25<44:05, 63.00s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.86s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.66s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.75s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.63s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.71s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.90s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.79s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.04s/it][A100%|██████████| 8/8 [00:51<00:00,  6.48s/it]
OOV: 0.811125
GEO: 0.833548
=======entity level========

Epoch: 9, P: 0.926194, R: 0.899041, F: 0.912415, OOV: 0.811125, GEO: 0.833548
=======entity level========
Epoch:  18%|█▊        | 9/50 [09:28<42:58, 62.88s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.54s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.62s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.89s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.82s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.75s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.84s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.87s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.15s/it][A100%|██████████| 8/8 [00:52<00:00,  6.54s/it]
OOV: 0.809508
GEO: 0.852310
=======entity level========

Epoch: 10, P: 0.925881, R: 0.898934, F: 0.912209, OOV: 0.809508, GEO: 0.852310
=======entity level========
Epoch:  20%|██        | 10/50 [10:31<42:00, 63.01s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.64s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.75s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.77s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.66s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.61s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.68s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.77s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.07s/it][A100%|██████████| 8/8 [00:51<00:00,  6.45s/it]
OOV: 0.804010
GEO: 0.872200
=======entity level========

Epoch: 11, P: 0.928011, R: 0.894670, F: 0.911035, OOV: 0.804010, GEO: 0.872200
=======entity level========
Epoch:  22%|██▏       | 11/50 [11:36<41:19, 63.57s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.72s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.62s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.57s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.66s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.58s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.69s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.61s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.87s/it][A100%|██████████| 8/8 [00:50<00:00,  6.33s/it]
OOV: 0.803364
GEO: 0.871626
=======entity level========

Epoch: 12, P: 0.929401, R: 0.895416, F: 0.912092, OOV: 0.803364, GEO: 0.871626
=======entity level========
Epoch:  24%|██▍       | 12/50 [12:37<39:51, 62.92s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.17s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.82s/it][A
 38%|███▊      | 3/8 [00:20<00:32,  6.57s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.54s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.57s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.57s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.58s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.10s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.802393
GEO: 0.877470
=======entity level========

Epoch: 13, P: 0.927962, R: 0.892644, F: 0.909960, OOV: 0.802393, GEO: 0.877470
=======entity level========
Epoch:  26%|██▌       | 13/50 [13:42<39:08, 63.47s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.54s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.91s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.72s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.67s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.60s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.61s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.57s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.98s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.812419
GEO: 0.867407
=======entity level========

Epoch: 14, P: 0.926642, R: 0.899574, F: 0.912907, OOV: 0.812419, GEO: 0.867407
=======entity level========
Epoch:  28%|██▊       | 14/50 [14:44<37:48, 63.01s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.99s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.82s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.89s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.63s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.61s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.60s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.47s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.99s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.811449
GEO: 0.865535
=======entity level========

Epoch: 15, P: 0.928083, R: 0.897015, F: 0.912285, OOV: 0.811449, GEO: 0.865535
=======entity level========
Epoch:  30%|███       | 15/50 [15:46<36:35, 62.73s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.76s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.07s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.83s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.73s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.63s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.56s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.43s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.81s/it][A100%|██████████| 8/8 [00:50<00:00,  6.33s/it]
OOV: 0.814360
GEO: 0.856957
=======entity level========

Epoch: 16, P: 0.926060, R: 0.901279, F: 0.913502, OOV: 0.814360, GEO: 0.856957
=======entity level========
Epoch:  32%|███▏      | 16/50 [16:48<35:19, 62.35s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.07s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.82s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.66s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.64s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.60s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.55s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.59s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.92s/it][A100%|██████████| 8/8 [00:50<00:00,  6.37s/it]
OOV: 0.802717
GEO: 0.877888
=======entity level========

Epoch: 17, P: 0.926737, R: 0.892751, F: 0.909427, OOV: 0.802717, GEO: 0.877888
=======entity level========
Epoch:  34%|███▍      | 17/50 [17:52<34:36, 62.92s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.99s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.51s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.51s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.64s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.57s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.73s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.77s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.05s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.810479
GEO: 0.865925
=======entity level========

Epoch: 18, P: 0.929210, R: 0.897015, F: 0.912829, OOV: 0.810479, GEO: 0.865925
=======entity level========
Epoch:  36%|███▌      | 18/50 [18:54<33:27, 62.74s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.55s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.82s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.90s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.96s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.83s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.81s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.77s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.06s/it][A100%|██████████| 8/8 [00:52<00:00,  6.53s/it]
OOV: 0.809508
GEO: 0.867801
=======entity level========

Epoch: 19, P: 0.928769, R: 0.896588, F: 0.912395, OOV: 0.809508, GEO: 0.867801
=======entity level========
Epoch:  38%|███▊      | 19/50 [19:57<32:29, 62.88s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.72s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.71s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.73s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.77s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.76s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.77s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.73s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.90s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.810155
GEO: 0.862541
=======entity level========

Epoch: 20, P: 0.929991, R: 0.897868, F: 0.913647, OOV: 0.810155, GEO: 0.862541
=======entity level========
Epoch:  40%|████      | 20/50 [20:59<31:18, 62.62s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:44,  6.36s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.46s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.46s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.57s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.63s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.62s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.70s/it][A
100%|██████████| 8/8 [00:50<00:00,  6.00s/it][A100%|██████████| 8/8 [00:50<00:00,  6.35s/it]
OOV: 0.809185
GEO: 0.864794
=======entity level========

Epoch: 21, P: 0.926899, R: 0.898934, F: 0.912702, OOV: 0.809185, GEO: 0.864794
=======entity level========
Epoch:  42%|████▏     | 21/50 [22:01<30:07, 62.33s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.60s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.53s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.55s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.68s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.56s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.58s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.97s/it][A100%|██████████| 8/8 [00:50<00:00,  6.35s/it]
OOV: 0.806921
GEO: 0.873276
=======entity level========

Epoch: 22, P: 0.929456, R: 0.896162, F: 0.912505, OOV: 0.806921, GEO: 0.873276
=======entity level========
Epoch:  44%|████▍     | 22/50 [23:03<28:58, 62.10s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:44,  6.42s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.41s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.49s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.64s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.48s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.56s/it][A
 88%|████████▊ | 7/8 [00:45<00:06,  6.58s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.97s/it][A100%|██████████| 8/8 [00:50<00:00,  6.31s/it]
OOV: 0.805951
GEO: 0.869337
=======entity level========

Epoch: 23, P: 0.929132, R: 0.895949, F: 0.912239, OOV: 0.805951, GEO: 0.869337
=======entity level========
Epoch:  46%|████▌     | 23/50 [24:04<27:49, 61.83s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.93s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.60s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.61s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.54s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.38s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.57s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:50<00:00,  6.03s/it][A100%|██████████| 8/8 [00:50<00:00,  6.36s/it]
OOV: 0.807245
GEO: 0.867801
=======entity level========

Epoch: 24, P: 0.929448, R: 0.896055, F: 0.912446, OOV: 0.807245, GEO: 0.867801
=======entity level========
Epoch:  48%|████▊     | 24/50 [25:06<26:46, 61.78s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.61s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.40s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.54s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.65s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.70s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.77s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.64s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.00s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.816624
GEO: 0.867580
=======entity level========

Epoch: 25, P: 0.928313, R: 0.901493, F: 0.914706, OOV: 0.816624, GEO: 0.867580
=======entity level========
Epoch:  50%|█████     | 25/50 [26:08<25:46, 61.84s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.69s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.79s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.84s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.75s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.66s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.70s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.98s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.813066
GEO: 0.868197
=======entity level========

Epoch: 26, P: 0.929445, R: 0.898827, F: 0.913880, OOV: 0.813066, GEO: 0.868197
=======entity level========
Epoch:  52%|█████▏    | 26/50 [27:10<24:47, 61.97s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.62s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.60s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.43s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.54s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.52s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.69s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.67s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.94s/it][A100%|██████████| 8/8 [00:50<00:00,  6.33s/it]
OOV: 0.810802
GEO: 0.871560
=======entity level========

Epoch: 27, P: 0.929881, R: 0.897761, F: 0.913539, OOV: 0.810802, GEO: 0.871560
=======entity level========

Early stop triggered at epoch 26

Epoch:  52%|█████▏    | 26/50 [28:11<26:01, 65.07s/it]

=======best f entity level========

Epoch: 17, P: 0.926737, R: 0.892751, F: 0.909427, OOV: 0.802717, GEO: 0.877888, GEO_N: 0.855714


=======best f entity level========
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
./models/self_bert_wm_av_3_score_0.7_0.83_2024-12-24-13-44-41/model.pt
  0%|          | 0/62 [00:00<?, ?it/s]/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|▏         | 1/62 [00:04<05:00,  4.92s/it]  3%|▎         | 2/62 [00:06<02:59,  2.99s/it]  5%|▍         | 3/62 [00:08<02:15,  2.29s/it]  6%|▋         | 4/62 [00:09<01:59,  2.06s/it]  8%|▊         | 5/62 [00:11<01:53,  1.98s/it] 10%|▉         | 6/62 [00:13<01:48,  1.94s/it] 11%|█▏        | 7/62 [00:14<01:33,  1.70s/it] 13%|█▎        | 8/62 [00:15<01:25,  1.58s/it] 15%|█▍        | 9/62 [00:17<01:27,  1.64s/it] 16%|█▌        | 10/62 [00:19<01:23,  1.60s/it] 18%|█▊        | 11/62 [00:21<01:29,  1.76s/it] 19%|█▉        | 12/62 [00:22<01:21,  1.64s/it] 21%|██        | 13/62 [00:24<01:25,  1.75s/it] 23%|██▎       | 14/62 [00:26<01:25,  1.78s/it] 24%|██▍       | 15/62 [00:28<01:20,  1.71s/it] 26%|██▌       | 16/62 [00:29<01:10,  1.53s/it] 27%|██▋       | 17/62 [00:30<01:04,  1.44s/it] 29%|██▉       | 18/62 [00:32<01:07,  1.54s/it] 31%|███       | 19/62 [00:34<01:15,  1.75s/it] 32%|███▏      | 20/62 [00:36<01:19,  1.89s/it] 34%|███▍      | 21/62 [00:39<01:27,  2.14s/it] 35%|███▌      | 22/62 [00:41<01:19,  1.99s/it] 37%|███▋      | 23/62 [00:42<01:08,  1.76s/it] 39%|███▊      | 24/62 [00:44<01:08,  1.81s/it] 40%|████      | 25/62 [00:47<01:20,  2.19s/it] 42%|████▏     | 26/62 [00:49<01:17,  2.14s/it] 44%|████▎     | 27/62 [00:50<01:09,  2.00s/it] 45%|████▌     | 28/62 [00:52<01:05,  1.93s/it] 47%|████▋     | 29/62 [00:54<01:03,  1.92s/it] 48%|████▊     | 30/62 [00:56<00:57,  1.80s/it] 50%|█████     | 31/62 [00:57<00:54,  1.77s/it] 52%|█████▏    | 32/62 [00:59<00:48,  1.60s/it] 53%|█████▎    | 33/62 [01:01<00:49,  1.72s/it] 55%|█████▍    | 34/62 [01:03<00:50,  1.80s/it] 56%|█████▋    | 35/62 [01:04<00:46,  1.73s/it] 58%|█████▊    | 36/62 [01:05<00:41,  1.61s/it] 60%|█████▉    | 37/62 [01:06<00:35,  1.43s/it] 61%|██████▏   | 38/62 [01:08<00:35,  1.47s/it] 63%|██████▎   | 39/62 [01:10<00:36,  1.61s/it] 65%|██████▍   | 40/62 [01:11<00:34,  1.59s/it] 66%|██████▌   | 41/62 [01:13<00:32,  1.56s/it] 68%|██████▊   | 42/62 [01:15<00:30,  1.55s/it] 69%|██████▉   | 43/62 [01:16<00:30,  1.63s/it] 71%|███████   | 44/62 [01:18<00:28,  1.58s/it] 73%|███████▎  | 45/62 [01:20<00:31,  1.85s/it] 74%|███████▍  | 46/62 [01:22<00:26,  1.67s/it] 76%|███████▌  | 47/62 [01:23<00:24,  1.60s/it] 77%|███████▋  | 48/62 [01:25<00:22,  1.58s/it] 79%|███████▉  | 49/62 [01:27<00:23,  1.79s/it] 81%|████████  | 50/62 [01:28<00:20,  1.70s/it] 82%|████████▏ | 51/62 [01:30<00:18,  1.71s/it] 84%|████████▍ | 52/62 [01:32<00:17,  1.74s/it] 85%|████████▌ | 53/62 [01:34<00:18,  2.01s/it] 87%|████████▋ | 54/62 [01:36<00:14,  1.86s/it] 89%|████████▊ | 55/62 [01:37<00:12,  1.75s/it] 90%|█████████ | 56/62 [01:39<00:09,  1.64s/it] 92%|█████████▏| 57/62 [01:40<00:07,  1.58s/it] 94%|█████████▎| 58/62 [01:42<00:06,  1.54s/it] 95%|█████████▌| 59/62 [01:43<00:04,  1.54s/it] 97%|█████████▋| 60/62 [01:45<00:02,  1.48s/it] 98%|█████████▊| 61/62 [01:47<00:01,  1.65s/it]100%|██████████| 62/62 [01:48<00:00,  1.61s/it]100%|██████████| 62/62 [01:48<00:00,  1.75s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/home/testcross/projects/models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0.7_0.84', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

 12%|█▎        | 1/8 [00:09<01:06,  9.53s/it][A
 25%|██▌       | 2/8 [00:16<00:47,  7.92s/it][A
 38%|███▊      | 3/8 [00:22<00:36,  7.32s/it][A
 50%|█████     | 4/8 [00:29<00:27,  6.97s/it][A
 62%|██████▎   | 5/8 [00:35<00:20,  6.79s/it][A
 75%|███████▌  | 6/8 [00:42<00:13,  6.80s/it][A
 88%|████████▊ | 7/8 [00:49<00:06,  6.76s/it][A
100%|██████████| 8/8 [00:53<00:00,  6.02s/it][A100%|██████████| 8/8 [00:53<00:00,  6.72s/it]
OOV: 0.665589
GEO: 0.561159
=======entity level========

Epoch: 1, P: 0.823925, R: 0.782729, F: 0.802799, OOV: 0.665589, GEO: 0.561159
=======entity level========
Epoch:   2%|▏         | 1/50 [01:06<54:01, 66.15s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.51s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.46s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.45s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.59s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.64s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.68s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.60s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.86s/it][A100%|██████████| 8/8 [00:50<00:00,  6.30s/it]
OOV: 0.775226
GEO: 0.853947
=======entity level========

Epoch: 2, P: 0.916173, R: 0.873881, F: 0.894527, OOV: 0.775226, GEO: 0.853947
=======entity level========
Epoch:   4%|▍         | 2/50 [02:09<51:42, 64.63s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.67s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.93s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.65s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.74s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.79s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.09s/it][A100%|██████████| 8/8 [00:51<00:00,  6.49s/it]
OOV: 0.799483
GEO: 0.860693
=======entity level========

Epoch: 3, P: 0.923391, R: 0.891791, F: 0.907316, OOV: 0.799483, GEO: 0.860693
=======entity level========
Epoch:   6%|▌         | 3/50 [03:15<50:52, 64.96s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.77s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.75s/it][A
 38%|███▊      | 3/8 [00:20<00:35,  7.05s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.82s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.84s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.76s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.74s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.01s/it][A100%|██████████| 8/8 [00:52<00:00,  6.50s/it]
OOV: 0.784282
GEO: 0.861681
=======entity level========

Epoch: 4, P: 0.926753, R: 0.884861, F: 0.905323, OOV: 0.784282, GEO: 0.861681
=======entity level========
Epoch:   8%|▊         | 4/50 [04:20<49:55, 65.12s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.68s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.57s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.51s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.61s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.68s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.01s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.799806
GEO: 0.846554
=======entity level========

Epoch: 5, P: 0.922172, R: 0.894350, F: 0.908048, OOV: 0.799806, GEO: 0.846554
=======entity level========
Epoch:  10%|█         | 5/50 [05:22<47:57, 63.94s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.51s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.70s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.74s/it][A
 50%|█████     | 4/8 [00:27<00:27,  7.00s/it][A
 62%|██████▎   | 5/8 [00:34<00:21,  7.01s/it][A
 75%|███████▌  | 6/8 [00:41<00:14,  7.05s/it][A
 88%|████████▊ | 7/8 [00:48<00:07,  7.03s/it][A
100%|██████████| 8/8 [00:53<00:00,  6.24s/it][A100%|██████████| 8/8 [00:53<00:00,  6.65s/it]
OOV: 0.804334
GEO: 0.860511
=======entity level========

Epoch: 6, P: 0.927813, R: 0.894776, F: 0.910995, OOV: 0.804334, GEO: 0.860511
=======entity level========
Epoch:  12%|█▏        | 6/50 [06:26<46:55, 63.98s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.57s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.54s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.48s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.70s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.71s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.69s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.93s/it][A100%|██████████| 8/8 [00:50<00:00,  6.36s/it]
OOV: 0.809832
GEO: 0.859935
=======entity level========

Epoch: 7, P: 0.925816, R: 0.898081, F: 0.911738, OOV: 0.809832, GEO: 0.859935
=======entity level========
Epoch:  14%|█▍        | 7/50 [07:28<45:19, 63.25s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.80s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.09s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.70s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.65s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.55s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.92s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.809508
GEO: 0.849546
=======entity level========

Epoch: 8, P: 0.925596, R: 0.897868, F: 0.911521, OOV: 0.809508, GEO: 0.849546
=======entity level========
Epoch:  16%|█▌        | 8/50 [08:30<43:59, 62.85s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.58s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.43s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.59s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.53s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.90s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.85s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.11s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.808538
GEO: 0.863874
=======entity level========

Epoch: 9, P: 0.928279, R: 0.895522, F: 0.911607, OOV: 0.808538, GEO: 0.863874
=======entity level========
Epoch:  18%|█▊        | 9/50 [09:35<43:24, 63.53s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.46s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.47s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.71s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.60s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.55s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.66s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.96s/it][A100%|██████████| 8/8 [00:50<00:00,  6.36s/it]
OOV: 0.807568
GEO: 0.866317
=======entity level========

Epoch: 10, P: 0.928785, R: 0.895416, F: 0.911795, OOV: 0.807568, GEO: 0.866317
=======entity level========
Epoch:  20%|██        | 10/50 [10:39<42:29, 63.73s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.54s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.71s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.73s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.57s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.49s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.52s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.67s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.04s/it][A100%|██████████| 8/8 [00:51<00:00,  6.38s/it]
OOV: 0.801100
GEO: 0.871457
=======entity level========

Epoch: 11, P: 0.928334, R: 0.892111, F: 0.909862, OOV: 0.801100, GEO: 0.871457
=======entity level========
Epoch:  22%|██▏       | 11/50 [11:43<41:34, 63.95s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.69s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.58s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.53s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.65s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.57s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.96s/it][A100%|██████████| 8/8 [00:50<00:00,  6.37s/it]
OOV: 0.800776
GEO: 0.876316
=======entity level========

Epoch: 12, P: 0.928182, R: 0.890085, F: 0.908735, OOV: 0.800776, GEO: 0.876316
=======entity level========
Epoch:  24%|██▍       | 12/50 [12:47<40:30, 63.96s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.14s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.75s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.46s/it][A
 50%|█████     | 4/8 [00:26<00:25,  6.44s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.52s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.54s/it][A
 88%|████████▊ | 7/8 [00:45<00:06,  6.56s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.10s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.810155
GEO: 0.873443
=======entity level========

Epoch: 13, P: 0.927974, R: 0.898294, F: 0.912893, OOV: 0.810155, GEO: 0.873443
=======entity level========
Epoch:  26%|██▌       | 13/50 [13:49<39:05, 63.39s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.66s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.94s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.74s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.68s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.63s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.60s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.55s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.96s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.804334
GEO: 0.874590
=======entity level========

Epoch: 14, P: 0.930289, R: 0.894883, F: 0.912243, OOV: 0.804334, GEO: 0.874590
=======entity level========
Epoch:  28%|██▊       | 14/50 [14:51<37:46, 62.95s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.98s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.76s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.85s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.62s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.59s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.57s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.45s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.96s/it][A100%|██████████| 8/8 [00:50<00:00,  6.37s/it]
OOV: 0.808862
GEO: 0.872131
=======entity level========

Epoch: 15, P: 0.928816, R: 0.897228, F: 0.912749, OOV: 0.808862, GEO: 0.872131
=======entity level========
Epoch:  30%|███       | 15/50 [15:53<36:30, 62.60s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.72s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.98s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.77s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.70s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.62s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.59s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.46s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.83s/it][A100%|██████████| 8/8 [00:50<00:00,  6.34s/it]
OOV: 0.810802
GEO: 0.861619
=======entity level========

Epoch: 16, P: 0.927879, R: 0.898401, F: 0.912902, OOV: 0.810802, GEO: 0.861619
=======entity level========
Epoch:  32%|███▏      | 16/50 [16:54<35:16, 62.25s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.21s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.02s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.87s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.85s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.82s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.73s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.05s/it][A100%|██████████| 8/8 [00:52<00:00,  6.53s/it]
OOV: 0.802717
GEO: 0.858824
=======entity level========

Epoch: 17, P: 0.925281, R: 0.895096, F: 0.909938, OOV: 0.802717, GEO: 0.858824
=======entity level========
Epoch:  34%|███▍      | 17/50 [17:58<34:23, 62.54s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.21s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.73s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.72s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.80s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.67s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.78s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.75s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.02s/it][A100%|██████████| 8/8 [00:51<00:00,  6.48s/it]
OOV: 0.805951
GEO: 0.856213
=======entity level========

Epoch: 18, P: 0.927555, R: 0.896802, F: 0.911919, OOV: 0.805951, GEO: 0.856213
=======entity level========
Epoch:  36%|███▌      | 18/50 [19:00<33:22, 62.58s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:44,  6.40s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.64s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.71s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.78s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.64s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.62s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.57s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.87s/it][A100%|██████████| 8/8 [00:50<00:00,  6.34s/it]
OOV: 0.802393
GEO: 0.862565
=======entity level========

Epoch: 19, P: 0.925983, R: 0.893603, F: 0.909505, OOV: 0.802393, GEO: 0.862565
=======entity level========
Epoch:  38%|███▊      | 19/50 [20:02<32:09, 62.26s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.55s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.54s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.65s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.73s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.74s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.76s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.71s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.93s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.808862
GEO: 0.844961
=======entity level========

Epoch: 20, P: 0.925239, R: 0.898507, F: 0.911677, OOV: 0.808862, GEO: 0.844961
=======entity level========
Epoch:  40%|████      | 20/50 [21:04<31:04, 62.16s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:44,  6.38s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.43s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.44s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.56s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.63s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.62s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.72s/it][A
100%|██████████| 8/8 [00:50<00:00,  6.00s/it][A100%|██████████| 8/8 [00:50<00:00,  6.35s/it]
OOV: 0.811449
GEO: 0.864794
=======entity level========

Epoch: 21, P: 0.927729, R: 0.897761, F: 0.912499, OOV: 0.811449, GEO: 0.864794
=======entity level========
Epoch:  42%|████▏     | 21/50 [22:05<29:58, 62.02s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.59s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.53s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.55s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.66s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.64s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.58s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.59s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.96s/it][A100%|██████████| 8/8 [00:50<00:00,  6.35s/it]
OOV: 0.805304
GEO: 0.866885
=======entity level========

Epoch: 22, P: 0.928358, R: 0.895203, F: 0.911479, OOV: 0.805304, GEO: 0.866885
=======entity level========

Early stop triggered at epoch 21

Epoch:  42%|████▏     | 21/50 [23:07<31:55, 66.07s/it]

=======best f entity level========

Epoch: 12, P: 0.928182, R: 0.890085, F: 0.908735, OOV: 0.800776, GEO: 0.876316, GEO_N: 0.851648


=======best f entity level========
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
./models/self_bert_wm_av_3_score_0.7_0.84_2024-12-24-14-15-18/model.pt
  0%|          | 0/62 [00:00<?, ?it/s]/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|▏         | 1/62 [00:04<05:02,  4.96s/it]  3%|▎         | 2/62 [00:06<03:02,  3.05s/it]  5%|▍         | 3/62 [00:08<02:19,  2.36s/it]  6%|▋         | 4/62 [00:10<02:03,  2.14s/it]  8%|▊         | 5/62 [00:11<01:57,  2.06s/it] 10%|▉         | 6/62 [00:13<01:53,  2.03s/it] 11%|█▏        | 7/62 [00:15<01:37,  1.78s/it] 13%|█▎        | 8/62 [00:16<01:29,  1.65s/it] 15%|█▍        | 9/62 [00:18<01:30,  1.72s/it] 16%|█▌        | 10/62 [00:19<01:27,  1.68s/it] 18%|█▊        | 11/62 [00:22<01:34,  1.85s/it] 19%|█▉        | 12/62 [00:23<01:26,  1.72s/it] 21%|██        | 13/62 [00:25<01:29,  1.82s/it] 23%|██▎       | 14/62 [00:27<01:27,  1.82s/it] 24%|██▍       | 15/62 [00:29<01:22,  1.75s/it] 26%|██▌       | 16/62 [00:30<01:11,  1.55s/it] 27%|██▋       | 17/62 [00:31<01:05,  1.47s/it] 29%|██▉       | 18/62 [00:33<01:08,  1.56s/it] 31%|███       | 19/62 [00:35<01:16,  1.77s/it] 32%|███▏      | 20/62 [00:37<01:20,  1.91s/it] 34%|███▍      | 21/62 [00:40<01:28,  2.16s/it] 35%|███▌      | 22/62 [00:42<01:20,  2.00s/it] 37%|███▋      | 23/62 [00:43<01:08,  1.76s/it] 39%|███▊      | 24/62 [00:45<01:08,  1.81s/it] 40%|████      | 25/62 [00:48<01:21,  2.20s/it] 42%|████▏     | 26/62 [00:50<01:16,  2.13s/it] 44%|████▎     | 27/62 [00:52<01:09,  2.00s/it] 45%|████▌     | 28/62 [00:53<01:05,  1.93s/it] 47%|████▋     | 29/62 [00:55<01:03,  1.92s/it] 48%|████▊     | 30/62 [00:57<00:57,  1.81s/it] 50%|█████     | 31/62 [00:58<00:54,  1.77s/it] 52%|█████▏    | 32/62 [01:00<00:48,  1.61s/it] 53%|█████▎    | 33/62 [01:02<00:49,  1.72s/it] 55%|█████▍    | 34/62 [01:04<00:50,  1.80s/it] 56%|█████▋    | 35/62 [01:05<00:46,  1.73s/it] 58%|█████▊    | 36/62 [01:06<00:41,  1.61s/it] 60%|█████▉    | 37/62 [01:08<00:35,  1.44s/it] 61%|██████▏   | 38/62 [01:09<00:35,  1.47s/it] 63%|██████▎   | 39/62 [01:11<00:37,  1.61s/it] 65%|██████▍   | 40/62 [01:13<00:34,  1.59s/it] 66%|██████▌   | 41/62 [01:14<00:32,  1.57s/it] 68%|██████▊   | 42/62 [01:16<00:30,  1.55s/it] 69%|██████▉   | 43/62 [01:17<00:31,  1.64s/it] 71%|███████   | 44/62 [01:19<00:28,  1.59s/it] 73%|███████▎  | 45/62 [01:21<00:31,  1.85s/it] 74%|███████▍  | 46/62 [01:23<00:26,  1.67s/it] 76%|███████▌  | 47/62 [01:24<00:24,  1.61s/it] 77%|███████▋  | 48/62 [01:26<00:22,  1.59s/it] 79%|███████▉  | 49/62 [01:28<00:23,  1.80s/it] 81%|████████  | 50/62 [01:29<00:20,  1.71s/it] 82%|████████▏ | 51/62 [01:31<00:18,  1.72s/it] 84%|████████▍ | 52/62 [01:33<00:17,  1.75s/it] 85%|████████▌ | 53/62 [01:36<00:18,  2.01s/it] 87%|████████▋ | 54/62 [01:37<00:14,  1.87s/it] 89%|████████▊ | 55/62 [01:39<00:12,  1.76s/it] 90%|█████████ | 56/62 [01:40<00:09,  1.65s/it] 92%|█████████▏| 57/62 [01:42<00:08,  1.60s/it] 94%|█████████▎| 58/62 [01:43<00:06,  1.56s/it] 95%|█████████▌| 59/62 [01:45<00:04,  1.55s/it] 97%|█████████▋| 60/62 [01:46<00:02,  1.48s/it] 98%|█████████▊| 61/62 [01:48<00:01,  1.66s/it]100%|██████████| 62/62 [01:49<00:00,  1.61s/it]100%|██████████| 62/62 [01:49<00:00,  1.77s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/home/testcross/projects/models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0.7_0.85', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

 12%|█▎        | 1/8 [00:09<01:06,  9.57s/it][A
 25%|██▌       | 2/8 [00:16<00:47,  7.96s/it][A
 38%|███▊      | 3/8 [00:22<00:36,  7.33s/it][A
 50%|█████     | 4/8 [00:29<00:27,  6.97s/it][A
 62%|██████▎   | 5/8 [00:35<00:20,  6.81s/it][A
 75%|███████▌  | 6/8 [00:42<00:13,  6.82s/it][A
 88%|████████▊ | 7/8 [00:49<00:06,  6.78s/it][A
100%|██████████| 8/8 [00:53<00:00,  6.05s/it][A100%|██████████| 8/8 [00:53<00:00,  6.74s/it]
OOV: 0.665912
GEO: 0.554913
=======entity level========

Epoch: 1, P: 0.825253, R: 0.783902, F: 0.804046, OOV: 0.665912, GEO: 0.554913
=======entity level========
Epoch:   2%|▏         | 1/50 [01:06<54:11, 66.35s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.54s/it][A
 25%|██▌       | 2/8 [00:13<00:38,  6.50s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.48s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.60s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.69s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.61s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.87s/it][A100%|██████████| 8/8 [00:50<00:00,  6.31s/it]
OOV: 0.774903
GEO: 0.854510
=======entity level========

Epoch: 2, P: 0.916564, R: 0.873667, F: 0.894602, OOV: 0.774903, GEO: 0.854510
=======entity level========
Epoch:   4%|▍         | 2/50 [02:10<51:50, 64.81s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.70s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.93s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.64s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.75s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.79s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.63s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.05s/it][A100%|██████████| 8/8 [00:51<00:00,  6.47s/it]
OOV: 0.799806
GEO: 0.850065
=======entity level========

Epoch: 3, P: 0.923204, R: 0.892004, F: 0.907336, OOV: 0.799806, GEO: 0.850065
=======entity level========
Epoch:   6%|▌         | 3/50 [03:12<50:00, 63.84s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.79s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.79s/it][A
 38%|███▊      | 3/8 [00:21<00:35,  7.10s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.89s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.83s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.63s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.89s/it][A100%|██████████| 8/8 [00:51<00:00,  6.45s/it]
OOV: 0.792367
GEO: 0.863905
=======entity level========

Epoch: 4, P: 0.927920, R: 0.889339, F: 0.908220, OOV: 0.792367, GEO: 0.863905
=======entity level========
Epoch:   8%|▊         | 4/50 [04:17<49:15, 64.25s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.60s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.50s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.50s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.56s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.61s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.65s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.59s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.95s/it][A100%|██████████| 8/8 [00:50<00:00,  6.33s/it]
OOV: 0.801746
GEO: 0.850455
=======entity level========

Epoch: 5, P: 0.923373, R: 0.894136, F: 0.908520, OOV: 0.801746, GEO: 0.850455
=======entity level========
Epoch:  10%|█         | 5/50 [05:19<47:28, 63.31s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.48s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.57s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.56s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.78s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.78s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.83s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.86s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.13s/it][A100%|██████████| 8/8 [00:51<00:00,  6.50s/it]
OOV: 0.801746
GEO: 0.868766
=======entity level========

Epoch: 6, P: 0.927377, R: 0.893070, F: 0.909901, OOV: 0.801746, GEO: 0.868766
=======entity level========
Epoch:  12%|█▏        | 6/50 [06:24<46:58, 64.07s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.80s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.77s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.68s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.92s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.90s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.83s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.80s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.01s/it][A100%|██████████| 8/8 [00:52<00:00,  6.50s/it]
OOV: 0.804981
GEO: 0.859192
=======entity level========

Epoch: 7, P: 0.924780, R: 0.895203, F: 0.909751, OOV: 0.804981, GEO: 0.859192
=======entity level========
Epoch:  14%|█▍        | 7/50 [07:27<45:38, 63.70s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.67s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.97s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.64s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.57s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.67s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.72s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.63s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.97s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.809508
GEO: 0.849546
=======entity level========

Epoch: 8, P: 0.925148, R: 0.897335, F: 0.911029, OOV: 0.809508, GEO: 0.849546
=======entity level========
Epoch:  16%|█▌        | 8/50 [08:29<44:14, 63.21s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.59s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.44s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.60s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.57s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.89s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.79s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.806921
GEO: 0.855469
=======entity level========

Epoch: 9, P: 0.929574, R: 0.896375, F: 0.912673, OOV: 0.806921, GEO: 0.855469
=======entity level========
Epoch:  18%|█▊        | 9/50 [09:32<42:59, 62.91s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:44,  6.42s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.46s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.72s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.64s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.56s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.66s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.96s/it][A100%|██████████| 8/8 [00:50<00:00,  6.36s/it]
OOV: 0.808538
GEO: 0.855469
=======entity level========

Epoch: 10, P: 0.924344, R: 0.897441, F: 0.910694, OOV: 0.808538, GEO: 0.855469
=======entity level========
Epoch:  20%|██        | 10/50 [10:33<41:42, 62.56s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.50s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.69s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.71s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.57s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.48s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.51s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.61s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.95s/it][A100%|██████████| 8/8 [00:50<00:00,  6.33s/it]
OOV: 0.801746
GEO: 0.867280
=======entity level========

Epoch: 11, P: 0.929150, R: 0.892004, F: 0.910199, OOV: 0.801746, GEO: 0.867280
=======entity level========
Epoch:  22%|██▏       | 11/50 [11:35<40:28, 62.27s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.73s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.60s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.57s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.65s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.59s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.69s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.61s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.88s/it][A100%|██████████| 8/8 [00:50<00:00,  6.33s/it]
OOV: 0.803040
GEO: 0.864262
=======entity level========

Epoch: 12, P: 0.929173, R: 0.893710, F: 0.911097, OOV: 0.803040, GEO: 0.864262
=======entity level========
Epoch:  24%|██▍       | 12/50 [12:37<39:18, 62.05s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.11s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.77s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.46s/it][A
 50%|█████     | 4/8 [00:26<00:25,  6.47s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.52s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.55s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.57s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.09s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.799483
GEO: 0.870309
=======entity level========

Epoch: 13, P: 0.927281, R: 0.891791, F: 0.909190, OOV: 0.799483, GEO: 0.870309
=======entity level========
Epoch:  26%|██▌       | 13/50 [13:41<38:42, 62.77s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.54s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.93s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.73s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.70s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.62s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.60s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.56s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.98s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.805951
GEO: 0.887278
=======entity level========

Epoch: 14, P: 0.929417, R: 0.895629, F: 0.912210, OOV: 0.805951, GEO: 0.887278
=======entity level========
Epoch:  28%|██▊       | 14/50 [14:46<37:58, 63.28s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:48,  7.00s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.79s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.90s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.62s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.59s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.57s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.46s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.00s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.807568
GEO: 0.858447
=======entity level========

Epoch: 15, P: 0.928721, R: 0.895949, F: 0.912041, OOV: 0.807568, GEO: 0.858447
=======entity level========
Epoch:  30%|███       | 15/50 [15:47<36:41, 62.89s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.76s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.02s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.81s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.74s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.58s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.46s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.83s/it][A100%|██████████| 8/8 [00:50<00:00,  6.35s/it]
OOV: 0.809508
GEO: 0.850843
=======entity level========

Epoch: 16, P: 0.925299, R: 0.897974, F: 0.911432, OOV: 0.809508, GEO: 0.850843
=======entity level========
Epoch:  32%|███▏      | 16/50 [16:49<35:25, 62.51s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.13s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.92s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.81s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.73s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.69s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.62s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.63s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.95s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.803040
GEO: 0.860875
=======entity level========

Epoch: 17, P: 0.928508, R: 0.893070, F: 0.910445, OOV: 0.803040, GEO: 0.860875
=======entity level========
Epoch:  34%|███▍      | 17/50 [17:51<34:20, 62.44s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.05s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.59s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.54s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.65s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.52s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.65s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.97s/it][A100%|██████████| 8/8 [00:50<00:00,  6.37s/it]
OOV: 0.805304
GEO: 0.859192
=======entity level========

Epoch: 18, P: 0.927192, R: 0.896055, F: 0.911358, OOV: 0.805304, GEO: 0.859192
=======entity level========
Epoch:  36%|███▌      | 18/50 [18:53<33:12, 62.26s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.44s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.66s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.73s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.81s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.67s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.64s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.60s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.90s/it][A100%|██████████| 8/8 [00:50<00:00,  6.37s/it]
OOV: 0.801100
GEO: 0.865183
=======entity level========

Epoch: 19, P: 0.927652, R: 0.891258, F: 0.909091, OOV: 0.801100, GEO: 0.865183
=======entity level========
Epoch:  38%|███▊      | 19/50 [19:55<32:05, 62.12s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.61s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.56s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.66s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.79s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.78s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.79s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.73s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.91s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.803364
GEO: 0.855469
=======entity level========

Epoch: 20, P: 0.928390, R: 0.894243, F: 0.910996, OOV: 0.803364, GEO: 0.855469
=======entity level========
Epoch:  40%|████      | 20/50 [20:57<31:03, 62.11s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:44,  6.39s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.43s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.44s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.63s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.73s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.69s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.79s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.06s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.807245
GEO: 0.860677
=======entity level========

Epoch: 21, P: 0.927122, R: 0.896482, F: 0.911545, OOV: 0.807245, GEO: 0.860677
=======entity level========
Epoch:  42%|████▏     | 21/50 [21:59<30:00, 62.10s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.64s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.61s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.61s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.71s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.69s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.59s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.61s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.98s/it][A100%|██████████| 8/8 [00:51<00:00,  6.38s/it]
OOV: 0.804981
GEO: 0.871560
=======entity level========

Epoch: 22, P: 0.928595, R: 0.894243, F: 0.911095, OOV: 0.804981, GEO: 0.871560
=======entity level========
Epoch:  44%|████▍     | 22/50 [23:01<28:57, 62.04s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.45s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.44s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.52s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.71s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.53s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.59s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.59s/it][A
100%|██████████| 8/8 [00:50<00:00,  6.01s/it][A100%|██████████| 8/8 [00:50<00:00,  6.35s/it]
OOV: 0.799806
GEO: 0.866885
=======entity level========

Epoch: 23, P: 0.928286, R: 0.892857, F: 0.910227, OOV: 0.799806, GEO: 0.866885
=======entity level========
Epoch:  46%|████▌     | 23/50 [24:03<27:51, 61.91s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.88s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.59s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.61s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.55s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.40s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.59s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:50<00:00,  6.04s/it][A100%|██████████| 8/8 [00:50<00:00,  6.37s/it]
OOV: 0.802070
GEO: 0.870079
=======entity level========

Epoch: 24, P: 0.929197, R: 0.894030, F: 0.911274, OOV: 0.802070, GEO: 0.870079
=======entity level========

Early stop triggered at epoch 23

Epoch:  46%|████▌     | 23/50 [25:05<29:26, 65.43s/it]

=======best f entity level========

Epoch: 14, P: 0.929417, R: 0.895629, F: 0.912210, OOV: 0.805951, GEO: 0.887278, GEO_N: 0.855431


=======best f entity level========
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
./models/self_bert_wm_av_3_score_0.7_0.85_2024-12-24-14-40-52/model.pt
  0%|          | 0/62 [00:00<?, ?it/s]/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|▏         | 1/62 [00:04<04:58,  4.89s/it]  3%|▎         | 2/62 [00:06<02:58,  2.97s/it]  5%|▍         | 3/62 [00:07<02:14,  2.28s/it]  6%|▋         | 4/62 [00:09<01:59,  2.05s/it]  8%|▊         | 5/62 [00:11<01:52,  1.97s/it] 10%|▉         | 6/62 [00:13<01:47,  1.93s/it] 11%|█▏        | 7/62 [00:14<01:32,  1.69s/it] 13%|█▎        | 8/62 [00:15<01:24,  1.57s/it] 15%|█▍        | 9/62 [00:17<01:26,  1.63s/it] 16%|█▌        | 10/62 [00:19<01:22,  1.59s/it] 18%|█▊        | 11/62 [00:21<01:29,  1.75s/it] 19%|█▉        | 12/62 [00:22<01:21,  1.63s/it] 21%|██        | 13/62 [00:24<01:25,  1.75s/it] 23%|██▎       | 14/62 [00:26<01:24,  1.77s/it] 24%|██▍       | 15/62 [00:27<01:20,  1.71s/it] 26%|██▌       | 16/62 [00:29<01:09,  1.52s/it] 27%|██▋       | 17/62 [00:30<01:04,  1.44s/it] 29%|██▉       | 18/62 [00:32<01:07,  1.54s/it] 31%|███       | 19/62 [00:34<01:15,  1.75s/it] 32%|███▏      | 20/62 [00:36<01:19,  1.88s/it] 34%|███▍      | 21/62 [00:39<01:27,  2.14s/it] 35%|███▌      | 22/62 [00:40<01:19,  1.99s/it] 37%|███▋      | 23/62 [00:42<01:08,  1.75s/it] 39%|███▊      | 24/62 [00:44<01:08,  1.80s/it] 40%|████      | 25/62 [00:47<01:20,  2.18s/it] 42%|████▏     | 26/62 [00:49<01:16,  2.12s/it] 44%|████▎     | 27/62 [00:50<01:09,  1.99s/it] 45%|████▌     | 28/62 [00:52<01:05,  1.93s/it] 47%|████▋     | 29/62 [00:54<01:03,  1.92s/it] 48%|████▊     | 30/62 [00:55<00:57,  1.80s/it] 50%|█████     | 31/62 [00:57<00:54,  1.77s/it] 52%|█████▏    | 32/62 [00:58<00:48,  1.60s/it] 53%|█████▎    | 33/62 [01:00<00:49,  1.72s/it] 55%|█████▍    | 34/62 [01:02<00:50,  1.79s/it] 56%|█████▋    | 35/62 [01:04<00:46,  1.73s/it] 58%|█████▊    | 36/62 [01:05<00:41,  1.60s/it] 60%|█████▉    | 37/62 [01:06<00:35,  1.43s/it] 61%|██████▏   | 38/62 [01:08<00:35,  1.47s/it] 63%|██████▎   | 39/62 [01:10<00:36,  1.61s/it] 65%|██████▍   | 40/62 [01:11<00:34,  1.58s/it] 66%|██████▌   | 41/62 [01:13<00:32,  1.56s/it] 68%|██████▊   | 42/62 [01:14<00:30,  1.55s/it] 69%|██████▉   | 43/62 [01:16<00:31,  1.63s/it] 71%|███████   | 44/62 [01:18<00:28,  1.59s/it] 73%|███████▎  | 45/62 [01:20<00:31,  1.85s/it] 74%|███████▍  | 46/62 [01:21<00:26,  1.67s/it] 76%|███████▌  | 47/62 [01:23<00:24,  1.60s/it] 77%|███████▋  | 48/62 [01:24<00:22,  1.58s/it] 79%|███████▉  | 49/62 [01:27<00:23,  1.79s/it] 81%|████████  | 50/62 [01:28<00:20,  1.70s/it] 82%|████████▏ | 51/62 [01:30<00:18,  1.72s/it] 84%|████████▍ | 52/62 [01:32<00:17,  1.74s/it] 85%|████████▌ | 53/62 [01:34<00:18,  2.01s/it] 87%|████████▋ | 54/62 [01:36<00:14,  1.86s/it] 89%|████████▊ | 55/62 [01:37<00:12,  1.75s/it] 90%|█████████ | 56/62 [01:39<00:09,  1.64s/it] 92%|█████████▏| 57/62 [01:40<00:07,  1.58s/it] 94%|█████████▎| 58/62 [01:42<00:06,  1.54s/it] 95%|█████████▌| 59/62 [01:43<00:04,  1.54s/it] 97%|█████████▋| 60/62 [01:44<00:02,  1.47s/it] 98%|█████████▊| 61/62 [01:46<00:01,  1.65s/it]100%|██████████| 62/62 [01:48<00:00,  1.61s/it]100%|██████████| 62/62 [01:48<00:00,  1.75s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/home/testcross/projects/models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0.7_0.86', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

 12%|█▎        | 1/8 [00:09<01:09,  9.89s/it][A
 25%|██▌       | 2/8 [00:16<00:49,  8.24s/it][A
 38%|███▊      | 3/8 [00:23<00:38,  7.62s/it][A
 50%|█████     | 4/8 [00:30<00:29,  7.26s/it][A
 62%|██████▎   | 5/8 [00:37<00:21,  7.09s/it][A
 75%|███████▌  | 6/8 [00:44<00:14,  7.10s/it][A
 88%|████████▊ | 7/8 [00:51<00:07,  7.06s/it][A
100%|██████████| 8/8 [00:56<00:00,  6.29s/it][A100%|██████████| 8/8 [00:56<00:00,  7.01s/it]
OOV: 0.666882
GEO: 0.556069
=======entity level========

Epoch: 1, P: 0.825488, R: 0.785181, F: 0.804830, OOV: 0.666882, GEO: 0.556069
=======entity level========
Epoch:   2%|▏         | 1/50 [01:08<55:59, 68.57s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.64s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.58s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.56s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.67s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.74s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.78s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.70s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.95s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.775550
GEO: 0.853386
=======entity level========

Epoch: 2, P: 0.917673, R: 0.874627, F: 0.895633, OOV: 0.775550, GEO: 0.853386
=======entity level========
Epoch:   4%|▍         | 2/50 [02:13<52:55, 66.16s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.78s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.04s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.75s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.86s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.87s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.87s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.76s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.15s/it][A100%|██████████| 8/8 [00:52<00:00,  6.57s/it]
OOV: 0.799806
GEO: 0.853037
=======entity level========

Epoch: 3, P: 0.921908, R: 0.892324, F: 0.906875, OOV: 0.799806, GEO: 0.853037
=======entity level========
Epoch:   6%|▌         | 3/50 [03:16<50:50, 64.91s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.74s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.70s/it][A
 38%|███▊      | 3/8 [00:20<00:35,  7.00s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.78s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.80s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.73s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.95s/it][A100%|██████████| 8/8 [00:51<00:00,  6.45s/it]
OOV: 0.790427
GEO: 0.862024
=======entity level========

Epoch: 4, P: 0.926791, R: 0.888060, F: 0.907012, OOV: 0.790427, GEO: 0.862024
=======entity level========
Epoch:   8%|▊         | 4/50 [04:21<49:46, 64.93s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.70s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.60s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.58s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.63s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.69s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.73s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.67s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.807245
GEO: 0.846403
=======entity level========

Epoch: 5, P: 0.924404, R: 0.896908, F: 0.910449, OOV: 0.807245, GEO: 0.846403
=======entity level========
Epoch:  10%|█         | 5/50 [05:23<47:59, 63.99s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.54s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.65s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.62s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.81s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.74s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.79s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.81s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.05s/it][A100%|██████████| 8/8 [00:51<00:00,  6.47s/it]
OOV: 0.799483
GEO: 0.863309
=======entity level========

Epoch: 6, P: 0.926913, R: 0.893710, F: 0.910009, OOV: 0.799483, GEO: 0.863309
=======entity level========
Epoch:  12%|█▏        | 6/50 [06:28<47:12, 64.38s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.68s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.64s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.56s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.79s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.78s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.70s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.96s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.802717
GEO: 0.858073
=======entity level========

Epoch: 7, P: 0.925615, R: 0.894136, F: 0.909604, OOV: 0.802717, GEO: 0.858073
=======entity level========
Epoch:  14%|█▍        | 7/50 [07:31<45:36, 63.64s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.71s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  7.00s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.69s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.64s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.71s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.72s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.67s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.06s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.806274
GEO: 0.858632
=======entity level========

Epoch: 8, P: 0.927634, R: 0.896482, F: 0.911792, OOV: 0.806274, GEO: 0.858632
=======entity level========
Epoch:  16%|█▌        | 8/50 [08:33<44:21, 63.36s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.89s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.71s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.86s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.83s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.94s/it][A
 75%|███████▌  | 6/8 [00:41<00:14,  7.11s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.97s/it][A
100%|██████████| 8/8 [00:53<00:00,  6.17s/it][A100%|██████████| 8/8 [00:53<00:00,  6.63s/it]
OOV: 0.806598
GEO: 0.848249
=======entity level========

Epoch: 9, P: 0.926673, R: 0.895949, F: 0.911052, OOV: 0.806598, GEO: 0.848249
=======entity level========
Epoch:  18%|█▊        | 9/50 [09:37<43:24, 63.53s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.50s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.55s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.81s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.73s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.66s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.79s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.81s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.06s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.801423
GEO: 0.862361
=======entity level========

Epoch: 10, P: 0.927695, R: 0.894563, F: 0.910828, OOV: 0.801423, GEO: 0.862361
=======entity level========
Epoch:  20%|██        | 10/50 [10:40<42:11, 63.28s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.59s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.87s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.94s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.84s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.74s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.72s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.78s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.09s/it][A100%|██████████| 8/8 [00:52<00:00,  6.51s/it]
OOV: 0.797219
GEO: 0.875989
=======entity level========

Epoch: 11, P: 0.929963, R: 0.890405, F: 0.909754, OOV: 0.797219, GEO: 0.875989
=======entity level========
Epoch:  22%|██▏       | 11/50 [11:45<41:34, 63.97s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.86s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.71s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.70s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.79s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.88s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.84s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.09s/it][A100%|██████████| 8/8 [00:52<00:00,  6.52s/it]
OOV: 0.795925
GEO: 0.875164
=======entity level========

Epoch: 12, P: 0.929286, R: 0.891045, F: 0.909764, OOV: 0.795925, GEO: 0.875164
=======entity level========
Epoch:  24%|██▍       | 12/50 [12:49<40:21, 63.71s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.24s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.85s/it][A
 38%|███▊      | 3/8 [00:20<00:32,  6.57s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.55s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.60s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.65s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.71s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.26s/it][A100%|██████████| 8/8 [00:52<00:00,  6.52s/it]
OOV: 0.803687
GEO: 0.875164
=======entity level========

Epoch: 13, P: 0.928429, R: 0.896162, F: 0.912010, OOV: 0.803687, GEO: 0.875164
=======entity level========
Epoch:  26%|██▌       | 13/50 [13:52<39:11, 63.56s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.80s/it][A
 25%|██▌       | 2/8 [00:14<00:43,  7.17s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.98s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.89s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.76s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.75s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.08s/it][A100%|██████████| 8/8 [00:52<00:00,  6.54s/it]
OOV: 0.789457
GEO: 0.874505
=======entity level========

Epoch: 14, P: 0.927790, R: 0.886247, F: 0.906543, OOV: 0.789457, GEO: 0.874505
=======entity level========
Epoch:  28%|██▊       | 14/50 [14:55<38:04, 63.45s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.10s/it][A
 25%|██▌       | 2/8 [00:14<00:41,  6.99s/it][A
 38%|███▊      | 3/8 [00:21<00:35,  7.13s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.88s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.85s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.82s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.65s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.12s/it][A100%|██████████| 8/8 [00:52<00:00,  6.58s/it]
OOV: 0.804334
GEO: 0.867233
=======entity level========

Epoch: 15, P: 0.927932, R: 0.894989, F: 0.911163, OOV: 0.804334, GEO: 0.867233
=======entity level========
Epoch:  30%|███       | 15/50 [15:59<37:02, 63.50s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.83s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.11s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.89s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.81s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.75s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.54s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.90s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.806921
GEO: 0.868369
=======entity level========

Epoch: 16, P: 0.927263, R: 0.895629, F: 0.911171, OOV: 0.806921, GEO: 0.868369
=======entity level========
Epoch:  32%|███▏      | 16/50 [17:01<35:46, 63.13s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.19s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.92s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.76s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.77s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.74s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.75s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.05s/it][A100%|██████████| 8/8 [00:52<00:00,  6.51s/it]
OOV: 0.797542
GEO: 0.870650
=======entity level========

Epoch: 17, P: 0.927572, R: 0.890192, F: 0.908497, OOV: 0.797542, GEO: 0.870650
=======entity level========
Epoch:  34%|███▍      | 17/50 [18:04<34:41, 63.09s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.11s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.60s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.59s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.68s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.56s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.72s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.72s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.803040
GEO: 0.865535
=======entity level========

Epoch: 18, P: 0.928224, R: 0.896162, F: 0.911911, OOV: 0.803040, GEO: 0.865535
=======entity level========
Epoch:  36%|███▌      | 18/50 [19:06<33:29, 62.79s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.49s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.75s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.81s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.85s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.73s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.98s/it][A100%|██████████| 8/8 [00:51<00:00,  6.44s/it]
OOV: 0.806921
GEO: 0.872131
=======entity level========

Epoch: 19, P: 0.927515, R: 0.896269, F: 0.911624, OOV: 0.806921, GEO: 0.872131
=======entity level========
Epoch:  38%|███▊      | 19/50 [20:08<32:21, 62.64s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.72s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.62s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.73s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.83s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.89s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.96s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.93s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.11s/it][A100%|██████████| 8/8 [00:52<00:00,  6.55s/it]
OOV: 0.803687
GEO: 0.864617
=======entity level========

Epoch: 20, P: 0.928998, R: 0.895522, F: 0.911953, OOV: 0.803687, GEO: 0.864617
=======entity level========
Epoch:  40%|████      | 20/50 [21:12<31:25, 62.85s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.61s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.59s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.61s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.71s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.81s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.94s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.24s/it][A100%|██████████| 8/8 [00:52<00:00,  6.55s/it]
OOV: 0.803364
GEO: 0.867060
=======entity level========

Epoch: 21, P: 0.929275, R: 0.895096, F: 0.911865, OOV: 0.803364, GEO: 0.867060
=======entity level========

Early stop triggered at epoch 20

Epoch:  40%|████      | 20/50 [22:15<33:23, 66.77s/it]

=======best f entity level========

Epoch: 11, P: 0.929963, R: 0.890405, F: 0.909754, OOV: 0.797219, GEO: 0.875989, GEO_N: 0.847788


=======best f entity level========
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
./models/self_bert_wm_av_3_score_0.7_0.86_2024-12-24-15-08-23/model.pt
  0%|          | 0/62 [00:00<?, ?it/s]/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|▏         | 1/62 [00:05<05:05,  5.01s/it]  3%|▎         | 2/62 [00:06<03:03,  3.06s/it]  5%|▍         | 3/62 [00:08<02:19,  2.37s/it]  6%|▋         | 4/62 [00:10<02:03,  2.14s/it]  8%|▊         | 5/62 [00:11<01:57,  2.06s/it] 10%|▉         | 6/62 [00:13<01:53,  2.02s/it] 11%|█▏        | 7/62 [00:15<01:37,  1.77s/it] 13%|█▎        | 8/62 [00:16<01:28,  1.64s/it] 15%|█▍        | 9/62 [00:18<01:30,  1.71s/it] 16%|█▌        | 10/62 [00:19<01:27,  1.68s/it] 18%|█▊        | 11/62 [00:22<01:33,  1.84s/it] 19%|█▉        | 12/62 [00:23<01:25,  1.72s/it] 21%|██        | 13/62 [00:25<01:30,  1.84s/it] 23%|██▎       | 14/62 [00:27<01:29,  1.86s/it] 24%|██▍       | 15/62 [00:29<01:24,  1.79s/it] 26%|██▌       | 16/62 [00:30<01:13,  1.60s/it] 27%|██▋       | 17/62 [00:31<01:08,  1.51s/it] 29%|██▉       | 18/62 [00:33<01:10,  1.61s/it] 31%|███       | 19/62 [00:35<01:18,  1.83s/it] 32%|███▏      | 20/62 [00:38<01:23,  1.98s/it] 34%|███▍      | 21/62 [00:41<01:32,  2.25s/it] 35%|███▌      | 22/62 [00:42<01:23,  2.09s/it] 37%|███▋      | 23/62 [00:44<01:12,  1.85s/it] 39%|███▊      | 24/62 [00:46<01:12,  1.90s/it] 40%|████      | 25/62 [00:49<01:25,  2.30s/it] 42%|████▏     | 26/62 [00:51<01:20,  2.24s/it] 44%|████▎     | 27/62 [00:53<01:13,  2.09s/it] 45%|████▌     | 28/62 [00:55<01:09,  2.03s/it] 47%|████▋     | 29/62 [00:57<01:06,  2.02s/it] 48%|████▊     | 30/62 [00:58<01:00,  1.89s/it] 50%|█████     | 31/62 [01:00<00:57,  1.86s/it] 52%|█████▏    | 32/62 [01:01<00:50,  1.69s/it] 53%|█████▎    | 33/62 [01:03<00:52,  1.80s/it] 55%|█████▍    | 34/62 [01:05<00:52,  1.89s/it] 56%|█████▋    | 35/62 [01:07<00:49,  1.82s/it] 58%|█████▊    | 36/62 [01:09<00:43,  1.69s/it] 60%|█████▉    | 37/62 [01:10<00:37,  1.51s/it] 61%|██████▏   | 38/62 [01:11<00:36,  1.54s/it] 63%|██████▎   | 39/62 [01:13<00:38,  1.69s/it] 65%|██████▍   | 40/62 [01:15<00:36,  1.67s/it] 66%|██████▌   | 41/62 [01:16<00:34,  1.64s/it] 68%|██████▊   | 42/62 [01:18<00:32,  1.62s/it] 69%|██████▉   | 43/62 [01:20<00:32,  1.71s/it] 71%|███████   | 44/62 [01:21<00:29,  1.66s/it] 73%|███████▎  | 45/62 [01:24<00:33,  1.94s/it] 74%|███████▍  | 46/62 [01:25<00:28,  1.76s/it] 76%|███████▌  | 47/62 [01:27<00:25,  1.68s/it] 77%|███████▋  | 48/62 [01:29<00:23,  1.65s/it] 79%|███████▉  | 49/62 [01:31<00:24,  1.88s/it] 81%|████████  | 50/62 [01:32<00:21,  1.78s/it] 82%|████████▏ | 51/62 [01:34<00:19,  1.80s/it] 84%|████████▍ | 52/62 [01:36<00:18,  1.84s/it] 85%|████████▌ | 53/62 [01:39<00:19,  2.12s/it] 87%|████████▋ | 54/62 [01:41<00:15,  1.96s/it] 89%|████████▊ | 55/62 [01:42<00:12,  1.84s/it] 90%|█████████ | 56/62 [01:44<00:10,  1.72s/it] 92%|█████████▏| 57/62 [01:45<00:08,  1.66s/it] 94%|█████████▎| 58/62 [01:47<00:06,  1.62s/it] 95%|█████████▌| 59/62 [01:48<00:04,  1.62s/it] 97%|█████████▋| 60/62 [01:50<00:03,  1.55s/it] 98%|█████████▊| 61/62 [01:52<00:01,  1.74s/it]100%|██████████| 62/62 [01:53<00:00,  1.69s/it]100%|██████████| 62/62 [01:53<00:00,  1.84s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/home/testcross/projects/models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0.7_0.87', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

 12%|█▎        | 1/8 [00:09<01:06,  9.47s/it][A
 25%|██▌       | 2/8 [00:16<00:47,  7.89s/it][A
 38%|███▊      | 3/8 [00:22<00:36,  7.29s/it][A
 50%|█████     | 4/8 [00:29<00:27,  6.95s/it][A
 62%|██████▎   | 5/8 [00:35<00:20,  6.78s/it][A
 75%|███████▌  | 6/8 [00:42<00:13,  6.78s/it][A
 88%|████████▊ | 7/8 [00:49<00:06,  6.74s/it][A
100%|██████████| 8/8 [00:53<00:00,  6.00s/it][A100%|██████████| 8/8 [00:53<00:00,  6.70s/it]
OOV: 0.665912
GEO: 0.557870
=======entity level========

Epoch: 1, P: 0.826497, R: 0.784115, F: 0.804749, OOV: 0.665912, GEO: 0.557870
=======entity level========
Epoch:   2%|▏         | 1/50 [01:05<53:50, 65.93s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.48s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.45s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.45s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.57s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.62s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.59s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.86s/it][A100%|██████████| 8/8 [00:50<00:00,  6.29s/it]
OOV: 0.775873
GEO: 0.853578
=======entity level========

Epoch: 2, P: 0.917319, R: 0.874094, F: 0.895185, OOV: 0.775873, GEO: 0.853578
=======entity level========
Epoch:   4%|▍         | 2/50 [02:09<51:41, 64.61s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.75s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.06s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.78s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.85s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.86s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.80s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.62s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.98s/it][A100%|██████████| 8/8 [00:51<00:00,  6.48s/it]
OOV: 0.800453
GEO: 0.851924
=======entity level========

Epoch: 3, P: 0.923264, R: 0.892751, F: 0.907751, OOV: 0.800453, GEO: 0.851924
=======entity level========
Epoch:   6%|▌         | 3/50 [03:12<49:56, 63.75s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.61s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.59s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.90s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.69s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.71s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.64s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.64s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.92s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.789457
GEO: 0.867280
=======entity level========

Epoch: 4, P: 0.926775, R: 0.887846, F: 0.906893, OOV: 0.789457, GEO: 0.867280
=======entity level========
Epoch:   8%|▊         | 4/50 [04:16<49:04, 64.02s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.59s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.50s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.48s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.53s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.60s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.64s/it][A
 88%|████████▊ | 7/8 [00:45<00:06,  6.58s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.94s/it][A100%|██████████| 8/8 [00:50<00:00,  6.32s/it]
OOV: 0.798512
GEO: 0.859008
=======entity level========

Epoch: 5, P: 0.926673, R: 0.891898, F: 0.908953, OOV: 0.798512, GEO: 0.859008
=======entity level========
Epoch:  10%|█         | 5/50 [05:18<47:18, 63.07s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.47s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.57s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.54s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.75s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.69s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.98s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.797542
GEO: 0.869165
=======entity level========

Epoch: 6, P: 0.929460, R: 0.892004, F: 0.910347, OOV: 0.797542, GEO: 0.869165
=======entity level========
Epoch:  12%|█▏        | 6/50 [06:22<46:36, 63.56s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.83s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.76s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.68s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.90s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.91s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.78s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.72s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.95s/it][A100%|██████████| 8/8 [00:51<00:00,  6.47s/it]
OOV: 0.803687
GEO: 0.864052
=======entity level========

Epoch: 7, P: 0.926818, R: 0.893817, F: 0.910018, OOV: 0.803687, GEO: 0.864052
=======entity level========
Epoch:  14%|█▍        | 7/50 [07:25<45:19, 63.25s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.70s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.96s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.62s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.57s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.65s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.53s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.90s/it][A100%|██████████| 8/8 [00:50<00:00,  6.35s/it]
OOV: 0.804981
GEO: 0.854167
=======entity level========

Epoch: 8, P: 0.925306, R: 0.895416, F: 0.910115, OOV: 0.804981, GEO: 0.854167
=======entity level========
Epoch:  16%|█▌        | 8/50 [08:26<43:54, 62.73s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.57s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.42s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.57s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.54s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.86s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.77s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.02s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.800453
GEO: 0.855657
=======entity level========

Epoch: 9, P: 0.929538, R: 0.893070, F: 0.910940, OOV: 0.800453, GEO: 0.855657
=======entity level========
Epoch:  18%|█▊        | 9/50 [09:28<42:43, 62.53s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:44,  6.39s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.44s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.70s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.63s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.56s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.65s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.95s/it][A100%|██████████| 8/8 [00:50<00:00,  6.35s/it]
OOV: 0.805304
GEO: 0.866450
=======entity level========

Epoch: 10, P: 0.927546, R: 0.895309, F: 0.911142, OOV: 0.805304, GEO: 0.866450
=======entity level========
Epoch:  20%|██        | 10/50 [10:30<41:30, 62.27s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.51s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.69s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.72s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.57s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.49s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.55s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.64s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.98s/it][A100%|██████████| 8/8 [00:50<00:00,  6.35s/it]
OOV: 0.794955
GEO: 0.871795
=======entity level========

Epoch: 11, P: 0.928794, R: 0.888593, F: 0.908249, OOV: 0.794955, GEO: 0.871795
=======entity level========
Epoch:  22%|██▏       | 11/50 [11:34<40:50, 62.83s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.75s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.62s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.59s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.66s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.58s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.59s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.86s/it][A100%|██████████| 8/8 [00:50<00:00,  6.33s/it]
OOV: 0.805304
GEO: 0.865359
=======entity level========

Epoch: 12, P: 0.927964, R: 0.895416, F: 0.911399, OOV: 0.805304, GEO: 0.865359
=======entity level========
Epoch:  24%|██▍       | 12/50 [12:36<39:31, 62.41s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.09s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.74s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.45s/it][A
 50%|█████     | 4/8 [00:26<00:25,  6.42s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.49s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.51s/it][A
 88%|████████▊ | 7/8 [00:45<00:06,  6.53s/it][A
100%|██████████| 8/8 [00:50<00:00,  6.07s/it][A100%|██████████| 8/8 [00:50<00:00,  6.36s/it]
OOV: 0.803364
GEO: 0.877792
=======entity level========

Epoch: 13, P: 0.929474, R: 0.893603, F: 0.911186, OOV: 0.803364, GEO: 0.877792
=======entity level========
Epoch:  26%|██▌       | 13/50 [13:40<38:48, 62.93s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.62s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.06s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.89s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.88s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.76s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.68s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.61s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.00s/it][A100%|██████████| 8/8 [00:51<00:00,  6.47s/it]
OOV: 0.803040
GEO: 0.884793
=======entity level========

Epoch: 14, P: 0.931406, R: 0.893177, F: 0.911891, OOV: 0.803040, GEO: 0.884793
=======entity level========
Epoch:  28%|██▊       | 14/50 [14:45<38:08, 63.57s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.02s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.79s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.86s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.61s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.58s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.57s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.45s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.96s/it][A100%|██████████| 8/8 [00:51<00:00,  6.38s/it]
OOV: 0.806274
GEO: 0.878369
=======entity level========

Epoch: 15, P: 0.928287, R: 0.895629, F: 0.911666, OOV: 0.806274, GEO: 0.878369
=======entity level========
Epoch:  30%|███       | 15/50 [15:47<36:46, 63.04s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.75s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.04s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.81s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.73s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.64s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.58s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.45s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.83s/it][A100%|██████████| 8/8 [00:50<00:00,  6.34s/it]
OOV: 0.802070
GEO: 0.882740
=======entity level========

Epoch: 16, P: 0.929237, R: 0.893177, F: 0.910850, OOV: 0.802070, GEO: 0.882740
=======entity level========
Epoch:  32%|███▏      | 16/50 [16:48<35:28, 62.60s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.17s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.85s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.69s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.66s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.62s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.57s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.62s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.95s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.801100
GEO: 0.878947
=======entity level========

Epoch: 17, P: 0.926532, R: 0.892751, F: 0.909328, OOV: 0.801100, GEO: 0.878947
=======entity level========
Epoch:  34%|███▍      | 17/50 [17:50<34:19, 62.42s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.03s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.52s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.51s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.62s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.50s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.73s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.09s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.802717
GEO: 0.884488
=======entity level========

Epoch: 18, P: 0.930078, R: 0.893390, F: 0.911365, OOV: 0.802717, GEO: 0.884488
=======entity level========
Epoch:  36%|███▌      | 18/50 [18:52<33:14, 62.33s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.45s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.67s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.74s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.80s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.67s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.63s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.59s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.90s/it][A100%|██████████| 8/8 [00:50<00:00,  6.36s/it]
OOV: 0.805304
GEO: 0.886109
=======entity level========

Epoch: 19, P: 0.931983, R: 0.892537, F: 0.911834, OOV: 0.805304, GEO: 0.886109
=======entity level========
Epoch:  38%|███▊      | 19/50 [19:56<32:27, 62.81s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.60s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.54s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.65s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.73s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.76s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.78s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.71s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.90s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.803040
GEO: 0.872299
=======entity level========

Epoch: 20, P: 0.931879, R: 0.892537, F: 0.911784, OOV: 0.803040, GEO: 0.872299
=======entity level========
Epoch:  40%|████      | 20/50 [20:58<31:16, 62.55s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:44,  6.30s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.39s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.42s/it][A
 50%|█████     | 4/8 [00:25<00:26,  6.54s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.83s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.12s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.805951
GEO: 0.858632
=======entity level========

Epoch: 21, P: 0.927381, R: 0.895842, F: 0.911339, OOV: 0.805951, GEO: 0.858632
=======entity level========
Epoch:  42%|████▏     | 21/50 [22:01<30:11, 62.47s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.82s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.74s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.68s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.77s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.74s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.68s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.71s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.09s/it][A100%|██████████| 8/8 [00:51<00:00,  6.48s/it]
OOV: 0.800453
GEO: 0.867974
=======entity level========

Epoch: 22, P: 0.928318, R: 0.893284, F: 0.910464, OOV: 0.800453, GEO: 0.867974
=======entity level========
Epoch:  44%|████▍     | 22/50 [23:03<29:12, 62.59s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.63s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.60s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.68s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.87s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.69s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.65s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.02s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.805951
GEO: 0.871895
=======entity level========

Epoch: 23, P: 0.926848, R: 0.896908, F: 0.911632, OOV: 0.805951, GEO: 0.871895
=======entity level========
Epoch:  46%|████▌     | 23/50 [24:06<28:07, 62.49s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.90s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.59s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.60s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.56s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.40s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.58s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.64s/it][A
100%|██████████| 8/8 [00:50<00:00,  6.01s/it][A100%|██████████| 8/8 [00:50<00:00,  6.36s/it]
OOV: 0.801746
GEO: 0.878113
=======entity level========

Epoch: 24, P: 0.929570, R: 0.893497, F: 0.911176, OOV: 0.801746, GEO: 0.878113
=======entity level========
Epoch:  48%|████▊     | 24/50 [25:07<26:58, 62.26s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.64s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.42s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.47s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.56s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.64s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.60s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.94s/it][A100%|██████████| 8/8 [00:50<00:00,  6.33s/it]
OOV: 0.804981
GEO: 0.873608
=======entity level========

Epoch: 25, P: 0.928327, R: 0.894776, F: 0.911243, OOV: 0.804981, GEO: 0.873608
=======entity level========
Epoch:  50%|█████     | 25/50 [26:09<25:50, 62.00s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.57s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.64s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.65s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.63s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.54s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.57s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.60s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.91s/it][A100%|██████████| 8/8 [00:50<00:00,  6.33s/it]
OOV: 0.807245
GEO: 0.868713
=======entity level========

Epoch: 26, P: 0.925946, R: 0.897122, F: 0.911306, OOV: 0.807245, GEO: 0.868713
=======entity level========
Epoch:  52%|█████▏    | 26/50 [27:10<24:43, 61.81s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.63s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.60s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.47s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.62s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.56s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.73s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.72s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.98s/it][A100%|██████████| 8/8 [00:50<00:00,  6.37s/it]
OOV: 0.804657
GEO: 0.872131
=======entity level========

Epoch: 27, P: 0.928556, R: 0.895096, F: 0.911519, OOV: 0.804657, GEO: 0.872131
=======entity level========
Epoch:  54%|█████▍    | 27/50 [28:12<23:41, 61.82s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.77s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.62s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.56s/it][A
 50%|█████     | 4/8 [00:26<00:25,  6.49s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.56s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.59s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.91s/it][A100%|██████████| 8/8 [00:50<00:00,  6.33s/it]
OOV: 0.802717
GEO: 0.874754
=======entity level========

Epoch: 28, P: 0.928682, R: 0.894030, F: 0.911027, OOV: 0.802717, GEO: 0.874754
=======entity level========
Epoch:  56%|█████▌    | 28/50 [29:13<22:36, 61.68s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.90s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.61s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.61s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.77s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.60s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.58s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.63s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.92s/it][A100%|██████████| 8/8 [00:50<00:00,  6.36s/it]
OOV: 0.809508
GEO: 0.865535
=======entity level========

Epoch: 29, P: 0.928997, R: 0.898294, F: 0.913388, OOV: 0.809508, GEO: 0.865535
=======entity level========

Early stop triggered at epoch 28

Epoch:  56%|█████▌    | 28/50 [30:15<23:46, 64.84s/it]

=======best f entity level========

Epoch: 19, P: 0.931983, R: 0.892537, F: 0.911834, OOV: 0.805304, GEO: 0.886109, GEO_N: 0.855716


=======best f entity level========
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
./models/self_bert_wm_av_3_score_0.7_0.87_2024-12-24-15-33-10/model.pt
  0%|          | 0/62 [00:00<?, ?it/s]/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|▏         | 1/62 [00:04<04:53,  4.82s/it]  3%|▎         | 2/62 [00:06<02:56,  2.94s/it]  5%|▍         | 3/62 [00:07<02:13,  2.27s/it]  6%|▋         | 4/62 [00:09<01:58,  2.04s/it]  8%|▊         | 5/62 [00:11<01:51,  1.96s/it] 10%|▉         | 6/62 [00:13<01:47,  1.92s/it] 11%|█▏        | 7/62 [00:14<01:32,  1.69s/it] 13%|█▎        | 8/62 [00:15<01:24,  1.57s/it] 15%|█▍        | 9/62 [00:17<01:26,  1.63s/it] 16%|█▌        | 10/62 [00:19<01:22,  1.59s/it] 18%|█▊        | 11/62 [00:21<01:29,  1.75s/it] 19%|█▉        | 12/62 [00:22<01:21,  1.63s/it] 21%|██        | 13/62 [00:24<01:25,  1.75s/it] 23%|██▎       | 14/62 [00:26<01:24,  1.77s/it] 24%|██▍       | 15/62 [00:27<01:20,  1.70s/it] 26%|██▌       | 16/62 [00:28<01:09,  1.52s/it] 27%|██▋       | 17/62 [00:30<01:04,  1.44s/it] 29%|██▉       | 18/62 [00:32<01:07,  1.54s/it] 31%|███       | 19/62 [00:34<01:15,  1.75s/it] 32%|███▏      | 20/62 [00:36<01:19,  1.89s/it] 34%|███▍      | 21/62 [00:39<01:27,  2.14s/it] 35%|███▌      | 22/62 [00:40<01:19,  1.99s/it] 37%|███▋      | 23/62 [00:42<01:08,  1.76s/it] 39%|███▊      | 24/62 [00:43<01:08,  1.81s/it] 40%|████      | 25/62 [00:47<01:20,  2.19s/it] 42%|████▏     | 26/62 [00:49<01:16,  2.13s/it] 44%|████▎     | 27/62 [00:50<01:09,  1.99s/it] 45%|████▌     | 28/62 [00:52<01:05,  1.92s/it] 47%|████▋     | 29/62 [00:54<01:03,  1.92s/it] 48%|████▊     | 30/62 [00:55<00:57,  1.80s/it] 50%|█████     | 31/62 [00:57<00:54,  1.77s/it] 52%|█████▏    | 32/62 [00:58<00:48,  1.60s/it] 53%|█████▎    | 33/62 [01:00<00:49,  1.72s/it] 55%|█████▍    | 34/62 [01:02<00:50,  1.80s/it] 56%|█████▋    | 35/62 [01:04<00:46,  1.73s/it] 58%|█████▊    | 36/62 [01:05<00:41,  1.61s/it] 60%|█████▉    | 37/62 [01:06<00:35,  1.44s/it] 61%|██████▏   | 38/62 [01:08<00:35,  1.47s/it] 63%|██████▎   | 39/62 [01:10<00:36,  1.61s/it] 65%|██████▍   | 40/62 [01:11<00:34,  1.58s/it] 66%|██████▌   | 41/62 [01:13<00:32,  1.56s/it] 68%|██████▊   | 42/62 [01:14<00:30,  1.54s/it] 69%|██████▉   | 43/62 [01:16<00:30,  1.63s/it] 71%|███████   | 44/62 [01:18<00:28,  1.58s/it] 73%|███████▎  | 45/62 [01:20<00:31,  1.85s/it] 74%|███████▍  | 46/62 [01:21<00:26,  1.67s/it] 76%|███████▌  | 47/62 [01:23<00:24,  1.60s/it] 77%|███████▋  | 48/62 [01:24<00:22,  1.58s/it] 79%|███████▉  | 49/62 [01:26<00:23,  1.79s/it] 81%|████████  | 50/62 [01:28<00:20,  1.70s/it] 82%|████████▏ | 51/62 [01:30<00:18,  1.71s/it] 84%|████████▍ | 52/62 [01:32<00:17,  1.74s/it] 85%|████████▌ | 53/62 [01:34<00:18,  2.01s/it] 87%|████████▋ | 54/62 [01:36<00:14,  1.86s/it] 89%|████████▊ | 55/62 [01:37<00:12,  1.76s/it] 90%|█████████ | 56/62 [01:39<00:09,  1.64s/it] 92%|█████████▏| 57/62 [01:40<00:07,  1.58s/it] 94%|█████████▎| 58/62 [01:41<00:06,  1.54s/it] 95%|█████████▌| 59/62 [01:43<00:04,  1.54s/it] 97%|█████████▋| 60/62 [01:44<00:02,  1.47s/it] 98%|█████████▊| 61/62 [01:46<00:01,  1.65s/it]100%|██████████| 62/62 [01:48<00:00,  1.61s/it]100%|██████████| 62/62 [01:48<00:00,  1.75s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/home/testcross/projects/models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0.7_0.88', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

 12%|█▎        | 1/8 [00:09<01:07,  9.70s/it][A
 25%|██▌       | 2/8 [00:16<00:48,  8.06s/it][A
 38%|███▊      | 3/8 [00:23<00:37,  7.44s/it][A
 50%|█████     | 4/8 [00:29<00:28,  7.08s/it][A
 62%|██████▎   | 5/8 [00:36<00:20,  6.91s/it][A
 75%|███████▌  | 6/8 [00:43<00:13,  6.95s/it][A
 88%|████████▊ | 7/8 [00:50<00:06,  6.95s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.18s/it][A100%|██████████| 8/8 [00:54<00:00,  6.87s/it]
OOV: 0.665912
GEO: 0.554913
=======entity level========

Epoch: 1, P: 0.826219, R: 0.784115, F: 0.804617, OOV: 0.665912, GEO: 0.554913
=======entity level========
Epoch:   2%|▏         | 1/50 [01:07<55:10, 67.57s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.63s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.58s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.56s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.68s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.73s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.78s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.70s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.94s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.772316
GEO: 0.860910
=======entity level========

Epoch: 2, P: 0.916545, R: 0.872281, F: 0.893866, OOV: 0.772316, GEO: 0.860910
=======entity level========
Epoch:   4%|▍         | 2/50 [02:12<52:37, 65.77s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.77s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.00s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.71s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.75s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.73s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.72s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.60s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.99s/it][A100%|██████████| 8/8 [00:51<00:00,  6.44s/it]
OOV: 0.797542
GEO: 0.857516
=======entity level========

Epoch: 3, P: 0.924781, R: 0.889979, F: 0.907046, OOV: 0.797542, GEO: 0.857516
=======entity level========
Epoch:   6%|▌         | 3/50 [03:14<50:17, 64.20s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.63s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.67s/it][A
 38%|███▊      | 3/8 [00:20<00:35,  7.07s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.90s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.91s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.78s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.72s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.97s/it][A100%|██████████| 8/8 [00:51<00:00,  6.49s/it]
OOV: 0.794955
GEO: 0.867105
=======entity level========

Epoch: 4, P: 0.929207, R: 0.889979, F: 0.909170, OOV: 0.794955, GEO: 0.867105
=======entity level========
Epoch:   8%|▊         | 4/50 [04:19<49:33, 64.64s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.72s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.59s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.58s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.63s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.67s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.05s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.797865
GEO: 0.859008
=======entity level========

Epoch: 5, P: 0.925659, R: 0.890725, F: 0.907856, OOV: 0.797865, GEO: 0.859008
=======entity level========
Epoch:  10%|█         | 5/50 [05:22<47:50, 63.80s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.53s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.68s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.63s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.81s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.74s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.78s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.77s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.04s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.797542
GEO: 0.867105
=======entity level========

Epoch: 6, P: 0.927382, R: 0.890405, F: 0.908517, OOV: 0.797542, GEO: 0.867105
=======entity level========
Epoch:  12%|█▏        | 6/50 [06:24<46:28, 63.38s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.71s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.67s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.58s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.80s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.78s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.70s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.96s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.799159
GEO: 0.865183
=======entity level========

Epoch: 7, P: 0.926311, R: 0.892537, F: 0.909111, OOV: 0.799159, GEO: 0.865183
=======entity level========
Epoch:  14%|█▍        | 7/50 [07:26<45:08, 62.98s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.83s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.06s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.72s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.66s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.70s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.61s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.97s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.804657
GEO: 0.858447
=======entity level========

Epoch: 8, P: 0.923085, R: 0.895629, F: 0.909150, OOV: 0.804657, GEO: 0.858447
=======entity level========
Epoch:  16%|█▌        | 8/50 [08:29<43:55, 62.75s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.64s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.52s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.68s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.62s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.74s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.96s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.89s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.13s/it][A100%|██████████| 8/8 [00:52<00:00,  6.51s/it]
OOV: 0.805627
GEO: 0.848446
=======entity level========

Epoch: 9, P: 0.926571, R: 0.895949, F: 0.911003, OOV: 0.805627, GEO: 0.848446
=======entity level========
Epoch:  18%|█▊        | 9/50 [09:31<42:54, 62.78s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.47s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.53s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.83s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.73s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.69s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.83s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.90s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.12s/it][A100%|██████████| 8/8 [00:52<00:00,  6.50s/it]
OOV: 0.796895
GEO: 0.871626
=======entity level========

Epoch: 10, P: 0.929358, R: 0.890618, F: 0.909576, OOV: 0.796895, GEO: 0.871626
=======entity level========
Epoch:  20%|██        | 10/50 [10:37<42:22, 63.56s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.60s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.78s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.82s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.65s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.57s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.61s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.71s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.04s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.808862
GEO: 0.881156
=======entity level========

Epoch: 11, P: 0.928540, R: 0.896269, F: 0.912119, OOV: 0.808862, GEO: 0.881156
=======entity level========
Epoch:  22%|██▏       | 11/50 [11:41<41:33, 63.94s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.83s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.73s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.78s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.90s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.84s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.93s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.86s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.12s/it][A100%|██████████| 8/8 [00:52<00:00,  6.56s/it]
OOV: 0.804657
GEO: 0.874181
=======entity level========

Epoch: 12, P: 0.930099, R: 0.895096, F: 0.912262, OOV: 0.804657, GEO: 0.874181
=======entity level========
Epoch:  24%|██▍       | 12/50 [12:45<40:24, 63.81s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:51,  7.35s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.00s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.71s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.64s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.68s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.67s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.18s/it][A100%|██████████| 8/8 [00:52<00:00,  6.53s/it]
OOV: 0.805951
GEO: 0.874918
=======entity level========

Epoch: 13, P: 0.927562, R: 0.895522, F: 0.911261, OOV: 0.805951, GEO: 0.874918
=======entity level========
Epoch:  26%|██▌       | 13/50 [13:48<39:11, 63.55s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.61s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.99s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.79s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.75s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.69s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.47s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.71s/it][A100%|██████████| 8/8 [00:50<00:00,  6.31s/it]
OOV: 0.803040
GEO: 0.880843
=======entity level========

Epoch: 14, P: 0.929793, R: 0.892324, F: 0.910673, OOV: 0.803040, GEO: 0.880843
=======entity level========
Epoch:  28%|██▊       | 14/50 [14:49<37:43, 62.87s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.09s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.87s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.96s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.72s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.69s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.66s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.54s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.05s/it][A100%|██████████| 8/8 [00:51<00:00,  6.47s/it]
OOV: 0.805627
GEO: 0.870989
=======entity level========

Epoch: 15, P: 0.928800, R: 0.895629, F: 0.911913, OOV: 0.805627, GEO: 0.870989
=======entity level========
Epoch:  30%|███       | 15/50 [15:52<36:37, 62.78s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.87s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.16s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.91s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.81s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.77s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.62s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.96s/it][A100%|██████████| 8/8 [00:51<00:00,  6.48s/it]
OOV: 0.807568
GEO: 0.870249
=======entity level========

Epoch: 16, P: 0.926708, R: 0.897761, F: 0.912005, OOV: 0.807568, GEO: 0.870249
=======entity level========
Epoch:  32%|███▏      | 16/50 [16:55<35:33, 62.76s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.21s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.94s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.84s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.79s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.73s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.73s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.04s/it][A100%|██████████| 8/8 [00:51<00:00,  6.50s/it]
OOV: 0.803040
GEO: 0.873443
=======entity level========

Epoch: 17, P: 0.928524, R: 0.891898, F: 0.909842, OOV: 0.803040, GEO: 0.873443
=======entity level========
Epoch:  34%|███▍      | 17/50 [17:57<34:31, 62.77s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.15s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.57s/it][A
 38%|███▊      | 3/8 [00:18<00:30,  6.16s/it][A
 50%|█████     | 4/8 [00:25<00:25,  6.44s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.41s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.61s/it][A
 88%|████████▊ | 7/8 [00:45<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:50<00:00,  6.00s/it][A100%|██████████| 8/8 [00:50<00:00,  6.32s/it]
OOV: 0.805304
GEO: 0.870820
=======entity level========

Epoch: 18, P: 0.930580, R: 0.896055, F: 0.912992, OOV: 0.805304, GEO: 0.870820
=======entity level========
Epoch:  36%|███▌      | 18/50 [18:59<33:16, 62.38s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.51s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.76s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.83s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.89s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.75s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.72s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.97s/it][A100%|██████████| 8/8 [00:51<00:00,  6.45s/it]
OOV: 0.807891
GEO: 0.869850
=======entity level========

Epoch: 19, P: 0.927467, R: 0.895629, F: 0.911270, OOV: 0.807891, GEO: 0.869850
=======entity level========
Epoch:  38%|███▊      | 19/50 [20:01<32:13, 62.38s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.69s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.70s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.84s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.96s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.99s/it][A
 75%|███████▌  | 6/8 [00:41<00:14,  7.02s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.96s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.13s/it][A100%|██████████| 8/8 [00:52<00:00,  6.61s/it]
OOV: 0.806598
GEO: 0.865183
=======entity level========

Epoch: 20, P: 0.930740, R: 0.895416, F: 0.912736, OOV: 0.806598, GEO: 0.865183
=======entity level========
Epoch:  40%|████      | 20/50 [21:05<31:24, 62.83s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.62s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.69s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.71s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.83s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.89s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.89s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.98s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.22s/it][A100%|██████████| 8/8 [00:52<00:00,  6.59s/it]
OOV: 0.802717
GEO: 0.868197
=======entity level========

Epoch: 21, P: 0.927434, R: 0.893817, F: 0.910315, OOV: 0.802717, GEO: 0.868197
=======entity level========

Early stop triggered at epoch 20

Epoch:  40%|████      | 20/50 [22:09<33:13, 66.46s/it]

=======best f entity level========

Epoch: 11, P: 0.928540, R: 0.896269, F: 0.912119, OOV: 0.808862, GEO: 0.881156, GEO_N: 0.850386


=======best f entity level========
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
./models/self_bert_wm_av_3_score_0.7_0.88_2024-12-24-16-05-51/model.pt
  0%|          | 0/62 [00:00<?, ?it/s]/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|▏         | 1/62 [00:04<05:04,  4.98s/it]  3%|▎         | 2/62 [00:06<03:03,  3.06s/it]  5%|▍         | 3/62 [00:08<02:20,  2.37s/it]  6%|▋         | 4/62 [00:10<02:04,  2.14s/it]  8%|▊         | 5/62 [00:11<01:57,  2.06s/it] 10%|▉         | 6/62 [00:13<01:53,  2.02s/it] 11%|█▏        | 7/62 [00:15<01:37,  1.77s/it] 13%|█▎        | 8/62 [00:16<01:28,  1.64s/it] 15%|█▍        | 9/62 [00:18<01:30,  1.71s/it] 16%|█▌        | 10/62 [00:19<01:26,  1.67s/it] 18%|█▊        | 11/62 [00:22<01:33,  1.84s/it] 19%|█▉        | 12/62 [00:23<01:25,  1.71s/it] 21%|██        | 13/62 [00:25<01:30,  1.84s/it] 23%|██▎       | 14/62 [00:27<01:29,  1.86s/it] 24%|██▍       | 15/62 [00:29<01:24,  1.79s/it] 26%|██▌       | 16/62 [00:30<01:13,  1.60s/it] 27%|██▋       | 17/62 [00:31<01:08,  1.51s/it] 29%|██▉       | 18/62 [00:33<01:11,  1.62s/it] 31%|███       | 19/62 [00:35<01:19,  1.84s/it] 32%|███▏      | 20/62 [00:38<01:23,  1.99s/it] 34%|███▍      | 21/62 [00:41<01:30,  2.21s/it] 35%|███▌      | 22/62 [00:42<01:21,  2.04s/it] 37%|███▋      | 23/62 [00:43<01:09,  1.79s/it] 39%|███▊      | 24/62 [00:45<01:09,  1.83s/it] 40%|████      | 25/62 [00:48<01:21,  2.21s/it] 42%|████▏     | 26/62 [00:50<01:17,  2.14s/it] 44%|████▎     | 27/62 [00:52<01:09,  2.00s/it] 45%|████▌     | 28/62 [00:54<01:05,  1.93s/it] 47%|████▋     | 29/62 [00:56<01:03,  1.92s/it] 48%|████▊     | 30/62 [00:57<00:57,  1.81s/it] 50%|█████     | 31/62 [00:59<00:54,  1.77s/it] 52%|█████▏    | 32/62 [01:00<00:48,  1.60s/it] 53%|█████▎    | 33/62 [01:02<00:49,  1.72s/it] 55%|█████▍    | 34/62 [01:04<00:50,  1.80s/it] 56%|█████▋    | 35/62 [01:06<00:46,  1.73s/it] 58%|█████▊    | 36/62 [01:07<00:41,  1.60s/it] 60%|█████▉    | 37/62 [01:08<00:35,  1.43s/it] 61%|██████▏   | 38/62 [01:10<00:35,  1.47s/it] 63%|██████▎   | 39/62 [01:12<00:36,  1.61s/it] 65%|██████▍   | 40/62 [01:13<00:34,  1.58s/it] 66%|██████▌   | 41/62 [01:15<00:32,  1.56s/it] 68%|██████▊   | 42/62 [01:16<00:30,  1.54s/it] 69%|██████▉   | 43/62 [01:18<00:30,  1.63s/it] 71%|███████   | 44/62 [01:19<00:28,  1.58s/it] 73%|███████▎  | 45/62 [01:22<00:31,  1.84s/it] 74%|███████▍  | 46/62 [01:23<00:26,  1.67s/it] 76%|███████▌  | 47/62 [01:25<00:23,  1.60s/it] 77%|███████▋  | 48/62 [01:26<00:22,  1.57s/it] 79%|███████▉  | 49/62 [01:28<00:23,  1.79s/it] 81%|████████  | 50/62 [01:30<00:20,  1.70s/it] 82%|████████▏ | 51/62 [01:32<00:18,  1.71s/it] 84%|████████▍ | 52/62 [01:33<00:17,  1.74s/it] 85%|████████▌ | 53/62 [01:36<00:18,  2.01s/it] 87%|████████▋ | 54/62 [01:37<00:14,  1.86s/it] 89%|████████▊ | 55/62 [01:39<00:12,  1.75s/it] 90%|█████████ | 56/62 [01:40<00:09,  1.64s/it] 92%|█████████▏| 57/62 [01:42<00:07,  1.58s/it] 94%|█████████▎| 58/62 [01:43<00:06,  1.54s/it] 95%|█████████▌| 59/62 [01:45<00:04,  1.54s/it] 97%|█████████▋| 60/62 [01:46<00:02,  1.47s/it] 98%|█████████▊| 61/62 [01:48<00:01,  1.65s/it]100%|██████████| 62/62 [01:50<00:00,  1.61s/it]100%|██████████| 62/62 [01:50<00:00,  1.78s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/home/testcross/projects/models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0.7_0.89', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

 12%|█▎        | 1/8 [00:09<01:07,  9.66s/it][A
 25%|██▌       | 2/8 [00:16<00:48,  8.04s/it][A
 38%|███▊      | 3/8 [00:23<00:37,  7.51s/it][A
 50%|█████     | 4/8 [00:30<00:28,  7.20s/it][A
 62%|██████▎   | 5/8 [00:36<00:21,  7.04s/it][A
 75%|███████▌  | 6/8 [00:43<00:14,  7.05s/it][A
 88%|████████▊ | 7/8 [00:50<00:07,  7.02s/it][A
100%|██████████| 8/8 [00:55<00:00,  6.26s/it][A100%|██████████| 8/8 [00:55<00:00,  6.95s/it]
OOV: 0.667529
GEO: 0.556904
=======entity level========

Epoch: 1, P: 0.826399, R: 0.785608, F: 0.805487, OOV: 0.667529, GEO: 0.556904
=======entity level========
Epoch:   2%|▏         | 1/50 [01:08<55:40, 68.17s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.75s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.61s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.57s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.67s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.70s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.75s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.92s/it][A100%|██████████| 8/8 [00:51<00:00,  6.38s/it]
OOV: 0.777490
GEO: 0.853578
=======entity level========

Epoch: 2, P: 0.917207, R: 0.875160, F: 0.895690, OOV: 0.777490, GEO: 0.853578
=======entity level========
Epoch:   4%|▍         | 2/50 [02:12<52:43, 65.91s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.70s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.97s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.69s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.74s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.72s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.59s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.00s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.799483
GEO: 0.856769
=======entity level========

Epoch: 3, P: 0.925647, R: 0.891898, F: 0.908459, OOV: 0.799483, GEO: 0.856769
=======entity level========
Epoch:   6%|▌         | 3/50 [03:17<51:08, 65.28s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.66s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.66s/it][A
 38%|███▊      | 3/8 [00:20<00:35,  7.06s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.86s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.90s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.83s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.81s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.08s/it][A100%|██████████| 8/8 [00:52<00:00,  6.55s/it]
OOV: 0.787840
GEO: 0.866930
=======entity level========

Epoch: 4, P: 0.929314, R: 0.885821, F: 0.907047, OOV: 0.787840, GEO: 0.866930
=======entity level========
Epoch:   8%|▊         | 4/50 [04:22<50:12, 65.48s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.85s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.65s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.59s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.65s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.69s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.77s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.72s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.07s/it][A100%|██████████| 8/8 [00:51<00:00,  6.45s/it]
OOV: 0.801746
GEO: 0.859935
=======entity level========

Epoch: 5, P: 0.925447, R: 0.893284, F: 0.909081, OOV: 0.801746, GEO: 0.859935
=======entity level========
Epoch:  10%|█         | 5/50 [05:25<48:18, 64.40s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.61s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.69s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.64s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.82s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.78s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.78s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.78s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.04s/it][A100%|██████████| 8/8 [00:51<00:00,  6.47s/it]
OOV: 0.795925
GEO: 0.865220
=======entity level========

Epoch: 6, P: 0.928810, R: 0.890192, F: 0.909091, OOV: 0.795925, GEO: 0.865220
=======entity level========
Epoch:  12%|█▏        | 6/50 [06:27<46:47, 63.81s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.70s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.66s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.57s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.79s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.94s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.807245
GEO: 0.865535
=======entity level========

Epoch: 7, P: 0.927090, R: 0.896055, F: 0.911309, OOV: 0.807245, GEO: 0.865535
=======entity level========
Epoch:  14%|█▍        | 7/50 [07:29<45:18, 63.22s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.78s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.04s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.70s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.65s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.70s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.73s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.62s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.97s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.807891
GEO: 0.873276
=======entity level========

Epoch: 8, P: 0.928548, R: 0.894989, F: 0.911460, OOV: 0.807891, GEO: 0.873276
=======entity level========
Epoch:  16%|█▌        | 8/50 [08:34<44:34, 63.68s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.68s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.52s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.67s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.63s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.75s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.96s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.87s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.10s/it][A100%|██████████| 8/8 [00:51<00:00,  6.49s/it]
OOV: 0.804981
GEO: 0.852884
=======entity level========

Epoch: 9, P: 0.926609, R: 0.895096, F: 0.910580, OOV: 0.804981, GEO: 0.852884
=======entity level========
Epoch:  18%|█▊        | 9/50 [09:37<43:19, 63.41s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.46s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.53s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.80s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.72s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.75s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.86s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.92s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.17s/it][A100%|██████████| 8/8 [00:52<00:00,  6.53s/it]
OOV: 0.808215
GEO: 0.857143
=======entity level========

Epoch: 10, P: 0.926003, R: 0.897868, F: 0.911719, OOV: 0.808215, GEO: 0.857143
=======entity level========
Epoch:  20%|██        | 10/50 [10:40<42:14, 63.36s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.78s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.97s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.99s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.85s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.76s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.79s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.86s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.14s/it][A100%|██████████| 8/8 [00:52<00:00,  6.57s/it]
OOV: 0.804657
GEO: 0.877792
=======entity level========

Epoch: 11, P: 0.929102, R: 0.894136, F: 0.911284, OOV: 0.804657, GEO: 0.877792
=======entity level========
Epoch:  22%|██▏       | 11/50 [11:46<41:40, 64.12s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.79s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.66s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.62s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.72s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.74s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.67s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.93s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.804010
GEO: 0.876802
=======entity level========

Epoch: 12, P: 0.927155, R: 0.896908, F: 0.911781, OOV: 0.804010, GEO: 0.876802
=======entity level========
Epoch:  24%|██▍       | 12/50 [12:48<40:11, 63.47s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.16s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.82s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.53s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.55s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.60s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.62s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.63s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.15s/it][A100%|██████████| 8/8 [00:51<00:00,  6.45s/it]
OOV: 0.800776
GEO: 0.879526
=======entity level========

Epoch: 13, P: 0.929850, R: 0.891684, F: 0.910367, OOV: 0.800776, GEO: 0.879526
=======entity level========
Epoch:  26%|██▌       | 13/50 [13:53<39:24, 63.90s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.62s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.02s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.82s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.76s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.78s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.79s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.77s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.17s/it][A100%|██████████| 8/8 [00:52<00:00,  6.55s/it]
OOV: 0.801746
GEO: 0.872536
=======entity level========

Epoch: 14, P: 0.929237, R: 0.893177, F: 0.910850, OOV: 0.801746, GEO: 0.872536
=======entity level========
Epoch:  28%|██▊       | 14/50 [14:56<38:13, 63.71s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.16s/it][A
 25%|██▌       | 2/8 [00:14<00:41,  6.99s/it][A
 38%|███▊      | 3/8 [00:21<00:35,  7.05s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.75s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.69s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.66s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.53s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.48s/it]
OOV: 0.807245
GEO: 0.859375
=======entity level========

Epoch: 15, P: 0.928942, R: 0.897548, F: 0.912975, OOV: 0.807245, GEO: 0.859375
=======entity level========
Epoch:  30%|███       | 15/50 [15:59<36:59, 63.41s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.83s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.09s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.87s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.79s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.74s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.66s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.53s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.91s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.807891
GEO: 0.860117
=======entity level========

Epoch: 16, P: 0.925840, R: 0.898401, F: 0.911914, OOV: 0.807891, GEO: 0.860117
=======entity level========
Epoch:  32%|███▏      | 16/50 [17:01<35:44, 63.09s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.23s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.95s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.78s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.77s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.73s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.00s/it][A100%|██████████| 8/8 [00:51<00:00,  6.47s/it]
OOV: 0.805627
GEO: 0.859008
=======entity level========

Epoch: 17, P: 0.925571, R: 0.894883, F: 0.909968, OOV: 0.805627, GEO: 0.859008
=======entity level========
Epoch:  34%|███▍      | 17/50 [18:04<34:36, 62.93s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.07s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.59s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.61s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.70s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.56s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.72s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.805304
GEO: 0.870989
=======entity level========

Epoch: 18, P: 0.929109, R: 0.895629, F: 0.912062, OOV: 0.805304, GEO: 0.870989
=======entity level========
Epoch:  36%|███▌      | 18/50 [19:06<33:27, 62.74s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.50s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.75s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.82s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.85s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.72s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.76s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.07s/it][A100%|██████████| 8/8 [00:51<00:00,  6.48s/it]
OOV: 0.804657
GEO: 0.868938
=======entity level========

Epoch: 19, P: 0.930091, R: 0.894989, F: 0.912203, OOV: 0.804657, GEO: 0.868938
=======entity level========
Epoch:  38%|███▊      | 19/50 [20:09<32:24, 62.73s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.80s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.82s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.89s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.92s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.89s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.89s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.84s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.00s/it][A100%|██████████| 8/8 [00:52<00:00,  6.53s/it]
OOV: 0.808862
GEO: 0.856400
=======entity level========

Epoch: 20, P: 0.928084, R: 0.898401, F: 0.913001, OOV: 0.808862, GEO: 0.856400
=======entity level========
Epoch:  40%|████      | 20/50 [21:12<31:24, 62.82s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.46s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.52s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.57s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.66s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.71s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.80s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.08s/it][A100%|██████████| 8/8 [00:51<00:00,  6.44s/it]
OOV: 0.810479
GEO: 0.849741
=======entity level========

Epoch: 21, P: 0.926141, R: 0.899680, F: 0.912719, OOV: 0.810479, GEO: 0.849741
=======entity level========
Epoch:  42%|████▏     | 21/50 [22:14<30:17, 62.67s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.73s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.64s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.64s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.76s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.74s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.65s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.804981
GEO: 0.871560
=======entity level========

Epoch: 22, P: 0.929663, R: 0.894776, F: 0.911886, OOV: 0.804981, GEO: 0.871560
=======entity level========
Epoch:  44%|████▍     | 22/50 [23:16<29:11, 62.56s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.47s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.48s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.56s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.72s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.57s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.64s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.64s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.38s/it]
OOV: 0.813389
GEO: 0.867752
=======entity level========

Epoch: 23, P: 0.929098, R: 0.901066, F: 0.914867, OOV: 0.813389, GEO: 0.867752
=======entity level========

Early stop triggered at epoch 22

Epoch:  44%|████▍     | 22/50 [24:18<30:56, 66.31s/it]

=======best f entity level========

Epoch: 13, P: 0.929850, R: 0.891684, F: 0.910367, OOV: 0.800776, GEO: 0.879526, GEO_N: 0.852148


=======best f entity level========
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
./models/self_bert_wm_av_3_score_0.7_0.89_2024-12-24-16-30-28/model.pt
  0%|          | 0/62 [00:00<?, ?it/s]/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|▏         | 1/62 [00:04<04:52,  4.80s/it]  3%|▎         | 2/62 [00:06<02:55,  2.93s/it]  5%|▍         | 3/62 [00:07<02:13,  2.26s/it]  6%|▋         | 4/62 [00:09<01:58,  2.03s/it]  8%|▊         | 5/62 [00:11<01:51,  1.96s/it] 10%|▉         | 6/62 [00:13<01:47,  1.92s/it] 11%|█▏        | 7/62 [00:14<01:32,  1.68s/it] 13%|█▎        | 8/62 [00:15<01:24,  1.56s/it] 15%|█▍        | 9/62 [00:17<01:26,  1.62s/it] 16%|█▌        | 10/62 [00:19<01:22,  1.59s/it] 18%|█▊        | 11/62 [00:21<01:29,  1.75s/it] 19%|█▉        | 12/62 [00:22<01:21,  1.63s/it] 21%|██        | 13/62 [00:24<01:25,  1.75s/it] 23%|██▎       | 14/62 [00:26<01:24,  1.77s/it] 24%|██▍       | 15/62 [00:27<01:20,  1.71s/it] 26%|██▌       | 16/62 [00:28<01:10,  1.52s/it] 27%|██▋       | 17/62 [00:30<01:04,  1.44s/it] 29%|██▉       | 18/62 [00:31<01:07,  1.54s/it] 31%|███       | 19/62 [00:34<01:15,  1.75s/it] 32%|███▏      | 20/62 [00:36<01:19,  1.89s/it] 34%|███▍      | 21/62 [00:39<01:28,  2.15s/it] 35%|███▌      | 22/62 [00:40<01:19,  1.99s/it] 37%|███▋      | 23/62 [00:42<01:08,  1.76s/it] 39%|███▊      | 24/62 [00:43<01:08,  1.81s/it] 40%|████      | 25/62 [00:47<01:20,  2.19s/it] 42%|████▏     | 26/62 [00:49<01:16,  2.13s/it] 44%|████▎     | 27/62 [00:50<01:09,  1.99s/it] 45%|████▌     | 28/62 [00:52<01:05,  1.92s/it] 47%|████▋     | 29/62 [00:54<01:03,  1.92s/it] 48%|████▊     | 30/62 [00:55<00:57,  1.80s/it] 50%|█████     | 31/62 [00:57<00:54,  1.77s/it] 52%|█████▏    | 32/62 [00:58<00:48,  1.60s/it] 53%|█████▎    | 33/62 [01:00<00:49,  1.71s/it] 55%|█████▍    | 34/62 [01:02<00:50,  1.79s/it] 56%|█████▋    | 35/62 [01:04<00:46,  1.73s/it] 58%|█████▊    | 36/62 [01:05<00:41,  1.61s/it] 60%|█████▉    | 37/62 [01:06<00:35,  1.44s/it] 61%|██████▏   | 38/62 [01:08<00:35,  1.47s/it] 63%|██████▎   | 39/62 [01:10<00:36,  1.61s/it] 65%|██████▍   | 40/62 [01:11<00:34,  1.59s/it] 66%|██████▌   | 41/62 [01:13<00:32,  1.56s/it] 68%|██████▊   | 42/62 [01:14<00:30,  1.55s/it] 69%|██████▉   | 43/62 [01:16<00:31,  1.63s/it] 71%|███████   | 44/62 [01:18<00:28,  1.59s/it] 73%|███████▎  | 45/62 [01:20<00:31,  1.85s/it] 74%|███████▍  | 46/62 [01:21<00:26,  1.68s/it] 76%|███████▌  | 47/62 [01:23<00:24,  1.61s/it] 77%|███████▋  | 48/62 [01:24<00:22,  1.59s/it] 79%|███████▉  | 49/62 [01:27<00:23,  1.81s/it] 81%|████████  | 50/62 [01:28<00:20,  1.71s/it] 82%|████████▏ | 51/62 [01:30<00:19,  1.73s/it] 84%|████████▍ | 52/62 [01:32<00:17,  1.75s/it] 85%|████████▌ | 53/62 [01:34<00:18,  2.02s/it] 87%|████████▋ | 54/62 [01:36<00:14,  1.87s/it] 89%|████████▊ | 55/62 [01:37<00:12,  1.76s/it] 90%|█████████ | 56/62 [01:39<00:09,  1.65s/it] 92%|█████████▏| 57/62 [01:40<00:07,  1.59s/it] 94%|█████████▎| 58/62 [01:42<00:06,  1.55s/it] 95%|█████████▌| 59/62 [01:43<00:04,  1.55s/it] 97%|█████████▋| 60/62 [01:44<00:02,  1.48s/it] 98%|█████████▊| 61/62 [01:47<00:01,  1.66s/it]100%|██████████| 62/62 [01:48<00:00,  1.61s/it]100%|██████████| 62/62 [01:48<00:00,  1.75s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/home/testcross/projects/models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0.7_0.810', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

 12%|█▎        | 1/8 [00:09<01:08,  9.83s/it][A
 25%|██▌       | 2/8 [00:16<00:48,  8.10s/it][A
 38%|███▊      | 3/8 [00:23<00:37,  7.46s/it][A
 50%|█████     | 4/8 [00:29<00:28,  7.10s/it][A
 62%|██████▎   | 5/8 [00:36<00:20,  6.91s/it][A
 75%|███████▌  | 6/8 [00:43<00:13,  6.91s/it][A
 88%|████████▊ | 7/8 [00:50<00:06,  6.86s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.12s/it][A100%|██████████| 8/8 [00:54<00:00,  6.84s/it]
OOV: 0.665912
GEO: 0.560834
=======entity level========

Epoch: 1, P: 0.827090, R: 0.783795, F: 0.804861, OOV: 0.665912, GEO: 0.560834
=======entity level========
Epoch:   2%|▏         | 1/50 [01:07<54:50, 67.16s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.57s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.54s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.53s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.67s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.86s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.81s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.07s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.773933
GEO: 0.859591
=======entity level========

Epoch: 2, P: 0.916723, R: 0.873134, F: 0.894398, OOV: 0.773933, GEO: 0.859591
=======entity level========
Epoch:   4%|▍         | 2/50 [02:12<52:47, 65.99s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.95s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.09s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.76s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.79s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.80s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.82s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.67s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.07s/it][A100%|██████████| 8/8 [00:52<00:00,  6.52s/it]
OOV: 0.800776
GEO: 0.862565
=======entity level========

Epoch: 3, P: 0.926459, R: 0.891791, F: 0.908795, OOV: 0.800776, GEO: 0.862565
=======entity level========
Epoch:   6%|▌         | 3/50 [03:17<51:32, 65.80s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.80s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.81s/it][A
 38%|███▊      | 3/8 [00:21<00:35,  7.08s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.79s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.78s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.68s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.64s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.93s/it][A100%|██████████| 8/8 [00:51<00:00,  6.45s/it]
OOV: 0.790103
GEO: 0.859580
=======entity level========

Epoch: 4, P: 0.928006, R: 0.887740, F: 0.907427, OOV: 0.790103, GEO: 0.859580
=======entity level========
Epoch:   8%|▊         | 4/50 [04:20<49:24, 64.45s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.65s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.56s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.53s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.59s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.64s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.68s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.05s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.802717
GEO: 0.857888
=======entity level========

Epoch: 5, P: 0.926511, R: 0.893817, F: 0.909870, OOV: 0.802717, GEO: 0.857888
=======entity level========
Epoch:  10%|█         | 5/50 [05:22<47:43, 63.63s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.70s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.81s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.76s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.88s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.80s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.80s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.79s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.05s/it][A100%|██████████| 8/8 [00:52<00:00,  6.51s/it]
OOV: 0.798512
GEO: 0.871053
=======entity level========

Epoch: 6, P: 0.930566, R: 0.891578, F: 0.910655, OOV: 0.798512, GEO: 0.871053
=======entity level========
Epoch:  12%|█▏        | 6/50 [06:27<47:05, 64.21s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.66s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.67s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.57s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.79s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.95s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.804010
GEO: 0.872703
=======entity level========

Epoch: 7, P: 0.927963, R: 0.894030, F: 0.910680, OOV: 0.804010, GEO: 0.872703
=======entity level========
Epoch:  14%|█▍        | 7/50 [07:32<46:04, 64.30s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.80s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.04s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.69s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.64s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.69s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.61s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.97s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.805304
GEO: 0.864440
=======entity level========

Epoch: 8, P: 0.926584, R: 0.894776, F: 0.910402, OOV: 0.805304, GEO: 0.864440
=======entity level========
Epoch:  16%|█▌        | 8/50 [08:34<44:32, 63.63s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.66s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.52s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.70s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.62s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.74s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.95s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.88s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.11s/it][A100%|██████████| 8/8 [00:52<00:00,  6.50s/it]
OOV: 0.802717
GEO: 0.857329
=======entity level========

Epoch: 9, P: 0.926172, R: 0.893390, F: 0.909486, OOV: 0.802717, GEO: 0.857329
=======entity level========
Epoch:  18%|█▊        | 9/50 [09:37<43:18, 63.39s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.46s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.51s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.78s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.70s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.73s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.76s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.01s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.805951
GEO: 0.854534
=======entity level========

Epoch: 10, P: 0.926289, R: 0.896269, F: 0.911032, OOV: 0.805951, GEO: 0.854534
=======entity level========
Epoch:  20%|██        | 10/50 [10:39<42:01, 63.04s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.54s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.74s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.77s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.62s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.55s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.58s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.67s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.00s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.799159
GEO: 0.873927
=======entity level========

Epoch: 11, P: 0.927723, R: 0.890832, F: 0.908903, OOV: 0.799159, GEO: 0.873927
=======entity level========
Epoch:  22%|██▏       | 11/50 [11:43<41:14, 63.44s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.82s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.67s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.61s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.70s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.63s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.74s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.92s/it][A100%|██████████| 8/8 [00:51<00:00,  6.38s/it]
OOV: 0.796895
GEO: 0.867105
=======entity level========

Epoch: 12, P: 0.929462, R: 0.890618, F: 0.909625, OOV: 0.796895, GEO: 0.867105
=======entity level========
Epoch:  24%|██▍       | 12/50 [12:45<39:51, 62.94s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.16s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.79s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.50s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.51s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.56s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.59s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.61s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.14s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.797219
GEO: 0.875826
=======entity level========

Epoch: 13, P: 0.927881, R: 0.890192, F: 0.908646, OOV: 0.797219, GEO: 0.875826
=======entity level========
Epoch:  26%|██▌       | 13/50 [13:50<39:08, 63.48s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.65s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.00s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.81s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.75s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.66s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.64s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.04s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.804010
GEO: 0.881423
=======entity level========

Epoch: 14, P: 0.930870, R: 0.894350, F: 0.912244, OOV: 0.804010, GEO: 0.881423
=======entity level========
Epoch:  28%|██▊       | 14/50 [14:55<38:20, 63.89s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.03s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.83s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.92s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.71s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.69s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.54s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.04s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.803687
GEO: 0.876730
=======entity level========

Epoch: 15, P: 0.929117, R: 0.894350, F: 0.911402, OOV: 0.803687, GEO: 0.876730
=======entity level========
Epoch:  30%|███       | 15/50 [15:57<37:01, 63.47s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.88s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.11s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.89s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.80s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.73s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.62s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.96s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.808862
GEO: 0.860495
=======entity level========

Epoch: 16, P: 0.928634, R: 0.898934, F: 0.913543, OOV: 0.808862, GEO: 0.860495
=======entity level========
Epoch:  32%|███▏      | 16/50 [17:00<35:48, 63.19s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.14s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.88s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.72s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.70s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.67s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.62s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.98s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.799483
GEO: 0.878468
=======entity level========

Epoch: 17, P: 0.928254, R: 0.889659, F: 0.908547, OOV: 0.799483, GEO: 0.878468
=======entity level========
Epoch:  34%|███▍      | 17/50 [18:02<34:36, 62.91s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.08s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.67s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.70s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.84s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.72s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.84s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.81s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.10s/it][A100%|██████████| 8/8 [00:52<00:00,  6.52s/it]
OOV: 0.808215
GEO: 0.869110
=======entity level========

Epoch: 18, P: 0.929582, R: 0.896482, F: 0.912732, OOV: 0.808215, GEO: 0.869110
=======entity level========
Epoch:  36%|███▌      | 18/50 [19:05<33:33, 62.93s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.49s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.78s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.92s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.97s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.86s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.85s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.83s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.12s/it][A100%|██████████| 8/8 [00:52<00:00,  6.56s/it]
OOV: 0.793338
GEO: 0.878888
=======entity level========

Epoch: 19, P: 0.928827, R: 0.886247, F: 0.907038, OOV: 0.793338, GEO: 0.878888
=======entity level========
Epoch:  38%|███▊      | 19/50 [20:09<32:36, 63.11s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.80s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.79s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.85s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.94s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.96s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.93s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.84s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.00s/it][A100%|██████████| 8/8 [00:52<00:00,  6.54s/it]
OOV: 0.810479
GEO: 0.864971
=======entity level========

Epoch: 20, P: 0.929171, R: 0.896482, F: 0.912534, OOV: 0.810479, GEO: 0.864971
=======entity level========
Epoch:  40%|████      | 20/50 [21:12<31:33, 63.11s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.48s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.51s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.52s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.65s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.74s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.72s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.80s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.08s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.804010
GEO: 0.854912
=======entity level========

Epoch: 21, P: 0.925653, R: 0.895949, F: 0.910559, OOV: 0.804010, GEO: 0.854912
=======entity level========
Epoch:  42%|████▏     | 21/50 [22:14<30:23, 62.86s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.70s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.62s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.64s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.76s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.74s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.64s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.02s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.805951
GEO: 0.878788
=======entity level========

Epoch: 22, P: 0.927592, R: 0.894563, F: 0.910778, OOV: 0.805951, GEO: 0.878788
=======entity level========
Epoch:  44%|████▍     | 22/50 [23:16<29:14, 62.67s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.50s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.48s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.57s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.74s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.56s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.64s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.65s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.38s/it]
OOV: 0.804981
GEO: 0.878947
=======entity level========

Epoch: 23, P: 0.928643, R: 0.893497, F: 0.910731, OOV: 0.804981, GEO: 0.878947
=======entity level========
Epoch:  46%|████▌     | 23/50 [24:18<28:05, 62.43s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.96s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.65s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.67s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.61s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.46s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.65s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.76s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.11s/it][A100%|██████████| 8/8 [00:51<00:00,  6.44s/it]
OOV: 0.803040
GEO: 0.870249
=======entity level========

Epoch: 24, P: 0.928041, R: 0.892324, F: 0.909832, OOV: 0.803040, GEO: 0.870249
=======entity level========

Early stop triggered at epoch 23

Epoch:  46%|████▌     | 23/50 [25:20<29:45, 66.13s/it]

=======best f entity level========

Epoch: 14, P: 0.930870, R: 0.894350, F: 0.912244, OOV: 0.804010, GEO: 0.881423, GEO_N: 0.856572


=======best f entity level========
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
./models/self_bert_wm_av_3_score_0.7_0.810_2024-12-24-16-57-12/model.pt
  0%|          | 0/62 [00:00<?, ?it/s]/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|▏         | 1/62 [00:04<04:53,  4.82s/it]  3%|▎         | 2/62 [00:06<02:55,  2.93s/it]  5%|▍         | 3/62 [00:07<02:13,  2.26s/it]  6%|▋         | 4/62 [00:09<01:58,  2.03s/it]  8%|▊         | 5/62 [00:11<01:51,  1.96s/it] 10%|▉         | 6/62 [00:13<01:47,  1.92s/it] 11%|█▏        | 7/62 [00:14<01:32,  1.68s/it] 13%|█▎        | 8/62 [00:15<01:24,  1.56s/it] 15%|█▍        | 9/62 [00:17<01:25,  1.62s/it] 16%|█▌        | 10/62 [00:19<01:22,  1.59s/it] 18%|█▊        | 11/62 [00:21<01:28,  1.74s/it] 19%|█▉        | 12/62 [00:22<01:21,  1.63s/it] 21%|██        | 13/62 [00:24<01:25,  1.75s/it] 23%|██▎       | 14/62 [00:26<01:24,  1.77s/it] 24%|██▍       | 15/62 [00:27<01:21,  1.73s/it] 26%|██▌       | 16/62 [00:29<01:11,  1.55s/it] 27%|██▋       | 17/62 [00:30<01:06,  1.48s/it] 29%|██▉       | 18/62 [00:32<01:09,  1.59s/it] 31%|███       | 19/62 [00:34<01:18,  1.82s/it] 32%|███▏      | 20/62 [00:36<01:22,  1.97s/it] 34%|███▍      | 21/62 [00:39<01:32,  2.25s/it] 35%|███▌      | 22/62 [00:41<01:23,  2.09s/it] 37%|███▋      | 23/62 [00:42<01:11,  1.83s/it] 39%|███▊      | 24/62 [00:44<01:10,  1.85s/it] 40%|████      | 25/62 [00:47<01:22,  2.22s/it] 42%|████▏     | 26/62 [00:49<01:17,  2.15s/it] 44%|████▎     | 27/62 [00:51<01:10,  2.00s/it] 45%|████▌     | 28/62 [00:53<01:05,  1.94s/it] 47%|████▋     | 29/62 [00:55<01:03,  1.92s/it] 48%|████▊     | 30/62 [00:56<00:57,  1.80s/it] 50%|█████     | 31/62 [00:58<00:54,  1.77s/it] 52%|█████▏    | 32/62 [00:59<00:48,  1.61s/it] 53%|█████▎    | 33/62 [01:01<00:49,  1.72s/it] 55%|█████▍    | 34/62 [01:03<00:50,  1.80s/it] 56%|█████▋    | 35/62 [01:05<00:46,  1.73s/it] 58%|█████▊    | 36/62 [01:06<00:41,  1.61s/it] 60%|█████▉    | 37/62 [01:07<00:35,  1.43s/it] 61%|██████▏   | 38/62 [01:08<00:35,  1.47s/it] 63%|██████▎   | 39/62 [01:10<00:36,  1.61s/it] 65%|██████▍   | 40/62 [01:12<00:34,  1.58s/it] 66%|██████▌   | 41/62 [01:13<00:32,  1.56s/it] 68%|██████▊   | 42/62 [01:15<00:30,  1.55s/it] 69%|██████▉   | 43/62 [01:17<00:30,  1.63s/it] 71%|███████   | 44/62 [01:18<00:28,  1.58s/it] 73%|███████▎  | 45/62 [01:21<00:31,  1.85s/it] 74%|███████▍  | 46/62 [01:22<00:26,  1.67s/it] 76%|███████▌  | 47/62 [01:23<00:24,  1.60s/it] 77%|███████▋  | 48/62 [01:25<00:22,  1.58s/it] 79%|███████▉  | 49/62 [01:27<00:23,  1.79s/it] 81%|████████  | 50/62 [01:29<00:20,  1.70s/it] 82%|████████▏ | 51/62 [01:30<00:18,  1.71s/it] 84%|████████▍ | 52/62 [01:32<00:17,  1.74s/it] 85%|████████▌ | 53/62 [01:35<00:18,  2.01s/it] 87%|████████▋ | 54/62 [01:36<00:14,  1.86s/it] 89%|████████▊ | 55/62 [01:38<00:12,  1.75s/it] 90%|█████████ | 56/62 [01:39<00:09,  1.64s/it] 92%|█████████▏| 57/62 [01:41<00:07,  1.58s/it] 94%|█████████▎| 58/62 [01:42<00:06,  1.54s/it] 95%|█████████▌| 59/62 [01:44<00:04,  1.54s/it] 97%|█████████▋| 60/62 [01:45<00:02,  1.47s/it] 98%|█████████▊| 61/62 [01:47<00:01,  1.65s/it]100%|██████████| 62/62 [01:49<00:00,  1.61s/it]100%|██████████| 62/62 [01:49<00:00,  1.76s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/home/testcross/projects/models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0.7_0.811', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

 12%|█▎        | 1/8 [00:09<01:07,  9.62s/it][A
 25%|██▌       | 2/8 [00:16<00:47,  7.95s/it][A
 38%|███▊      | 3/8 [00:22<00:36,  7.33s/it][A
 50%|█████     | 4/8 [00:29<00:27,  6.97s/it][A
 62%|██████▎   | 5/8 [00:35<00:20,  6.79s/it][A
 75%|███████▌  | 6/8 [00:42<00:13,  6.85s/it][A
 88%|████████▊ | 7/8 [00:49<00:06,  6.87s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.14s/it][A100%|██████████| 8/8 [00:54<00:00,  6.79s/it]
OOV: 0.665912
GEO: 0.559351
=======entity level========

Epoch: 1, P: 0.826791, R: 0.783689, F: 0.804663, OOV: 0.665912, GEO: 0.559351
=======entity level========
Epoch:   2%|▏         | 1/50 [01:06<54:32, 66.79s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.53s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.47s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.45s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.57s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.63s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.59s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.86s/it][A100%|██████████| 8/8 [00:50<00:00,  6.29s/it]
OOV: 0.776197
GEO: 0.854701
=======entity level========

Epoch: 2, P: 0.917189, R: 0.873774, F: 0.894955, OOV: 0.776197, GEO: 0.854701
=======entity level========
Epoch:   4%|▍         | 2/50 [02:10<51:56, 64.93s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.67s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.93s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.64s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.68s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.66s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.66s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.53s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.94s/it][A100%|██████████| 8/8 [00:51<00:00,  6.38s/it]
OOV: 0.796895
GEO: 0.863130
=======entity level========

Epoch: 3, P: 0.925852, R: 0.889232, F: 0.907173, OOV: 0.796895, GEO: 0.863130
=======entity level========
Epoch:   6%|▌         | 3/50 [03:14<50:38, 64.64s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.60s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.58s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.90s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.66s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.59s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.55s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.84s/it][A100%|██████████| 8/8 [00:50<00:00,  6.33s/it]
OOV: 0.791074
GEO: 0.863905
=======entity level========

Epoch: 4, P: 0.929568, R: 0.887846, F: 0.908228, OOV: 0.791074, GEO: 0.863905
=======entity level========
Epoch:   8%|▊         | 4/50 [04:18<49:18, 64.32s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.56s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.47s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.44s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.55s/it][A
 62%|██████▎   | 5/8 [00:32<00:20,  6.67s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.68s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.62s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.98s/it][A100%|██████████| 8/8 [00:50<00:00,  6.35s/it]
OOV: 0.799806
GEO: 0.854167
=======entity level========

Epoch: 5, P: 0.925279, R: 0.892431, F: 0.908558, OOV: 0.799806, GEO: 0.854167
=======entity level========
Epoch:  10%|█         | 5/50 [05:20<47:30, 63.35s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.44s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.56s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.56s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.73s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.67s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.69s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.96s/it][A100%|██████████| 8/8 [00:51<00:00,  6.38s/it]
OOV: 0.800129
GEO: 0.871795
=======entity level========

Epoch: 6, P: 0.928865, R: 0.892324, F: 0.910228, OOV: 0.800129, GEO: 0.871795
=======entity level========
Epoch:  12%|█▏        | 6/50 [06:24<46:36, 63.57s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.62s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.58s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.49s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.72s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.70s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.65s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.63s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.89s/it][A100%|██████████| 8/8 [00:50<00:00,  6.34s/it]
OOV: 0.805951
GEO: 0.869281
=======entity level========

Epoch: 7, P: 0.927719, R: 0.894883, F: 0.911005, OOV: 0.805951, GEO: 0.869281
=======entity level========
Epoch:  14%|█▍        | 7/50 [07:25<45:04, 62.90s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.69s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.99s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.65s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.58s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.63s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.64s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.55s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.91s/it][A100%|██████████| 8/8 [00:50<00:00,  6.36s/it]
OOV: 0.804010
GEO: 0.864052
=======entity level========

Epoch: 8, P: 0.926118, R: 0.894030, F: 0.909791, OOV: 0.804010, GEO: 0.864052
=======entity level========
Epoch:  16%|█▌        | 8/50 [08:27<43:45, 62.52s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.58s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.47s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.60s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.54s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.66s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.87s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.78s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.02s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.806274
GEO: 0.851036
=======entity level========

Epoch: 9, P: 0.926036, R: 0.895629, F: 0.910579, OOV: 0.806274, GEO: 0.851036
=======entity level========
Epoch:  18%|█▊        | 9/50 [09:29<42:39, 62.42s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:44,  6.38s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.46s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.72s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.70s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.67s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.80s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.85s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.10s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.805627
GEO: 0.860313
=======entity level========

Epoch: 10, P: 0.927206, R: 0.894883, F: 0.910758, OOV: 0.805627, GEO: 0.860313
=======entity level========
Epoch:  20%|██        | 10/50 [10:32<41:39, 62.50s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.53s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.72s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.83s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.71s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.63s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.61s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.01s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.798189
GEO: 0.873110
=======entity level========

Epoch: 11, P: 0.926456, R: 0.890405, F: 0.908073, OOV: 0.798189, GEO: 0.873110
=======entity level========
Epoch:  22%|██▏       | 11/50 [11:36<40:56, 63.00s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.85s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.66s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.62s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.77s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.73s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.86s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.78s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.00s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.802393
GEO: 0.861438
=======entity level========

Epoch: 12, P: 0.926867, R: 0.894456, F: 0.910373, OOV: 0.802393, GEO: 0.861438
=======entity level========
Epoch:  24%|██▍       | 12/50 [12:38<39:48, 62.86s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.06s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.73s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.44s/it][A
 50%|█████     | 4/8 [00:26<00:25,  6.42s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.51s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.54s/it][A
 88%|████████▊ | 7/8 [00:45<00:06,  6.56s/it][A
100%|██████████| 8/8 [00:50<00:00,  6.09s/it][A100%|██████████| 8/8 [00:50<00:00,  6.37s/it]
OOV: 0.800453
GEO: 0.869337
=======entity level========

Epoch: 13, P: 0.926713, R: 0.892431, F: 0.909249, OOV: 0.800453, GEO: 0.869337
=======entity level========
Epoch:  26%|██▌       | 13/50 [13:40<38:34, 62.55s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.50s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.90s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.71s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.66s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.60s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.59s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.58s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.99s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.795602
GEO: 0.867280
=======entity level========

Epoch: 14, P: 0.930124, R: 0.889765, F: 0.909497, OOV: 0.795602, GEO: 0.867280
=======entity level========
Epoch:  28%|██▊       | 14/50 [14:42<37:25, 62.36s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.98s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.80s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.87s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.62s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.59s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.59s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.46s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.98s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.799806
GEO: 0.873684
=======entity level========

Epoch: 15, P: 0.928889, R: 0.891258, F: 0.909684, OOV: 0.799806, GEO: 0.873684
=======entity level========
Epoch:  30%|███       | 15/50 [15:47<36:43, 62.96s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.78s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.03s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.82s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.73s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.66s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.61s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.48s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.85s/it][A100%|██████████| 8/8 [00:50<00:00,  6.36s/it]
OOV: 0.804010
GEO: 0.856957
=======entity level========

Epoch: 16, P: 0.924447, R: 0.896162, F: 0.910085, OOV: 0.804010, GEO: 0.856957
=======entity level========
Epoch:  32%|███▏      | 16/50 [16:48<35:29, 62.62s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.09s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.84s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.69s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.65s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.64s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.58s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.60s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.93s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.803364
GEO: 0.859008
=======entity level========

Epoch: 17, P: 0.924416, R: 0.894456, F: 0.909189, OOV: 0.803364, GEO: 0.859008
=======entity level========
Epoch:  34%|███▍      | 17/50 [17:50<34:19, 62.40s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.03s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.63s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.64s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.78s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.79s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.80s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.11s/it][A100%|██████████| 8/8 [00:51<00:00,  6.50s/it]
OOV: 0.801746
GEO: 0.856209
=======entity level========

Epoch: 18, P: 0.926212, R: 0.893923, F: 0.909781, OOV: 0.801746, GEO: 0.856209
=======entity level========
Epoch:  36%|███▌      | 18/50 [18:53<33:22, 62.56s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.65s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.87s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.92s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.98s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.83s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.74s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.96s/it][A100%|██████████| 8/8 [00:51<00:00,  6.48s/it]
OOV: 0.803364
GEO: 0.871053
=======entity level========

Epoch: 19, P: 0.928904, R: 0.892857, F: 0.910524, OOV: 0.803364, GEO: 0.871053
=======entity level========
Epoch:  38%|███▊      | 19/50 [19:56<32:21, 62.62s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.57s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.54s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.68s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.76s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.79s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.73s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.92s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.804334
GEO: 0.856213
=======entity level========

Epoch: 20, P: 0.926061, R: 0.895949, F: 0.910756, OOV: 0.804334, GEO: 0.856213
=======entity level========
Epoch:  40%|████      | 20/50 [20:58<31:14, 62.49s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:44,  6.40s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.44s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.45s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.56s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.63s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.62s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.71s/it][A
100%|██████████| 8/8 [00:50<00:00,  6.00s/it][A100%|██████████| 8/8 [00:50<00:00,  6.35s/it]
OOV: 0.804334
GEO: 0.858257
=======entity level========

Epoch: 21, P: 0.926012, R: 0.895309, F: 0.910402, OOV: 0.804334, GEO: 0.858257
=======entity level========
Epoch:  42%|████▏     | 21/50 [22:00<30:04, 62.21s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.70s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.60s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.58s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.69s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.66s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.58s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.59s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.96s/it][A100%|██████████| 8/8 [00:50<00:00,  6.36s/it]
OOV: 0.800776
GEO: 0.868369
=======entity level========

Epoch: 22, P: 0.929214, R: 0.891471, F: 0.909952, OOV: 0.800776, GEO: 0.868369
=======entity level========
Epoch:  44%|████▍     | 22/50 [23:02<28:58, 62.08s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:44,  6.41s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.41s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.47s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.63s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.48s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.59s/it][A
 88%|████████▊ | 7/8 [00:45<00:06,  6.59s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.97s/it][A100%|██████████| 8/8 [00:50<00:00,  6.31s/it]
OOV: 0.804010
GEO: 0.863103
=======entity level========

Epoch: 23, P: 0.926261, R: 0.894563, F: 0.910136, OOV: 0.804010, GEO: 0.863103
=======entity level========
Epoch:  46%|████▌     | 23/50 [24:03<27:49, 61.83s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.04s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.79s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.81s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.74s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.58s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.73s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.76s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.13s/it][A100%|██████████| 8/8 [00:52<00:00,  6.51s/it]
OOV: 0.803687
GEO: 0.872466
=======entity level========

Epoch: 24, P: 0.929681, R: 0.893603, F: 0.911285, OOV: 0.803687, GEO: 0.872466
=======entity level========
Epoch:  48%|████▊     | 24/50 [25:06<26:56, 62.16s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.80s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.65s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.60s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.62s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.75s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.63s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.96s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.805304
GEO: 0.874510
=======entity level========

Epoch: 25, P: 0.928801, R: 0.894243, F: 0.911194, OOV: 0.805304, GEO: 0.874510
=======entity level========
Epoch:  50%|█████     | 25/50 [26:10<26:07, 62.71s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.56s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.64s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.71s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.75s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.69s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.77s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.73s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.99s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.805304
GEO: 0.869679
=======entity level========

Epoch: 26, P: 0.926921, R: 0.893817, F: 0.910068, OOV: 0.805304, GEO: 0.869679
=======entity level========
Epoch:  52%|█████▏    | 26/50 [27:12<25:00, 62.54s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.54s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.58s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.43s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.54s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.50s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.68s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.94s/it][A100%|██████████| 8/8 [00:50<00:00,  6.33s/it]
OOV: 0.800129
GEO: 0.863130
=======entity level========

Epoch: 27, P: 0.926065, R: 0.892004, F: 0.908716, OOV: 0.800129, GEO: 0.863130
=======entity level========
Epoch:  54%|█████▍    | 27/50 [28:13<23:50, 62.21s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.78s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.63s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.58s/it][A
 50%|█████     | 4/8 [00:26<00:25,  6.49s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.54s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.58s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.92s/it][A100%|██████████| 8/8 [00:50<00:00,  6.33s/it]
OOV: 0.803687
GEO: 0.854545
=======entity level========

Epoch: 28, P: 0.926081, R: 0.894883, F: 0.910215, OOV: 0.803687, GEO: 0.854545
=======entity level========
Epoch:  56%|█████▌    | 28/50 [29:15<22:43, 62.00s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.83s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.60s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.61s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.79s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.66s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.66s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.96s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.807245
GEO: 0.862720
=======entity level========

Epoch: 29, P: 0.926424, R: 0.896695, F: 0.911317, OOV: 0.807245, GEO: 0.862720
=======entity level========
Epoch:  58%|█████▊    | 29/50 [30:17<21:42, 62.02s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:51,  7.34s/it][A
 25%|██▌       | 2/8 [00:14<00:43,  7.18s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.82s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.62s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.57s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.55s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.48s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.90s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.804657
GEO: 0.865535
=======entity level========

Epoch: 30, P: 0.927120, R: 0.895096, F: 0.910827, OOV: 0.804657, GEO: 0.865535
=======entity level========
Epoch:  60%|██████    | 30/50 [31:19<20:39, 61.99s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.81s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  7.00s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.75s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.69s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.55s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.56s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.52s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.81s/it][A100%|██████████| 8/8 [00:50<00:00,  6.32s/it]
OOV: 0.806274
GEO: 0.865711
=======entity level========

Epoch: 31, P: 0.927634, R: 0.896482, F: 0.911792, OOV: 0.806274, GEO: 0.865711
=======entity level========
Epoch:  62%|██████▏   | 31/50 [32:20<19:34, 61.80s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.94s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.67s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.72s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.61s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.61s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.74s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.65s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.85s/it][A100%|██████████| 8/8 [00:50<00:00,  6.36s/it]
OOV: 0.804010
GEO: 0.866667
=======entity level========

Epoch: 32, P: 0.927821, R: 0.894883, F: 0.911054, OOV: 0.804010, GEO: 0.866667
=======entity level========
Epoch:  64%|██████▍   | 32/50 [33:22<18:31, 61.78s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.74s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.78s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.87s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.65s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.64s/it][A
 75%|███████▌  | 6/8 [00:39<00:12,  6.47s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.85s/it][A100%|██████████| 8/8 [00:50<00:00,  6.35s/it]
OOV: 0.806274
GEO: 0.869452
=======entity level========

Epoch: 33, P: 0.927223, R: 0.895096, F: 0.910876, OOV: 0.806274, GEO: 0.869452
=======entity level========
Epoch:  66%|██████▌   | 33/50 [34:23<17:29, 61.75s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.65s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.47s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.64s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.87s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.68s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.61s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.83s/it][A100%|██████████| 8/8 [00:50<00:00,  6.35s/it]
OOV: 0.805627
GEO: 0.869110
=======entity level========

Epoch: 34, P: 0.928508, R: 0.894456, F: 0.911164, OOV: 0.805627, GEO: 0.869110
=======entity level========
Epoch:  68%|██████▊   | 34/50 [35:25<16:27, 61.69s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.09s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.92s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.71s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.65s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.69s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.64s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.55s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.90s/it][A100%|██████████| 8/8 [00:51<00:00,  6.38s/it]
OOV: 0.805627
GEO: 0.867233
=======entity level========

Epoch: 35, P: 0.927648, R: 0.895309, F: 0.911192, OOV: 0.805627, GEO: 0.867233
=======entity level========

Early stop triggered at epoch 34

Epoch:  68%|██████▊   | 34/50 [36:27<17:09, 64.34s/it]

=======best f entity level========

Epoch: 25, P: 0.928801, R: 0.894243, F: 0.911194, OOV: 0.805304, GEO: 0.874510, GEO_N: 0.851953


=======best f entity level========
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
./models/self_bert_wm_av_3_score_0.7_0.811_2024-12-24-17-24-59/model.pt
  0%|          | 0/62 [00:00<?, ?it/s]/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|▏         | 1/62 [00:03<03:27,  3.40s/it]  3%|▎         | 2/62 [00:04<02:13,  2.22s/it]  5%|▍         | 3/62 [00:06<01:46,  1.80s/it]  6%|▋         | 4/62 [00:07<01:37,  1.68s/it]  8%|▊         | 5/62 [00:09<01:33,  1.64s/it] 10%|▉         | 6/62 [00:10<01:31,  1.63s/it] 11%|█▏        | 7/62 [00:11<01:19,  1.44s/it] 13%|█▎        | 8/62 [00:12<01:13,  1.36s/it] 15%|█▍        | 9/62 [00:14<01:14,  1.40s/it] 16%|█▌        | 10/62 [00:15<01:11,  1.38s/it] 18%|█▊        | 11/62 [00:17<01:17,  1.52s/it] 19%|█▉        | 12/62 [00:18<01:11,  1.42s/it] 21%|██        | 13/62 [00:20<01:14,  1.51s/it] 23%|██▎       | 14/62 [00:22<01:13,  1.52s/it] 24%|██▍       | 15/62 [00:23<01:09,  1.47s/it] 26%|██▌       | 16/62 [00:24<01:00,  1.33s/it] 27%|██▋       | 17/62 [00:25<00:56,  1.26s/it] 29%|██▉       | 18/62 [00:27<00:58,  1.34s/it] 31%|███       | 19/62 [00:29<01:04,  1.51s/it] 32%|███▏      | 20/62 [00:30<01:08,  1.63s/it] 34%|███▍      | 21/62 [00:33<01:16,  1.86s/it] 35%|███▌      | 22/62 [00:34<01:09,  1.75s/it] 37%|███▋      | 23/62 [00:35<01:00,  1.56s/it] 39%|███▊      | 24/62 [00:37<01:00,  1.60s/it] 40%|████      | 25/62 [00:40<01:11,  1.92s/it] 42%|████▏     | 26/62 [00:42<01:07,  1.86s/it] 44%|████▎     | 27/62 [00:43<01:01,  1.75s/it] 45%|████▌     | 28/62 [00:45<00:58,  1.71s/it] 47%|████▋     | 29/62 [00:46<00:56,  1.70s/it] 48%|████▊     | 30/62 [00:48<00:51,  1.61s/it] 50%|█████     | 31/62 [00:49<00:49,  1.58s/it] 52%|█████▏    | 32/62 [00:50<00:43,  1.45s/it] 53%|█████▎    | 33/62 [00:52<00:44,  1.53s/it] 55%|█████▍    | 34/62 [00:54<00:44,  1.60s/it] 56%|█████▋    | 35/62 [00:55<00:41,  1.55s/it] 58%|█████▊    | 36/62 [00:56<00:37,  1.44s/it] 60%|█████▉    | 37/62 [00:57<00:32,  1.30s/it] 61%|██████▏   | 38/62 [00:59<00:31,  1.32s/it] 63%|██████▎   | 39/62 [01:01<00:33,  1.44s/it] 65%|██████▍   | 40/62 [01:02<00:31,  1.43s/it] 66%|██████▌   | 41/62 [01:03<00:29,  1.40s/it] 68%|██████▊   | 42/62 [01:05<00:27,  1.39s/it] 69%|██████▉   | 43/62 [01:06<00:27,  1.46s/it] 71%|███████   | 44/62 [01:08<00:25,  1.41s/it] 73%|███████▎  | 45/62 [01:10<00:27,  1.64s/it] 74%|███████▍  | 46/62 [01:11<00:23,  1.49s/it] 76%|███████▌  | 47/62 [01:12<00:21,  1.43s/it] 77%|███████▋  | 48/62 [01:14<00:19,  1.42s/it] 79%|███████▉  | 49/62 [01:16<00:21,  1.65s/it] 81%|████████  | 50/62 [01:17<00:19,  1.62s/it] 82%|████████▏ | 51/62 [01:19<00:18,  1.69s/it] 84%|████████▍ | 52/62 [01:21<00:17,  1.75s/it] 85%|████████▌ | 53/62 [01:24<00:18,  2.06s/it] 87%|████████▋ | 54/62 [01:25<00:15,  1.90s/it] 89%|████████▊ | 55/62 [01:27<00:12,  1.78s/it] 90%|█████████ | 56/62 [01:28<00:09,  1.65s/it] 92%|█████████▏| 57/62 [01:30<00:07,  1.59s/it] 94%|█████████▎| 58/62 [01:31<00:06,  1.54s/it] 95%|█████████▌| 59/62 [01:33<00:04,  1.54s/it] 97%|█████████▋| 60/62 [01:34<00:02,  1.47s/it] 98%|█████████▊| 61/62 [01:36<00:01,  1.65s/it]100%|██████████| 62/62 [01:37<00:00,  1.61s/it]100%|██████████| 62/62 [01:37<00:00,  1.58s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/home/testcross/projects/models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0.7_0.812', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

 12%|█▎        | 1/8 [00:09<01:07,  9.59s/it][A
 25%|██▌       | 2/8 [00:16<00:48,  8.02s/it][A
 38%|███▊      | 3/8 [00:23<00:37,  7.42s/it][A
 50%|█████     | 4/8 [00:29<00:28,  7.07s/it][A
 62%|██████▎   | 5/8 [00:36<00:20,  6.91s/it][A
 75%|███████▌  | 6/8 [00:43<00:13,  6.95s/it][A
 88%|████████▊ | 7/8 [00:50<00:06,  6.93s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.16s/it][A100%|██████████| 8/8 [00:54<00:00,  6.85s/it]
OOV: 0.666559
GEO: 0.551843
=======entity level========

Epoch: 1, P: 0.826043, R: 0.785181, F: 0.805094, OOV: 0.666559, GEO: 0.551843
=======entity level========
Epoch:   2%|▏         | 1/50 [01:07<54:54, 67.23s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.59s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.54s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.53s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.66s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.72s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.77s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.94s/it][A100%|██████████| 8/8 [00:51<00:00,  6.38s/it]
OOV: 0.779431
GEO: 0.853578
=======entity level========

Epoch: 2, P: 0.918101, R: 0.876013, F: 0.896563, OOV: 0.779431, GEO: 0.853578
=======entity level========
Epoch:   4%|▍         | 2/50 [02:11<52:24, 65.51s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.76s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.04s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.80s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.82s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.78s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.76s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.63s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.02s/it][A100%|██████████| 8/8 [00:51<00:00,  6.49s/it]
OOV: 0.800776
GEO: 0.846004
=======entity level========

Epoch: 3, P: 0.924428, R: 0.892004, F: 0.907927, OOV: 0.800776, GEO: 0.846004
=======entity level========
Epoch:   6%|▌         | 3/50 [03:14<50:17, 64.21s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.64s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.64s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.97s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.75s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.69s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.65s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.93s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.787516
GEO: 0.859776
=======entity level========

Epoch: 4, P: 0.928260, R: 0.885608, F: 0.906432, OOV: 0.787516, GEO: 0.859776
=======entity level========
Epoch:   8%|▊         | 4/50 [04:18<49:20, 64.37s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.72s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.58s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.58s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.62s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.67s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.67s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.02s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.800129
GEO: 0.851008
=======entity level========

Epoch: 5, P: 0.925762, R: 0.893390, F: 0.909288, OOV: 0.800129, GEO: 0.851008
=======entity level========
Epoch:  10%|█         | 5/50 [05:20<47:38, 63.52s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.52s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.65s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.61s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.83s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.76s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.78s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.80s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.10s/it][A100%|██████████| 8/8 [00:51<00:00,  6.49s/it]
OOV: 0.792367
GEO: 0.868421
=======entity level========

Epoch: 6, P: 0.927093, R: 0.887953, F: 0.907101, OOV: 0.792367, GEO: 0.868421
=======entity level========
Epoch:  12%|█▏        | 6/50 [06:26<47:01, 64.13s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.68s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.65s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.57s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.82s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.78s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.95s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.806598
GEO: 0.876802
=======entity level========

Epoch: 7, P: 0.928595, R: 0.895629, F: 0.911814, OOV: 0.806598, GEO: 0.876802
=======entity level========
Epoch:  14%|█▍        | 7/50 [07:30<46:04, 64.29s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.76s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.02s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.70s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.64s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.71s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.77s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.71s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.08s/it][A100%|██████████| 8/8 [00:51<00:00,  6.48s/it]
OOV: 0.804657
GEO: 0.869850
=======entity level========

Epoch: 8, P: 0.925946, R: 0.894456, F: 0.909929, OOV: 0.804657, GEO: 0.869850
=======entity level========
Epoch:  16%|█▌        | 8/50 [08:33<44:38, 63.78s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.67s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.63s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.81s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.79s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.87s/it][A
 75%|███████▌  | 6/8 [00:41<00:14,  7.04s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.98s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.22s/it][A100%|██████████| 8/8 [00:52<00:00,  6.61s/it]
OOV: 0.804010
GEO: 0.848446
=======entity level========

Epoch: 9, P: 0.925196, R: 0.895309, F: 0.910007, OOV: 0.804010, GEO: 0.848446
=======entity level========
Epoch:  18%|█▊        | 9/50 [09:37<43:34, 63.78s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.67s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.77s/it][A
 38%|███▊      | 3/8 [00:20<00:35,  7.01s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.91s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.83s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.83s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.08s/it][A100%|██████████| 8/8 [00:52<00:00,  6.54s/it]
OOV: 0.803364
GEO: 0.861619
=======entity level========

Epoch: 10, P: 0.925334, R: 0.894456, F: 0.909633, OOV: 0.803364, GEO: 0.861619
=======entity level========
Epoch:  20%|██        | 10/50 [10:40<42:24, 63.61s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.56s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.75s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.79s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.63s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.55s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.59s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.806598
GEO: 0.873443
=======entity level========

Epoch: 11, P: 0.928034, R: 0.894989, F: 0.911212, OOV: 0.806598, GEO: 0.873443
=======entity level========
Epoch:  22%|██▏       | 11/50 [11:42<41:03, 63.16s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.84s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.72s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.66s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.74s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.76s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.67s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.93s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.804657
GEO: 0.873443
=======entity level========

Epoch: 12, P: 0.928398, R: 0.894350, F: 0.911056, OOV: 0.804657, GEO: 0.873443
=======entity level========
Epoch:  24%|██▍       | 12/50 [12:44<39:46, 62.80s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.16s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.81s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.52s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.53s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.58s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.61s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.62s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.14s/it][A100%|██████████| 8/8 [00:51<00:00,  6.44s/it]
OOV: 0.809508
GEO: 0.868146
=======entity level========

Epoch: 13, P: 0.927555, R: 0.896802, F: 0.911919, OOV: 0.809508, GEO: 0.868146
=======entity level========
Epoch:  26%|██▌       | 13/50 [13:46<38:38, 62.66s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.58s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.97s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.78s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.82s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.79s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.79s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.77s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.18s/it][A100%|██████████| 8/8 [00:52<00:00,  6.55s/it]
OOV: 0.802070
GEO: 0.872536
=======entity level========

Epoch: 14, P: 0.929016, R: 0.891578, F: 0.909912, OOV: 0.802070, GEO: 0.872536
=======entity level========
Epoch:  28%|██▊       | 14/50 [14:50<37:43, 62.88s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.09s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.87s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.94s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.72s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.66s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.53s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.04s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.806274
GEO: 0.861057
=======entity level========

Epoch: 15, P: 0.927624, R: 0.894989, F: 0.911015, OOV: 0.806274, GEO: 0.861057
=======entity level========
Epoch:  30%|███       | 15/50 [15:52<36:37, 62.77s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.82s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.09s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.87s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.81s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.73s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.66s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.53s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.89s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.808215
GEO: 0.863666
=======entity level========

Epoch: 16, P: 0.927728, R: 0.896375, F: 0.911782, OOV: 0.808215, GEO: 0.863666
=======entity level========
Epoch:  32%|███▏      | 16/50 [16:54<35:28, 62.59s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.14s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.89s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.74s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.73s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.70s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.68s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.75s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.05s/it][A100%|██████████| 8/8 [00:51<00:00,  6.48s/it]
OOV: 0.800776
GEO: 0.871963
=======entity level========

Epoch: 17, P: 0.924810, R: 0.892964, F: 0.908608, OOV: 0.800776, GEO: 0.871963
=======entity level========

Early stop triggered at epoch 16

Epoch:  32%|███▏      | 16/50 [17:57<38:09, 67.35s/it]

=======best f entity level========

Epoch: 7, P: 0.928595, R: 0.895629, F: 0.911814, OOV: 0.806598, GEO: 0.876802, GEO_N: 0.852802


=======best f entity level========
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
./models/self_bert_wm_av_3_score_0.7_0.812_2024-12-24-18-03-37/model.pt
  0%|          | 0/62 [00:00<?, ?it/s]/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|▏         | 1/62 [00:04<04:57,  4.87s/it]  3%|▎         | 2/62 [00:06<02:57,  2.97s/it]  5%|▍         | 3/62 [00:07<02:14,  2.28s/it]  6%|▋         | 4/62 [00:09<01:59,  2.05s/it]  8%|▊         | 5/62 [00:11<01:52,  1.97s/it] 10%|▉         | 6/62 [00:13<01:48,  1.93s/it] 11%|█▏        | 7/62 [00:14<01:33,  1.69s/it] 13%|█▎        | 8/62 [00:15<01:24,  1.57s/it] 15%|█▍        | 9/62 [00:17<01:26,  1.64s/it] 16%|█▌        | 10/62 [00:19<01:23,  1.60s/it] 18%|█▊        | 11/62 [00:21<01:29,  1.75s/it] 19%|█▉        | 12/62 [00:22<01:21,  1.63s/it] 21%|██        | 13/62 [00:24<01:25,  1.75s/it] 23%|██▎       | 14/62 [00:26<01:25,  1.77s/it] 24%|██▍       | 15/62 [00:28<01:20,  1.71s/it] 26%|██▌       | 16/62 [00:29<01:10,  1.52s/it] 27%|██▋       | 17/62 [00:30<01:04,  1.44s/it] 29%|██▉       | 18/62 [00:32<01:07,  1.54s/it] 31%|███       | 19/62 [00:34<01:15,  1.75s/it] 32%|███▏      | 20/62 [00:36<01:19,  1.89s/it] 34%|███▍      | 21/62 [00:39<01:27,  2.14s/it] 35%|███▌      | 22/62 [00:40<01:19,  1.99s/it] 37%|███▋      | 23/62 [00:42<01:08,  1.75s/it] 39%|███▊      | 24/62 [00:44<01:08,  1.80s/it] 40%|████      | 25/62 [00:47<01:20,  2.18s/it] 42%|████▏     | 26/62 [00:49<01:16,  2.13s/it] 44%|████▎     | 27/62 [00:50<01:09,  1.99s/it] 45%|████▌     | 28/62 [00:52<01:05,  1.93s/it] 47%|████▋     | 29/62 [00:54<01:03,  1.91s/it] 48%|████▊     | 30/62 [00:56<00:57,  1.80s/it] 50%|█████     | 31/62 [00:57<00:54,  1.77s/it] 52%|█████▏    | 32/62 [00:58<00:48,  1.60s/it] 53%|█████▎    | 33/62 [01:00<00:49,  1.72s/it] 55%|█████▍    | 34/62 [01:02<00:50,  1.80s/it] 56%|█████▋    | 35/62 [01:04<00:46,  1.73s/it] 58%|█████▊    | 36/62 [01:05<00:41,  1.60s/it] 60%|█████▉    | 37/62 [01:06<00:35,  1.43s/it] 61%|██████▏   | 38/62 [01:08<00:35,  1.46s/it] 63%|██████▎   | 39/62 [01:10<00:36,  1.60s/it] 65%|██████▍   | 40/62 [01:11<00:34,  1.58s/it] 66%|██████▌   | 41/62 [01:13<00:32,  1.56s/it] 68%|██████▊   | 42/62 [01:14<00:30,  1.54s/it] 69%|██████▉   | 43/62 [01:16<00:30,  1.63s/it] 71%|███████   | 44/62 [01:18<00:28,  1.58s/it] 73%|███████▎  | 45/62 [01:20<00:31,  1.84s/it] 74%|███████▍  | 46/62 [01:21<00:26,  1.67s/it] 76%|███████▌  | 47/62 [01:23<00:24,  1.60s/it] 77%|███████▋  | 48/62 [01:24<00:22,  1.58s/it] 79%|███████▉  | 49/62 [01:27<00:23,  1.79s/it] 81%|████████  | 50/62 [01:28<00:20,  1.70s/it] 82%|████████▏ | 51/62 [01:30<00:18,  1.71s/it] 84%|████████▍ | 52/62 [01:32<00:17,  1.74s/it] 85%|████████▌ | 53/62 [01:34<00:18,  2.01s/it] 87%|████████▋ | 54/62 [01:36<00:14,  1.86s/it] 89%|████████▊ | 55/62 [01:37<00:12,  1.75s/it] 90%|█████████ | 56/62 [01:39<00:09,  1.64s/it] 92%|█████████▏| 57/62 [01:40<00:07,  1.58s/it] 94%|█████████▎| 58/62 [01:41<00:06,  1.54s/it] 95%|█████████▌| 59/62 [01:43<00:04,  1.54s/it] 97%|█████████▋| 60/62 [01:44<00:02,  1.47s/it] 98%|█████████▊| 61/62 [01:46<00:01,  1.65s/it]100%|██████████| 62/62 [01:48<00:00,  1.61s/it]100%|██████████| 62/62 [01:48<00:00,  1.75s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/home/testcross/projects/models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0.7_0.813', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

 12%|█▎        | 1/8 [00:09<01:06,  9.54s/it][A
 25%|██▌       | 2/8 [00:16<00:47,  7.97s/it][A
 38%|███▊      | 3/8 [00:23<00:36,  7.36s/it][A
 50%|█████     | 4/8 [00:29<00:28,  7.02s/it][A
 62%|██████▎   | 5/8 [00:36<00:20,  6.85s/it][A
 75%|███████▌  | 6/8 [00:42<00:13,  6.85s/it][A
 88%|████████▊ | 7/8 [00:49<00:06,  6.82s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.07s/it][A100%|██████████| 8/8 [00:54<00:00,  6.77s/it]
OOV: 0.666559
GEO: 0.550691
=======entity level========

Epoch: 1, P: 0.825707, R: 0.784861, F: 0.804766, OOV: 0.666559, GEO: 0.550691
=======entity level========
Epoch:   2%|▏         | 1/50 [01:06<54:21, 66.57s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.56s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.52s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.51s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.65s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.71s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.75s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.67s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.93s/it][A100%|██████████| 8/8 [00:50<00:00,  6.36s/it]
OOV: 0.779107
GEO: 0.847969
=======entity level========

Epoch: 2, P: 0.917579, R: 0.875906, F: 0.896258, OOV: 0.779107, GEO: 0.847969
=======entity level========
Epoch:   4%|▍         | 2/50 [02:10<52:11, 65.24s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.95s/it][A
 25%|██▌       | 2/8 [00:14<00:43,  7.19s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.86s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.92s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.90s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.95s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.86s/it][A
100%|██████████| 8/8 [00:53<00:00,  6.28s/it][A100%|██████████| 8/8 [00:53<00:00,  6.68s/it]
OOV: 0.799806
GEO: 0.863130
=======entity level========

Epoch: 3, P: 0.924355, R: 0.889765, F: 0.906730, OOV: 0.799806, GEO: 0.863130
=======entity level========
Epoch:   6%|▌         | 3/50 [03:17<51:45, 66.08s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.82s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.74s/it][A
 38%|███▊      | 3/8 [00:20<00:35,  7.03s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.80s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.80s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.93s/it][A100%|██████████| 8/8 [00:51<00:00,  6.45s/it]
OOV: 0.788810
GEO: 0.857518
=======entity level========

Epoch: 4, P: 0.927107, R: 0.886780, F: 0.906495, OOV: 0.788810, GEO: 0.857518
=======entity level========
Epoch:   8%|▊         | 4/50 [04:20<49:35, 64.68s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.93s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.78s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.73s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.75s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.78s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.77s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.70s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.05s/it][A100%|██████████| 8/8 [00:51<00:00,  6.48s/it]
OOV: 0.801100
GEO: 0.850455
=======entity level========

Epoch: 5, P: 0.926069, R: 0.893390, F: 0.909436, OOV: 0.801100, GEO: 0.850455
=======entity level========
Epoch:  10%|█         | 5/50 [05:23<47:58, 63.96s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.50s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.63s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.60s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.79s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.76s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.78s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.77s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.45s/it]
OOV: 0.797219
GEO: 0.866142
=======entity level========

Epoch: 6, P: 0.927176, R: 0.890405, F: 0.908419, OOV: 0.797219, GEO: 0.866142
=======entity level========
Epoch:  12%|█▏        | 6/50 [06:28<47:08, 64.29s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.69s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.64s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.57s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.79s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.95s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.809508
GEO: 0.861799
=======entity level========

Epoch: 7, P: 0.927219, R: 0.897761, F: 0.912252, OOV: 0.809508, GEO: 0.861799
=======entity level========
Epoch:  14%|█▍        | 7/50 [07:30<45:33, 63.58s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.74s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.00s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.69s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.63s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.71s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.61s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.96s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.809832
GEO: 0.869850
=======entity level========

Epoch: 8, P: 0.928729, R: 0.897441, F: 0.912817, OOV: 0.809832, GEO: 0.869850
=======entity level========
Epoch:  16%|█▌        | 8/50 [08:34<44:34, 63.69s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.75s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.72s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.83s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.71s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.81s/it][A
 75%|███████▌  | 6/8 [00:41<00:14,  7.01s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.90s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.13s/it][A100%|██████████| 8/8 [00:52<00:00,  6.56s/it]
OOV: 0.803040
GEO: 0.870820
=======entity level========

Epoch: 9, P: 0.929546, R: 0.893177, F: 0.910999, OOV: 0.803040, GEO: 0.870820
=======entity level========
Epoch:  18%|█▊        | 9/50 [09:40<43:59, 64.38s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.48s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.54s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.80s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.71s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.64s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.74s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.76s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.02s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.803687
GEO: 0.866101
=======entity level========

Epoch: 10, P: 0.928785, R: 0.895416, F: 0.911795, OOV: 0.803687, GEO: 0.866101
=======entity level========
Epoch:  20%|██        | 10/50 [10:42<42:29, 63.74s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.57s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.76s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.81s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.65s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.56s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.58s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.01s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.803687
GEO: 0.873037
=======entity level========

Epoch: 11, P: 0.928034, R: 0.894989, F: 0.911212, OOV: 0.803687, GEO: 0.873037
=======entity level========
Epoch:  22%|██▏       | 11/50 [11:46<41:34, 63.96s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.81s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.68s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.64s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.76s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.67s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.76s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.67s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.93s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.804657
GEO: 0.868713
=======entity level========

Epoch: 12, P: 0.929227, R: 0.895842, F: 0.912229, OOV: 0.804657, GEO: 0.868713
=======entity level========
Epoch:  24%|██▍       | 12/50 [12:48<40:08, 63.39s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.21s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.84s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.54s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.54s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.59s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.62s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.64s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.16s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.795925
GEO: 0.881266
=======entity level========

Epoch: 13, P: 0.927984, R: 0.890192, F: 0.908695, OOV: 0.795925, GEO: 0.881266
=======entity level========
Epoch:  26%|██▌       | 13/50 [13:53<39:24, 63.90s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.56s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.97s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.81s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.76s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.69s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.12s/it][A100%|██████████| 8/8 [00:51<00:00,  6.49s/it]
OOV: 0.808538
GEO: 0.866667
=======entity level========

Epoch: 14, P: 0.927233, R: 0.896588, F: 0.911653, OOV: 0.808538, GEO: 0.866667
=======entity level========
Epoch:  28%|██▊       | 14/50 [14:56<38:08, 63.58s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.24s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.01s/it][A
 38%|███▊      | 3/8 [00:21<00:35,  7.04s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.78s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.75s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.57s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.07s/it][A100%|██████████| 8/8 [00:52<00:00,  6.52s/it]
OOV: 0.800776
GEO: 0.876640
=======entity level========

Epoch: 15, P: 0.929977, R: 0.892004, F: 0.910595, OOV: 0.800776, GEO: 0.876640
=======entity level========
Epoch:  30%|███       | 15/50 [15:59<36:58, 63.38s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.93s/it][A
 25%|██▌       | 2/8 [00:14<00:43,  7.19s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.92s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.81s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.75s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.66s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.53s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.89s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.803040
GEO: 0.867974
=======entity level========

Epoch: 16, P: 0.927829, R: 0.894989, F: 0.911114, OOV: 0.803040, GEO: 0.867974
=======entity level========
Epoch:  32%|███▏      | 16/50 [17:02<35:43, 63.05s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.12s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.88s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.72s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.71s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.71s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.66s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.01s/it][A100%|██████████| 8/8 [00:51<00:00,  6.45s/it]
OOV: 0.805304
GEO: 0.874181
=======entity level========

Epoch: 17, P: 0.927704, R: 0.896055, F: 0.911605, OOV: 0.805304, GEO: 0.874181
=======entity level========
Epoch:  34%|███▍      | 17/50 [18:04<34:35, 62.89s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.09s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.58s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.57s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.68s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.55s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.69s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.70s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.02s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.801100
GEO: 0.871158
=======entity level========

Epoch: 18, P: 0.927158, R: 0.894243, F: 0.910403, OOV: 0.801100, GEO: 0.871158
=======entity level========
Epoch:  36%|███▌      | 18/50 [19:06<33:24, 62.64s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.44s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.71s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.79s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.85s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.73s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.69s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.95s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.794955
GEO: 0.873276
=======entity level========

Epoch: 19, P: 0.924610, R: 0.890405, F: 0.907185, OOV: 0.794955, GEO: 0.873276
=======entity level========
Epoch:  38%|███▊      | 19/50 [20:08<32:17, 62.50s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.64s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.61s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.72s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.80s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.81s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.86s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.80s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.97s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.803040
GEO: 0.864971
=======entity level========

Epoch: 20, P: 0.928382, R: 0.894136, F: 0.910937, OOV: 0.803040, GEO: 0.864971
=======entity level========
Epoch:  40%|████      | 20/50 [21:11<31:13, 62.46s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:44,  6.40s/it][A
 25%|██▌       | 2/8 [00:12<00:39,  6.51s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.51s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.63s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.70s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.74s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.88s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.15s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.801746
GEO: 0.875903
=======entity level========

Epoch: 21, P: 0.927669, R: 0.892857, F: 0.909930, OOV: 0.801746, GEO: 0.875903
=======entity level========
Epoch:  42%|████▏     | 21/50 [22:13<30:12, 62.49s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.71s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.67s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.66s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.76s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.75s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.65s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.801746
GEO: 0.872870
=======entity level========

Epoch: 22, P: 0.928840, R: 0.894776, F: 0.911490, OOV: 0.801746, GEO: 0.872870
=======entity level========
Epoch:  44%|████▍     | 22/50 [23:16<29:08, 62.44s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.48s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.47s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.56s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.74s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.57s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.64s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.70s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.11s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.798512
GEO: 0.885073
=======entity level========

Epoch: 23, P: 0.927771, R: 0.891471, F: 0.909259, OOV: 0.798512, GEO: 0.885073
=======entity level========
Epoch:  46%|████▌     | 23/50 [24:20<28:24, 63.13s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.04s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.70s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.71s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.64s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.50s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.68s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.73s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.09s/it][A100%|██████████| 8/8 [00:51<00:00,  6.45s/it]
OOV: 0.800776
GEO: 0.880263
=======entity level========

Epoch: 24, P: 0.927922, R: 0.892111, F: 0.909664, OOV: 0.800776, GEO: 0.880263
=======entity level========
Epoch:  48%|████▊     | 24/50 [25:23<27:15, 62.92s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.70s/it][A
 25%|██▌       | 2/8 [00:13<00:38,  6.50s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.55s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.62s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.72s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.80s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.01s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.802393
GEO: 0.873443
=======entity level========

Epoch: 25, P: 0.928255, R: 0.893817, F: 0.910710, OOV: 0.802393, GEO: 0.873443
=======entity level========
Epoch:  50%|█████     | 25/50 [26:25<26:07, 62.68s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.65s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.73s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.74s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.71s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.72s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.44s/it]
OOV: 0.806274
GEO: 0.871560
=======entity level========

Epoch: 26, P: 0.926571, R: 0.895949, F: 0.911003, OOV: 0.806274, GEO: 0.871560
=======entity level========
Epoch:  52%|█████▏    | 26/50 [27:27<25:04, 62.68s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.76s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.84s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.69s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.85s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.80s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.97s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.94s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.18s/it][A100%|██████████| 8/8 [00:52<00:00,  6.59s/it]
OOV: 0.806921
GEO: 0.877953
=======entity level========

Epoch: 27, P: 0.927211, R: 0.897655, F: 0.912193, OOV: 0.806921, GEO: 0.877953
=======entity level========
Epoch:  54%|█████▍    | 27/50 [28:31<24:09, 63.00s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.03s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.78s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.67s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.58s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.63s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.68s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.78s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.02s/it][A100%|██████████| 8/8 [00:51<00:00,  6.44s/it]
OOV: 0.805627
GEO: 0.859935
=======entity level========

Epoch: 28, P: 0.927351, R: 0.896802, F: 0.911820, OOV: 0.805627, GEO: 0.859935
=======entity level========
Epoch:  56%|█████▌    | 28/50 [29:34<23:01, 62.79s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.85s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.69s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.68s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.84s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.64s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.65s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.70s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.00s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.808862
GEO: 0.878847
=======entity level========

Epoch: 29, P: 0.927463, R: 0.898294, F: 0.912646, OOV: 0.808862, GEO: 0.878847
=======entity level========
Epoch:  58%|█████▊    | 29/50 [30:36<21:55, 62.65s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:51,  7.39s/it][A
 25%|██▌       | 2/8 [00:14<00:43,  7.25s/it][A
 38%|███▊      | 3/8 [00:21<00:34,  6.94s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.72s/it][A
 62%|██████▎   | 5/8 [00:34<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.62s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.54s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.96s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.809508
GEO: 0.873608
=======entity level========

Epoch: 30, P: 0.927023, R: 0.897868, F: 0.912212, OOV: 0.809508, GEO: 0.873608
=======entity level========
Epoch:  60%|██████    | 30/50 [31:38<20:52, 62.63s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.90s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.09s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.81s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.76s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.63s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.64s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.59s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.86s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.805627
GEO: 0.876893
=======entity level========

Epoch: 31, P: 0.928366, R: 0.895309, F: 0.911538, OOV: 0.805627, GEO: 0.876893
=======entity level========
Epoch:  62%|██████▏   | 31/50 [32:40<19:46, 62.42s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.09s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.79s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.80s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.60s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.69s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.85s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.73s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.92s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.807245
GEO: 0.869850
=======entity level========

Epoch: 32, P: 0.928311, R: 0.897335, F: 0.912560, OOV: 0.807245, GEO: 0.869850
=======entity level========
Epoch:  64%|██████▍   | 32/50 [33:43<18:42, 62.37s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.74s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.82s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.84s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.60s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.63s/it][A
 75%|███████▌  | 6/8 [00:39<00:12,  6.49s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.71s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.89s/it][A100%|██████████| 8/8 [00:50<00:00,  6.36s/it]
OOV: 0.805627
GEO: 0.878369
=======entity level========

Epoch: 33, P: 0.929045, R: 0.896162, F: 0.912307, OOV: 0.805627, GEO: 0.878369
=======entity level========

Early stop triggered at epoch 32

Epoch:  64%|██████▍   | 32/50 [34:44<19:32, 65.15s/it]

=======best f entity level========

Epoch: 23, P: 0.927771, R: 0.891471, F: 0.909259, OOV: 0.798512, GEO: 0.885073, GEO_N: 0.852713


=======best f entity level========
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
./models/self_bert_wm_av_3_score_0.7_0.813_2024-12-24-18-24-00/model.pt
  0%|          | 0/62 [00:00<?, ?it/s]/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|▏         | 1/62 [00:04<05:04,  4.99s/it]  3%|▎         | 2/62 [00:06<03:03,  3.06s/it]  5%|▍         | 3/62 [00:08<02:19,  2.37s/it]  6%|▋         | 4/62 [00:10<02:04,  2.14s/it]  8%|▊         | 5/62 [00:11<01:57,  2.06s/it] 10%|▉         | 6/62 [00:13<01:53,  2.03s/it] 11%|█▏        | 7/62 [00:15<01:37,  1.77s/it] 13%|█▎        | 8/62 [00:16<01:28,  1.64s/it] 15%|█▍        | 9/62 [00:18<01:30,  1.71s/it] 16%|█▌        | 10/62 [00:19<01:26,  1.67s/it] 18%|█▊        | 11/62 [00:22<01:33,  1.84s/it] 19%|█▉        | 12/62 [00:23<01:25,  1.72s/it] 21%|██        | 13/62 [00:25<01:30,  1.84s/it] 23%|██▎       | 14/62 [00:27<01:29,  1.86s/it] 24%|██▍       | 15/62 [00:29<01:24,  1.79s/it] 26%|██▌       | 16/62 [00:30<01:13,  1.59s/it] 27%|██▋       | 17/62 [00:31<01:07,  1.51s/it] 29%|██▉       | 18/62 [00:33<01:10,  1.61s/it] 31%|███       | 19/62 [00:35<01:18,  1.84s/it] 32%|███▏      | 20/62 [00:38<01:23,  1.99s/it] 34%|███▍      | 21/62 [00:41<01:32,  2.25s/it] 35%|███▌      | 22/62 [00:42<01:23,  2.09s/it] 37%|███▋      | 23/62 [00:44<01:12,  1.85s/it] 39%|███▊      | 24/62 [00:46<01:12,  1.90s/it] 40%|████      | 25/62 [00:49<01:25,  2.30s/it] 42%|████▏     | 26/62 [00:51<01:20,  2.24s/it] 44%|████▎     | 27/62 [00:53<01:13,  2.09s/it] 45%|████▌     | 28/62 [00:55<01:08,  2.03s/it] 47%|████▋     | 29/62 [00:57<01:06,  2.01s/it] 48%|████▊     | 30/62 [00:58<01:00,  1.89s/it] 50%|█████     | 31/62 [01:00<00:57,  1.86s/it] 52%|█████▏    | 32/62 [01:01<00:50,  1.69s/it] 53%|█████▎    | 33/62 [01:03<00:52,  1.80s/it] 55%|█████▍    | 34/62 [01:05<00:52,  1.89s/it] 56%|█████▋    | 35/62 [01:07<00:49,  1.82s/it] 58%|█████▊    | 36/62 [01:08<00:43,  1.69s/it] 60%|█████▉    | 37/62 [01:10<00:37,  1.50s/it] 61%|██████▏   | 38/62 [01:11<00:36,  1.54s/it] 63%|██████▎   | 39/62 [01:13<00:38,  1.69s/it] 65%|██████▍   | 40/62 [01:15<00:36,  1.67s/it] 66%|██████▌   | 41/62 [01:16<00:34,  1.64s/it] 68%|██████▊   | 42/62 [01:18<00:32,  1.63s/it] 69%|██████▉   | 43/62 [01:20<00:32,  1.72s/it] 71%|███████   | 44/62 [01:21<00:29,  1.67s/it] 73%|███████▎  | 45/62 [01:24<00:33,  1.94s/it] 74%|███████▍  | 46/62 [01:25<00:28,  1.76s/it] 76%|███████▌  | 47/62 [01:27<00:25,  1.68s/it] 77%|███████▋  | 48/62 [01:29<00:23,  1.66s/it] 79%|███████▉  | 49/62 [01:31<00:24,  1.85s/it] 81%|████████  | 50/62 [01:32<00:20,  1.74s/it] 82%|████████▏ | 51/62 [01:34<00:19,  1.75s/it] 84%|████████▍ | 52/62 [01:36<00:17,  1.77s/it] 85%|████████▌ | 53/62 [01:39<00:18,  2.03s/it] 87%|████████▋ | 54/62 [01:40<00:15,  1.88s/it] 89%|████████▊ | 55/62 [01:42<00:12,  1.77s/it] 90%|█████████ | 56/62 [01:43<00:09,  1.65s/it] 92%|█████████▏| 57/62 [01:44<00:07,  1.59s/it] 94%|█████████▎| 58/62 [01:46<00:06,  1.55s/it] 95%|█████████▌| 59/62 [01:47<00:04,  1.55s/it] 97%|█████████▋| 60/62 [01:49<00:02,  1.47s/it] 98%|█████████▊| 61/62 [01:51<00:01,  1.65s/it]100%|██████████| 62/62 [01:52<00:00,  1.61s/it]100%|██████████| 62/62 [01:52<00:00,  1.82s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/home/testcross/projects/models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0.7_0.814', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

 12%|█▎        | 1/8 [00:09<01:09,  9.90s/it][A
 25%|██▌       | 2/8 [00:17<00:49,  8.26s/it][A
 38%|███▊      | 3/8 [00:23<00:38,  7.62s/it][A
 50%|█████     | 4/8 [00:30<00:29,  7.27s/it][A
 62%|██████▎   | 5/8 [00:37<00:21,  7.10s/it][A
 75%|███████▌  | 6/8 [00:44<00:14,  7.05s/it][A
 88%|████████▊ | 7/8 [00:51<00:06,  6.96s/it][A
100%|██████████| 8/8 [00:55<00:00,  6.19s/it][A100%|██████████| 8/8 [00:55<00:00,  6.96s/it]
OOV: 0.667206
GEO: 0.553953
=======entity level========

Epoch: 1, P: 0.825619, R: 0.785394, F: 0.805005, OOV: 0.667206, GEO: 0.553953
=======entity level========
Epoch:   2%|▏         | 1/50 [01:08<55:37, 68.12s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.59s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.62s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.66s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.81s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.88s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.93s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.86s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.10s/it][A100%|██████████| 8/8 [00:52<00:00,  6.52s/it]
OOV: 0.778461
GEO: 0.861660
=======entity level========

Epoch: 2, P: 0.918671, R: 0.875480, F: 0.896555, OOV: 0.778461, GEO: 0.861660
=======entity level========
Epoch:   4%|▍         | 2/50 [02:13<53:20, 66.67s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.95s/it][A
 25%|██▌       | 2/8 [00:14<00:43,  7.19s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.89s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.93s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.91s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.90s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.74s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.09s/it][A100%|██████████| 8/8 [00:52<00:00,  6.59s/it]
OOV: 0.798512
GEO: 0.859764
=======entity level========

Epoch: 3, P: 0.924681, R: 0.888699, F: 0.906333, OOV: 0.798512, GEO: 0.859764
=======entity level========
Epoch:   6%|▌         | 3/50 [03:17<51:06, 65.24s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.65s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.63s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.97s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.78s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.81s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.67s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.94s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.789780
GEO: 0.856767
=======entity level========

Epoch: 4, P: 0.927767, R: 0.887313, F: 0.907090, OOV: 0.789780, GEO: 0.856767
=======entity level========
Epoch:   8%|▊         | 4/50 [04:19<49:06, 64.05s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.83s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.73s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.74s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.80s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.86s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.88s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.76s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.09s/it][A100%|██████████| 8/8 [00:52<00:00,  6.53s/it]
OOV: 0.800453
GEO: 0.852140
=======entity level========

Epoch: 5, P: 0.926355, R: 0.894456, F: 0.910126, OOV: 0.800453, GEO: 0.852140
=======entity level========
Epoch:  10%|█         | 5/50 [05:22<47:45, 63.69s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.53s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.63s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.59s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.80s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.74s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.78s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.78s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.05s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.790750
GEO: 0.871626
=======entity level========

Epoch: 6, P: 0.928683, R: 0.887100, F: 0.907415, OOV: 0.790750, GEO: 0.871626
=======entity level========
Epoch:  12%|█▏        | 6/50 [06:27<47:01, 64.12s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.67s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.63s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.58s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.79s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.69s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.95s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.807891
GEO: 0.863281
=======entity level========

Epoch: 7, P: 0.927101, R: 0.897548, F: 0.912085, OOV: 0.807891, GEO: 0.863281
=======entity level========
Epoch:  14%|█▍        | 7/50 [07:29<45:28, 63.45s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.75s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.01s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.69s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.63s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.60s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.97s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.807891
GEO: 0.872131
=======entity level========

Epoch: 8, P: 0.925311, R: 0.896802, F: 0.910833, OOV: 0.807891, GEO: 0.872131
=======entity level========
Epoch:  16%|█▌        | 8/50 [08:34<44:40, 63.81s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.69s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.52s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.67s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.61s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.76s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.96s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.87s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.10s/it][A100%|██████████| 8/8 [00:51<00:00,  6.50s/it]
OOV: 0.804981
GEO: 0.858257
=======entity level========

Epoch: 9, P: 0.926248, R: 0.895736, F: 0.910737, OOV: 0.804981, GEO: 0.858257
=======entity level========
Epoch:  18%|█▊        | 9/50 [09:36<43:22, 63.47s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.47s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.52s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.78s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.76s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.88s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.93s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.18s/it][A100%|██████████| 8/8 [00:52<00:00,  6.54s/it]
OOV: 0.799806
GEO: 0.852502
=======entity level========

Epoch: 10, P: 0.925325, R: 0.894350, F: 0.909574, OOV: 0.799806, GEO: 0.852502
=======entity level========
Epoch:  20%|██        | 10/50 [10:40<42:16, 63.41s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.80s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.92s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.88s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.68s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.57s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.60s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.02s/it][A100%|██████████| 8/8 [00:51<00:00,  6.44s/it]
OOV: 0.799159
GEO: 0.879526
=======entity level========

Epoch: 11, P: 0.930002, R: 0.890938, F: 0.910051, OOV: 0.799159, GEO: 0.879526
=======entity level========
Epoch:  22%|██▏       | 11/50 [11:44<41:28, 63.82s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.87s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.81s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.79s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.88s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.85s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.73s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.97s/it][A100%|██████████| 8/8 [00:51<00:00,  6.48s/it]
OOV: 0.799483
GEO: 0.872299
=======entity level========

Epoch: 12, P: 0.926565, R: 0.893177, F: 0.909565, OOV: 0.799483, GEO: 0.872299
=======entity level========
Epoch:  24%|██▍       | 12/50 [12:47<40:11, 63.45s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.20s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.82s/it][A
 38%|███▊      | 3/8 [00:20<00:32,  6.56s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.55s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.66s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.73s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.78s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.30s/it][A100%|██████████| 8/8 [00:52<00:00,  6.55s/it]
OOV: 0.795602
GEO: 0.882740
=======entity level========

Epoch: 13, P: 0.928952, R: 0.892111, F: 0.910159, OOV: 0.795602, GEO: 0.882740
=======entity level========
Epoch:  26%|██▌       | 13/50 [13:53<39:34, 64.16s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.57s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  7.00s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.81s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.75s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.69s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.69s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.64s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.04s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.796572
GEO: 0.870820
=======entity level========

Epoch: 14, P: 0.927446, R: 0.891258, F: 0.908992, OOV: 0.796572, GEO: 0.870820
=======entity level========
Epoch:  28%|██▊       | 14/50 [14:55<38:10, 63.63s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.06s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.88s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.95s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.69s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.69s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.55s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.05s/it][A100%|██████████| 8/8 [00:51<00:00,  6.47s/it]
OOV: 0.797865
GEO: 0.872703
=======entity level========

Epoch: 15, P: 0.927374, R: 0.890299, F: 0.908458, OOV: 0.797865, GEO: 0.872703
=======entity level========
Epoch:  30%|███       | 15/50 [15:58<36:55, 63.30s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.79s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.05s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.84s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.76s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.64s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.51s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.88s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.810155
GEO: 0.860299
=======entity level========

Epoch: 16, P: 0.925914, R: 0.899360, F: 0.912444, OOV: 0.810155, GEO: 0.860299
=======entity level========
Epoch:  32%|███▏      | 16/50 [17:00<35:37, 62.87s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.15s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.94s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.75s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.72s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.75s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.76s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.82s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.13s/it][A100%|██████████| 8/8 [00:52<00:00,  6.54s/it]
OOV: 0.806274
GEO: 0.877792
=======entity level========

Epoch: 17, P: 0.928051, R: 0.896588, F: 0.912049, OOV: 0.806274, GEO: 0.877792
=======entity level========
Epoch:  34%|███▍      | 17/50 [18:03<34:38, 63.00s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.09s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.63s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.60s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.69s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.56s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.71s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.01s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.804981
GEO: 0.876066
=======entity level========

Epoch: 18, P: 0.928769, R: 0.896588, F: 0.912395, OOV: 0.804981, GEO: 0.876066
=======entity level========
Epoch:  36%|███▌      | 18/50 [19:05<33:28, 62.76s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:42,  6.08s/it][A
 25%|██▌       | 2/8 [00:11<00:35,  5.93s/it][A
 38%|███▊      | 3/8 [00:17<00:29,  5.86s/it][A
 50%|█████     | 4/8 [00:24<00:24,  6.07s/it][A
 62%|██████▎   | 5/8 [00:30<00:18,  6.21s/it][A
 75%|███████▌  | 6/8 [00:37<00:12,  6.35s/it][A
 88%|████████▊ | 7/8 [00:43<00:06,  6.43s/it][A
100%|██████████| 8/8 [00:48<00:00,  5.79s/it][A100%|██████████| 8/8 [00:48<00:00,  6.02s/it]
OOV: 0.805627
GEO: 0.875740
=======entity level========

Epoch: 19, P: 0.930163, R: 0.894563, F: 0.912016, OOV: 0.805627, GEO: 0.875740
=======entity level========
Epoch:  38%|███▊      | 19/50 [20:04<31:50, 61.62s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.59s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.58s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.70s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.81s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.91s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.96s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.93s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.11s/it][A100%|██████████| 8/8 [00:52<00:00,  6.54s/it]
OOV: 0.809185
GEO: 0.874754
=======entity level========

Epoch: 20, P: 0.928288, R: 0.897015, F: 0.912383, OOV: 0.809185, GEO: 0.874754
=======entity level========
Epoch:  40%|████      | 20/50 [21:07<31:04, 62.14s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.63s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.69s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.73s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.83s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.88s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.87s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.96s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.22s/it][A100%|██████████| 8/8 [00:52<00:00,  6.59s/it]
OOV: 0.806921
GEO: 0.864230
=======entity level========

Epoch: 21, P: 0.926746, R: 0.896908, F: 0.911583, OOV: 0.806921, GEO: 0.864230
=======entity level========
Epoch:  42%|████▏     | 21/50 [22:11<30:15, 62.61s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.83s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.68s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.66s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.75s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.73s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.64s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.04s/it][A100%|██████████| 8/8 [00:51<00:00,  6.44s/it]
OOV: 0.805627
GEO: 0.873276
=======entity level========

Epoch: 22, P: 0.927357, R: 0.895522, F: 0.911162, OOV: 0.805627, GEO: 0.873276
=======entity level========
Epoch:  44%|████▍     | 22/50 [23:13<29:10, 62.51s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.54s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.55s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.61s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.81s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.62s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.68s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.06s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.807245
GEO: 0.872299
=======entity level========

Epoch: 23, P: 0.926990, R: 0.897441, F: 0.911977, OOV: 0.807245, GEO: 0.872299
=======entity level========

Early stop triggered at epoch 22

Epoch:  44%|████▍     | 22/50 [24:16<30:53, 66.19s/it]

=======best f entity level========

Epoch: 13, P: 0.928952, R: 0.892111, F: 0.910159, OOV: 0.795602, GEO: 0.882740, GEO_N: 0.850724


=======best f entity level========
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
./models/self_bert_wm_av_3_score_0.7_0.814_2024-12-24-19-01-15/model.pt
  0%|          | 0/62 [00:00<?, ?it/s]/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|▏         | 1/62 [00:05<06:05,  5.99s/it]  3%|▎         | 2/62 [00:07<03:30,  3.50s/it]  5%|▍         | 3/62 [00:09<02:32,  2.58s/it]  6%|▋         | 4/62 [00:10<02:10,  2.25s/it]  8%|▊         | 5/62 [00:12<02:00,  2.11s/it] 10%|▉         | 6/62 [00:14<01:53,  2.03s/it] 11%|█▏        | 7/62 [00:15<01:36,  1.76s/it] 13%|█▎        | 8/62 [00:17<01:27,  1.62s/it] 15%|█▍        | 9/62 [00:19<01:30,  1.70s/it] 16%|█▌        | 10/62 [00:20<01:25,  1.65s/it] 18%|█▊        | 11/62 [00:22<01:31,  1.80s/it] 19%|█▉        | 12/62 [00:24<01:23,  1.67s/it] 21%|██        | 13/62 [00:26<01:27,  1.79s/it] 23%|██▎       | 14/62 [00:28<01:26,  1.81s/it] 24%|██▍       | 15/62 [00:29<01:21,  1.74s/it] 26%|██▌       | 16/62 [00:30<01:11,  1.55s/it] 27%|██▋       | 17/62 [00:32<01:05,  1.46s/it] 29%|██▉       | 18/62 [00:33<01:08,  1.56s/it] 31%|███       | 19/62 [00:36<01:16,  1.78s/it] 32%|███▏      | 20/62 [00:38<01:20,  1.92s/it] 34%|███▍      | 21/62 [00:41<01:29,  2.19s/it] 35%|███▌      | 22/62 [00:42<01:21,  2.03s/it] 37%|███▋      | 23/62 [00:44<01:09,  1.79s/it] 39%|███▊      | 24/62 [00:46<01:10,  1.85s/it] 40%|████      | 25/62 [00:49<01:22,  2.24s/it] 42%|████▏     | 26/62 [00:51<01:19,  2.21s/it] 44%|████▎     | 27/62 [00:53<01:12,  2.06s/it] 45%|████▌     | 28/62 [00:54<01:07,  1.99s/it] 47%|████▋     | 29/62 [00:56<01:05,  1.98s/it] 48%|████▊     | 30/62 [00:58<00:59,  1.85s/it] 50%|█████     | 31/62 [01:00<00:56,  1.82s/it] 52%|█████▏    | 32/62 [01:01<00:49,  1.64s/it] 53%|█████▎    | 33/62 [01:03<00:50,  1.75s/it] 55%|█████▍    | 34/62 [01:05<00:51,  1.84s/it] 56%|█████▋    | 35/62 [01:07<00:47,  1.77s/it] 58%|█████▊    | 36/62 [01:08<00:42,  1.65s/it] 60%|█████▉    | 37/62 [01:09<00:36,  1.47s/it] 61%|██████▏   | 38/62 [01:11<00:36,  1.51s/it] 63%|██████▎   | 39/62 [01:13<00:37,  1.65s/it] 65%|██████▍   | 40/62 [01:14<00:35,  1.63s/it] 66%|██████▌   | 41/62 [01:16<00:33,  1.60s/it] 68%|██████▊   | 42/62 [01:17<00:31,  1.58s/it] 69%|██████▉   | 43/62 [01:19<00:31,  1.67s/it] 71%|███████   | 44/62 [01:21<00:29,  1.62s/it] 73%|███████▎  | 45/62 [01:23<00:32,  1.89s/it] 74%|███████▍  | 46/62 [01:24<00:27,  1.72s/it] 76%|███████▌  | 47/62 [01:26<00:24,  1.64s/it] 77%|███████▋  | 48/62 [01:27<00:22,  1.61s/it] 79%|███████▉  | 49/62 [01:30<00:23,  1.83s/it] 81%|████████  | 50/62 [01:31<00:20,  1.73s/it] 82%|████████▏ | 51/62 [01:33<00:19,  1.74s/it] 84%|████████▍ | 52/62 [01:35<00:17,  1.78s/it] 85%|████████▌ | 53/62 [01:38<00:18,  2.05s/it] 87%|████████▋ | 54/62 [01:39<00:15,  1.90s/it] 89%|████████▊ | 55/62 [01:41<00:12,  1.79s/it] 90%|█████████ | 56/62 [01:42<00:10,  1.68s/it] 92%|█████████▏| 57/62 [01:44<00:08,  1.61s/it] 94%|█████████▎| 58/62 [01:45<00:06,  1.57s/it] 95%|█████████▌| 59/62 [01:47<00:04,  1.57s/it] 97%|█████████▋| 60/62 [01:48<00:02,  1.50s/it] 98%|█████████▊| 61/62 [01:50<00:01,  1.68s/it]100%|██████████| 62/62 [01:52<00:00,  1.64s/it]100%|██████████| 62/62 [01:52<00:00,  1.81s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/home/testcross/projects/models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0.7_0.815', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13464
# of trainable parameters: 112621824
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

 12%|█▎        | 1/8 [00:09<01:07,  9.59s/it][A
 25%|██▌       | 2/8 [00:16<00:47,  7.97s/it][A
 38%|███▊      | 3/8 [00:23<00:36,  7.37s/it][A
 50%|█████     | 4/8 [00:29<00:28,  7.00s/it][A
 62%|██████▎   | 5/8 [00:36<00:20,  6.82s/it][A
 75%|███████▌  | 6/8 [00:42<00:13,  6.82s/it][A
 88%|████████▊ | 7/8 [00:49<00:06,  6.78s/it][A
100%|██████████| 8/8 [00:53<00:00,  6.04s/it][A100%|██████████| 8/8 [00:53<00:00,  6.75s/it]
OOV: 0.609961
GEO: 0.422198
=======entity level========

Epoch: 1, P: 0.779914, R: 0.769936, F: 0.774893, OOV: 0.609961, GEO: 0.422198
=======entity level========
Epoch:   2%|▏         | 1/50 [01:06<54:21, 66.55s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.59s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.48s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.49s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.62s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.75s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.74s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.64s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.89s/it][A100%|██████████| 8/8 [00:50<00:00,  6.34s/it]
OOV: 0.786546
GEO: 0.842037
=======entity level========

Epoch: 2, P: 0.915796, R: 0.878891, F: 0.896964, OOV: 0.786546, GEO: 0.842037
=======entity level========
Epoch:   4%|▍         | 2/50 [02:10<52:01, 65.02s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.62s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.05s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.78s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.77s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.71s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.69s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.54s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.92s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.782988
GEO: 0.874172
=======entity level========

Epoch: 3, P: 0.923524, R: 0.880597, F: 0.901550, OOV: 0.782988, GEO: 0.874172
=======entity level========
Epoch:   6%|▌         | 3/50 [03:15<50:46, 64.82s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.58s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.56s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.88s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.68s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.70s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.61s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.58s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.84s/it][A100%|██████████| 8/8 [00:50<00:00,  6.34s/it]
OOV: 0.780078
GEO: 0.869623
=======entity level========

Epoch: 4, P: 0.927546, R: 0.881663, F: 0.904023, OOV: 0.780078, GEO: 0.869623
=======entity level========
Epoch:   8%|▊         | 4/50 [04:16<48:42, 63.53s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.62s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.51s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.46s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.53s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.62s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.72s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.65s/it][A
100%|██████████| 8/8 [00:50<00:00,  6.01s/it][A100%|██████████| 8/8 [00:50<00:00,  6.37s/it]
OOV: 0.798189
GEO: 0.853056
=======entity level========

Epoch: 5, P: 0.923485, R: 0.890405, F: 0.906644, OOV: 0.798189, GEO: 0.853056
=======entity level========
Epoch:  10%|█         | 5/50 [05:18<47:10, 62.91s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.58s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.77s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.70s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.86s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.83s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.89s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.89s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.13s/it][A100%|██████████| 8/8 [00:52<00:00,  6.55s/it]
OOV: 0.799159
GEO: 0.860511
=======entity level========

Epoch: 6, P: 0.925462, R: 0.890832, F: 0.907817, OOV: 0.799159, GEO: 0.860511
=======entity level========
Epoch:  12%|█▏        | 6/50 [06:21<46:14, 63.06s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.67s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.59s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.51s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.73s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.71s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.64s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.64s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.90s/it][A100%|██████████| 8/8 [00:50<00:00,  6.35s/it]
OOV: 0.804657
GEO: 0.869110
=======entity level========

Epoch: 7, P: 0.925807, R: 0.892644, F: 0.908923, OOV: 0.804657, GEO: 0.869110
=======entity level========
Epoch:  14%|█▍        | 7/50 [07:23<44:51, 62.60s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.70s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.02s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.75s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.65s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.66s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.65s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.56s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.92s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.798836
GEO: 0.887566
=======entity level========

Epoch: 8, P: 0.925075, R: 0.888486, F: 0.906411, OOV: 0.798836, GEO: 0.887566
=======entity level========
Epoch:  16%|█▌        | 8/50 [08:27<44:13, 63.19s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.64s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.51s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.64s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.57s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.88s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.81s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.04s/it][A100%|██████████| 8/8 [00:51<00:00,  6.44s/it]
OOV: 0.804657
GEO: 0.873518
=======entity level========

Epoch: 9, P: 0.927048, R: 0.894136, F: 0.910295, OOV: 0.804657, GEO: 0.873518
=======entity level========
Epoch:  18%|█▊        | 9/50 [09:30<43:00, 62.94s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:44,  6.41s/it][A
 25%|██▌       | 2/8 [00:12<00:39,  6.51s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.76s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.66s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.58s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.71s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.97s/it][A100%|██████████| 8/8 [00:51<00:00,  6.38s/it]
OOV: 0.803364
GEO: 0.865183
=======entity level========

Epoch: 10, P: 0.925587, R: 0.895096, F: 0.910086, OOV: 0.803364, GEO: 0.865183
=======entity level========
Epoch:  20%|██        | 10/50 [10:32<41:45, 62.64s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.49s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.70s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.73s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.57s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.49s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.52s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.63s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.97s/it][A100%|██████████| 8/8 [00:50<00:00,  6.35s/it]
OOV: 0.804334
GEO: 0.883476
=======entity level========

Epoch: 11, P: 0.927931, R: 0.893603, F: 0.910444, OOV: 0.804334, GEO: 0.883476
=======entity level========
Epoch:  22%|██▏       | 11/50 [11:33<40:31, 62.34s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.74s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.61s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.58s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.67s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.63s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.63s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.89s/it][A100%|██████████| 8/8 [00:50<00:00,  6.35s/it]
OOV: 0.801100
GEO: 0.886980
=======entity level========

Epoch: 12, P: 0.925832, R: 0.892964, F: 0.909101, OOV: 0.801100, GEO: 0.886980
=======entity level========
Epoch:  24%|██▍       | 12/50 [12:35<39:21, 62.14s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.25s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.95s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.65s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.61s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.62s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.61s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.61s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.12s/it][A100%|██████████| 8/8 [00:51<00:00,  6.47s/it]
OOV: 0.799159
GEO: 0.877888
=======entity level========

Epoch: 13, P: 0.925721, R: 0.890192, F: 0.907609, OOV: 0.799159, GEO: 0.877888
=======entity level========
Epoch:  26%|██▌       | 13/50 [13:38<38:24, 62.29s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.50s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.92s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.73s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.69s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.62s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.62s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.57s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.98s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.795278
GEO: 0.877309
=======entity level========

Epoch: 14, P: 0.927380, R: 0.889019, F: 0.907794, OOV: 0.795278, GEO: 0.877309
=======entity level========
Epoch:  28%|██▊       | 14/50 [14:40<37:18, 62.17s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.18s/it][A
 25%|██▌       | 2/8 [00:14<00:41,  6.98s/it][A
 38%|███▊      | 3/8 [00:21<00:34,  6.99s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.70s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.64s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.50s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.00s/it][A100%|██████████| 8/8 [00:51<00:00,  6.45s/it]
OOV: 0.815006
GEO: 0.868542
=======entity level========

Epoch: 15, P: 0.928949, R: 0.900426, F: 0.914465, OOV: 0.815006, GEO: 0.868542
=======entity level========
Epoch:  30%|███       | 15/50 [15:42<36:18, 62.25s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.83s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.05s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.82s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.74s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.65s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.53s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.88s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.807568
GEO: 0.867060
=======entity level========

Epoch: 16, P: 0.926698, R: 0.896269, F: 0.911229, OOV: 0.807568, GEO: 0.867060
=======entity level========
Epoch:  32%|███▏      | 16/50 [16:44<35:14, 62.20s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.09s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.83s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.67s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.68s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.63s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.57s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.61s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.96s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.803687
GEO: 0.882004
=======entity level========

Epoch: 17, P: 0.928477, R: 0.894030, F: 0.910928, OOV: 0.803687, GEO: 0.882004
=======entity level========
Epoch:  34%|███▍      | 17/50 [17:46<34:12, 62.19s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.20s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.72s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.70s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.80s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.59s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.99s/it][A100%|██████████| 8/8 [00:51<00:00,  6.44s/it]
OOV: 0.806274
GEO: 0.872299
=======entity level========

Epoch: 18, P: 0.928643, R: 0.894883, F: 0.911450, OOV: 0.806274, GEO: 0.872299
=======entity level========

Early stop triggered at epoch 17

Epoch:  34%|███▍      | 17/50 [18:49<36:31, 66.42s/it]

=======best f entity level========

Epoch: 8, P: 0.925075, R: 0.888486, F: 0.906411, OOV: 0.798836, GEO: 0.887566, GEO_N: 0.849650


=======best f entity level========
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
./models/self_bert_wm_av_3_score_0.7_0.815_2024-12-24-19-28-03/model.pt
  0%|          | 0/62 [00:00<?, ?it/s]/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|▏         | 1/62 [00:04<05:00,  4.93s/it]  3%|▎         | 2/62 [00:06<03:01,  3.03s/it]  5%|▍         | 3/62 [00:08<02:18,  2.35s/it]  6%|▋         | 4/62 [00:09<02:03,  2.12s/it]  8%|▊         | 5/62 [00:11<01:57,  2.05s/it] 10%|▉         | 6/62 [00:13<01:53,  2.02s/it] 11%|█▏        | 7/62 [00:15<01:37,  1.77s/it] 13%|█▎        | 8/62 [00:16<01:27,  1.62s/it] 15%|█▍        | 9/62 [00:18<01:28,  1.66s/it] 16%|█▌        | 10/62 [00:19<01:24,  1.62s/it] 18%|█▊        | 11/62 [00:21<01:29,  1.76s/it] 19%|█▉        | 12/62 [00:23<01:21,  1.64s/it] 21%|██        | 13/62 [00:25<01:25,  1.75s/it] 23%|██▎       | 14/62 [00:26<01:24,  1.77s/it] 24%|██▍       | 15/62 [00:28<01:20,  1.71s/it] 26%|██▌       | 16/62 [00:29<01:09,  1.52s/it] 27%|██▋       | 17/62 [00:30<01:04,  1.44s/it] 29%|██▉       | 18/62 [00:32<01:07,  1.54s/it] 31%|███       | 19/62 [00:34<01:14,  1.74s/it] 32%|███▏      | 20/62 [00:37<01:19,  1.88s/it] 34%|███▍      | 21/62 [00:39<01:27,  2.14s/it] 35%|███▌      | 22/62 [00:41<01:19,  1.98s/it] 37%|███▋      | 23/62 [00:42<01:08,  1.75s/it] 39%|███▊      | 24/62 [00:44<01:08,  1.80s/it] 40%|████      | 25/62 [00:47<01:20,  2.18s/it] 42%|████▏     | 26/62 [00:49<01:16,  2.13s/it] 44%|████▎     | 27/62 [00:51<01:09,  1.99s/it] 45%|████▌     | 28/62 [00:53<01:05,  1.92s/it] 47%|████▋     | 29/62 [00:54<01:03,  1.91s/it] 48%|████▊     | 30/62 [00:56<00:57,  1.80s/it] 50%|█████     | 31/62 [00:58<00:54,  1.76s/it] 52%|█████▏    | 32/62 [00:59<00:47,  1.60s/it] 53%|█████▎    | 33/62 [01:01<00:49,  1.71s/it] 55%|█████▍    | 34/62 [01:03<00:50,  1.80s/it] 56%|█████▋    | 35/62 [01:04<00:46,  1.73s/it] 58%|█████▊    | 36/62 [01:06<00:41,  1.61s/it] 60%|█████▉    | 37/62 [01:07<00:35,  1.43s/it] 61%|██████▏   | 38/62 [01:08<00:35,  1.47s/it] 63%|██████▎   | 39/62 [01:10<00:36,  1.60s/it] 65%|██████▍   | 40/62 [01:12<00:34,  1.58s/it] 66%|██████▌   | 41/62 [01:13<00:32,  1.56s/it] 68%|██████▊   | 42/62 [01:15<00:30,  1.54s/it] 69%|██████▉   | 43/62 [01:17<00:30,  1.63s/it] 71%|███████   | 44/62 [01:18<00:28,  1.58s/it] 73%|███████▎  | 45/62 [01:20<00:31,  1.85s/it] 74%|███████▍  | 46/62 [01:22<00:26,  1.67s/it] 76%|███████▌  | 47/62 [01:23<00:24,  1.60s/it] 77%|███████▋  | 48/62 [01:25<00:22,  1.58s/it] 79%|███████▉  | 49/62 [01:27<00:23,  1.79s/it] 81%|████████  | 50/62 [01:29<00:20,  1.70s/it] 82%|████████▏ | 51/62 [01:30<00:18,  1.71s/it] 84%|████████▍ | 52/62 [01:32<00:17,  1.74s/it] 85%|████████▌ | 53/62 [01:35<00:18,  2.01s/it] 87%|████████▋ | 54/62 [01:36<00:14,  1.86s/it] 89%|████████▊ | 55/62 [01:38<00:12,  1.75s/it] 90%|█████████ | 56/62 [01:39<00:09,  1.64s/it] 92%|█████████▏| 57/62 [01:41<00:07,  1.58s/it] 94%|█████████▎| 58/62 [01:42<00:06,  1.54s/it] 95%|█████████▌| 59/62 [01:44<00:04,  1.54s/it] 97%|█████████▋| 60/62 [01:45<00:02,  1.47s/it] 98%|█████████▊| 61/62 [01:47<00:01,  1.65s/it]100%|██████████| 62/62 [01:48<00:00,  1.60s/it]100%|██████████| 62/62 [01:48<00:00,  1.76s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/home/testcross/projects/models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0.7_0.816', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13464
# of trainable parameters: 112621824
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

 12%|█▎        | 1/8 [00:10<01:16, 10.93s/it][A
 25%|██▌       | 2/8 [00:18<00:52,  8.76s/it][A
 38%|███▊      | 3/8 [00:25<00:39,  7.96s/it][A
 50%|█████     | 4/8 [00:32<00:30,  7.52s/it][A
 62%|██████▎   | 5/8 [00:38<00:21,  7.30s/it][A
 75%|███████▌  | 6/8 [00:46<00:14,  7.32s/it][A
 88%|████████▊ | 7/8 [00:53<00:07,  7.25s/it][A
100%|██████████| 8/8 [00:58<00:00,  6.46s/it][A100%|██████████| 8/8 [00:58<00:00,  7.27s/it]
OOV: 0.608991
GEO: 0.422367
=======entity level========

Epoch: 1, P: 0.779952, R: 0.768977, F: 0.774426, OOV: 0.608991, GEO: 0.422367
=======entity level========
Epoch:   2%|▏         | 1/50 [01:11<58:31, 71.66s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.87s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.79s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.80s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.94s/it][A
 62%|██████▎   | 5/8 [00:34<00:21,  7.08s/it][A
 75%|███████▌  | 6/8 [00:42<00:14,  7.11s/it][A
 88%|████████▊ | 7/8 [00:48<00:07,  7.03s/it][A
100%|██████████| 8/8 [00:53<00:00,  6.26s/it][A100%|██████████| 8/8 [00:53<00:00,  6.69s/it]
OOV: 0.780078
GEO: 0.857518
=======entity level========

Epoch: 2, P: 0.913024, R: 0.872921, F: 0.892522, OOV: 0.780078, GEO: 0.857518
=======entity level========
Epoch:   4%|▍         | 2/50 [02:19<55:33, 69.45s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.05s/it][A
 25%|██▌       | 2/8 [00:14<00:44,  7.37s/it][A
 38%|███▊      | 3/8 [00:21<00:35,  7.17s/it][A
 50%|█████     | 4/8 [00:28<00:28,  7.19s/it][A
 62%|██████▎   | 5/8 [00:35<00:21,  7.15s/it][A
 75%|███████▌  | 6/8 [00:42<00:14,  7.13s/it][A
 88%|████████▊ | 7/8 [00:49<00:06,  6.99s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.33s/it][A100%|██████████| 8/8 [00:54<00:00,  6.82s/it]
OOV: 0.790427
GEO: 0.866755
=======entity level========

Epoch: 3, P: 0.921998, R: 0.883369, F: 0.902270, OOV: 0.790427, GEO: 0.866755
=======entity level========
Epoch:   6%|▌         | 3/50 [03:28<54:10, 69.17s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.93s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.96s/it][A
 38%|███▊      | 3/8 [00:21<00:36,  7.30s/it][A
 50%|█████     | 4/8 [00:28<00:28,  7.12s/it][A
 62%|██████▎   | 5/8 [00:35<00:21,  7.10s/it][A
 75%|███████▌  | 6/8 [00:42<00:13,  6.99s/it][A
 88%|████████▊ | 7/8 [00:49<00:06,  6.96s/it][A
100%|██████████| 8/8 [00:53<00:00,  6.19s/it][A100%|██████████| 8/8 [00:53<00:00,  6.72s/it]
OOV: 0.784929
GEO: 0.871693
=======entity level========

Epoch: 4, P: 0.927362, R: 0.881983, F: 0.904104, OOV: 0.784929, GEO: 0.871693
=======entity level========
Epoch:   8%|▊         | 4/50 [04:36<52:45, 68.80s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.03s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.91s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.88s/it][A
 50%|█████     | 4/8 [00:27<00:28,  7.02s/it][A
 62%|██████▎   | 5/8 [00:35<00:21,  7.07s/it][A
 75%|███████▌  | 6/8 [00:42<00:14,  7.09s/it][A
 88%|████████▊ | 7/8 [00:49<00:07,  7.02s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.35s/it][A100%|██████████| 8/8 [00:54<00:00,  6.75s/it]
OOV: 0.798189
GEO: 0.857143
=======entity level========

Epoch: 5, P: 0.923460, R: 0.890085, F: 0.906465, OOV: 0.798189, GEO: 0.857143
=======entity level========
Epoch:  10%|█         | 5/50 [05:42<50:47, 67.72s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.88s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.02s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.96s/it][A
 50%|█████     | 4/8 [00:28<00:28,  7.14s/it][A
 62%|██████▎   | 5/8 [00:35<00:21,  7.07s/it][A
 75%|███████▌  | 6/8 [00:42<00:14,  7.15s/it][A
 88%|████████▊ | 7/8 [00:49<00:07,  7.13s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.36s/it][A100%|██████████| 8/8 [00:54<00:00,  6.79s/it]
OOV: 0.803040
GEO: 0.856769
=======entity level========

Epoch: 6, P: 0.925987, R: 0.892324, F: 0.908844, OOV: 0.803040, GEO: 0.856769
=======entity level========
Epoch:  12%|█▏        | 6/50 [06:48<49:08, 67.02s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.22s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.03s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.91s/it][A
 50%|█████     | 4/8 [00:28<00:28,  7.13s/it][A
 62%|██████▎   | 5/8 [00:35<00:21,  7.10s/it][A
 75%|███████▌  | 6/8 [00:42<00:14,  7.02s/it][A
 88%|████████▊ | 7/8 [00:49<00:07,  7.00s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.29s/it][A100%|██████████| 8/8 [00:54<00:00,  6.75s/it]
OOV: 0.805304
GEO: 0.869337
=======entity level========

Epoch: 7, P: 0.927078, R: 0.893177, F: 0.909812, OOV: 0.805304, GEO: 0.869337
=======entity level========
Epoch:  14%|█▍        | 7/50 [07:53<47:36, 66.43s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.05s/it][A
 25%|██▌       | 2/8 [00:14<00:43,  7.33s/it][A
 38%|███▊      | 3/8 [00:21<00:35,  7.00s/it][A
 50%|█████     | 4/8 [00:28<00:28,  7.01s/it][A
 62%|██████▎   | 5/8 [00:35<00:21,  7.06s/it][A
 75%|███████▌  | 6/8 [00:42<00:14,  7.07s/it][A
 88%|████████▊ | 7/8 [00:49<00:06,  6.96s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.36s/it][A100%|██████████| 8/8 [00:54<00:00,  6.78s/it]
OOV: 0.794955
GEO: 0.874670
=======entity level========

Epoch: 8, P: 0.926672, R: 0.887846, F: 0.906844, OOV: 0.794955, GEO: 0.874670
=======entity level========
Epoch:  16%|█▌        | 8/50 [09:01<46:53, 66.99s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.05s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.87s/it][A
 38%|███▊      | 3/8 [00:21<00:35,  7.12s/it][A
 50%|█████     | 4/8 [00:28<00:28,  7.05s/it][A
 62%|██████▎   | 5/8 [00:35<00:21,  7.16s/it][A
 75%|███████▌  | 6/8 [00:43<00:14,  7.37s/it][A
 88%|████████▊ | 7/8 [00:50<00:07,  7.33s/it][A
100%|██████████| 8/8 [00:55<00:00,  6.50s/it][A100%|██████████| 8/8 [00:55<00:00,  6.91s/it]
OOV: 0.803040
GEO: 0.867454
=======entity level========

Epoch: 9, P: 0.926372, R: 0.894670, F: 0.910245, OOV: 0.803040, GEO: 0.867454
=======entity level========
Epoch:  18%|█▊        | 9/50 [10:08<45:42, 66.90s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.95s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.88s/it][A
 38%|███▊      | 3/8 [00:21<00:35,  7.13s/it][A
 50%|█████     | 4/8 [00:28<00:28,  7.02s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.95s/it][A
 75%|███████▌  | 6/8 [00:42<00:14,  7.04s/it][A
 88%|████████▊ | 7/8 [00:49<00:07,  7.07s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.36s/it][A100%|██████████| 8/8 [00:54<00:00,  6.76s/it]
OOV: 0.804657
GEO: 0.862924
=======entity level========

Epoch: 10, P: 0.926902, R: 0.896269, F: 0.911328, OOV: 0.804657, GEO: 0.862924
=======entity level========
Epoch:  20%|██        | 10/50 [11:13<44:15, 66.38s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.86s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.06s/it][A
 38%|███▊      | 3/8 [00:21<00:35,  7.18s/it][A
 50%|█████     | 4/8 [00:28<00:27,  6.98s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.87s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.89s/it][A
 88%|████████▊ | 7/8 [00:48<00:07,  7.03s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.40s/it][A100%|██████████| 8/8 [00:54<00:00,  6.75s/it]
OOV: 0.793338
GEO: 0.875412
=======entity level========

Epoch: 11, P: 0.925544, R: 0.889232, F: 0.907025, OOV: 0.793338, GEO: 0.875412
=======entity level========
Epoch:  22%|██▏       | 11/50 [12:21<43:27, 66.86s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.20s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.16s/it][A
 38%|███▊      | 3/8 [00:21<00:35,  7.07s/it][A
 50%|█████     | 4/8 [00:28<00:28,  7.13s/it][A
 62%|██████▎   | 5/8 [00:35<00:21,  7.04s/it][A
 75%|███████▌  | 6/8 [00:42<00:14,  7.13s/it][A
 88%|████████▊ | 7/8 [00:49<00:07,  7.11s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.31s/it][A100%|██████████| 8/8 [00:54<00:00,  6.79s/it]
OOV: 0.800453
GEO: 0.869165
=======entity level========

Epoch: 12, P: 0.924895, R: 0.892751, F: 0.908539, OOV: 0.800453, GEO: 0.869165
=======entity level========
Epoch:  24%|██▍       | 12/50 [13:27<42:09, 66.55s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:52,  7.56s/it][A
 25%|██▌       | 2/8 [00:14<00:43,  7.19s/it][A
 38%|███▊      | 3/8 [00:21<00:34,  6.97s/it][A
 50%|█████     | 4/8 [00:28<00:27,  6.92s/it][A
 62%|██████▎   | 5/8 [00:35<00:20,  6.96s/it][A
 75%|███████▌  | 6/8 [00:42<00:13,  6.99s/it][A
 88%|████████▊ | 7/8 [00:49<00:06,  7.00s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.49s/it][A100%|██████████| 8/8 [00:54<00:00,  6.82s/it]
OOV: 0.801423
GEO: 0.878049
=======entity level========

Epoch: 13, P: 0.925905, R: 0.891258, F: 0.908251, OOV: 0.801423, GEO: 0.878049
=======entity level========
Epoch:  26%|██▌       | 13/50 [14:36<41:31, 67.33s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.90s/it][A
 25%|██▌       | 2/8 [00:14<00:43,  7.28s/it][A
 38%|███▊      | 3/8 [00:21<00:35,  7.10s/it][A
 50%|█████     | 4/8 [00:28<00:28,  7.07s/it][A
 62%|██████▎   | 5/8 [00:35<00:20,  6.97s/it][A
 75%|███████▌  | 6/8 [00:42<00:14,  7.04s/it][A
 88%|████████▊ | 7/8 [00:49<00:06,  7.00s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.38s/it][A100%|██████████| 8/8 [00:54<00:00,  6.79s/it]
OOV: 0.798836
GEO: 0.880528
=======entity level========

Epoch: 14, P: 0.927444, R: 0.889872, F: 0.908270, OOV: 0.798836, GEO: 0.880528
=======entity level========
Epoch:  28%|██▊       | 14/50 [15:44<40:38, 67.72s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:52,  7.48s/it][A
 25%|██▌       | 2/8 [00:14<00:43,  7.24s/it][A
 38%|███▊      | 3/8 [00:22<00:37,  7.41s/it][A
 50%|█████     | 4/8 [00:28<00:28,  7.11s/it][A
 62%|██████▎   | 5/8 [00:35<00:21,  7.07s/it][A
 75%|███████▌  | 6/8 [00:42<00:14,  7.02s/it][A
 88%|████████▊ | 7/8 [00:49<00:06,  6.89s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.38s/it][A100%|██████████| 8/8 [00:54<00:00,  6.83s/it]
OOV: 0.803040
GEO: 0.872368
=======entity level========

Epoch: 15, P: 0.927259, R: 0.892857, F: 0.909733, OOV: 0.803040, GEO: 0.872368
=======entity level========
Epoch:  30%|███       | 15/50 [16:51<39:15, 67.31s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.16s/it][A
 25%|██▌       | 2/8 [00:14<00:44,  7.47s/it][A
 38%|███▊      | 3/8 [00:21<00:36,  7.24s/it][A
 50%|█████     | 4/8 [00:28<00:28,  7.14s/it][A
 62%|██████▎   | 5/8 [00:35<00:21,  7.12s/it][A
 75%|███████▌  | 6/8 [00:42<00:14,  7.02s/it][A
 88%|████████▊ | 7/8 [00:49<00:06,  6.87s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.19s/it][A100%|██████████| 8/8 [00:54<00:00,  6.75s/it]
OOV: 0.803364
GEO: 0.878628
=======entity level========

Epoch: 16, P: 0.926840, R: 0.892751, F: 0.909476, OOV: 0.803364, GEO: 0.878628
=======entity level========
Epoch:  32%|███▏      | 16/50 [17:56<37:47, 66.69s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:52,  7.48s/it][A
 25%|██▌       | 2/8 [00:14<00:43,  7.21s/it][A
 38%|███▊      | 3/8 [00:21<00:35,  7.05s/it][A
 50%|█████     | 4/8 [00:28<00:28,  7.09s/it][A
 62%|██████▎   | 5/8 [00:35<00:21,  7.03s/it][A
 75%|███████▌  | 6/8 [00:42<00:13,  6.96s/it][A
 88%|████████▊ | 7/8 [00:49<00:06,  6.99s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.27s/it][A100%|██████████| 8/8 [00:54<00:00,  6.76s/it]
OOV: 0.805627
GEO: 0.876640
=======entity level========

Epoch: 17, P: 0.926969, R: 0.894456, F: 0.910423, OOV: 0.805627, GEO: 0.876640
=======entity level========
Epoch:  34%|███▍      | 17/50 [19:02<36:29, 66.35s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:51,  7.37s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.90s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.91s/it][A
 50%|█████     | 4/8 [00:28<00:28,  7.02s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.95s/it][A
 75%|███████▌  | 6/8 [00:42<00:14,  7.08s/it][A
 88%|████████▊ | 7/8 [00:49<00:07,  7.09s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.35s/it][A100%|██████████| 8/8 [00:54<00:00,  6.76s/it]
OOV: 0.801746
GEO: 0.885073
=======entity level========

Epoch: 18, P: 0.927986, R: 0.892964, F: 0.910138, OOV: 0.801746, GEO: 0.885073
=======entity level========
Epoch:  36%|███▌      | 18/50 [20:10<35:44, 67.01s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.77s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.04s/it][A
 38%|███▊      | 3/8 [00:21<00:35,  7.11s/it][A
 50%|█████     | 4/8 [00:28<00:28,  7.15s/it][A
 62%|██████▎   | 5/8 [00:35<00:21,  7.02s/it][A
 75%|███████▌  | 6/8 [00:42<00:13,  6.99s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.95s/it][A
100%|██████████| 8/8 [00:53<00:00,  6.22s/it][A100%|██████████| 8/8 [00:53<00:00,  6.71s/it]
OOV: 0.804010
GEO: 0.884336
=======entity level========

Epoch: 19, P: 0.928239, R: 0.892217, F: 0.909872, OOV: 0.804010, GEO: 0.884336
=======entity level========
Epoch:  38%|███▊      | 19/50 [21:15<34:18, 66.41s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.94s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.89s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  7.00s/it][A
 50%|█████     | 4/8 [00:28<00:28,  7.18s/it][A
 62%|██████▎   | 5/8 [00:35<00:21,  7.19s/it][A
 75%|███████▌  | 6/8 [00:42<00:14,  7.21s/it][A
 88%|████████▊ | 7/8 [00:49<00:07,  7.16s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.35s/it][A100%|██████████| 8/8 [00:54<00:00,  6.81s/it]
OOV: 0.805304
GEO: 0.875740
=======entity level========

Epoch: 20, P: 0.928627, R: 0.893284, F: 0.910612, OOV: 0.805304, GEO: 0.875740
=======entity level========
Epoch:  40%|████      | 20/50 [22:21<33:09, 66.32s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.79s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.85s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.96s/it][A
 50%|█████     | 4/8 [00:27<00:28,  7.06s/it][A
 62%|██████▎   | 5/8 [00:35<00:21,  7.11s/it][A
 75%|███████▌  | 6/8 [00:42<00:14,  7.08s/it][A
 88%|████████▊ | 7/8 [00:49<00:07,  7.17s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.41s/it][A100%|██████████| 8/8 [00:54<00:00,  6.79s/it]
OOV: 0.803364
GEO: 0.878049
=======entity level========

Epoch: 21, P: 0.928587, R: 0.894136, F: 0.911036, OOV: 0.803364, GEO: 0.878049
=======entity level========
Epoch:  42%|████▏     | 21/50 [23:27<32:00, 66.23s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.03s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.93s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.95s/it][A
 50%|█████     | 4/8 [00:28<00:28,  7.16s/it][A
 62%|██████▎   | 5/8 [00:35<00:21,  7.13s/it][A
 75%|███████▌  | 6/8 [00:42<00:14,  7.03s/it][A
 88%|████████▊ | 7/8 [00:49<00:07,  7.05s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.38s/it][A100%|██████████| 8/8 [00:54<00:00,  6.78s/it]
OOV: 0.801100
GEO: 0.873518
=======entity level========

Epoch: 22, P: 0.930287, R: 0.892004, F: 0.910743, OOV: 0.801100, GEO: 0.873518
=======entity level========
Epoch:  44%|████▍     | 22/50 [24:33<30:53, 66.18s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.86s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.85s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.93s/it][A
 50%|█████     | 4/8 [00:28<00:28,  7.17s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.97s/it][A
 75%|███████▌  | 6/8 [00:42<00:14,  7.04s/it][A
 88%|████████▊ | 7/8 [00:49<00:07,  7.04s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.38s/it][A100%|██████████| 8/8 [00:54<00:00,  6.76s/it]
OOV: 0.804981
GEO: 0.879367
=======entity level========

Epoch: 23, P: 0.928405, R: 0.893070, F: 0.910395, OOV: 0.804981, GEO: 0.879367
=======entity level========
Epoch:  46%|████▌     | 23/50 [25:39<29:44, 66.08s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:51,  7.29s/it][A
 25%|██▌       | 2/8 [00:14<00:41,  6.97s/it][A
 38%|███▊      | 3/8 [00:21<00:34,  6.98s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.94s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.79s/it][A
 75%|███████▌  | 6/8 [00:41<00:14,  7.04s/it][A
 88%|████████▊ | 7/8 [00:49<00:07,  7.07s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.39s/it][A100%|██████████| 8/8 [00:54<00:00,  6.75s/it]
OOV: 0.807245
GEO: 0.869679
=======entity level========

Epoch: 24, P: 0.929054, R: 0.894883, F: 0.911648, OOV: 0.807245, GEO: 0.869679
=======entity level========
Epoch:  48%|████▊     | 24/50 [26:44<28:31, 65.83s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.04s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.93s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.92s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.96s/it][A
 62%|██████▎   | 5/8 [00:34<00:21,  7.04s/it][A
 75%|███████▌  | 6/8 [00:42<00:14,  7.12s/it][A
 88%|████████▊ | 7/8 [00:49<00:07,  7.02s/it][A
100%|██████████| 8/8 [00:53<00:00,  6.32s/it][A100%|██████████| 8/8 [00:53<00:00,  6.74s/it]
OOV: 0.805627
GEO: 0.876640
=======entity level========

Epoch: 25, P: 0.930078, R: 0.893390, F: 0.911365, OOV: 0.805627, GEO: 0.876640
=======entity level========
Epoch:  50%|█████     | 25/50 [27:50<27:24, 65.77s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.95s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.13s/it][A
 38%|███▊      | 3/8 [00:21<00:35,  7.12s/it][A
 50%|█████     | 4/8 [00:28<00:28,  7.11s/it][A
 62%|██████▎   | 5/8 [00:35<00:21,  7.01s/it][A
 75%|███████▌  | 6/8 [00:42<00:14,  7.04s/it][A
 88%|████████▊ | 7/8 [00:49<00:07,  7.04s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.31s/it][A100%|██████████| 8/8 [00:54<00:00,  6.76s/it]
OOV: 0.806274
GEO: 0.880686
=======entity level========

Epoch: 26, P: 0.928991, R: 0.892644, F: 0.910455, OOV: 0.806274, GEO: 0.880686
=======entity level========
Epoch:  52%|█████▏    | 26/50 [28:56<26:19, 65.81s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.02s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.02s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.95s/it][A
 50%|█████     | 4/8 [00:28<00:28,  7.03s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.94s/it][A
 75%|███████▌  | 6/8 [00:42<00:14,  7.09s/it][A
 88%|████████▊ | 7/8 [00:49<00:07,  7.06s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.35s/it][A100%|██████████| 8/8 [00:54<00:00,  6.76s/it]
OOV: 0.807245
GEO: 0.880105
=======entity level========

Epoch: 27, P: 0.927702, R: 0.893284, F: 0.910167, OOV: 0.807245, GEO: 0.880105
=======entity level========
Epoch:  54%|█████▍    | 27/50 [30:01<25:09, 65.64s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.18s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.05s/it][A
 38%|███▊      | 3/8 [00:21<00:35,  7.08s/it][A
 50%|█████     | 4/8 [00:28<00:27,  6.97s/it][A
 62%|██████▎   | 5/8 [00:35<00:21,  7.01s/it][A
 75%|███████▌  | 6/8 [00:42<00:14,  7.05s/it][A
 88%|████████▊ | 7/8 [00:49<00:07,  7.13s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.32s/it][A100%|██████████| 8/8 [00:54<00:00,  6.77s/it]
OOV: 0.807891
GEO: 0.884488
=======entity level========

Epoch: 28, P: 0.928050, R: 0.893817, F: 0.910611, OOV: 0.807891, GEO: 0.884488
=======entity level========

Early stop triggered at epoch 27

Epoch:  54%|█████▍    | 27/50 [31:07<26:30, 69.16s/it]

=======best f entity level========

Epoch: 18, P: 0.927986, R: 0.892964, F: 0.910138, OOV: 0.801746, GEO: 0.885073, GEO_N: 0.850936


=======best f entity level========
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
./models/self_bert_wm_av_3_score_0.7_0.816_2024-12-24-19-49-19/model.pt
  0%|          | 0/62 [00:00<?, ?it/s]/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|▏         | 1/62 [00:04<04:52,  4.80s/it]  3%|▎         | 2/62 [00:06<02:55,  2.93s/it]  5%|▍         | 3/62 [00:07<02:13,  2.26s/it]  6%|▋         | 4/62 [00:09<01:58,  2.04s/it]  8%|▊         | 5/62 [00:11<01:51,  1.96s/it] 10%|▉         | 6/62 [00:13<01:47,  1.92s/it] 11%|█▏        | 7/62 [00:14<01:32,  1.68s/it] 13%|█▎        | 8/62 [00:15<01:24,  1.56s/it] 15%|█▍        | 9/62 [00:17<01:26,  1.62s/it] 16%|█▌        | 10/62 [00:19<01:22,  1.59s/it] 18%|█▊        | 11/62 [00:21<01:28,  1.74s/it] 19%|█▉        | 12/62 [00:22<01:21,  1.63s/it] 21%|██        | 13/62 [00:24<01:25,  1.75s/it] 23%|██▎       | 14/62 [00:26<01:24,  1.77s/it] 24%|██▍       | 15/62 [00:27<01:20,  1.70s/it] 26%|██▌       | 16/62 [00:28<01:10,  1.53s/it] 27%|██▋       | 17/62 [00:30<01:05,  1.45s/it] 29%|██▉       | 18/62 [00:31<01:07,  1.54s/it] 31%|███       | 19/62 [00:34<01:15,  1.75s/it] 32%|███▏      | 20/62 [00:36<01:19,  1.89s/it] 34%|███▍      | 21/62 [00:39<01:27,  2.14s/it] 35%|███▌      | 22/62 [00:40<01:19,  1.99s/it] 37%|███▋      | 23/62 [00:41<01:08,  1.75s/it] 39%|███▊      | 24/62 [00:43<01:08,  1.81s/it] 40%|████      | 25/62 [00:47<01:20,  2.19s/it] 42%|████▏     | 26/62 [00:49<01:16,  2.13s/it] 44%|████▎     | 27/62 [00:50<01:09,  1.99s/it] 45%|████▌     | 28/62 [00:52<01:05,  1.93s/it] 47%|████▋     | 29/62 [00:54<01:03,  1.92s/it] 48%|████▊     | 30/62 [00:55<00:57,  1.80s/it] 50%|█████     | 31/62 [00:57<00:54,  1.77s/it] 52%|█████▏    | 32/62 [00:58<00:48,  1.61s/it] 53%|█████▎    | 33/62 [01:00<00:49,  1.72s/it] 55%|█████▍    | 34/62 [01:02<00:50,  1.80s/it] 56%|█████▋    | 35/62 [01:04<00:46,  1.73s/it] 58%|█████▊    | 36/62 [01:05<00:41,  1.61s/it] 60%|█████▉    | 37/62 [01:06<00:35,  1.44s/it] 61%|██████▏   | 38/62 [01:08<00:35,  1.47s/it] 63%|██████▎   | 39/62 [01:10<00:36,  1.60s/it] 65%|██████▍   | 40/62 [01:11<00:34,  1.58s/it] 66%|██████▌   | 41/62 [01:13<00:32,  1.56s/it] 68%|██████▊   | 42/62 [01:14<00:30,  1.54s/it] 69%|██████▉   | 43/62 [01:16<00:30,  1.63s/it] 71%|███████   | 44/62 [01:18<00:28,  1.58s/it] 73%|███████▎  | 45/62 [01:20<00:31,  1.85s/it] 74%|███████▍  | 46/62 [01:21<00:26,  1.67s/it] 76%|███████▌  | 47/62 [01:23<00:24,  1.60s/it] 77%|███████▋  | 48/62 [01:24<00:22,  1.58s/it] 79%|███████▉  | 49/62 [01:26<00:23,  1.79s/it] 81%|████████  | 50/62 [01:28<00:20,  1.70s/it] 82%|████████▏ | 51/62 [01:30<00:18,  1.71s/it] 84%|████████▍ | 52/62 [01:32<00:17,  1.74s/it] 85%|████████▌ | 53/62 [01:34<00:18,  2.01s/it] 87%|████████▋ | 54/62 [01:36<00:14,  1.86s/it] 89%|████████▊ | 55/62 [01:37<00:12,  1.75s/it] 90%|█████████ | 56/62 [01:39<00:09,  1.64s/it] 92%|█████████▏| 57/62 [01:40<00:07,  1.58s/it] 94%|█████████▎| 58/62 [01:41<00:06,  1.54s/it] 95%|█████████▌| 59/62 [01:43<00:04,  1.54s/it] 97%|█████████▋| 60/62 [01:44<00:02,  1.47s/it] 98%|█████████▊| 61/62 [01:46<00:01,  1.65s/it]100%|██████████| 62/62 [01:48<00:00,  1.60s/it]100%|██████████| 62/62 [01:48<00:00,  1.75s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/home/testcross/projects/models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0.7_0.817', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

 12%|█▎        | 1/8 [00:09<01:07,  9.58s/it][A
 25%|██▌       | 2/8 [00:16<00:47,  7.98s/it][A
 38%|███▊      | 3/8 [00:23<00:36,  7.40s/it][A
 50%|█████     | 4/8 [00:29<00:28,  7.06s/it][A
 62%|██████▎   | 5/8 [00:36<00:20,  6.89s/it][A
 75%|███████▌  | 6/8 [00:43<00:13,  6.90s/it][A
 88%|████████▊ | 7/8 [00:49<00:06,  6.87s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.11s/it][A100%|██████████| 8/8 [00:54<00:00,  6.81s/it]
OOV: 0.667529
GEO: 0.557870
=======entity level========

Epoch: 1, P: 0.825303, R: 0.785181, F: 0.804742, OOV: 0.667529, GEO: 0.557870
=======entity level========
Epoch:   2%|▏         | 1/50 [01:06<54:40, 66.94s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.60s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.57s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.56s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.68s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.79s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.88s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.83s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.08s/it][A100%|██████████| 8/8 [00:51<00:00,  6.47s/it]
OOV: 0.775873
GEO: 0.855263
=======entity level========

Epoch: 2, P: 0.917619, R: 0.872814, F: 0.894656, OOV: 0.775873, GEO: 0.855263
=======entity level========
Epoch:   4%|▍         | 2/50 [02:11<52:30, 65.63s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.73s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.02s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.75s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.83s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.79s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.79s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.71s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.11s/it][A100%|██████████| 8/8 [00:52<00:00,  6.53s/it]
OOV: 0.801746
GEO: 0.862001
=======entity level========

Epoch: 3, P: 0.925135, R: 0.891898, F: 0.908213, OOV: 0.801746, GEO: 0.862001
=======entity level========
Epoch:   6%|▌         | 3/50 [03:17<51:25, 65.65s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.75s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.68s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.99s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.74s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.76s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.63s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.92s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.789780
GEO: 0.862409
=======entity level========

Epoch: 4, P: 0.926112, R: 0.885928, F: 0.905574, OOV: 0.789780, GEO: 0.862409
=======entity level========
Epoch:   8%|▊         | 4/50 [04:21<50:00, 65.22s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.68s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.56s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.54s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.71s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.80s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.85s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.76s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.09s/it][A100%|██████████| 8/8 [00:51<00:00,  6.47s/it]
OOV: 0.800129
GEO: 0.857515
=======entity level========

Epoch: 5, P: 0.924589, R: 0.892751, F: 0.908391, OOV: 0.800129, GEO: 0.857515
=======entity level========
Epoch:  10%|█         | 5/50 [05:24<48:11, 64.26s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.59s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.67s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.63s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.84s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.85s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.89s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.88s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.11s/it][A100%|██████████| 8/8 [00:52<00:00,  6.53s/it]
OOV: 0.789780
GEO: 0.865043
=======entity level========

Epoch: 6, P: 0.927192, R: 0.885181, F: 0.905699, OOV: 0.789780, GEO: 0.865043
=======entity level========
Epoch:  12%|█▏        | 6/50 [06:29<47:25, 64.68s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.79s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.79s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.73s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.94s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.90s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.81s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.76s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.00s/it][A100%|██████████| 8/8 [00:52<00:00,  6.50s/it]
OOV: 0.807568
GEO: 0.869679
=======entity level========

Epoch: 7, P: 0.927381, R: 0.895842, F: 0.911339, OOV: 0.807568, GEO: 0.869679
=======entity level========
Epoch:  14%|█▍        | 7/50 [07:34<46:24, 64.75s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.81s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.10s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.82s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.77s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.83s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.86s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.77s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.15s/it][A100%|██████████| 8/8 [00:52<00:00,  6.57s/it]
OOV: 0.792044
GEO: 0.866755
=======entity level========

Epoch: 8, P: 0.925197, R: 0.887420, F: 0.905915, OOV: 0.792044, GEO: 0.866755
=======entity level========
Epoch:  16%|█▌        | 8/50 [08:38<45:03, 64.36s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.88s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.73s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.86s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.79s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.90s/it][A
 75%|███████▌  | 6/8 [00:41<00:14,  7.12s/it][A
 88%|████████▊ | 7/8 [00:48<00:07,  7.04s/it][A
100%|██████████| 8/8 [00:53<00:00,  6.22s/it][A100%|██████████| 8/8 [00:53<00:00,  6.65s/it]
OOV: 0.803040
GEO: 0.859375
=======entity level========

Epoch: 9, P: 0.928185, R: 0.895629, F: 0.911616, OOV: 0.803040, GEO: 0.859375
=======entity level========
Epoch:  18%|█▊        | 9/50 [09:42<43:55, 64.27s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.47s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.54s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.83s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.73s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.77s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.85s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.13s/it][A100%|██████████| 8/8 [00:51<00:00,  6.49s/it]
OOV: 0.801100
GEO: 0.865925
=======entity level========

Epoch: 10, P: 0.927299, R: 0.893390, F: 0.910029, OOV: 0.801100, GEO: 0.865925
=======entity level========
Epoch:  20%|██        | 10/50 [10:45<42:34, 63.86s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.75s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.97s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.99s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.84s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.75s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.81s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.90s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.22s/it][A100%|██████████| 8/8 [00:52<00:00,  6.61s/it]
OOV: 0.800776
GEO: 0.869337
=======entity level========

Epoch: 11, P: 0.928089, R: 0.892964, F: 0.910187, OOV: 0.800776, GEO: 0.869337
=======entity level========
Epoch:  22%|██▏       | 11/50 [11:49<41:29, 63.84s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.01s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.91s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.85s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.92s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.83s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.88s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.82s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.08s/it][A100%|██████████| 8/8 [00:52<00:00,  6.57s/it]
OOV: 0.792691
GEO: 0.868820
=======entity level========

Epoch: 12, P: 0.926379, R: 0.888060, F: 0.906815, OOV: 0.792691, GEO: 0.868820
=======entity level========
Epoch:  24%|██▍       | 12/50 [12:52<40:20, 63.70s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:51,  7.36s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.02s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.72s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.72s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.79s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.82s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.77s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.25s/it][A100%|██████████| 8/8 [00:52<00:00,  6.60s/it]
OOV: 0.793338
GEO: 0.873684
=======entity level========

Epoch: 13, P: 0.928945, R: 0.889232, F: 0.908655, OOV: 0.793338, GEO: 0.873684
=======entity level========
Epoch:  26%|██▌       | 13/50 [13:58<39:44, 64.45s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.56s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.97s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.84s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.88s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.82s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.82s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.79s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.17s/it][A100%|██████████| 8/8 [00:52<00:00,  6.57s/it]
OOV: 0.790103
GEO: 0.875248
=======entity level========

Epoch: 14, P: 0.927615, R: 0.886674, F: 0.906683, OOV: 0.790103, GEO: 0.875248
=======entity level========
Epoch:  28%|██▊       | 14/50 [15:04<38:55, 64.88s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.04s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.94s/it][A
 38%|███▊      | 3/8 [00:21<00:35,  7.07s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.77s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.71s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.68s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.57s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.07s/it][A100%|██████████| 8/8 [00:52<00:00,  6.50s/it]
OOV: 0.802070
GEO: 0.872536
=======entity level========

Epoch: 15, P: 0.927900, R: 0.894563, F: 0.910927, OOV: 0.802070, GEO: 0.872536
=======entity level========
Epoch:  30%|███       | 15/50 [16:07<37:29, 64.27s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.84s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.10s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.88s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.80s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.75s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.66s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.53s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.90s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.803687
GEO: 0.877216
=======entity level========

Epoch: 16, P: 0.924884, R: 0.893923, F: 0.909140, OOV: 0.803687, GEO: 0.877216
=======entity level========
Epoch:  32%|███▏      | 16/50 [17:12<36:31, 64.44s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.26s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.06s/it][A
 38%|███▊      | 3/8 [00:21<00:34,  6.96s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.94s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.85s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.75s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.76s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.06s/it][A100%|██████████| 8/8 [00:52<00:00,  6.56s/it]
OOV: 0.798512
GEO: 0.878628
=======entity level========

Epoch: 17, P: 0.926267, R: 0.890618, F: 0.908093, OOV: 0.798512, GEO: 0.878628
=======entity level========
Epoch:  34%|███▍      | 17/50 [18:18<35:40, 64.88s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.11s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.60s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.59s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.67s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.58s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.78s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.82s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.14s/it][A100%|██████████| 8/8 [00:51<00:00,  6.49s/it]
OOV: 0.799806
GEO: 0.871626
=======entity level========

Epoch: 18, P: 0.925447, R: 0.893284, F: 0.909081, OOV: 0.799806, GEO: 0.871626
=======entity level========
Epoch:  36%|███▌      | 18/50 [19:21<34:17, 64.30s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.72s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.95s/it][A
 38%|███▊      | 3/8 [00:20<00:35,  7.02s/it][A
 50%|█████     | 4/8 [00:28<00:28,  7.05s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.96s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.88s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.79s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.05s/it][A100%|██████████| 8/8 [00:52<00:00,  6.58s/it]
OOV: 0.794631
GEO: 0.879526
=======entity level========

Epoch: 19, P: 0.926431, R: 0.890085, F: 0.907895, OOV: 0.794631, GEO: 0.879526
=======entity level========
Epoch:  38%|███▊      | 19/50 [20:27<33:28, 64.78s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.63s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.63s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.77s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.90s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.94s/it][A
 75%|███████▌  | 6/8 [00:41<00:14,  7.01s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.96s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.12s/it][A100%|██████████| 8/8 [00:52<00:00,  6.58s/it]
OOV: 0.805304
GEO: 0.876066
=======entity level========

Epoch: 20, P: 0.926523, R: 0.895309, F: 0.910648, OOV: 0.805304, GEO: 0.876066
=======entity level========
Epoch:  40%|████      | 20/50 [21:30<32:12, 64.43s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.70s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.71s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.71s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.83s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.90s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.88s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.96s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.22s/it][A100%|██████████| 8/8 [00:52<00:00,  6.59s/it]
OOV: 0.803364
GEO: 0.879106
=======entity level========

Epoch: 21, P: 0.925750, R: 0.894563, F: 0.909889, OOV: 0.803364, GEO: 0.879106
=======entity level========
Epoch:  42%|████▏     | 21/50 [22:34<31:01, 64.18s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.82s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.74s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.69s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.78s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.76s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.72s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.79s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.11s/it][A100%|██████████| 8/8 [00:52<00:00,  6.50s/it]
OOV: 0.797219
GEO: 0.874425
=======entity level========

Epoch: 22, P: 0.927146, R: 0.891365, F: 0.908903, OOV: 0.797219, GEO: 0.874425
=======entity level========
Epoch:  44%|████▍     | 22/50 [23:37<29:45, 63.79s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.52s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.49s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.58s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.73s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.57s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.64s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.64s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.38s/it]
OOV: 0.799806
GEO: 0.879106
=======entity level========

Epoch: 23, P: 0.925799, R: 0.892537, F: 0.908864, OOV: 0.799806, GEO: 0.879106
=======entity level========
Epoch:  46%|████▌     | 23/50 [24:39<28:27, 63.23s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.96s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.66s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.68s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.61s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.49s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.66s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.72s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.08s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.796895
GEO: 0.870650
=======entity level========

Epoch: 24, P: 0.927311, R: 0.890832, F: 0.908705, OOV: 0.796895, GEO: 0.870650
=======entity level========
Epoch:  48%|████▊     | 24/50 [25:41<27:16, 62.93s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.69s/it][A
 25%|██▌       | 2/8 [00:13<00:38,  6.49s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.57s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.63s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.72s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.80s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.00s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.792044
GEO: 0.873761
=======entity level========

Epoch: 25, P: 0.927250, R: 0.887313, F: 0.906842, OOV: 0.792044, GEO: 0.873761
=======entity level========
Epoch:  50%|█████     | 25/50 [26:43<26:06, 62.66s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.60s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.70s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.72s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.72s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.64s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.66s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.97s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.792367
GEO: 0.872607
=======entity level========

Epoch: 26, P: 0.926371, R: 0.887953, F: 0.906755, OOV: 0.792367, GEO: 0.872607
=======entity level========
Epoch:  52%|█████▏    | 26/50 [27:45<24:59, 62.48s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.63s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.65s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.49s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.62s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.61s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.81s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.78s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.797219
GEO: 0.869737
=======entity level========

Epoch: 27, P: 0.926402, R: 0.891045, F: 0.908380, OOV: 0.797219, GEO: 0.869737
=======entity level========
Epoch:  54%|█████▍    | 27/50 [28:47<23:55, 62.39s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.84s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.69s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.62s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.55s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.63s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.74s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.99s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.800453
GEO: 0.868766
=======entity level========

Epoch: 28, P: 0.925942, R: 0.893070, F: 0.909209, OOV: 0.800453, GEO: 0.868766
=======entity level========
Epoch:  56%|█████▌    | 28/50 [29:49<22:49, 62.24s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.89s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.65s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.70s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.85s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.65s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.98s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.801423
GEO: 0.868938
=======entity level========

Epoch: 29, P: 0.926843, R: 0.894136, F: 0.910196, OOV: 0.801423, GEO: 0.868938
=======entity level========

Early stop triggered at epoch 28

Epoch:  56%|█████▌    | 28/50 [30:51<24:14, 66.13s/it]

=======best f entity level========

Epoch: 19, P: 0.926431, R: 0.890085, F: 0.907895, OOV: 0.794631, GEO: 0.879526, GEO_N: 0.847669


=======best f entity level========
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
./models/self_bert_wm_av_3_score_0.7_0.817_2024-12-24-20-22-56/model.pt
  0%|          | 0/62 [00:00<?, ?it/s]/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|▏         | 1/62 [00:04<04:51,  4.78s/it]  3%|▎         | 2/62 [00:06<02:55,  2.92s/it]  5%|▍         | 3/62 [00:07<02:13,  2.26s/it]  6%|▋         | 4/62 [00:09<01:57,  2.03s/it]  8%|▊         | 5/62 [00:11<01:51,  1.96s/it] 10%|▉         | 6/62 [00:13<01:47,  1.92s/it] 11%|█▏        | 7/62 [00:14<01:32,  1.69s/it] 13%|█▎        | 8/62 [00:15<01:24,  1.57s/it] 15%|█▍        | 9/62 [00:17<01:26,  1.62s/it] 16%|█▌        | 10/62 [00:19<01:22,  1.59s/it] 18%|█▊        | 11/62 [00:21<01:29,  1.75s/it] 19%|█▉        | 12/62 [00:22<01:21,  1.63s/it] 21%|██        | 13/62 [00:24<01:25,  1.75s/it] 23%|██▎       | 14/62 [00:26<01:24,  1.76s/it] 24%|██▍       | 15/62 [00:27<01:20,  1.71s/it] 26%|██▌       | 16/62 [00:28<01:10,  1.52s/it] 27%|██▋       | 17/62 [00:30<01:04,  1.44s/it] 29%|██▉       | 18/62 [00:31<01:07,  1.54s/it] 31%|███       | 19/62 [00:34<01:15,  1.75s/it] 32%|███▏      | 20/62 [00:36<01:19,  1.89s/it] 34%|███▍      | 21/62 [00:39<01:27,  2.14s/it] 35%|███▌      | 22/62 [00:40<01:19,  1.99s/it] 37%|███▋      | 23/62 [00:42<01:08,  1.76s/it] 39%|███▊      | 24/62 [00:43<01:08,  1.81s/it] 40%|████      | 25/62 [00:47<01:20,  2.19s/it] 42%|████▏     | 26/62 [00:49<01:16,  2.13s/it] 44%|████▎     | 27/62 [00:50<01:09,  1.99s/it] 45%|████▌     | 28/62 [00:52<01:05,  1.93s/it] 47%|████▋     | 29/62 [00:54<01:03,  1.92s/it] 48%|████▊     | 30/62 [00:55<00:57,  1.80s/it] 50%|█████     | 31/62 [00:57<00:54,  1.77s/it] 52%|█████▏    | 32/62 [00:58<00:48,  1.60s/it] 53%|█████▎    | 33/62 [01:00<00:49,  1.72s/it] 55%|█████▍    | 34/62 [01:02<00:50,  1.80s/it] 56%|█████▋    | 35/62 [01:04<00:46,  1.73s/it] 58%|█████▊    | 36/62 [01:05<00:41,  1.61s/it] 60%|█████▉    | 37/62 [01:06<00:35,  1.44s/it] 61%|██████▏   | 38/62 [01:08<00:35,  1.47s/it] 63%|██████▎   | 39/62 [01:10<00:36,  1.61s/it] 65%|██████▍   | 40/62 [01:11<00:34,  1.59s/it] 66%|██████▌   | 41/62 [01:13<00:32,  1.56s/it] 68%|██████▊   | 42/62 [01:14<00:30,  1.55s/it] 69%|██████▉   | 43/62 [01:16<00:30,  1.63s/it] 71%|███████   | 44/62 [01:18<00:28,  1.58s/it] 73%|███████▎  | 45/62 [01:20<00:31,  1.85s/it] 74%|███████▍  | 46/62 [01:21<00:26,  1.67s/it] 76%|███████▌  | 47/62 [01:23<00:24,  1.61s/it] 77%|███████▋  | 48/62 [01:24<00:22,  1.58s/it] 79%|███████▉  | 49/62 [01:27<00:23,  1.79s/it] 81%|████████  | 50/62 [01:28<00:20,  1.70s/it] 82%|████████▏ | 51/62 [01:30<00:18,  1.72s/it] 84%|████████▍ | 52/62 [01:32<00:17,  1.75s/it] 85%|████████▌ | 53/62 [01:34<00:18,  2.01s/it] 87%|████████▋ | 54/62 [01:36<00:14,  1.86s/it] 89%|████████▊ | 55/62 [01:37<00:12,  1.75s/it] 90%|█████████ | 56/62 [01:39<00:09,  1.64s/it] 92%|█████████▏| 57/62 [01:40<00:07,  1.58s/it] 94%|█████████▎| 58/62 [01:41<00:06,  1.54s/it] 95%|█████████▌| 59/62 [01:43<00:04,  1.54s/it] 97%|█████████▋| 60/62 [01:44<00:02,  1.47s/it] 98%|█████████▊| 61/62 [01:46<00:01,  1.65s/it]100%|██████████| 62/62 [01:48<00:00,  1.61s/it]100%|██████████| 62/62 [01:48<00:00,  1.75s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/home/testcross/projects/models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0.7_0.818', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

 12%|█▎        | 1/8 [00:09<01:07,  9.60s/it][A
 25%|██▌       | 2/8 [00:16<00:47,  7.99s/it][A
 38%|███▊      | 3/8 [00:23<00:36,  7.39s/it][A
 50%|█████     | 4/8 [00:29<00:28,  7.04s/it][A
 62%|██████▎   | 5/8 [00:36<00:20,  6.86s/it][A
 75%|███████▌  | 6/8 [00:43<00:13,  6.87s/it][A
 88%|████████▊ | 7/8 [00:49<00:06,  6.87s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.16s/it][A100%|██████████| 8/8 [00:54<00:00,  6.82s/it]
OOV: 0.668499
GEO: 0.552161
=======entity level========

Epoch: 1, P: 0.826033, R: 0.786141, F: 0.805593, OOV: 0.668499, GEO: 0.552161
=======entity level========
Epoch:   2%|▏         | 1/50 [01:07<54:45, 67.05s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.58s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.54s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.53s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.66s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.76s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.86s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.81s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.07s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.775873
GEO: 0.864116
=======entity level========

Epoch: 2, P: 0.917564, R: 0.872175, F: 0.894294, OOV: 0.775873, GEO: 0.864116
=======entity level========
Epoch:   4%|▍         | 2/50 [02:12<52:41, 65.86s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.74s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  7.00s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.72s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.77s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.75s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.74s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.62s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.01s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.802393
GEO: 0.860131
=======entity level========

Epoch: 3, P: 0.924633, R: 0.892004, F: 0.908025, OOV: 0.802393, GEO: 0.860131
=======entity level========
Epoch:   6%|▌         | 3/50 [03:14<50:22, 64.32s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.69s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.67s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.98s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.77s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.78s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.69s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.95s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.786869
GEO: 0.857143
=======entity level========

Epoch: 4, P: 0.926323, R: 0.884648, F: 0.905006, OOV: 0.786869, GEO: 0.857143
=======entity level========
Epoch:   8%|▊         | 4/50 [04:16<48:41, 63.50s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.63s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.56s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.56s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.61s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.73s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.79s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.71s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.06s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.793014
GEO: 0.858447
=======entity level========

Epoch: 5, P: 0.923716, R: 0.889446, F: 0.906257, OOV: 0.793014, GEO: 0.858447
=======entity level========
Epoch:  10%|█         | 5/50 [05:19<47:18, 63.07s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.50s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.72s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.73s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.95s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.90s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.96s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.96s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.20s/it][A100%|██████████| 8/8 [00:52<00:00,  6.60s/it]
OOV: 0.793338
GEO: 0.869165
=======entity level========

Epoch: 6, P: 0.927887, R: 0.887527, F: 0.907258, OOV: 0.793338, GEO: 0.869165
=======entity level========
Epoch:  12%|█▏        | 6/50 [06:24<46:51, 63.90s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.69s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.71s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.72s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.93s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.87s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.77s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.73s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.98s/it][A100%|██████████| 8/8 [00:51<00:00,  6.47s/it]
OOV: 0.803687
GEO: 0.873608
=======entity level========

Epoch: 7, P: 0.926654, R: 0.894350, F: 0.910215, OOV: 0.803687, GEO: 0.873608
=======entity level========
Epoch:  14%|█▍        | 7/50 [07:29<46:03, 64.26s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.76s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.03s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.69s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.65s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.69s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.60s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.96s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.802070
GEO: 0.870249
=======entity level========

Epoch: 8, P: 0.926344, R: 0.892964, F: 0.909348, OOV: 0.802070, GEO: 0.870249
=======entity level========
Epoch:  16%|█▌        | 8/50 [08:31<44:30, 63.59s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.65s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.50s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.67s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.71s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.86s/it][A
 75%|███████▌  | 6/8 [00:41<00:14,  7.10s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.99s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.18s/it][A100%|██████████| 8/8 [00:52<00:00,  6.57s/it]
OOV: 0.804010
GEO: 0.863844
=======entity level========

Epoch: 9, P: 0.927672, R: 0.895629, F: 0.911369, OOV: 0.804010, GEO: 0.863844
=======entity level========
Epoch:  18%|█▊        | 9/50 [09:35<43:25, 63.55s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.43s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.48s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.76s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.67s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.61s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.76s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.02s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.796572
GEO: 0.878788
=======entity level========

Epoch: 10, P: 0.927834, R: 0.890938, F: 0.909012, OOV: 0.796572, GEO: 0.878788
=======entity level========
Epoch:  20%|██        | 10/50 [10:39<42:33, 63.85s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.62s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.87s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.93s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.79s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.71s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.78s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.09s/it][A100%|██████████| 8/8 [00:52<00:00,  6.50s/it]
OOV: 0.805304
GEO: 0.871326
=======entity level========

Epoch: 11, P: 0.926579, R: 0.896055, F: 0.911062, OOV: 0.805304, GEO: 0.871326
=======entity level========
Epoch:  22%|██▏       | 11/50 [11:42<41:18, 63.54s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.83s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.68s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.64s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.72s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.80s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.77s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.01s/it][A100%|██████████| 8/8 [00:51<00:00,  6.44s/it]
OOV: 0.804010
GEO: 0.874754
=======entity level========

Epoch: 12, P: 0.926867, R: 0.894456, F: 0.910373, OOV: 0.804010, GEO: 0.874754
=======entity level========
Epoch:  24%|██▍       | 12/50 [12:44<40:00, 63.17s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.20s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.82s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.53s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.51s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.55s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.58s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.60s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.13s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.792044
GEO: 0.879367
=======entity level========

Epoch: 13, P: 0.926965, R: 0.887633, F: 0.906873, OOV: 0.792044, GEO: 0.879367
=======entity level========
Epoch:  26%|██▌       | 13/50 [13:49<39:14, 63.65s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.55s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.94s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.75s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.73s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.66s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.65s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.60s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.02s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.794955
GEO: 0.875576
=======entity level========

Epoch: 14, P: 0.927253, R: 0.888699, F: 0.907567, OOV: 0.794955, GEO: 0.875576
=======entity level========
Epoch:  28%|██▊       | 14/50 [14:51<37:55, 63.22s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.04s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.83s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.91s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.67s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.64s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.52s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.02s/it][A100%|██████████| 8/8 [00:51<00:00,  6.44s/it]
OOV: 0.793984
GEO: 0.864084
=======entity level========

Epoch: 15, P: 0.926337, R: 0.890192, F: 0.907905, OOV: 0.793984, GEO: 0.864084
=======entity level========
Epoch:  30%|███       | 15/50 [15:54<36:42, 62.93s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.82s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.07s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.94s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.94s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.86s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.74s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.58s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.93s/it][A100%|██████████| 8/8 [00:51<00:00,  6.48s/it]
OOV: 0.800453
GEO: 0.868146
=======entity level========

Epoch: 16, P: 0.924655, R: 0.893603, F: 0.908864, OOV: 0.800453, GEO: 0.868146
=======entity level========
Epoch:  32%|███▏      | 16/50 [16:56<35:36, 62.83s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.12s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.92s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.76s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.73s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.70s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.65s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.00s/it][A100%|██████████| 8/8 [00:51<00:00,  6.45s/it]
OOV: 0.800776
GEO: 0.879842
=======entity level========

Epoch: 17, P: 0.926106, R: 0.892537, F: 0.909012, OOV: 0.800776, GEO: 0.879842
=======entity level========
Epoch:  34%|███▍      | 17/50 [18:01<34:54, 63.46s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.07s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.60s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.59s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.67s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.55s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.71s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.02s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.800453
GEO: 0.884363
=======entity level========

Epoch: 18, P: 0.928476, R: 0.892644, F: 0.910208, OOV: 0.800453, GEO: 0.884363
=======entity level========
Epoch:  36%|███▌      | 18/50 [19:06<34:00, 63.77s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.51s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.73s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.80s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.85s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.74s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.67s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.97s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.802393
GEO: 0.888596
=======entity level========

Epoch: 19, P: 0.927520, R: 0.893603, F: 0.910246, OOV: 0.802393, GEO: 0.888596
=======entity level========
Epoch:  38%|███▊      | 19/50 [20:10<33:05, 64.04s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.90s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.72s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.78s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.84s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.83s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.85s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.79s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.97s/it][A100%|██████████| 8/8 [00:51<00:00,  6.48s/it]
OOV: 0.801423
GEO: 0.874918
=======entity level========

Epoch: 20, P: 0.928556, R: 0.893710, F: 0.910800, OOV: 0.801423, GEO: 0.874918
=======entity level========
Epoch:  40%|████      | 20/50 [21:13<31:49, 63.66s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.45s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.49s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.50s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.63s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.71s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.79s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.07s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.802717
GEO: 0.876640
=======entity level========

Epoch: 21, P: 0.927403, R: 0.894776, F: 0.910798, OOV: 0.802717, GEO: 0.876640
=======entity level========
Epoch:  42%|████▏     | 21/50 [22:15<30:32, 63.20s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.72s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.70s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.73s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.79s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.79s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.69s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.70s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.05s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.801100
GEO: 0.890646
=======entity level========

Epoch: 22, P: 0.929688, R: 0.893710, F: 0.911344, OOV: 0.801100, GEO: 0.890646
=======entity level========
Epoch:  44%|████▍     | 22/50 [23:20<29:44, 63.74s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.54s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.53s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.60s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.75s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.58s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.66s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.04s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.799806
GEO: 0.873443
=======entity level========

Epoch: 23, P: 0.926881, R: 0.893284, F: 0.909772, OOV: 0.799806, GEO: 0.873443
=======entity level========
Epoch:  46%|████▌     | 23/50 [24:22<28:27, 63.24s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.96s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.67s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.70s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.62s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.47s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.71s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.75s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.11s/it][A100%|██████████| 8/8 [00:51<00:00,  6.45s/it]
OOV: 0.798512
GEO: 0.872870
=======entity level========

Epoch: 24, P: 0.926659, R: 0.893070, F: 0.909555, OOV: 0.798512, GEO: 0.872870
=======entity level========
Epoch:  48%|████▊     | 24/50 [25:25<27:18, 63.01s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.71s/it][A
 25%|██▌       | 2/8 [00:13<00:38,  6.49s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.55s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.62s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.71s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.81s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.70s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.794955
GEO: 0.885224
=======entity level========

Epoch: 25, P: 0.927152, R: 0.890085, F: 0.908240, OOV: 0.794955, GEO: 0.885224
=======entity level========
Epoch:  50%|█████     | 25/50 [26:27<26:08, 62.75s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.66s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.73s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.75s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.74s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.66s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.69s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.69s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.99s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.797865
GEO: 0.881423
=======entity level========

Epoch: 26, P: 0.926648, R: 0.891578, F: 0.908775, OOV: 0.797865, GEO: 0.881423
=======entity level========
Epoch:  52%|█████▏    | 26/50 [27:29<25:02, 62.58s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.69s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.68s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.52s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.63s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.60s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.78s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.77s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.06s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.797542
GEO: 0.882004
=======entity level========

Epoch: 27, P: 0.927400, R: 0.892004, F: 0.909358, OOV: 0.797542, GEO: 0.882004
=======entity level========
Epoch:  54%|█████▍    | 27/50 [28:32<23:58, 62.55s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.05s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.79s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.68s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.58s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.62s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.74s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.98s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.803040
GEO: 0.873608
=======entity level========

Epoch: 28, P: 0.928327, R: 0.894776, F: 0.911243, OOV: 0.803040, GEO: 0.873608
=======entity level========
Epoch:  56%|█████▌    | 28/50 [29:34<22:53, 62.44s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.93s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.67s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.66s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.81s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.63s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.66s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.71s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.01s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.797542
GEO: 0.883476
=======entity level========

Epoch: 29, P: 0.927559, R: 0.892751, F: 0.909822, OOV: 0.797542, GEO: 0.883476
=======entity level========
Epoch:  58%|█████▊    | 29/50 [30:36<21:50, 62.39s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:51,  7.37s/it][A
 25%|██▌       | 2/8 [00:14<00:43,  7.23s/it][A
 38%|███▊      | 3/8 [00:21<00:34,  6.91s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.68s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.62s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.59s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.54s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.97s/it][A100%|██████████| 8/8 [00:51<00:00,  6.45s/it]
OOV: 0.804010
GEO: 0.876640
=======entity level========

Epoch: 30, P: 0.926625, R: 0.895309, F: 0.910698, OOV: 0.804010, GEO: 0.876640
=======entity level========
Epoch:  60%|██████    | 30/50 [31:38<20:47, 62.38s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.90s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.09s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.81s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.79s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.64s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.58s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.86s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.800453
GEO: 0.883476
=======entity level========

Epoch: 31, P: 0.926999, R: 0.893497, F: 0.909940, OOV: 0.800453, GEO: 0.883476
=======entity level========
Epoch:  62%|██████▏   | 31/50 [32:40<19:43, 62.27s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.05s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.77s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.80s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.60s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.62s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.76s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.89s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.797865
GEO: 0.874590
=======entity level========

Epoch: 32, P: 0.927053, R: 0.892857, F: 0.909634, OOV: 0.797865, GEO: 0.874590
=======entity level========

Early stop triggered at epoch 31

Epoch:  62%|██████▏   | 31/50 [33:42<20:39, 65.26s/it]

=======best f entity level========

Epoch: 22, P: 0.929688, R: 0.893710, F: 0.911344, OOV: 0.801100, GEO: 0.890646, GEO_N: 0.853865


=======best f entity level========
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
./models/self_bert_wm_av_3_score_0.7_0.818_2024-12-24-20-56-13/model.pt
  0%|          | 0/62 [00:00<?, ?it/s]/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|▏         | 1/62 [00:04<04:53,  4.81s/it]  3%|▎         | 2/62 [00:06<02:56,  2.94s/it]  5%|▍         | 3/62 [00:07<02:13,  2.27s/it]  6%|▋         | 4/62 [00:09<01:58,  2.04s/it]  8%|▊         | 5/62 [00:11<01:51,  1.96s/it] 10%|▉         | 6/62 [00:13<01:47,  1.92s/it] 11%|█▏        | 7/62 [00:14<01:32,  1.69s/it] 13%|█▎        | 8/62 [00:15<01:24,  1.57s/it] 15%|█▍        | 9/62 [00:17<01:26,  1.63s/it] 16%|█▌        | 10/62 [00:19<01:22,  1.59s/it] 18%|█▊        | 11/62 [00:21<01:29,  1.75s/it] 19%|█▉        | 12/62 [00:22<01:21,  1.63s/it] 21%|██        | 13/62 [00:24<01:25,  1.75s/it] 23%|██▎       | 14/62 [00:26<01:25,  1.77s/it] 24%|██▍       | 15/62 [00:27<01:20,  1.71s/it] 26%|██▌       | 16/62 [00:29<01:10,  1.53s/it] 27%|██▋       | 17/62 [00:30<01:05,  1.44s/it] 29%|██▉       | 18/62 [00:32<01:07,  1.54s/it] 31%|███       | 19/62 [00:34<01:15,  1.75s/it] 32%|███▏      | 20/62 [00:36<01:19,  1.89s/it] 34%|███▍      | 21/62 [00:39<01:27,  2.15s/it] 35%|███▌      | 22/62 [00:40<01:19,  1.99s/it] 37%|███▋      | 23/62 [00:42<01:08,  1.76s/it] 39%|███▊      | 24/62 [00:44<01:08,  1.81s/it] 40%|████      | 25/62 [00:47<01:21,  2.19s/it] 42%|████▏     | 26/62 [00:49<01:16,  2.13s/it] 44%|████▎     | 27/62 [00:50<01:09,  1.99s/it] 45%|████▌     | 28/62 [00:52<01:05,  1.93s/it] 47%|████▋     | 29/62 [00:54<01:03,  1.92s/it] 48%|████▊     | 30/62 [00:55<00:57,  1.80s/it] 50%|█████     | 31/62 [00:57<00:54,  1.77s/it] 52%|█████▏    | 32/62 [00:58<00:48,  1.60s/it] 53%|█████▎    | 33/62 [01:00<00:49,  1.72s/it] 55%|█████▍    | 34/62 [01:02<00:50,  1.80s/it] 56%|█████▋    | 35/62 [01:04<00:46,  1.73s/it] 58%|█████▊    | 36/62 [01:05<00:41,  1.60s/it] 60%|█████▉    | 37/62 [01:06<00:35,  1.43s/it] 61%|██████▏   | 38/62 [01:08<00:35,  1.46s/it] 63%|██████▎   | 39/62 [01:10<00:36,  1.61s/it] 65%|██████▍   | 40/62 [01:11<00:34,  1.59s/it] 66%|██████▌   | 41/62 [01:13<00:32,  1.56s/it] 68%|██████▊   | 42/62 [01:14<00:30,  1.55s/it] 69%|██████▉   | 43/62 [01:16<00:31,  1.63s/it] 71%|███████   | 44/62 [01:18<00:28,  1.59s/it] 73%|███████▎  | 45/62 [01:20<00:31,  1.85s/it] 74%|███████▍  | 46/62 [01:21<00:26,  1.67s/it] 76%|███████▌  | 47/62 [01:23<00:24,  1.60s/it] 77%|███████▋  | 48/62 [01:24<00:22,  1.58s/it] 79%|███████▉  | 49/62 [01:27<00:23,  1.79s/it] 81%|████████  | 50/62 [01:28<00:20,  1.70s/it] 82%|████████▏ | 51/62 [01:30<00:18,  1.71s/it] 84%|████████▍ | 52/62 [01:32<00:17,  1.74s/it] 85%|████████▌ | 53/62 [01:34<00:18,  2.01s/it] 87%|████████▋ | 54/62 [01:36<00:14,  1.86s/it] 89%|████████▊ | 55/62 [01:37<00:12,  1.75s/it] 90%|█████████ | 56/62 [01:39<00:09,  1.64s/it] 92%|█████████▏| 57/62 [01:40<00:07,  1.58s/it] 94%|█████████▎| 58/62 [01:42<00:06,  1.54s/it] 95%|█████████▌| 59/62 [01:43<00:04,  1.54s/it] 97%|█████████▋| 60/62 [01:44<00:02,  1.47s/it] 98%|█████████▊| 61/62 [01:46<00:01,  1.65s/it]100%|██████████| 62/62 [01:48<00:00,  1.61s/it]100%|██████████| 62/62 [01:48<00:00,  1.75s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/home/testcross/projects/models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0.7_0.819', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

 12%|█▎        | 1/8 [00:09<01:06,  9.56s/it][A
 25%|██▌       | 2/8 [00:16<00:47,  7.99s/it][A
 38%|███▊      | 3/8 [00:23<00:36,  7.39s/it][A
 50%|█████     | 4/8 [00:29<00:28,  7.04s/it][A
 62%|██████▎   | 5/8 [00:36<00:20,  6.87s/it][A
 75%|███████▌  | 6/8 [00:43<00:13,  6.90s/it][A
 88%|████████▊ | 7/8 [00:50<00:06,  6.92s/it][A
100%|██████████| 8/8 [00:54<00:00,  6.15s/it][A100%|██████████| 8/8 [00:54<00:00,  6.83s/it]
OOV: 0.667529
GEO: 0.551843
=======entity level========

Epoch: 1, P: 0.824754, R: 0.785714, F: 0.804761, OOV: 0.667529, GEO: 0.551843
=======entity level========
Epoch:   2%|▏         | 1/50 [01:07<54:45, 67.06s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.62s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.56s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.54s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.67s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.72s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.76s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.93s/it][A100%|██████████| 8/8 [00:51<00:00,  6.38s/it]
OOV: 0.776520
GEO: 0.861660
=======entity level========

Epoch: 2, P: 0.917844, R: 0.873028, F: 0.894875, OOV: 0.776520, GEO: 0.861660
=======entity level========
Epoch:   4%|▍         | 2/50 [02:11<52:21, 65.45s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.74s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.02s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.81s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.90s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.90s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.91s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.78s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.13s/it][A100%|██████████| 8/8 [00:52<00:00,  6.58s/it]
OOV: 0.798836
GEO: 0.856397
=======entity level========

Epoch: 3, P: 0.924566, R: 0.891151, F: 0.907551, OOV: 0.798836, GEO: 0.856397
=======entity level========
Epoch:   6%|▌         | 3/50 [03:14<50:33, 64.54s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.66s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.69s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.99s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.76s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.68s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.65s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.93s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.787516
GEO: 0.857895
=======entity level========

Epoch: 4, P: 0.925975, R: 0.885501, F: 0.905286, OOV: 0.787516, GEO: 0.857895
=======entity level========
Epoch:   8%|▊         | 4/50 [04:17<48:46, 63.62s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.64s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.56s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.57s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.61s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.66s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.65s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.02s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.801746
GEO: 0.853437
=======entity level========

Epoch: 5, P: 0.924553, R: 0.893603, F: 0.908815, OOV: 0.801746, GEO: 0.853437
=======entity level========
Epoch:  10%|█         | 5/50 [05:19<47:15, 63.02s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.49s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.66s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.63s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.84s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.77s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.82s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.81s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.06s/it][A100%|██████████| 8/8 [00:51<00:00,  6.48s/it]
OOV: 0.802070
GEO: 0.871391
=======entity level========

Epoch: 6, P: 0.928017, R: 0.892004, F: 0.909654, OOV: 0.802070, GEO: 0.871391
=======entity level========
Epoch:  12%|█▏        | 6/50 [06:24<46:44, 63.74s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.70s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.64s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.57s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.80s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.80s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.73s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.72s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.96s/it][A100%|██████████| 8/8 [00:51<00:00,  6.42s/it]
OOV: 0.804334
GEO: 0.856213
=======entity level========

Epoch: 7, P: 0.925322, R: 0.895629, F: 0.910233, OOV: 0.804334, GEO: 0.856213
=======entity level========
Epoch:  14%|█▍        | 7/50 [07:26<45:18, 63.23s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.76s/it][A
 25%|██▌       | 2/8 [00:13<00:42,  7.03s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.69s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.64s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.69s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.73s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.62s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.98s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.797865
GEO: 0.873684
=======entity level========

Epoch: 8, P: 0.926559, R: 0.890405, F: 0.908122, OOV: 0.797865, GEO: 0.873684
=======entity level========
Epoch:  16%|█▌        | 8/50 [08:30<44:34, 63.69s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.66s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.54s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.68s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.61s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.74s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.95s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.87s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.09s/it][A100%|██████████| 8/8 [00:51<00:00,  6.49s/it]
OOV: 0.804657
GEO: 0.865147
=======entity level========

Epoch: 9, P: 0.925705, R: 0.895309, F: 0.910254, OOV: 0.804657, GEO: 0.865147
=======entity level========
Epoch:  18%|█▊        | 9/50 [09:33<43:20, 63.42s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.49s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.54s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.80s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.71s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.74s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.78s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.04s/it][A100%|██████████| 8/8 [00:51<00:00,  6.44s/it]
OOV: 0.794308
GEO: 0.878209
=======entity level========

Epoch: 10, P: 0.926431, R: 0.890085, F: 0.907895, OOV: 0.794308, GEO: 0.878209
=======entity level========
Epoch:  20%|██        | 10/50 [10:38<42:35, 63.89s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.58s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.77s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.83s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.73s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.72s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.84s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.12s/it][A100%|██████████| 8/8 [00:52<00:00,  6.50s/it]
OOV: 0.801100
GEO: 0.870588
=======entity level========

Epoch: 11, P: 0.926069, R: 0.893390, F: 0.909436, OOV: 0.801100, GEO: 0.870588
=======entity level========
Epoch:  22%|██▏       | 11/50 [11:41<41:19, 63.57s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.77s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.66s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.66s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.74s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.66s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.80s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.76s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.45s/it]
OOV: 0.793661
GEO: 0.882431
=======entity level========

Epoch: 12, P: 0.925700, R: 0.888593, F: 0.906767, OOV: 0.793661, GEO: 0.882431
=======entity level========
Epoch:  24%|██▍       | 12/50 [12:46<40:33, 64.04s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:51,  7.34s/it][A
 25%|██▌       | 2/8 [00:14<00:41,  6.99s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.69s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.68s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.70s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.68s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.18s/it][A100%|██████████| 8/8 [00:52<00:00,  6.53s/it]
OOV: 0.802070
GEO: 0.883322
=======entity level========

Epoch: 13, P: 0.927315, R: 0.893603, F: 0.910147, OOV: 0.802070, GEO: 0.883322
=======entity level========
Epoch:  26%|██▌       | 13/50 [13:52<39:45, 64.48s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.59s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.98s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.79s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.76s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.66s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.62s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.45s/it]
OOV: 0.793984
GEO: 0.872536
=======entity level========

Epoch: 14, P: 0.926382, R: 0.889446, F: 0.907538, OOV: 0.793984, GEO: 0.872536
=======entity level========
Epoch:  28%|██▊       | 14/50 [14:54<38:18, 63.85s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.04s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.83s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.92s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.71s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.64s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.52s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.45s/it]
OOV: 0.802070
GEO: 0.879106
=======entity level========

Epoch: 15, P: 0.927607, R: 0.893390, F: 0.910177, OOV: 0.802070, GEO: 0.879106
=======entity level========
Epoch:  30%|███       | 15/50 [15:56<36:58, 63.37s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.86s/it][A
 25%|██▌       | 2/8 [00:14<00:43,  7.20s/it][A
 38%|███▊      | 3/8 [00:21<00:35,  7.02s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.95s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.88s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.82s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.73s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.07s/it][A100%|██████████| 8/8 [00:52<00:00,  6.58s/it]
OOV: 0.809185
GEO: 0.873608
=======entity level========

Epoch: 16, P: 0.926220, R: 0.896695, F: 0.911218, OOV: 0.809185, GEO: 0.873608
=======entity level========
Epoch:  32%|███▏      | 16/50 [17:00<35:56, 63.43s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:50,  7.26s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.94s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.79s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.75s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.72s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.66s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.72s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.49s/it]
OOV: 0.796248
GEO: 0.872870
=======entity level========

Epoch: 17, P: 0.925889, R: 0.891045, F: 0.908133, OOV: 0.796248, GEO: 0.872870
=======entity level========
Epoch:  34%|███▍      | 17/50 [18:03<34:45, 63.21s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.11s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.60s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.59s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.68s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.58s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.72s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.73s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.04s/it][A100%|██████████| 8/8 [00:51<00:00,  6.43s/it]
OOV: 0.796572
GEO: 0.884641
=======entity level========

Epoch: 18, P: 0.927059, R: 0.891578, F: 0.908972, OOV: 0.796572, GEO: 0.884641
=======entity level========
Epoch:  36%|███▌      | 18/50 [19:07<33:57, 63.68s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.57s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.78s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.83s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.87s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.73s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.67s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.97s/it][A100%|██████████| 8/8 [00:51<00:00,  6.44s/it]
OOV: 0.798512
GEO: 0.882159
=======entity level========

Epoch: 19, P: 0.926656, R: 0.891684, F: 0.908834, OOV: 0.798512, GEO: 0.882159
=======entity level========
Epoch:  38%|███▊      | 19/50 [20:10<32:41, 63.27s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.71s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.63s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.78s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.90s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.94s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.95s/it][A
 88%|████████▊ | 7/8 [00:48<00:06,  6.87s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.03s/it][A100%|██████████| 8/8 [00:52<00:00,  6.53s/it]
OOV: 0.799159
GEO: 0.880999
=======entity level========

Epoch: 20, P: 0.927226, R: 0.892431, F: 0.909496, OOV: 0.799159, GEO: 0.880999
=======entity level========
Epoch:  40%|████      | 20/50 [21:13<31:36, 63.22s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:44,  6.41s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.48s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.49s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.61s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.68s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.78s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.07s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.804010
GEO: 0.884363
=======entity level========

Epoch: 21, P: 0.927632, R: 0.895096, F: 0.911074, OOV: 0.804010, GEO: 0.884363
=======entity level========
Epoch:  42%|████▏     | 21/50 [22:15<30:24, 62.92s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.70s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.70s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.75s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.92s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.91s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.83s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.85s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.20s/it][A100%|██████████| 8/8 [00:52<00:00,  6.58s/it]
OOV: 0.795278
GEO: 0.885224
=======entity level========

Epoch: 22, P: 0.927509, R: 0.890725, F: 0.908745, OOV: 0.795278, GEO: 0.885224
=======entity level========
Epoch:  44%|████▍     | 22/50 [23:21<29:47, 63.83s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.56s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.50s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.57s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.72s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.60s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.06s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.794955
GEO: 0.876568
=======entity level========

Epoch: 23, P: 0.926575, R: 0.890618, F: 0.908241, OOV: 0.794955, GEO: 0.876568
=======entity level========
Epoch:  46%|████▌     | 23/50 [24:23<28:29, 63.32s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.00s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.68s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.74s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.65s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.49s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.73s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.09s/it][A100%|██████████| 8/8 [00:51<00:00,  6.45s/it]
OOV: 0.800776
GEO: 0.874590
=======entity level========

Epoch: 24, P: 0.927337, R: 0.892537, F: 0.909605, OOV: 0.800776, GEO: 0.874590
=======entity level========
Epoch:  48%|████▊     | 24/50 [25:26<27:19, 63.05s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.71s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.50s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.55s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.64s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.82s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.92s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.82s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.16s/it][A100%|██████████| 8/8 [00:52<00:00,  6.51s/it]
OOV: 0.798189
GEO: 0.882895
=======entity level========

Epoch: 25, P: 0.927273, R: 0.891684, F: 0.909130, OOV: 0.798189, GEO: 0.882895
=======entity level========
Epoch:  50%|█████     | 25/50 [26:29<26:19, 63.17s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.83s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.91s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.92s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.91s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.79s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.83s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.84s/it][A
100%|██████████| 8/8 [00:52<00:00,  6.11s/it][A100%|██████████| 8/8 [00:52<00:00,  6.57s/it]
OOV: 0.802393
GEO: 0.883629
=======entity level========

Epoch: 26, P: 0.927544, R: 0.893923, F: 0.910423, OOV: 0.802393, GEO: 0.883629
=======entity level========
Epoch:  52%|█████▏    | 26/50 [27:32<25:18, 63.26s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.60s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.62s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.46s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.59s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.59s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.76s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.74s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.00s/it][A100%|██████████| 8/8 [00:51<00:00,  6.38s/it]
OOV: 0.798836
GEO: 0.881423
=======entity level========

Epoch: 27, P: 0.926973, R: 0.891791, F: 0.909042, OOV: 0.798836, GEO: 0.881423
=======entity level========
Epoch:  54%|█████▍    | 27/50 [28:34<24:05, 62.84s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.84s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.75s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.66s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.57s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.62s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.74s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.00s/it][A100%|██████████| 8/8 [00:51<00:00,  6.41s/it]
OOV: 0.796572
GEO: 0.880263
=======entity level========

Epoch: 28, P: 0.927414, R: 0.890832, F: 0.908755, OOV: 0.796572, GEO: 0.880263
=======entity level========
Epoch:  56%|█████▌    | 28/50 [29:37<22:58, 62.67s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.98s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.72s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.71s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.86s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.66s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.74s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.02s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.802717
GEO: 0.877953
=======entity level========

Epoch: 29, P: 0.928698, R: 0.894243, F: 0.911145, OOV: 0.802717, GEO: 0.877953
=======entity level========
Epoch:  58%|█████▊    | 29/50 [30:39<21:54, 62.61s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:51,  7.34s/it][A
 25%|██▌       | 2/8 [00:14<00:43,  7.24s/it][A
 38%|███▊      | 3/8 [00:21<00:34,  6.92s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.72s/it][A
 62%|██████▎   | 5/8 [00:34<00:19,  6.66s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.62s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.55s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.97s/it][A100%|██████████| 8/8 [00:51<00:00,  6.46s/it]
OOV: 0.798836
GEO: 0.881735
=======entity level========

Epoch: 30, P: 0.926856, R: 0.892964, F: 0.909594, OOV: 0.798836, GEO: 0.881735
=======entity level========
Epoch:  60%|██████    | 30/50 [31:42<20:52, 62.61s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.11s/it][A
 25%|██▌       | 2/8 [00:14<00:43,  7.29s/it][A
 38%|███▊      | 3/8 [00:21<00:34,  7.00s/it][A
 50%|█████     | 4/8 [00:28<00:27,  6.94s/it][A
 62%|██████▎   | 5/8 [00:34<00:20,  6.79s/it][A
 75%|███████▌  | 6/8 [00:41<00:13,  6.73s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.65s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.90s/it][A100%|██████████| 8/8 [00:51<00:00,  6.49s/it]
OOV: 0.796895
GEO: 0.881735
=======entity level========

Epoch: 31, P: 0.927249, R: 0.891365, F: 0.908953, OOV: 0.796895, GEO: 0.881735
=======entity level========
Epoch:  62%|██████▏   | 31/50 [32:45<19:50, 62.68s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.00s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.76s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.79s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.60s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.63s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.78s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.70s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.90s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.798512
GEO: 0.880843
=======entity level========

Epoch: 32, P: 0.927456, R: 0.892751, F: 0.909772, OOV: 0.798512, GEO: 0.880843
=======entity level========

Early stop triggered at epoch 31

Epoch:  62%|██████▏   | 31/50 [33:47<20:42, 65.39s/it]

=======best f entity level========

Epoch: 22, P: 0.927509, R: 0.890725, F: 0.908745, OOV: 0.795278, GEO: 0.885224, GEO_N: 0.849800


=======best f entity level========
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
./models/self_bert_wm_av_3_score_0.7_0.819_2024-12-24-21-32-21/model.pt
  0%|          | 0/62 [00:00<?, ?it/s]/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|▏         | 1/62 [00:04<05:02,  4.96s/it]  3%|▎         | 2/62 [00:06<03:03,  3.05s/it]  5%|▍         | 3/62 [00:08<02:19,  2.37s/it]  6%|▋         | 4/62 [00:10<02:03,  2.14s/it]  8%|▊         | 5/62 [00:11<01:57,  2.06s/it] 10%|▉         | 6/62 [00:13<01:53,  2.02s/it] 11%|█▏        | 7/62 [00:15<01:37,  1.77s/it] 13%|█▎        | 8/62 [00:16<01:29,  1.65s/it] 15%|█▍        | 9/62 [00:18<01:30,  1.71s/it] 16%|█▌        | 10/62 [00:19<01:27,  1.68s/it] 18%|█▊        | 11/62 [00:22<01:34,  1.85s/it] 19%|█▉        | 12/62 [00:23<01:25,  1.72s/it] 21%|██        | 13/62 [00:25<01:30,  1.84s/it] 23%|██▎       | 14/62 [00:27<01:29,  1.86s/it] 24%|██▍       | 15/62 [00:29<01:24,  1.79s/it] 26%|██▌       | 16/62 [00:30<01:13,  1.60s/it] 27%|██▋       | 17/62 [00:31<01:07,  1.51s/it] 29%|██▉       | 18/62 [00:33<01:10,  1.61s/it] 31%|███       | 19/62 [00:35<01:19,  1.84s/it] 32%|███▏      | 20/62 [00:38<01:23,  1.99s/it] 34%|███▍      | 21/62 [00:41<01:32,  2.26s/it] 35%|███▌      | 22/62 [00:42<01:23,  2.09s/it] 37%|███▋      | 23/62 [00:44<01:12,  1.85s/it] 39%|███▊      | 24/62 [00:46<01:12,  1.90s/it] 40%|████      | 25/62 [00:49<01:25,  2.31s/it] 42%|████▏     | 26/62 [00:51<01:20,  2.24s/it] 44%|████▎     | 27/62 [00:53<01:13,  2.10s/it] 45%|████▌     | 28/62 [00:55<01:09,  2.03s/it] 47%|████▋     | 29/62 [00:57<01:06,  2.02s/it] 48%|████▊     | 30/62 [00:58<01:00,  1.90s/it] 50%|█████     | 31/62 [01:00<00:57,  1.87s/it] 52%|█████▏    | 32/62 [01:01<00:50,  1.69s/it] 53%|█████▎    | 33/62 [01:03<00:51,  1.78s/it] 55%|█████▍    | 34/62 [01:05<00:51,  1.85s/it] 56%|█████▋    | 35/62 [01:07<00:47,  1.77s/it] 58%|█████▊    | 36/62 [01:08<00:42,  1.64s/it] 60%|█████▉    | 37/62 [01:09<00:36,  1.46s/it] 61%|██████▏   | 38/62 [01:11<00:35,  1.49s/it] 63%|██████▎   | 39/62 [01:13<00:37,  1.62s/it] 65%|██████▍   | 40/62 [01:14<00:35,  1.60s/it] 66%|██████▌   | 41/62 [01:16<00:32,  1.57s/it] 68%|██████▊   | 42/62 [01:17<00:31,  1.55s/it] 69%|██████▉   | 43/62 [01:19<00:31,  1.63s/it] 71%|███████   | 44/62 [01:21<00:28,  1.59s/it] 73%|███████▎  | 45/62 [01:23<00:31,  1.85s/it] 74%|███████▍  | 46/62 [01:24<00:26,  1.67s/it] 76%|███████▌  | 47/62 [01:26<00:24,  1.60s/it] 77%|███████▋  | 48/62 [01:27<00:22,  1.58s/it] 79%|███████▉  | 49/62 [01:30<00:23,  1.79s/it] 81%|████████  | 50/62 [01:31<00:20,  1.70s/it] 82%|████████▏ | 51/62 [01:33<00:18,  1.71s/it] 84%|████████▍ | 52/62 [01:35<00:17,  1.74s/it] 85%|████████▌ | 53/62 [01:37<00:18,  2.01s/it] 87%|████████▋ | 54/62 [01:39<00:14,  1.86s/it] 89%|████████▊ | 55/62 [01:40<00:12,  1.75s/it] 90%|█████████ | 56/62 [01:42<00:09,  1.65s/it] 92%|█████████▏| 57/62 [01:43<00:07,  1.59s/it] 94%|█████████▎| 58/62 [01:45<00:06,  1.54s/it] 95%|█████████▌| 59/62 [01:46<00:04,  1.54s/it] 97%|█████████▋| 60/62 [01:47<00:02,  1.47s/it] 98%|█████████▊| 61/62 [01:50<00:01,  1.65s/it]100%|██████████| 62/62 [01:51<00:00,  1.61s/it]100%|██████████| 62/62 [01:51<00:00,  1.80s/it]
write results to ./data_preprocessing/mydata/larger/self_train.txt
write results tsv to ./data_preprocessing/mydata/larger/self_train.tsv
{'do_train': True, 'do_test': False, 'do_predict': False, 'do_predict_uc': False, 'train_data_path': './data/mydata/larger/train.tsv', 'self_train_data_path': './data_preprocessing/mydata/larger/self_train.tsv', 'eval_data_path': './data/mydata/larger/dev.tsv', 'input_file': None, 'output_file': None, 'output_file_tsv': None, 'use_bert': True, 'use_zen': False, 'bert_model': '/home/testcross/projects/models/bert-base-chinese', 'eval_model': None, 'cache_dir': '', 'max_seq_length': 300, 'max_ngram_size': 300, 'do_lower_case': False, 'train_batch_size': 16, 'eval_batch_size': 16, 'lambda_rate': 0.8, 'c_th': 0.7, 'u_th': 0.8, 'learning_rate': 1e-05, 'num_train_epochs': 50.0, 'warmup_proportion': 0.1, 'no_cuda': False, 'local_rank': -1, 'seed': 42, 'gradient_accumulation_steps': 1, 'fp16': False, 'loss_scale': 0, 'server_ip': '', 'server_port': '', 'patient': 10, 'ngram_num_threshold': 3, 'av_threshold': 1, 'max_ngram_length': 5, 'model_name': 'self_bert_wm_av_3_score_0.7_0.820', 'use_memory': True, 'use_cnn': False, 'decoder': 'softmax', 'ngram_flag': 'av', 'save_top': 1}
device: cuda n_gpu: 2, distributed training: False, 16-bits training: False
# of word in train: 1079: 
# of n-gram in memory: 13466
# of trainable parameters: 112623360
***** Running self-training *****
  Num examples = 120
  Num self-train examples = 1226
  Batch size = 16
  Num steps = 4200
Epoch:   0%|          | 0/50 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A/home/testcross/anaconda3/envs/master/lib/python3.6/site-packages/torch/nn/parallel/_functions.py:61: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '

 12%|█▎        | 1/8 [00:09<01:07,  9.64s/it][A
 25%|██▌       | 2/8 [00:16<00:47,  7.99s/it][A
 38%|███▊      | 3/8 [00:23<00:36,  7.36s/it][A
 50%|█████     | 4/8 [00:29<00:27,  7.00s/it][A
 62%|██████▎   | 5/8 [00:36<00:20,  6.82s/it][A
 75%|███████▌  | 6/8 [00:42<00:13,  6.80s/it][A
 88%|████████▊ | 7/8 [00:49<00:06,  6.77s/it][A
100%|██████████| 8/8 [00:53<00:00,  6.03s/it][A100%|██████████| 8/8 [00:53<00:00,  6.75s/it]
OOV: 0.669146
GEO: 0.554273
=======entity level========

Epoch: 1, P: 0.825328, R: 0.785821, F: 0.805090, OOV: 0.669146, GEO: 0.554273
=======entity level========
Epoch:   2%|▏         | 1/50 [01:06<54:12, 66.37s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.55s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.48s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.47s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.59s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.66s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.62s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.88s/it][A100%|██████████| 8/8 [00:50<00:00,  6.32s/it]
OOV: 0.776520
GEO: 0.859591
=======entity level========

Epoch: 2, P: 0.917217, R: 0.872921, F: 0.894521, OOV: 0.776520, GEO: 0.859591
=======entity level========
Epoch:   4%|▍         | 2/50 [02:10<51:54, 64.88s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.68s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.94s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.65s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.70s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.68s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.55s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.95s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.801100
GEO: 0.865183
=======entity level========

Epoch: 3, P: 0.925495, R: 0.891258, F: 0.908054, OOV: 0.801100, GEO: 0.865183
=======entity level========
Epoch:   6%|▌         | 3/50 [03:14<50:39, 64.66s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.58s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.56s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.88s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.68s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.69s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.61s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.57s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.83s/it][A100%|██████████| 8/8 [00:50<00:00,  6.33s/it]
OOV: 0.783959
GEO: 0.860343
=======entity level========

Epoch: 4, P: 0.926775, R: 0.883795, F: 0.904775, OOV: 0.783959, GEO: 0.860343
=======entity level========
Epoch:   8%|▊         | 4/50 [04:16<48:35, 63.38s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.65s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.52s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.47s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.53s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.62s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.64s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.58s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.95s/it][A100%|██████████| 8/8 [00:50<00:00,  6.33s/it]
OOV: 0.800453
GEO: 0.856400
=======entity level========

Epoch: 5, P: 0.924460, R: 0.893710, F: 0.908825, OOV: 0.800453, GEO: 0.856400
=======entity level========
Epoch:  10%|█         | 5/50 [05:17<47:01, 62.70s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.44s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.56s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.53s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.72s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.68s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.69s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.96s/it][A100%|██████████| 8/8 [00:50<00:00,  6.37s/it]
OOV: 0.794308
GEO: 0.870712
=======entity level========

Epoch: 6, P: 0.927283, R: 0.887740, F: 0.907081, OOV: 0.794308, GEO: 0.870712
=======entity level========
Epoch:  12%|█▏        | 6/50 [06:21<46:25, 63.30s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.62s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.58s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.50s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.73s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.71s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.66s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.91s/it][A100%|██████████| 8/8 [00:50<00:00,  6.36s/it]
OOV: 0.805304
GEO: 0.871728
=======entity level========

Epoch: 7, P: 0.926326, R: 0.895416, F: 0.910609, OOV: 0.805304, GEO: 0.871728
=======entity level========
Epoch:  14%|█▍        | 7/50 [07:26<45:33, 63.58s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.70s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.96s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.64s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.68s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.71s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.58s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.94s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.798836
GEO: 0.871053
=======entity level========

Epoch: 8, P: 0.925667, R: 0.890832, F: 0.907915, OOV: 0.798836, GEO: 0.871053
=======entity level========
Epoch:  16%|█▌        | 8/50 [08:28<44:08, 63.07s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.62s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.46s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.62s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.56s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.70s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.95s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.89s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.15s/it][A100%|██████████| 8/8 [00:51<00:00,  6.49s/it]
OOV: 0.801100
GEO: 0.866142
=======entity level========

Epoch: 9, P: 0.926889, R: 0.893390, F: 0.909831, OOV: 0.801100, GEO: 0.866142
=======entity level========
Epoch:  18%|█▊        | 9/50 [09:31<43:05, 63.05s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:46,  6.60s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.66s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.92s/it][A
 50%|█████     | 4/8 [00:27<00:27,  6.82s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.76s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.79s/it][A
 88%|████████▊ | 7/8 [00:47<00:06,  6.78s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.02s/it][A100%|██████████| 8/8 [00:51<00:00,  6.48s/it]
OOV: 0.804334
GEO: 0.863844
=======entity level========

Epoch: 10, P: 0.926514, R: 0.895203, F: 0.910589, OOV: 0.804334, GEO: 0.863844
=======entity level========
Epoch:  20%|██        | 10/50 [10:33<41:58, 62.97s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.50s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.69s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.72s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.60s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.50s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.56s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.72s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.03s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.792367
GEO: 0.887708
=======entity level========

Epoch: 11, P: 0.926305, R: 0.887100, F: 0.906279, OOV: 0.792367, GEO: 0.887708
=======entity level========
Epoch:  22%|██▏       | 11/50 [11:38<41:13, 63.43s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.77s/it][A
 25%|██▌       | 2/8 [00:12<00:37,  6.26s/it][A
 38%|███▊      | 3/8 [00:18<00:30,  6.19s/it][A
 50%|█████     | 4/8 [00:25<00:25,  6.43s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.47s/it][A
 75%|███████▌  | 6/8 [00:38<00:13,  6.60s/it][A
 88%|████████▊ | 7/8 [00:45<00:06,  6.55s/it][A
100%|██████████| 8/8 [00:49<00:00,  5.83s/it][A100%|██████████| 8/8 [00:49<00:00,  6.21s/it]
OOV: 0.802393
GEO: 0.878788
=======entity level========

Epoch: 12, P: 0.927007, R: 0.893603, F: 0.909999, OOV: 0.802393, GEO: 0.878788
=======entity level========
Epoch:  24%|██▍       | 12/50 [12:38<39:36, 62.55s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.10s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.74s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.49s/it][A
 50%|█████     | 4/8 [00:26<00:25,  6.45s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.51s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.55s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.56s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.09s/it][A100%|██████████| 8/8 [00:51<00:00,  6.38s/it]
OOV: 0.810802
GEO: 0.874918
=======entity level========

Epoch: 13, P: 0.927017, R: 0.899147, F: 0.912869, OOV: 0.810802, GEO: 0.874918
=======entity level========
Epoch:  26%|██▌       | 13/50 [13:40<38:27, 62.37s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.54s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.93s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.73s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.69s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.62s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.60s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.58s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.99s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.799806
GEO: 0.879789
=======entity level========

Epoch: 14, P: 0.929231, R: 0.890299, F: 0.909348, OOV: 0.799806, GEO: 0.879789
=======entity level========
Epoch:  28%|██▊       | 14/50 [14:42<37:21, 62.27s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:48,  6.98s/it][A
 25%|██▌       | 2/8 [00:13<00:40,  6.80s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.88s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.63s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.60s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.60s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.47s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.99s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.803687
GEO: 0.877632
=======entity level========

Epoch: 15, P: 0.927387, R: 0.894563, F: 0.910679, OOV: 0.803687, GEO: 0.877632
=======entity level========
Epoch:  30%|███       | 15/50 [15:44<36:16, 62.18s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:47,  6.81s/it][A
 25%|██▌       | 2/8 [00:14<00:42,  7.05s/it][A
 38%|███▊      | 3/8 [00:20<00:34,  6.82s/it][A
 50%|█████     | 4/8 [00:27<00:26,  6.73s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.59s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.47s/it][A
100%|██████████| 8/8 [00:50<00:00,  5.84s/it][A100%|██████████| 8/8 [00:50<00:00,  6.36s/it]
OOV: 0.806921
GEO: 0.873608
=======entity level========

Epoch: 16, P: 0.926024, R: 0.896802, F: 0.911179, OOV: 0.806921, GEO: 0.873608
=======entity level========
Epoch:  32%|███▏      | 16/50 [16:46<35:09, 62.04s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.10s/it][A
 25%|██▌       | 2/8 [00:13<00:41,  6.84s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.68s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.66s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.62s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.59s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.63s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.94s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.801423
GEO: 0.876478
=======entity level========

Epoch: 17, P: 0.924443, R: 0.893497, F: 0.908706, OOV: 0.801423, GEO: 0.876478
=======entity level========
Epoch:  34%|███▍      | 17/50 [17:48<34:06, 62.02s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:07<00:49,  7.11s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.56s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.55s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.71s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.54s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.67s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.68s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.00s/it][A100%|██████████| 8/8 [00:51<00:00,  6.40s/it]
OOV: 0.800776
GEO: 0.877216
=======entity level========

Epoch: 18, P: 0.928066, R: 0.894030, F: 0.910730, OOV: 0.800776, GEO: 0.877216
=======entity level========
Epoch:  36%|███▌      | 18/50 [18:50<33:05, 62.06s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.45s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.66s/it][A
 38%|███▊      | 3/8 [00:20<00:33,  6.76s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.79s/it][A
 62%|██████▎   | 5/8 [00:33<00:19,  6.66s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.66s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.62s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.94s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.800776
GEO: 0.885658
=======entity level========

Epoch: 19, P: 0.928492, R: 0.892857, F: 0.910326, OOV: 0.800776, GEO: 0.885658
=======entity level========
Epoch:  38%|███▊      | 19/50 [19:52<32:02, 62.00s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:45,  6.54s/it][A
 25%|██▌       | 2/8 [00:13<00:39,  6.52s/it][A
 38%|███▊      | 3/8 [00:19<00:33,  6.68s/it][A
 50%|█████     | 4/8 [00:26<00:27,  6.75s/it][A
 62%|██████▎   | 5/8 [00:33<00:20,  6.76s/it][A
 75%|███████▌  | 6/8 [00:40<00:13,  6.78s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.72s/it][A
100%|██████████| 8/8 [00:51<00:00,  5.91s/it][A100%|██████████| 8/8 [00:51<00:00,  6.39s/it]
OOV: 0.803040
GEO: 0.866101
=======entity level========

Epoch: 20, P: 0.927198, R: 0.894776, F: 0.910699, OOV: 0.803040, GEO: 0.866101
=======entity level========
Epoch:  40%|████      | 20/50 [20:54<31:00, 62.01s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|█▎        | 1/8 [00:06<00:44,  6.37s/it][A
 25%|██▌       | 2/8 [00:12<00:38,  6.42s/it][A
 38%|███▊      | 3/8 [00:19<00:32,  6.43s/it][A
 50%|█████     | 4/8 [00:26<00:26,  6.56s/it][A
 62%|██████▎   | 5/8 [00:32<00:19,  6.65s/it][A
 75%|███████▌  | 6/8 [00:39<00:13,  6.70s/it][A
 88%|████████▊ | 7/8 [00:46<00:06,  6.77s/it][A
100%|██████████| 8/8 [00:51<00:00,  6.04s/it][A100%|██████████| 8/8 [00:51<00:00,  6.38s/it]
OOV: 0.801100
GEO: 0.870989
=======entity level========

Epoch: 21, P: 0.927931, R: 0.893603, F: 0.910444, OOV: 0.801100, GEO: 0.870989
=======entity level========

Early stop triggered at epoch 20

Epoch:  40%|████      | 20/50 [21:56<32:54, 65.82s/it]

=======best f entity level========

Epoch: 11, P: 0.926305, R: 0.887100, F: 0.906279, OOV: 0.792367, GEO: 0.887708, GEO_N: 0.849775


=======best f entity level========
